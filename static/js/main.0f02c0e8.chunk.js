(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{135:function(e,t,n){},136:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){},140:function(e,t,n){},148:function(e,t){},149:function(e,t,n){},150:function(e,t,n){},151:function(e,t,n){},152:function(e,t,n){},197:function(e,t,n){},198:function(e,t,n){},199:function(e,t,n){},200:function(e,t,n){},201:function(e,t,n){},202:function(e,t,n){},203:function(e,t,n){},204:function(e,t,n){},205:function(e,t,n){},206:function(e,t,n){},207:function(e,t,n){},208:function(e,t,n){},209:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},214:function(e,t,n){"use strict";n.r(t);var r,a,o,s=n(25),c=n.n(s),i=n(34),u=n(75),l=n.n(u),m=n(0),d=n(22),p=n(81),g=n(38),v=n(12);function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.common,n=arguments.length>2?arguments[2]:void 0;return{type:o.addLogEntry,key:e,channel:t,context:n}}!function(e){e.gameTick="gameTick"}(r||(r={})),function(e){e[e.common=0]="common",e[e.town=1]="town",e[e.quest=2]="quest"}(a||(a={})),(o||(o={})).addLogEntry="addLogEntry";var f,b,y=function(e){var t=e.split(".").map(function(e){return Number(e)});if(3!==t.length)throw new Error("Received invalid version string: ".concat(e));t.forEach(function(e){if(e>=1024)throw new Error("Version string invalid, ".concat(e," is too large"))});for(var n=0,r=0;r<3;r++)n|=t[r]<<10*r;return n}("0.0.4"),w=n(1),k=n(3),O=n(4),T=n(6),j=n(5),E=n(7);function I(e,t,n){return{type:f.moveItemInInventory,adventurerId:e,fromSlot:t,toSlot:n}}function N(e,t,n){return{type:f.addItemToInventory,adventurerId:e,item:t,toSlot:n}}function C(e,t){return{type:b.addItem,item:e,toSlot:t}}!function(e){e.moveItemInInventory="moveItemInInventory",e.moveItemToOtherAdventurer="moveItemToOtherAdventurer",e.moveItemFromWarehouseToAdventurer="moveItemFromWarehouseToAdventurer",e.addItemToInventory="addItemToInventory",e.removeItemFromInventory="removeItemFromInventory"}(f||(f={})),function(e){e.addItem="addItem",e.moveItemInWarehouse="moveItemInWarehouse",e.removeItem="removeItem"}(b||(b={}));var x,S="adventurer",q="item";!function(e){e[e.adventurer=0]="adventurer",e[e.warehouse=1]="warehouse",e[e.tavern=2]="tavern"}(x||(x={}));var A,D=n(26),M=n(13);!function(e){e[e.resource=0]="resource",e[e.production=1]="production",e[e.tavern=2]="tavern",e[e.warehouse=3]="warehouse"}(A||(A={}));var R,B,W={type:A.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-alchemist-name",workerCapacity:2,cost:{gold:0},produces:[]},{displayName:"structure-alchemist-name",workerCapacity:5,cost:{gold:30},produces:[]},{displayName:"structure-alchemist-name",workerCapacity:10,cost:{gold:50},produces:[]}]},L=n(49),Q=(n(134),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"milliseconds";return L.duration(e,t).format("d [days] h [hours] m [min] s [sec]",{trim:"both"})});!function(e){e[e.deed=0]="deed",e[e.equipment=1]="equipment",e[e.material=2]="material",e[e.questItem=3]="questItem",e[e.trinket=4]="trinket",e[e.weapon=5]="weapon"}(R||(R={})),function(e){e.deedForLumbermill="deedForLumbermill",e.deedForWeaponsmith="deedForWeaponsmith",e.boots1="boots1",e.boots2="boots2",e.boots3="boots3",e.chainmailHood="chainmailHood",e.chest="chest",e.clothGloves="clothGloves",e.cowl="cowl",e.fedora="fedora",e.druidChest="druidChest",e.druidFeet="druidFeet",e.druidHands="druidHands",e.druidHead="druidHead",e.druidLegs="druidLegs",e.greaves1="greaves1",e.greaves2="greaves2",e.hornedHelmet="hornedHelmet",e.leatherGloves="leatherGloves",e.nomadHelmet="nomadHelmet",e.pants1="pants1",e.pants2="pants2",e.plateChest1="plateChest1",e.plateChest2="plateChest2",e.plateChest3="plateChest3",e.plateChest4="plateChest4",e.plateGloves1="plateGloves1",e.plateGloves2="plateGloves2",e.plateHelmet="plateHelmet",e.platePants="platePants",e.plateShoulders1="plateShoulders1",e.plateShoulders2="plateShoulders2",e.robe="robe",e.shoulders1="shoulders1",e.shoulders2="shoulders2",e.shoulders3="shoulders3",e.vest="vest",e.bolts="bolts",e.buckle="buckle",e.chain="chain",e.cogs="cogs",e.gem="gem",e.ingot="ingot",e.nails="nails",e.poisonVial="poisonVial",e.ribbon="ribbon",e.rope="rope",e.scales="scales",e.spring="spring",e.thread="thread",e.blueprints="blueprints",e.crate="crate",e.dynamite="dynamite",e.eye="eye",e.feather="feather",e.food="food",e.heart="heart",e.horn="horn",e.key="key",e.letters="letters",e.lockPicks="lockPicks",e.oil="oil",e.orcFinger="orcFinger",e.plans="plans",e.purpleGems="purpleGems",e.runestone="runestone",e.teeth="teeth",e.tooth="tooth",e.torch="torch",e.tusk="tusk",e.vase="vase",e.vial="vial",e.weeds="weeds",e.ring="ring",e.magicAmulet="magicAmulet",e.battleAxe="battleAxe",e.brassKnuckles="brassKnuckles",e.cleaver="cleaver",e.club="club",e.crossbow="crossbow",e.dagger="dagger",e.flail="flail",e.greatswordOfGwai="greatswordOfGwai",e.khopesh="khopesh",e.longbow="longbow",e.mace="mace",e.morningStar="morningStar",e.poisonedDagger="poisonedDagger",e.ravenStaff="ravenStaff",e.savageStaff="savageStaff",e.spear="spear",e.sword="sword",e.warhammer="warhammer"}(B||(B={}));var F,H={item:B.boots1,cost:{resources:{wood:2,iron:15},time:18e5}},_={item:B.chest,cost:{resources:{wood:10,iron:45},time:36e5}},G={item:B.cowl,cost:{resources:{iron:15},time:36e5}},U={cost:{gold:40,time:4e3},type:A.production,levels:[{displayName:"structure-armoursmith-name",workerCapacity:2,cost:{gold:0},produces:[H]},{displayName:"structure-armoursmith-name",workerCapacity:5,cost:{gold:30},produces:[H,_]},{displayName:"structure-armoursmith-name",workerCapacity:10,cost:{gold:50},produces:[H,_,G]}]},V={type:A.resource,cost:{gold:40,time:4e3},levels:[{displayName:"structure-garden-name",workerCapacity:2,cost:{gold:0},generates:{food:2}},{displayName:"structure-garden-name",workerCapacity:5,cost:{gold:30},generates:{food:2}},{displayName:"structure-garden-name",workerCapacity:10,cost:{gold:50},generates:{food:2}}]},z={type:A.resource,cost:{gold:31,time:5e3},levels:[{displayName:"structure-lumber-mill-name",workerCapacity:2,cost:{gold:0},generates:{wood:2}},{displayName:"structure-lumber-mill-name",workerCapacity:5,cost:{gold:30},generates:{wood:2}},{displayName:"structure-lumber-mill-name",workerCapacity:10,cost:{gold:50},generates:{wood:2}}]},P={cost:{gold:40,time:4e3},type:A.resource,levels:[{displayName:"structure-mine-name",workerCapacity:2,cost:{gold:0},generates:{iron:2}},{displayName:"structure-mine-name",workerCapacity:5,cost:{gold:30},generates:{iron:2}},{displayName:"structure-mine-name",workerCapacity:10,cost:{gold:50},generates:{iron:2}}]},K={cost:{gold:40,time:4e3},type:A.production,levels:[{displayName:"structure-quarry-name",workerCapacity:2,cost:{gold:0},produces:[]},{displayName:"structure-quarry-name",workerCapacity:5,cost:{gold:30},produces:[]},{displayName:"structure-quarry-name",workerCapacity:10,cost:{gold:50},produces:[]}]},X={cost:{gold:40,time:4e3},type:A.resource,levels:[{displayName:"structure-tannery-name",workerCapacity:2,cost:{gold:0},generates:{leather:2}},{displayName:"structure-tannery-name",workerCapacity:5,cost:{gold:30},generates:{leather:5}},{displayName:"structure-tannery-name",workerCapacity:10,cost:{gold:50},generates:{leather:7}}]},Y={cost:{gold:40,time:4e3},type:A.tavern,levels:[{displayName:"structure-tavern-name",workerCapacity:2,cost:{gold:0},rooms:10},{displayName:"structure-tavern-name",workerCapacity:5,cost:{gold:30},rooms:12},{displayName:"structure-tavern-name",workerCapacity:10,cost:{gold:50},rooms:15}]},J={cost:{gold:40,time:4e3},type:A.warehouse,levels:[{displayName:"structure-warehouse-name",workerCapacity:2,cost:{gold:0},maxResources:{fabric:200,food:200,gunpowder:200,iron:200,leather:200,stone:200,wood:200}},{displayName:"structure-warehouse-name",workerCapacity:5,cost:{gold:30},maxResources:{fabric:500,food:500,gunpowder:500,iron:500,leather:500,stone:500,wood:500}},{displayName:"structure-warehouse-name",workerCapacity:10,cost:{gold:50},maxResources:{fabric:1e3,food:1e3,gunpowder:1e3,iron:1e3,leather:1e3,stone:1e3,wood:1e3}}]},Z={item:B.crossbow,cost:{resources:{wood:20,iron:5},time:18e5}},$={item:B.longbow,cost:{resources:{wood:40,iron:5},time:36e5}},ee={item:B.poisonedDagger,cost:{resources:{wood:50,iron:15},materials:[B.poisonVial],time:36e5}},te={item:B.dagger,cost:{resources:{wood:10,iron:10},time:36e5}},ne={item:B.sword,cost:{resources:{wood:10,iron:30},time:36e5}},re={item:B.khopesh,cost:{resources:{wood:15,iron:40},time:12e4}},ae={type:A.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-weaponsmith-name",workerCapacity:2,cost:{gold:0},produces:[Z,te]},{displayName:"structure-weaponsmith-name",workerCapacity:5,cost:{gold:30},produces:[Z,te,$]},{displayName:"structure-weaponsmith-name",workerCapacity:10,cost:{gold:50},produces:[Z,te,$,ne,re]},{displayName:"structure-weaponsmith-name",workerCapacity:14,cost:{gold:50},produces:[Z,te,$,ne,re,ee]}]},oe={cost:{gold:40,time:4e3},type:A.resource,levels:[{displayName:"structure-weaver-name",workerCapacity:2,cost:{gold:0},generates:{fabric:2}},{displayName:"structure-weaver-name",workerCapacity:5,cost:{gold:30},generates:{fabric:5}},{displayName:"structure-weaver-name",workerCapacity:10,cost:{gold:50},generates:{fabric:7}}]};!function(e){e.alchemist="alchemist",e.armoursmith="armoursmith",e.garden="garden",e.lumberMill="lumberMill",e.mine="mine",e.quarry="quarry",e.tavern="tavern",e.tannery="tannery",e.warehouse="warehouse",e.weaponsmith="weaponsmith",e.weaver="weaver"}(F||(F={}));var se,ce,ie={alchemist:W,armoursmith:U,garden:V,lumberMill:z,mine:P,quarry:K,tavern:Y,tannery:X,warehouse:J,weaponsmith:ae,weaver:oe},ue=R.deed,le={deedForLumbermill:{item:B.deedForLumbermill,structure:F.lumberMill,itemType:ue,subText:"It allows for the construction of a lumber mill",iconImg:"/img/items/deeds/deed.png"},deedForWeaponsmith:{item:B.deedForWeaponsmith,structure:F.weaponsmith,itemType:ue,subText:"It allows for the construction of a weaponsmith",iconImg:"/img/items/deeds/deed.png"}},me=R.equipment,de="/img/items/equipment/";!function(e){e[e.feet=0]="feet",e[e.hands=1]="hands",e[e.chest=2]="chest",e[e.legs=3]="legs",e[e.head=4]="head",e[e.shoulders=5]="shoulders"}(ce||(ce={}));var pe,ge,ve,he,fe,be=(se={},Object(w.a)(se,B.boots1,{item:B.boots1,equipmentType:ce.feet,itemType:me,subText:"These boots are made for questin'",iconImg:"".concat(de,"boots_1.png")}),Object(w.a)(se,B.boots2,{item:B.boots2,equipmentType:ce.feet,itemType:me,subText:"",iconImg:"".concat(de,"boots_2.png")}),Object(w.a)(se,B.boots3,{item:B.boots3,equipmentType:ce.feet,itemType:me,subText:"",iconImg:"".concat(de,"boots_3.png")}),Object(w.a)(se,B.chainmailHood,{item:B.chainmailHood,equipmentType:ce.head,itemType:me,subText:"",iconImg:"".concat(de,"chainmail_hood.png")}),Object(w.a)(se,B.chest,{item:B.chest,equipmentType:ce.chest,itemType:me,subText:"",iconImg:"".concat(de,"chest_1.png")}),Object(w.a)(se,B.clothGloves,{item:B.clothGloves,equipmentType:ce.hands,itemType:me,subText:"",iconImg:"".concat(de,"cloth_gloves.png")}),Object(w.a)(se,B.cowl,{item:B.cowl,equipmentType:ce.head,itemType:me,subText:"",iconImg:"".concat(de,"cowl.png")}),Object(w.a)(se,B.druidChest,{item:B.druidHands,equipmentType:ce.chest,itemType:me,subText:"",iconImg:"".concat(de,"druid-chest.png")}),Object(w.a)(se,B.druidFeet,{item:B.druidFeet,equipmentType:ce.feet,itemType:me,subText:"",iconImg:"".concat(de,"druid-feet.png")}),Object(w.a)(se,B.druidHands,{item:B.druidHands,equipmentType:ce.hands,itemType:me,subText:"",iconImg:"".concat(de,"druid-hands.png")}),Object(w.a)(se,B.druidHead,{item:B.druidHead,equipmentType:ce.head,itemType:me,subText:"",iconImg:"".concat(de,"druid-head.png")}),Object(w.a)(se,B.druidLegs,{item:B.druidLegs,equipmentType:ce.legs,itemType:me,subText:"",iconImg:"".concat(de,"druid-legs.png")}),Object(w.a)(se,B.fedora,{item:B.fedora,equipmentType:ce.head,itemType:me,subText:"I study the blade",iconImg:"".concat(de,"fedora.png")}),Object(w.a)(se,B.greaves1,{item:B.greaves1,equipmentType:ce.hands,itemType:me,subText:"",iconImg:"".concat(de,"greaves_1.png")}),Object(w.a)(se,B.greaves2,{item:B.greaves2,equipmentType:ce.hands,itemType:me,subText:"",iconImg:"".concat(de,"greaves_2.png")}),Object(w.a)(se,B.hornedHelmet,{item:B.hornedHelmet,equipmentType:ce.head,itemType:me,subText:"",iconImg:"".concat(de,"horned_helmet.png")}),Object(w.a)(se,B.leatherGloves,{item:B.leatherGloves,equipmentType:ce.hands,itemType:me,subText:"",iconImg:"".concat(de,"leather_gloves.png")}),Object(w.a)(se,B.nomadHelmet,{item:B.nomadHelmet,equipmentType:ce.head,itemType:me,subText:"",iconImg:"".concat(de,"nomad_helmet.png")}),Object(w.a)(se,B.pants1,{item:B.pants1,equipmentType:ce.legs,itemType:me,subText:"",iconImg:"".concat(de,"pants_1.png")}),Object(w.a)(se,B.pants2,{item:B.pants2,equipmentType:ce.legs,itemType:me,subText:"",iconImg:"".concat(de,"pants_2.png")}),Object(w.a)(se,B.plateChest1,{item:B.plateChest1,equipmentType:ce.chest,itemType:me,subText:"",iconImg:"".concat(de,"plate_chest_1.png")}),Object(w.a)(se,B.plateChest2,{item:B.plateChest2,equipmentType:ce.chest,itemType:me,subText:"",iconImg:"".concat(de,"plate_chest_2.png")}),Object(w.a)(se,B.plateChest3,{item:B.plateChest3,equipmentType:ce.chest,itemType:me,subText:"",iconImg:"".concat(de,"plate_chest_3.png")}),Object(w.a)(se,B.plateChest4,{item:B.plateChest4,equipmentType:ce.chest,itemType:me,subText:"",iconImg:"".concat(de,"plate_chest_4.png")}),Object(w.a)(se,B.plateGloves1,{item:B.plateGloves1,equipmentType:ce.hands,itemType:me,subText:"",iconImg:"".concat(de,"plate_gloves_1.png")}),Object(w.a)(se,B.plateGloves2,{item:B.plateGloves2,equipmentType:ce.hands,itemType:me,subText:"",iconImg:"".concat(de,"plate_gloves_2.png")}),Object(w.a)(se,B.plateHelmet,{item:B.plateHelmet,equipmentType:ce.head,itemType:me,subText:"",iconImg:"".concat(de,"plate_helmet_1.png")}),Object(w.a)(se,B.platePants,{item:B.platePants,equipmentType:ce.legs,itemType:me,subText:"",iconImg:"".concat(de,"plate_pants1.png")}),Object(w.a)(se,B.plateShoulders1,{item:B.plateShoulders1,equipmentType:ce.shoulders,itemType:me,subText:"",iconImg:"".concat(de,"plate_shoulders_1.png")}),Object(w.a)(se,B.plateShoulders2,{item:B.plateShoulders2,equipmentType:ce.shoulders,itemType:me,subText:"",iconImg:"".concat(de,"plate_shoulders_2.png")}),Object(w.a)(se,B.robe,{item:B.robe,equipmentType:ce.chest,itemType:me,subText:"",iconImg:"".concat(de,"robe_1.png")}),Object(w.a)(se,B.shoulders1,{item:B.shoulders1,equipmentType:ce.shoulders,itemType:me,subText:"",iconImg:"".concat(de,"shoulders_1.png")}),Object(w.a)(se,B.shoulders2,{item:B.shoulders2,equipmentType:ce.shoulders,itemType:me,subText:"",iconImg:"".concat(de,"shoulders_2.png")}),Object(w.a)(se,B.shoulders3,{item:B.shoulders3,equipmentType:ce.shoulders,itemType:me,subText:"",iconImg:"".concat(de,"shoulders_3.png")}),Object(w.a)(se,B.vest,{item:B.vest,equipmentType:ce.chest,itemType:me,subText:"",iconImg:"".concat(de,"vest_1.png")}),se),ye=R.material,we="/img/items/materials/",ke=(pe={},Object(w.a)(pe,B.bolts,{item:B.bolts,itemType:ye,iconImg:"".concat(we,"bolts.png")}),Object(w.a)(pe,B.buckle,{item:B.buckle,itemType:ye,iconImg:"".concat(we,"buckle.png")}),Object(w.a)(pe,B.chain,{item:B.chain,itemType:ye,iconImg:"".concat(we,"chain.png")}),Object(w.a)(pe,B.cogs,{item:B.cogs,itemType:ye,iconImg:"".concat(we,"cogs.png")}),Object(w.a)(pe,B.gem,{item:B.gem,itemType:ye,iconImg:"".concat(we,"gem.png")}),Object(w.a)(pe,B.ingot,{item:B.ingot,itemType:ye,iconImg:"".concat(we,"ingot.png")}),Object(w.a)(pe,B.nails,{item:B.nails,itemType:ye,iconImg:"".concat(we,"nails.png")}),Object(w.a)(pe,B.poisonVial,{item:B.poisonVial,itemType:ye,iconImg:"".concat(we,"poison-vial.png")}),Object(w.a)(pe,B.ribbon,{item:B.ribbon,itemType:ye,iconImg:"".concat(we,"ribbon.png")}),Object(w.a)(pe,B.rope,{item:B.rope,itemType:ye,iconImg:"".concat(we,"rope.png")}),Object(w.a)(pe,B.gem,{item:B.gem,itemType:ye,iconImg:"".concat(we,"gem.png")}),Object(w.a)(pe,B.scales,{item:B.scales,itemType:ye,iconImg:"".concat(we,"scales.png")}),Object(w.a)(pe,B.spring,{item:B.spring,itemType:ye,iconImg:"".concat(we,"spring.png")}),Object(w.a)(pe,B.thread,{item:B.thread,itemType:ye,iconImg:"".concat(we,"thread.png")}),pe),Oe=R.questItem,Te="/img/items/quest-items/",je=(ge={},Object(w.a)(ge,B.blueprints,{item:B.blueprints,itemType:Oe,iconImg:"".concat(Te,"blueprints.png")}),Object(w.a)(ge,B.crate,{item:B.crate,itemType:Oe,iconImg:"".concat(Te,"crate.png")}),Object(w.a)(ge,B.dynamite,{item:B.dynamite,itemType:Oe,iconImg:"".concat(Te,"dynamite.png")}),Object(w.a)(ge,B.eye,{item:B.eye,itemType:Oe,iconImg:"".concat(Te,"eye.png")}),Object(w.a)(ge,B.feather,{item:B.feather,itemType:Oe,iconImg:"".concat(Te,"feather.png")}),Object(w.a)(ge,B.food,{item:B.food,itemType:Oe,iconImg:"".concat(Te,"food.png")}),Object(w.a)(ge,B.heart,{item:B.heart,itemType:Oe,iconImg:"".concat(Te,"heart.png")}),Object(w.a)(ge,B.horn,{item:B.horn,itemType:Oe,iconImg:"".concat(Te,"horn.png")}),Object(w.a)(ge,B.key,{item:B.key,itemType:Oe,iconImg:"".concat(Te,"key.png")}),Object(w.a)(ge,B.letters,{item:B.letters,itemType:Oe,iconImg:"".concat(Te,"letters.png")}),Object(w.a)(ge,B.lockPicks,{item:B.lockPicks,itemType:Oe,iconImg:"".concat(Te,"lock-picks.png")}),Object(w.a)(ge,B.oil,{item:B.oil,itemType:Oe,iconImg:"".concat(Te,"oil.png")}),Object(w.a)(ge,B.orcFinger,{item:B.orcFinger,itemType:Oe,iconImg:"".concat(Te,"orc-finger.png")}),Object(w.a)(ge,B.plans,{item:B.plans,itemType:Oe,iconImg:"".concat(Te,"plans.png")}),Object(w.a)(ge,B.purpleGems,{item:B.purpleGems,itemType:Oe,iconImg:"".concat(Te,"purple-gems.png")}),Object(w.a)(ge,B.runestone,{item:B.runestone,itemType:Oe,iconImg:"".concat(Te,"runestone.png")}),Object(w.a)(ge,B.teeth,{item:B.teeth,itemType:Oe,iconImg:"".concat(Te,"teeth.png")}),Object(w.a)(ge,B.tooth,{item:B.tooth,itemType:Oe,iconImg:"".concat(Te,"tooth.png")}),Object(w.a)(ge,B.torch,{item:B.torch,itemType:Oe,iconImg:"".concat(Te,"torch.png")}),Object(w.a)(ge,B.tusk,{item:B.tusk,itemType:Oe,iconImg:"".concat(Te,"tusk.png")}),Object(w.a)(ge,B.vase,{item:B.vase,itemType:Oe,iconImg:"".concat(Te,"vase.png")}),Object(w.a)(ge,B.vial,{item:B.vial,itemType:Oe,iconImg:"".concat(Te,"vial.png")}),Object(w.a)(ge,B.weeds,{item:B.weeds,itemType:Oe,iconImg:"".concat(Te,"weeds.png")}),ge),Ee=R.trinket,Ie=(ve={},Object(w.a)(ve,B.magicAmulet,{item:B.magicAmulet,itemType:Ee,iconImg:"".concat("/img/items/trinkets/","magic_amulet.png")}),Object(w.a)(ve,B.ring,{item:B.ring,itemType:Ee,iconImg:"".concat("/img/items/trinkets/","ring.png")}),ve),Ne=R.weapon,Ce="/img/items/weapons/";!function(e){e[e.axe=0]="axe",e[e.bow=1]="bow",e[e.club=2]="club",e[e.crossbow=3]="crossbow",e[e.fist=4]="fist",e[e.flail=5]="flail",e[e.hammer=6]="hammer",e[e.melee=7]="melee",e[e.knife=8]="knife",e[e.staff=9]="staff",e[e.sword=10]="sword",e[e.poleArm=11]="poleArm"}(fe||(fe={}));var xe=(he={},Object(w.a)(he,B.battleAxe,{item:B.battleAxe,itemType:Ne,weaponType:fe.axe,subText:"It's an axe for battle",iconImg:"".concat(Ce,"battle_axe.png")}),Object(w.a)(he,B.brassKnuckles,{item:B.brassKnuckles,itemType:Ne,weaponType:fe.melee,subText:" Brass knuckles are pieces of metal shaped to fit around the knuckles.",iconImg:"".concat(Ce,"brass_knuckles.png")}),Object(w.a)(he,B.crossbow,{item:B.crossbow,itemType:Ne,weaponType:fe.crossbow,subText:"Shoots and reloads fast",iconImg:"".concat(Ce,"crossbow.png")}),Object(w.a)(he,B.cleaver,{item:B.cleaver,itemType:Ne,weaponType:fe.knife,subText:"A cleaver is a large knife that varies in its shape but usually resembles a rectangular-bladed hatchet.",iconImg:"".concat(Ce,"cleaver.png")}),Object(w.a)(he,B.club,{item:B.club,itemType:Ne,weaponType:fe.club,subText:"A club is among the simplest of all weapons: a short staff or stick, usually made of wood, wielded as a weapon",iconImg:"".concat(Ce,"club.png")}),Object(w.a)(he,B.dagger,{item:B.dagger,itemType:Ne,weaponType:fe.knife,subText:"Excellent for ritual sacrifice and cheese platters",iconImg:"".concat(Ce,"dagger.png")}),Object(w.a)(he,B.flail,{item:B.flail,itemType:Ne,weaponType:fe.flail,subText:"A flail is a weapon consisting of a striking head attached to a handle by a flexible rope, strap, or chain. ",iconImg:"".concat(Ce,"flail.png")}),Object(w.a)(he,B.greatswordOfGwai,{item:B.greatswordOfGwai,itemType:Ne,weaponType:fe.sword,subText:"Finer steel was seldom forged",iconImg:"".concat(Ce,"greatsword-gwai.png"),unique:!0}),Object(w.a)(he,B.khopesh,{item:B.khopesh,itemType:Ne,weaponType:fe.sword,subText:"Dafuq is this. Can I get garlic sauce with that?",iconImg:"".concat(Ce,"khopesh.png")}),Object(w.a)(he,B.longbow,{item:B.longbow,itemType:Ne,weaponType:fe.bow,subText:"A deadly killer from long range",iconImg:"".concat(Ce,"longbow.png")}),Object(w.a)(he,B.mace,{item:B.mace,itemType:Ne,weaponType:fe.club,subText:"A mace is a blunt weapon, a type of club or virge that uses a heavy head on the end of a handle to deliver powerful blows.",iconImg:"".concat(Ce,"mace.png")}),Object(w.a)(he,B.morningStar,{item:B.morningStar,itemType:Ne,weaponType:fe.club,subText:"A morning star is any of several medieval club-like weapons consisting of a shaft with an attached ball adorned with one or more spikes.",iconImg:"".concat(Ce,"morning-star.png")}),Object(w.a)(he,B.poisonedDagger,{item:B.poisonedDagger,itemType:Ne,weaponType:fe.knife,subText:"Excellent for ritual sacrifice and cheese platters",iconImg:"".concat(Ce,"poisoned-dagger.png")}),Object(w.a)(he,B.ravenStaff,{item:B.ravenStaff,itemType:Ne,weaponType:fe.staff,subText:"Kaa, kaa!",iconImg:"".concat(Ce,"raven-staff.png")}),Object(w.a)(he,B.savageStaff,{item:B.savageStaff,itemType:Ne,weaponType:fe.staff,subText:"Savage dude",iconImg:"".concat(Ce,"savage-staff.png")}),Object(w.a)(he,B.spear,{item:B.spear,itemType:Ne,weaponType:fe.poleArm,subText:"A spear is a pole weapon consisting of a shaft, usually of wood, with a pointed head. ",iconImg:"".concat(Ce,"sword.png")}),Object(w.a)(he,B.sword,{item:B.sword,itemType:Ne,weaponType:fe.sword,subText:"An elegant weapon for a more civilized age",iconImg:"".concat(Ce,"sword.png")}),Object(w.a)(he,B.warhammer,{item:B.warhammer,itemType:Ne,weaponType:fe.hammer,subText:"A war hammer is a late medieval weapon of war intended for close combat action, whose design resembles the hammer",iconImg:"".concat(Ce,"warhammer.png")}),he),Se=Object(M.a)({},le,be,ke,je,Ie,xe),qe=Se;function Ae(e){return Se[e]}var De=function(){function e(){Object(k.a)(this,e)}return Object(O.a)(e,null,[{key:"init",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.texts=e,this.templates={},t&&this.compileAll(),this.initialized=!0}},{key:"get",value:function(e,t){if(!this.initialized)throw new Error("Error ".concat(this," not initialized!"));var n=this.getTemplate(e);return n?n(t):(console.error("Key '".concat(e,"' not found in TextManager")),"<<'".concat(e,"' missing>>"))}},{key:"getTemplate",value:function(e){var t=this.templates[e];return!t&&this.texts[e]&&(this.compile(e,this.texts[e]),t=this.templates[e]),t}},{key:"getQuestTitle",value:function(e){return this.get("quest-".concat(e,"-title"))}},{key:"getQuestDescription",value:function(e){return this.get("quest-".concat(e,"-description"))}},{key:"getResourceName",value:function(e){return this.get("resource-".concat(e,"-name"))}},{key:"getItemName",value:function(e){var t=R[Ae(e).itemType];return this.get("item-".concat(t,"-").concat(e,"-name"))}},{key:"compileAll",value:function(){var e=this;Object.keys(this.texts).forEach(function(t){e.compile(t,e.texts[t])})}},{key:"compile",value:function(e,t){var n=D.compile(t);this.templates[e]=n}}]),e}();De.initialized=!1,De.texts=void 0,De.templates=void 0,D.registerHelper("item:name",function(e,t){if(!qe[e])return new D.SafeString("<<ITEM DEFINITION NOT FOUND: ".concat(e,">>"));switch(t){case"aA":return Me(e);case"aD":case"aU":return Be(e);default:var n=qe[e].name;return new D.SafeString(n)}}),D.registerHelper("structure:name",function(e){var t=De.get("structure-".concat(e,"-name"));return new D.SafeString(t)});var Me=function(e){return Re(e)},Re=function(e){var t=qe[e].name,n=De.getTemplate("common-article-undefined");return new D.SafeString("".concat(n({noun:t})))},Be=function(e){var t=qe[e].name,n=De.getTemplate("common-article-defined");return new D.SafeString("".concat(n({noun:t})))},We=(n(135),n(136),function(e){var t=e.adventurer,n=(e.className||"")+" avatar";return m.createElement("div",{className:n,style:{backgroundImage:"url(".concat(t.avatarImg,")")},onClick:function(){e.onClick&&e.onClick(e.adventurer.id)}},m.createElement("div",{className:"sizer"}),e.displayName&&m.createElement("div",{className:"name"},t.name))}),Le=(n(137),function(e){var t=e.item,n=qe[t];return n||console.warn("could not find definition for ".concat(t)),m.createElement("div",{className:"item-icon",onClick:e.onClick,style:{backgroundImage:"url(".concat(n.iconImg,")")}})});var Qe,Fe=function(e){function t(){return Object(k.a)(this,t),Object(T.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.onClick,r=e.isDragging,a=e.connectDragSource;return r?null:a(m.createElement("div",null,m.createElement(Le,{item:t,onClick:n})))}}]),t}(m.Component),He=Object(d.c)(q,{beginDrag:function(e){return{inventorySlot:e.index,item:e.item,sourceId:e.sourceId,sourceType:e.sourceType}}},function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(Fe);!function(e){e[e.item=0]="item"}(Qe||(Qe={}));var _e,Ge=function(e){return function(t){function n(){return Object(k.a)(this,n),Object(T.a)(this,Object(j.a)(n).apply(this,arguments))}return Object(E.a)(n,t),Object(O.a)(n,[{key:"render",value:function(){var t=this;return m.createElement(Yn.Consumer,null,function(n){return m.createElement(e,Object.assign({},t.props,n))})}}]),n}(m.Component)},Ue=(n(138),function(e){function t(){return Object(k.a)(this,t),Object(T.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isOver,n=e.canDrop,r="#1b8417";return t&&n?r="#e2bc23":n&&(r="#7ea752"),(0,e.connectDropTarget)(m.createElement("div",{style:{borderColor:r},className:"inventory-item"},this.props.children))}}]),t}(m.Component)),Ve=Object(d.d)(q,{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e){return e.empty}},function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}})(Ue),ze=Ge(function(e){for(var t=[],n=function(n){var r=void 0,a=e.items[n];a&&(r=m.createElement(He,{index:n,sourceId:e.sourceId,sourceType:e.sourceType,item:a,onClick:function(){e.onContextualObjectActivated(Qe.item,qe[a])}}));var o=m.createElement(Ve,{key:"inventory-slot-".concat(n),empty:void 0===r,onDrop:function(t){if(e.onDropItem){var r=t.inventorySlot;e.onDropItem(t.item,r,n,t.sourceType,t.sourceId)}}},r);t.push(o)},r=0;r<e.items.length;r++)n(r);return m.createElement("div",{className:"inventory"},t)}),Pe=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).state={selectedAdventurer:null},n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=function(t){var n=t.id===e.state.selectedAdventurer?"selected":void 0;return m.createElement("li",{key:t.id,className:n},m.createElement(We,{adventurer:t,onClick:function(){var n=e.state.selectedAdventurer===t.id?null:t.id;e.setState({selectedAdventurer:n})}}))};return m.createElement("div",{className:"adventurers-box"},m.createElement("h3",null,"Adventurers"),m.createElement("ul",null,Object.keys(e.props.groupedAdventurers).map(function(n){return function(n,r){var a=r.find(function(t){return t.id===e.state.selectedAdventurer}),o=null;a&&(o=m.createElement("div",{className:"adventurer-info"},m.createElement("div",null,a.name," "),m.createElement("div",{className:"adventurer-info-container"},m.createElement("div",{className:"equipment"},m.createElement("br",null),"[ TODO: GEAR ]"),m.createElement(ze,{items:a.inventory,sourceId:a.id,sourceType:x.adventurer,onDropItem:function(t,n,r,o){switch(o){case x.adventurer:e.props.onMoveItemInInventory&&e.props.onMoveItemInInventory(a.id,n,r);break;case x.warehouse:e.props.onMoveItemFromWarehouseToAdventurer&&e.props.onMoveItemFromWarehouseToAdventurer(a.id,t,n,r)}}}))));var s=e.props.quests.find(function(e){return e.name===n}),c="",i="";return s&&(i="img/sigils/".concat(s.icon),c=De.getQuestTitle(s.name)),m.createElement("li",{key:n,className:"group"},m.createElement("div",{className:"sigil",style:{backgroundImage:"url(".concat(i,")")}}),m.createElement("span",{className:"title",title:c}," ",c," "),m.createElement("ul",{className:"adventurer-portraits"},r.map(function(e){return t(e)})),o)}(n,e.props.groupedAdventurers[n])})))}}]),t}(m.Component),Ke=n(17),Xe=n(39);!function(e){e[e.unavailable=0]="unavailable",e[e.available=1]="available",e[e.active=2]="active",e[e.completed=3]="completed"}(_e||(_e={}));var Ye,Je,Ze,$e,et,tt=Object(Xe.a)([function(e){return e.adventurers},function(e){return e.quests}],function(e,t){var n=[],r=function(t){return e.find(function(e){return e.id===t})},a=Object.values(t).reduce(function(e,t){var a=t.party.map(function(e){return r(e)});return t.status===_e.active&&(e[t.name]=a),n.push.apply(n,Object(Ke.a)(a)),e},{});return a.solo=e.filter(function(e){return-1===n.indexOf(e)}),a}),nt=Object(v.b)(function(e){return{groupedAdventurers:tt(e),quests:e.quests}},function(e){return{onMoveItemFromWarehouseToAdventurer:function(t,n,r,a){var o=function(e){return{type:b.removeItem,fromSlot:e}}(r);e(o);var s=N(t,n,a);e(s)},onMoveItemInInventory:function(t,n,r){var a=I(t,n,r);e(a)}}})(Pe);function rt(e){return{type:Je.addGold,amount:e}}function at(e){return{type:Je.addGold,amount:-e}}function ot(e){return{type:Ze.addResources,resources:e}}function st(e){return{type:$e.finishBuildingStructure,structure:e}}function ct(e){return{type:$e.upgradeStructure,structure:e}}function it(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:$e.increaseWorkers,structure:e,workers:t}}function ut(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:$e.decreaseWorkers,structure:e,workers:t}}(Ye||(Ye={})).addWorkers="addWorkers",(Je||(Je={})).addGold="addGold",function(e){e.addResources="addResources",e.removeResources="removeResources"}(Ze||(Ze={})),function(e){e.upgradeStructure="upgradeStructure",e.increaseWorkers="increaseWorkers",e.decreaseWorkers="decreaseWorkers",e.startBuildingStructure="startBuildingStructure",e.finishBuildingStructure="finishBuildingStructure",e.setStructureState="setStructureState"}($e||($e={})),function(e){e[e.NotBuilt=0]="NotBuilt",e[e.Building=1]="Building",e[e.Built=2]="Built"}(et||(et={}));et.NotBuilt,n(139);var lt,mt=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).itemSelectRef=void 0,n.handleCheatGold=function(e){var t=n.state.gold;n.props.onCheatGold&&n.props.onCheatGold(t)},n.handleCheatWorkers=function(e){var t=n.state.workers;n.props.onCheatWorkers&&n.props.onCheatWorkers(t)},n.handleCheatResources=function(e){var t={food:n.state.resources,iron:n.state.resources,leather:n.state.resources,wood:n.state.resources};n.props.onCheatResources&&n.props.onCheatResources(t)},n.handleCheatItem=function(e){var t=n.itemSelectRef.current.value;n.props.onCheatItem&&n.props.onCheatItem(t)},n.handleChangeStructureState=function(e,t){n.props.onCheatStructureState&&n.props.onCheatStructureState(e,t?et.Built:et.NotBuilt)},n.handleChangeGold=function(e){var t=Number(e.target.value);n.setState({gold:t})},n.handleChangeWorkers=function(e){var t=Number(e.target.value);n.setState({workers:t})},n.handleChangeResources=function(e){var t=Number(e.target.checked);n.setState({resources:t})},n.state={gold:50,resources:50,workers:10},n.itemSelectRef=m.createRef(),n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=Object.keys(this.props.structures).map(function(t){return function(t){var n=ie[t],r=e.props.structures[t],a=n.levels[r.level],o=De.get(a.displayName);return m.createElement("div",{className:"label-dropdown",key:t},m.createElement("label",{title:t},"".concat(o)),m.createElement("input",{key:t,type:"checkbox",checked:e.props.structures[t].state===et.Built,onChange:function(){return e.handleChangeStructureState(t,e.props.structures[t].state!==et.Built)}}))}(t)}),n=function(e){return m.createElement("option",{value:e,key:e},De.getItemName(e))},r=Object.keys(R).filter(function(e){return!isNaN(e)}).map(function(e){return m.createElement("optgroup",{label:R[e],key:e},function(e){return Object.keys(B).filter(function(t){return Ae(t).itemType==e}).map(function(e){return n(e)})}(e))});return m.createElement("div",{className:"cheat-box"},m.createElement("h3",null,"CHEATS"),m.createElement("div",{className:"label-numberbox-button"},m.createElement("label",null,"Gold"),m.createElement("input",{type:"number",value:this.state.gold,style:{width:"50px"},onChange:this.handleChangeGold}),m.createElement("button",{onClick:this.handleCheatGold},"Add")),m.createElement("div",{className:"label-numberbox-button"},m.createElement("label",null,"Workers"),m.createElement("input",{type:"number",value:this.state.workers,style:{width:"50px"},onChange:this.handleChangeWorkers}),m.createElement("button",{onClick:this.handleCheatWorkers},"Add")),m.createElement("div",{className:"label-numberbox-button"},m.createElement("label",null,"Resources"),m.createElement("input",{type:"number",value:this.state.resources,style:{width:"50px"},onChange:this.handleChangeResources}),m.createElement("button",{onClick:this.handleCheatResources},"Add")),m.createElement("div",{className:"label-numberbox-button"},m.createElement("label",null,"Items"),m.createElement("select",{style:{width:"150px"},ref:this.itemSelectRef},r),m.createElement("button",{onClick:this.handleCheatItem},"Add")),t)}}]),t}(m.Component),dt=Object(v.b)(function(e){return{structures:e.structures}},function(e){return{onCheatGold:function(t){return e(rt(t))},onCheatItem:function(t){return e(C(t))},onCheatResources:function(t){return e(ot(t))},onCheatStructureState:function(t,n){return e(function(e,t){return{type:$e.setStructureState,structure:e,state:t}}(t,n))},onCheatWorkers:function(t){return e((n=t,{type:Ye.addWorkers,value:n}));var n}}})(mt);n(140);!function(e){e[e.all=0]="all",e[e.town=1]="town",e[e.quest=2]="quest"}(lt||(lt={}));var pt,gt=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).state={selectedTabId:"all"},n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=[{label:De.get("common-log-tab-all"),tabId:"all",tabType:lt.all},{label:De.get("common-log-tab-town"),tabId:"town",tabType:lt.town}];this.props.questNames.forEach(function(e){t.push({context:e,label:De.getQuestTitle(e),tabId:"quest-".concat(e),tabType:lt.quest})});var n=[],r=t.find(function(t){return t.tabId===e.state.selectedTabId});switch(r.tabType){case lt.all:n=this.props.logEntries;break;case lt.town:n=this.props.logEntries.filter(function(e){return e.channel===a.town});break;case lt.quest:n=this.props.logEntries.filter(function(e){return e.channel===a.quest&&e.context===r.context})}return m.createElement("div",{className:"log"},m.createElement("ul",{className:"tabs"},t.map(function(t){return m.createElement("li",{key:t.tabId,className:e.state.selectedTabId===t.tabId?"active":"",onClick:function(){return e.handleTabClick(t.tabId)}},t.label)})),m.createElement("div",{className:"log-entries"},n.map(function(e){return function(e){var t=De.get(e.key,e.context);return m.createElement("div",{className:"entry",key:e.time},t)}(e)})))}},{key:"handleTabClick",value:function(e){this.setState({selectedTabId:e})}}]),t}(m.Component),vt=Object(v.b)(function(e){return{logEntries:e.log,questNames:e.quests.filter(function(e){return e.status===_e.active}).map(function(e){return e.name})}},function(e){return{}})(gt);function ht(e){return{type:pt.advanceQuest,questName:e}}!function(e){e.launchQuest="launchQuest",e.advanceQuest="advanceQuest",e.updateQuestVars="updateQuestVars",e.updateEncounterResult="updateEncounterResult",e.startEncounter="startEncounter",e.updateQuests="updateQuests"}(pt||(pt={}));var ft,bt=n(14),yt=function(e,t){return t.party.map(function(t){return wt(e,t)})},wt=function(e,t){return e.adventurers.find(function(e){return e.id===t})},kt=function(e){return!!e.rngState},Ot=n(78),Tt=n.n(Ot);function jt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return e=Math.ceil(e),t=Math.floor(t),Math.floor(function(){if(!ft)throw new Error("Call init() before random()");return It=!0,ft()}()*(t-e+1))+e}var Et,It=!1,Nt=function(){function e(t,n){Object(k.a)(this,e),this.questName=void 0,this.store=void 0,this.questName=t,this.store=n}return Object(O.a)(e,[{key:"getAdventurerWithHighest",value:function(e){return yt(this.store,this.quest).concat().sort(function(t,n){return n.stats[e]-t.stats[e]})[0]}},{key:"getAdventurerWithLowest",value:function(e){return yt(this.store,this.quest).concat().sort(function(t,n){return t.stats[e]-n.stats[e]})[0]}},{key:"getRandomAdventurer",value:function(){return this.adventurers[jt(0,this.adventurers.length)]}},{key:"questVars",get:function(){return this.quest.questVars}},{key:"quest",get:function(){var e=this;return this.store.quests.find(function(t){return t.name===e.questName})}},{key:"adventurers",get:function(){return yt(this.store,this.quest)}}]),e}(),Ct={};!function(e){e.backstabbed="backstabbed",e.goblinHouseHallway="goblinHouseHallway",e.goblinHouseOutside="goblinHouseOutside",e.theBigTree="theBigTree"}(Et||(Et={}));var xt,St={name:Et.backstabbed,getOracle:function(e,t){return new Nt(e,t)},getTitle:function(e){return"Backstabbed"},getDescription:function(e){return"A group of rogues emerges from the bushes, knives drawn."},getOptions:function(e){return{fight:"Fight the brigands",flight:"Run away!"}},answer:function(e,t,n){switch(e){case"flight":return"You run away like a pussy";case"fight":var r=t.getRandomAdventurer();return n(N(r.id,B.deedForWeaponsmith)),"The party fights off the rogues. One of them drops a document. ".concat(r.name," picks it up");default:throw new Error("Unhandled option '".concat(e))}}},qt={name:Et.goblinHouseOutside,getOracle:function(e,t){return new Nt(e,t)},getTitle:function(e){return"As you make your way along the forest you notice a small house just of the road, smoke rises from the chimney"},getDescription:function(e){return"quest-kill10Boars-encounter-goblinHouseOutside-description"},getOptions:function(e){return{investigate:"Investigate",leave:"Keep walking"}},answer:function(e,t,n){t.store,t.questVars;var r=t.quest;switch(e){case"investigate":return n(function(e,t){return{type:pt.startEncounter,questName:e,encounter:t}}(r.name,Et.goblinHouseHallway)),"The party coutiously opens the door and goes inside";default:throw new Error("Unhandled option ".concat(e))}}},At={backstabbed:St,goblinHouseHallway:{name:Et.goblinHouseHallway,getOracle:function(e,t){return new Nt(e,t)},getTitle:function(e){return"The party stands inside the hallway."},getDescription:function(e){return""},getOptions:function(e){return{investigate:"Go inside the house",leave:"Leave the premise"}},answer:function(e,t,n){t.store,t.questVars,t.quest;switch(e){case"walkAround":return"Your party walks around the tree";case"leave":return n(ht(t.questName)),"The party escapes the house unscathed";default:throw new Error("Unhandled option ".concat(e))}}},goblinHouseOutside:qt,theBigTree:{name:Et.theBigTree,getOracle:function(e,t){return new Nt(e,t)},getTitle:function(e){return"The big tree"},getDescription:function(e){return"A huge tree blocks the way"},getOptions:function(e){e.store;var t=e.getAdventurerWithHighest("strength");return{walkAround:"Walk around the tree",lift:"Lift the tree (".concat(t.name,")")}},answer:function(e,t,n){t.store;var r=t.questVars,a=t.quest;switch(e){case"walkAround":return"Your party walks around the tree";case"lift":var o=t.getAdventurerWithHighest("strength");r.treeState="lifted",n(function(e,t){return{type:pt.updateQuestVars,questName:e,vars:t}}(a.name,r));var s=jt(2,5);return n(rt(s)),"".concat(o.name," heaves and lifts the heavy tree, moving it aside. Underneath your party finds ").concat(s," gold coins");default:throw new Error("Unhandled option ".concat(e))}}}};!function(e){e[e.nothing=0]="nothing",e[e.encounter=1]="encounter",e[e.combat=2]="combat",e[e.boss=3]="boss"}(xt||(xt={}));var Dt={kill10Boars:{displayName:"Kill 10 boars",nodes:[{x:0,y:1,type:xt.nothing,log:"quest-kill10Boars-node0"},{x:0,y:3,type:xt.nothing,log:"quest-kill10Boars-node1"},{x:0,y:2,type:xt.encounter,encounter:Et.goblinHouseOutside},{x:0,y:3,type:xt.nothing,log:"quest-kill10Boars-node4"},{x:1,y:3,type:xt.nothing},{x:1,y:3,type:xt.nothing},{x:2,y:1,type:xt.encounter,encounter:Et.backstabbed},{x:1,y:3,type:xt.nothing,log:"The party spots a boss"},{x:2,y:3,type:xt.boss}]},retrieveMagicAmulet:{displayName:"Retrieve the magic amulet",nodes:[{x:0,y:1,type:xt.nothing},{x:1,y:1,type:xt.nothing,log:"Papa loves mambo"},{x:1,y:1,type:xt.nothing,log:"Mama loves mambo"},{x:1,y:1,type:xt.nothing,log:"Look at 'em sway with it"},{x:1,y:1,type:xt.nothing,log:"gettin' so gay with it"},{x:1,y:1,type:xt.nothing},{x:1,y:1,type:xt.nothing},{x:0,y:2,type:xt.encounter,encounter:Et.theBigTree},{x:1,y:1,type:xt.nothing},{x:1,y:1,type:xt.nothing},{x:1,y:1,type:xt.nothing},{x:1,y:1,type:xt.nothing},{x:1,y:1,type:xt.nothing},{x:1,y:1,type:xt.nothing},{x:1,y:1,type:xt.nothing},{x:1,y:1,type:xt.nothing},{x:1,y:1,type:xt.nothing},{x:2,y:1,type:xt.encounter,encounter:Et.backstabbed},{x:3,y:1,type:xt.boss}]}},Mt=(n(149),function(e){function t(){return Object(k.a)(this,t),Object(T.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props;e.isOver,e.canDrop;return(0,e.connectDropTarget)(m.createElement("div",{className:"droppable-adventurer-avatar"},m.createElement(We,{adventurer:this.props.adventurer,onClick:this.props.onClick})))}}]),t}(m.Component)),Rt=Object(d.d)(q,{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){return!0}},function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}})(Mt),Bt=(n(150),function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).getAvatars=function(){return n.props.adventurers.map(function(e){var t=n.state.selectedAdventurer===e.id;return m.createElement(Rt,{key:"".concat(e.id,"-avatar"),className:t?" selected":"",adventurer:e,onClick:function(){return n.handleAvatarClick(e.id)},onDrop:function(t){var r=n.state.selectedAdventurer;if(e.id!==r&&n.props.onMoveItemToOtherAdventurer){var a=t.inventorySlot;n.props.onMoveItemToOtherAdventurer(r,a,e.id)}}})})},n.getBottomPart=function(){if(n.state.selectedAdventurer){var e=n.props.adventurers.find(function(e){return e.id===n.state.selectedAdventurer});return n.getAdventurerInfo(e)}var t=n.props.quest,r=Dt[t.name],a=Math.floor(t.progress),o=r.nodes[a],s=m.createElement("p",null),c=m.createElement("p",null);switch(o.type){case xt.nothing:var i=Object(Ke.a)(t.log).reverse();s=m.createElement("div",null," ",i.map(function(e){return m.createElement("p",null," ",e," ")})," ");break;case xt.encounter:var u=n.props.store,l=At[t.currentEncounter],d=l.getOracle(t.name,u);s=m.createElement("div",null,m.createElement("p",null," ",l.getTitle(d)," "),m.createElement("p",null," ",l.getDescription(d)));var p=l.getOptions(d);c=m.createElement("ul",null,Object.keys(p).map(function(e){return m.createElement("li",{key:e},m.createElement("button",{onClick:function(){return n.handleEncounterOptionClick(l,e,d)}},e),p[e])}));break;case xt.boss:s=m.createElement("p",null," ","Boss fight!"," ")}return m.createElement("div",{className:"questlog"},s,m.createElement("div",{className:"actions"},c))},n.state={selectedAdventurer:null},n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=Dt[this.props.quest.name];return m.createElement("div",{className:"partyscreen"},m.createElement("div",{className:"header"},e.displayName),m.createElement("div",{className:"avatars"},this.getAvatars()),this.getBottomPart())}},{key:"componentDidUpdate",value:function(e){e.quest!==this.props.quest&&this.setState({selectedAdventurer:null})}},{key:"getAdventurerInfo",value:function(e){var t=this;if(!e)return null;var n=Object.keys(e.stats).map(function(t){var n=e.stats[t];return m.createElement("div",{key:"".concat(e.id,"-").concat(t)}," ",m.createElement("b",null,t),": ",n.toFixed(1)," ")}),r=Object.keys(e.equipment).map(function(t){return m.createElement("div",{key:"".concat(e.id,"-").concat(t)},m.createElement("b",null,t),": ",e.equipment[t],"  ")});return m.createElement("div",{className:"adventurer-container"},m.createElement("div",{className:"left"},m.createElement("div",{className:"name"},m.createElement("b",null,e.name)),m.createElement("div",{className:"attributes"},n),m.createElement("div",{className:"equipment"},r)),m.createElement("div",{className:"right"},m.createElement(ze,{sourceType:x.adventurer,items:e.inventory,onDropItem:function(n,r,a){t.props.onMoveItemInInventory&&t.props.onMoveItemInInventory(e.id,r,a)}})))}},{key:"handleAvatarClick",value:function(e){this.state.selectedAdventurer===e&&(e=null),this.setState({selectedAdventurer:e})}},{key:"handleEncounterOptionClick",value:function(e,t,n){var r=e.answer(t,n,this.props.onDispatch);this.props.onUpdateEncounterResult(this.props.quest.progress,r)}}]),t}(m.Component));var Wt,Lt,Qt,Ft=Object(bt.c)(Object(v.b)(function(e,t){return{adventurers:yt(e,t.quest),store:e}},function(e,t){return{onAdvanceQuest:function(t){e(ht(t))},onDispatch:e,onMoveItemInInventory:function(t,n,r){var a=I(t,n,r);e(a)},onMoveItemToOtherAdventurer:function(t,n,r){var a=function(e,t,n,r){return{type:f.moveItemToOtherAdventurer,adventurerId:e,fromSlot:t,toAdventurerId:n,toSlot:r}}(t,n,r);e(a)},onUpdateEncounterResult:function(n,r){var a=function(e,t,n){return{type:pt.updateEncounterResult,questName:e,nodeIndex:t,result:n}}(t.quest.name,n,r);e(a)}}}),Ge)(Bt),Ht=n(82);!function(e){e[e.town=0]="town",e[e.world=1]="world"}(Wt||(Wt={})),function(e){e[e.buttonClick=0]="buttonClick"}(Lt||(Lt={}));var _t={},Gt=null,Ut={},Vt=function(){function e(){Object(k.a)(this,e)}return Object(O.a)(e,null,[{key:"loadMedia",value:function(e){Qt=e}},{key:"addSounds",value:function(e){Object.entries(e).forEach(function(e){var t=Object(Ht.a)(e,2),n=t[0],r=t[1];Ut[n]=Qt.find(function(e){return e.url===r}).content})}},{key:"playSound",value:function(e){Ut[e].play()}},{key:"addMusicTrack",value:function(e,t){var n=Qt.find(function(e){return e.url===t});if(!n)throw new Error("No sound found at ".concat(t));_t.hasOwnProperty(e)||(_t[e]=n.content)}},{key:"playMusicTrack",value:function(e){null!==Gt&&_t[Gt].fade(1,0,500);var t=_t[e];t.playing()||t.play(),t.fade(0,1,500),Gt=e}}]),e}(),zt=(n(151),function(e){var t=e.quest,n=Dt[t.name],r=n.nodes.map(function(e,n){return function(e,n){var r={className:Math.floor(t.progress)===n?"active":"",key:"node_".concat(n)};switch(e.type){case xt.encounter:return m.createElement("span",Object.assign({title:"encounter"},r),"*");case xt.boss:return m.createElement("span",Object.assign({title:"boss"},r),"#");case xt.nothing:default:return m.createElement("span",r,"-")}}(e,n)});return m.createElement("div",{className:"questlinevisualization"},m.createElement("div",{className:"questname"}," ",De.getQuestTitle(t.name)," "),r,e.selected?m.createElement("span",{className:"selected"},"selected"):m.createElement("button",{className:"select",onClick:function(){return e.onSelectQuest(t.name)}},"select"))}),Pt=(n(152),function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).state={selectedQuest:null},Vt.addMusicTrack(Wt.world,"sound/music/TheLoomingBattle.ogg"),n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props.quests.find(function(t){return t.name===e.state.selectedQuest}),n=this.props.quests.filter(function(e){return e.status===_e.active}).map(function(n){return m.createElement(zt,{key:n.name,selected:n===t,quest:n,onSelectQuest:function(){return e.handleSelectQuest(n.name)}})});return m.createElement("div",{className:"realworldview"},m.createElement("fieldset",{className:"progress"},m.createElement("legend",null,"Quest progress"),n),t&&m.createElement(Ft,{quest:t}))}},{key:"handleSelectQuest",value:function(e){this.setState({selectedQuest:e})}},{key:"componentDidMount",value:function(){this.playMusic()}},{key:"playMusic",value:function(){Vt.playMusicTrack(Wt.world)}}]),t}(m.Component));var Kt=Object(v.b)(function(e,t){return{quests:e.quests}},function(e,t){return{onAdvanceQuest:function(t){e(ht(t))}}})(Pt),Xt=n(40),Yt=n.n(Xt),Jt=n(23),Zt=(n(197),function(e){function t(){var e,n;Object(k.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(T.a)(this,(e=Object(j.a)(t)).call.apply(e,[this].concat(a)))).layer=void 0,n.animationFrame=0,n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){this.initSmoke()}},{key:"componentWillUnmount",value:function(){this.stopSmoke()}},{key:"render",value:function(){var e=this;return m.createElement(Jt.FastLayer,{ref:function(t){return e.layer=t}})}},{key:"initSmoke",value:function(){var e=this,t=this.layer.getContext(),n=this.layer.canvas,r=[],a=performance.now(),o=this.props,s=o.emitterX,c=o.emitterY,i=o.smokeImg;!function o(){var u=r.length;for(t.clearRect(0,0,n.width,n.height);u--;)if(r[u].position.y<0||r[u].lifeTime>3e3)r.splice(u,1);else{r[u].update(),t.save();var l=-r[u].size/2,m=-r[u].size/2;t.translate(r[u].position.x,r[u].position.y),t.rotate(r[u].angle/180*Math.PI),t.globalAlpha=r[u].alpha,t.drawImage(i,l,m,r[u].size,r[u].size),t.restore()}performance.now()>a+40&&(a=performance.now(),r.push(new $t(s,c,3e3))),e.animationFrame=requestAnimationFrame(o)}()}},{key:"stopSmoke",value:function(){cancelAnimationFrame(this.animationFrame)}}]),t}(m.Component)),$t=function(){function e(t,n,r){Object(k.a)(this,e),this.position=void 0,this.size=void 0,this.angle=void 0,this.alpha=void 0,this.lifeTime=void 0,this.maxLifeTime=void 0,this.startSize=void 0,this.endSize=void 0,this.startLife=void 0,this.velocity=void 0,this.position={x:t,y:n},this.maxLifeTime=r,this.size=1,this.startSize=32,this.endSize=40,this.angle=359*Math.random(),this.alpha=1,this.startLife=performance.now(),this.lifeTime=0,this.velocity={x:0,y:-3-.5*Math.random()}}return Object(O.a)(e,[{key:"update",value:function(){this.lifeTime=performance.now()-this.startLife,this.angle+=.2;var e=this.lifeTime/this.maxLifeTime*100;this.size=this.startSize+(this.endSize-this.startSize)*e*.1,this.alpha=1-.01*e,this.alpha=Math.max(this.alpha,0),this.position={x:this.position.x+this.velocity.x,y:this.position.y+this.velocity.y}}}]),e}(),en=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).plasmaBeam=void 0,n.anim=void 0,n.handleStructureClick=function(e){n.props.onStructureClick&&n.props.onStructureClick(F[e.target.name()])},n.handleBackgroundClick=function(e){n.props.onStructureClick&&n.props.onStructureClick(null)},n.state={images:{}},Vt.addMusicTrack(Wt.town,"sound/music/Soliloquy.mp3"),n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.playMusic();this.plasmaBeam&&(this.plasmaBeam.filters([Yt.a.Filters.Brighten]),this.anim=new Yt.a.Animation(function(t){if(e.plasmaBeam){var n=(Math.sin(t.time/500*2)+1)/2;e.plasmaBeam.brightness(n),e.plasmaBeam.fillPatternOffsetX(e.plasmaBeam.fillPatternOffsetX()-150)}},this.plasmaBeam.getLayer()),this.anim.start())}},{key:"componentWillUnmount",value:function(){this.anim&&this.anim.stop(),delete this.anim}},{key:"render",value:function(){var e=this,t=Object.keys(F).map(function(t,n){var r=ie[t],a=e.props.structures[t];if(a.state===et.NotBuilt)return null;var o=r.levels[a.level],s=De.get(o.displayName);return m.createElement(Jt.Text,{name:t,key:t,text:"".concat(s," (level ").concat(a.level+1,")"),x:100,y:50*n+100,fontSize:40,fill:"white",onClick:e.handleStructureClick})});return console.log("rendered the town"),m.createElement(Jt.Stage,{width:1024,height:768,scale:{x:.4,y:.4}},m.createElement(Jt.Layer,{name:"background",onClick:this.handleBackgroundClick}),m.createElement(Jt.Layer,{name:"background",onClick:this.handleBackgroundClick},m.createElement(Jt.Image,{image:this.imgSrc("img/town/sky.jpg")})),m.createElement(Jt.Layer,{name:"town"},t,m.createElement(Jt.Image,{name:"warehouse",image:this.imgSrc("img/town/tavern.png"),x:15,y:1057,shadowBlur:15,shadowColor:"red",shadowEnabled:!0,strokeWidth:30,ref:function(e){tn(e)}}),m.createElement(Jt.Image,{name:F.warehouse,image:this.imgSrc("img/town/lighthouse.png"),onClick:this.handleStructureClick,ref:function(e){tn(e)}}),m.createElement(Jt.Image,{name:"lumberMill",image:this.imgSrc("img/town/mill.png"),x:947,y:1384,shadowBlur:15,ref:function(e){tn(e)}})),m.createElement(Zt,{emitterX:190,emitterY:510,smokeImg:this.imgSrc("img/town/effects/smoke.png")}))}},{key:"imgSrc",value:function(e){var t=this.props.media.find(function(t){return t.url===e});if(void 0===t)throw Error("Could not find image with url ".concat(e));return t.content}},{key:"playMusic",value:function(){Vt.playMusicTrack(Wt.town)}}]),t}(m.Component),tn=function(e){e&&e.drawHitFromCache(.5)},nn=en;var rn,an,on=Object(bt.c)(Object(v.b)(function(e,t){return e.tasks.running.filter(function(e){return"town"===e.origin}),{structures:e.structures}},function(e,t){return{}}),Ge)(nn),sn=(n(73),n(198),function(e){var t=e.itemsInInventory,n=(e.className||"")+" itemsbox",r=e.items.map(function(e){var n="item";t&&-1===t.indexOf(e)&&(n+=" missing");var r=qe[e];return m.createElement("li",{className:n,key:e},m.createElement("div",{className:"icon common-icon-smallest",style:{backgroundImage:"url(".concat(r.iconImg,")")}}),m.createElement("div",{className:"name"},De.getItemName(e)))});return m.createElement("ul",{className:n},r)}),cn=Object(v.b)(function(e,t){var n=[];return t.items.forEach(function(t){e.items.indexOf(t)>-1&&n.push(t)}),{itemsInInventory:n}})(sn);!function(e){e.wood="wood",e.iron="iron",e.stone="stone",e.leather="leather",e.fabric="fabric",e.food="food",e.gunpowder="gunpowder"}(an||(an={}));var un=(rn={},Object(w.a)(rn,an.wood,{resource:an.wood,iconImg:"/img/resources/wood.png"}),Object(w.a)(rn,an.iron,{resource:an.iron,iconImg:"/img/resources/iron.png"}),Object(w.a)(rn,an.stone,{resource:an.stone,iconImg:"/img/resources/stone.png"}),Object(w.a)(rn,an.leather,{resource:an.leather,iconImg:"/img/resources/leather.png"}),Object(w.a)(rn,an.fabric,{resource:an.fabric,iconImg:"/img/resources/fabric.png"}),Object(w.a)(rn,an.food,{resource:an.food,iconImg:"/img/resources/food.png"}),Object(w.a)(rn,an.gunpowder,{resource:an.gunpowder,iconImg:"/img/resources/gunpowder.png"}),rn),ln=(n(74),function(e){var t=e.sufficientResources,n=(e.className||"")+" resourcesbox",r=Object.keys(e.resources).map(function(n){var r="resource";t&&!t[n]&&(r+=" insufficient");var a=un[n];return m.createElement("li",{className:r,key:n},m.createElement("div",{className:"icon",style:{backgroundImage:"url(".concat(a.iconImg,")")}}),m.createElement("div",{className:"name"},De.getResourceName(n)),m.createElement("div",{className:"amount"},e.resources[n]))});return m.createElement("ul",{className:n},r)}),mn=Object(v.b)(function(e,t){var n={};return Object.keys(t.resources).forEach(function(r){n[r]=e.resources[r]>=t.resources[r]}),{sufficientResources:n}})(ln),dn=function(e,t){if(t>6)throw new Error("Cannot possibly have more than ".concat(6," on one item!"));return e-.1*e*t},pn=(n(199),function(e){var t,n,r,a=(t=e.progress||0,n=0,t>(r=1)?r:t<n?n:t);return m.createElement("div",{className:"progressbar"},m.createElement("div",{className:"progressbar-label"},e.label),m.createElement("div",{className:"progressbar-info",style:{width:"".concat(100*a,"%")}},"  "))});n(200);var gn,vn=function(e){var t;return t=null==e.max?e.value:m.createElement("span",null,e.value," / ",m.createElement("span",{className:"max"},e.max)),m.createElement("div",{className:"updownvalue"},m.createElement("label",null," ",e.label),t,m.createElement("i",{className:"arrow up"+(e.upDisabled?" disabled":""),onClick:function(){e.onUp&&!e.upDisabled&&e.onUp()}}),m.createElement("i",{className:"arrow down"+(e.downDisabled?" disabled":""),onClick:function(){e.onDown&&!e.downDisabled&&e.onDown()}}))},hn=(n(201),function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).state={selectedItem:null,workersAssigned:0},n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"componentWillMount",value:function(){console.log("component will mount"+this.props.type)}},{key:"componentWillUnmount",value:function(){console.log("component will unmount"+this.props.type)}},{key:"render",value:function(){var e=this,t=ie[this.props.type];if(!t)throw new Error("No definition found for structure ".concat(this.props.type,"\n                with type ProductionStructureDefinition."));var n=this.props.level||0,r=t.levels[n],a=De.get(r.displayName),o=function(t){e.setState({selectedItem:t})};return m.createElement("details",{open:!0,className:"productionstructureview"},m.createElement("summary",null,a),m.createElement("section",null,function(){var r=e.props.gold,a=t.levels[n+1],o=null!=a?a.cost.gold||0:-1,s=null!=a&&r>=o,c="Upgrade! (".concat(o<0?"max":o+" gold",")");return m.createElement("div",null,m.createElement("label",null,"level:"),n+1+" / "+t.levels.length,m.createElement("button",{style:{float:"right"},onClick:function(t){e.props.onUpgrade&&e.props.onUpgrade(o,n+1)},disabled:!s},c))}(),m.createElement("div",null,"craft:"),m.createElement("div",{className:"crafting-area"},m.createElement("ul",{className:"vertical-tab-bar"},function(){var t=e.state.selectedItem;return r.produces.map(function(e){return m.createElement("li",{key:"craft".concat(e.item),onClick:function(){return o(e.item)},className:t===e.item?"selected":""},m.createElement(Le,{item:e.item}),De.getItemName(e.item))})}()),function(){var t=e.state.selectedItem;if(!t)return null;var n=r.produces.find(function(e){return e.item===t}),a=e.props.resources||{},o=n.cost.resources,s=Object.keys(o).some(function(e){return o[e]>a[e]}),c=!1,i=n.cost.materials;i&&(c=i.some(function(t){return-1===e.props.items.indexOf(t)}));var u=s||c||e.state.workersAssigned<1,l=qe[t],d=null;return i&&(d=m.createElement(cn,{items:i})),m.createElement("div",{className:"crafting-details"},"Craft a ",De.getItemName(l.item),m.createElement("div",{className:"crafting-costs"},m.createElement("fieldset",null,m.createElement(mn,{resources:o})),m.createElement("fieldset",null,d)),m.createElement("div",{style:{display:"flex "}},m.createElement(vn,{value:e.state.workersAssigned,label:"Workers: ",onUp:function(){e.setState({workersAssigned:e.state.workersAssigned+1})},onDown:function(){e.setState({workersAssigned:e.state.workersAssigned-1})},upDisabled:e.state.workersAssigned>=e.props.workersFree||e.state.workersAssigned>=6,downDisabled:e.state.workersAssigned<1}),"\xa0",function(t){if(0===e.state.workersAssigned)return"";var n=dn(t,e.state.workersAssigned),r=Q(n);return" Crafting time: ".concat(r)}(n.cost.time||0)),m.createElement("div",null,m.createElement("button",{disabled:u,onClick:function(){return t=n,void(e.props.onCraft&&(e.props.onCraft(t,e.state.workersAssigned),e.setState({workersAssigned:0})));var t}},"Craft")))}()),m.createElement("fieldset",null,m.createElement("legend",null,"Currently crafting:"),(e.props.tasks||[]).map(function(e){return m.createElement(pn,{key:"".concat(e.name).concat(e.startTime),label:"".concat(e.name," (").concat(Q(e.timeRemaining),")"),progress:e.progress})}))))}}]),t}(m.Component));function fn(e,t,n,r,a){return{type:gn.start,taskType:e,name:t,origin:n,time:r,callbacks:a}}!function(e){e.start="startTask",e.update="updateTasks"}(gn||(gn={}));var bn,yn=Object(Xe.a)([function(e){return e.structures},function(e){return e.workers}],function(e,t){return t-Object.keys(e).map(function(t){return e[t]}).reduce(function(e,t){return e+t.workers},0)});!function(e){e[e.buildStructure=0]="buildStructure",e[e.craftItem=1]="craftItem"}(bn||(bn={}));var wn=Object(bt.c)(Object(v.b)(function(e,t){var n=e.structures[t.type],r=e.tasks.running.filter(function(e){return e.origin==="".concat(t.type,".craft")}),a=[];return e.items.forEach(function(e){null!==e&&a.push(e)}),{gold:e.gold,items:a,level:n.level,resources:e.resources,tasks:r,workersFree:yn(e)}},function(e,t){return{onCraft:function(n,r){var a,o=dn(n.cost.time||0,r);e((a=n.cost.resources||{},{type:Ze.removeResources,resources:a})),e(it(t.type,r));var s=[C(n.item),ut(t.type,r)],c=fn(bn.craftItem,n.item,"".concat(t.type,".craft"),o,s);e(c)},onUpgrade:function(n,r){e(at(n)),e(ct(t.type)),r++,e(h("log-town-upgrade-structure-complete",a.town,{level:r,structure:t.type}))}}}),Ge)(hn),kn=function(e){var t=ie[e.type];if(!t)throw new Error("No definition found for structure ".concat(e.type," with type ResourceStructureDefinition."));var n=e.level||0,r=t.levels[n],a=De.get(r.displayName);return m.createElement("details",{open:!0,className:"structureview"},m.createElement("summary",null,a),m.createElement("section",null,function(){var t=e.workers===r.workerCapacity||(e.workersFree||0)<1,n=0===e.workers;return m.createElement(vn,{label:"workers:",value:e.workers,max:r.workerCapacity,upDisabled:t,downDisabled:n,onDown:function(){e.onWorkersDown&&e.onWorkersDown()},onUp:function(){e.onWorkersUp&&e.onWorkersUp()}})}(),function(){var r=e.gold||0,a=t.levels[n+1],o=null!=a?a.cost.gold||0:-1,s=null!=a&&r>=o,c="Upgrade! (".concat(o<0?"max":o+" gold",")");return m.createElement("div",null,m.createElement("label",null,"level:"),n+1+" / "+t.levels.length,m.createElement("button",{style:{float:"right"},onClick:function(t){e.onUpgrade&&e.onUpgrade(o,n+1)},disabled:!s},c))}(),function(){var t=r.generates,n=Object.keys(t).reduce(function(n,r){return t[r]&&n.push("".concat(t[r]," x ").concat(e.workers," = ").concat(t[r]*(e.workers||0)," ").concat(r)),n},[]).join(",");return m.createElement("div",null,"Generates (every minute): ",m.createElement("br",null),n)}()))};var On=Object(v.b)(function(e,t){var n=e.structures[t.type];if(!n)throw new Error("No structure '".concat(t.type,"' found in the store!"));return{gold:e.gold,level:n.level,workers:n.workers,workersFree:yn(e)}},function(e,t){return{onUpgrade:function(n,r){e(at(n)),e(ct(t.type)),r++,e(h("log-town-upgrade-structure-complete",a.town,{level:r,structure:t.type}))},onWorkersDown:function(){e(ut(t.type))},onWorkersUp:function(){e(it(t.type))}}})(kn),Tn=(n(202),{beginDrag:function(e){return{adventurer:e.adventurer,sourceId:e.sourceId,sourceType:x.adventurer}}});var jn=function(e){function t(){return Object(k.a)(this,t),Object(T.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.onClick,e.isDragging),n=e.connectDragSource,r="draggable-adventurer-avatar";return e.disabled&&(r+=" disabled"),t&&(r+=" dragging"),n(m.createElement("div",{className:r},m.createElement(We,this.props)))}}]),t}(m.Component),En=Object(d.c)(S,Tn,function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(jn),In=(n(203),n(204),function(e){function t(){return Object(k.a)(this,t),Object(T.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isOver,n=e.canDrop,r="droppable-adventurer-slot";return t?r+=" active-drop":n&&(r+=" can-drop"),(0,e.connectDropTarget)(m.createElement("div",{className:r}))}}]),t}(m.Component)),Nn=Object(d.d)(S,{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){return!0}},function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}})(In),Cn=(n(205),function(e){return m.createElement("ul",{className:"assign-adventurers"},function(){for(var t=[],n=function(n){var r=void 0,a="";if(e.assignedAventurers[n]){var o=e.assignedAventurers[n];r=m.createElement(We,{adventurer:o,displayName:!1,onClick:function(){return e.onRemoveAdventurer(n)}}),a="has-adventurer"}else r=m.createElement(Nn,{onDrop:function(t){e.onAddEventurer(t,n)}});t.push(m.createElement("li",{key:"slot".concat(n),className:a}," ",r," "))},r=0;r<e.availableSlots;r++)n(r);return t}())}),xn=(n(206),function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).state={selectedQuest:null},n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props.availableQuests.map(function(t){var n="img/sigils/".concat(t.icon),r="quest"+(t.name===e.props.selectedQuestName?" selected":"");return m.createElement("li",{key:t.name,className:r,onClick:function(){e.props.onQuestClick(t.name)}},m.createElement("div",{className:"icon",style:{backgroundImage:"url(".concat(n,")")}}),m.createElement("div",{className:"title"},De.getQuestTitle(t.name)," "))});return m.createElement("div",{className:"quest-board"},m.createElement("h2",null," ",De.get("structure-tavern-title-quest-board")," "),m.createElement("ul",{className:"quest-list"},t),function(){if(!e.props.selectedQuestName)return null;if(!e.props.availableQuests.find(function(t){return t.name===e.props.selectedQuestName}))return m.createElement("div",null," ",De.get("structure-tavern-quest-launched")," ");var t=e.props.assignedAventurers.filter(function(e){return null!==e}).length>=3;return m.createElement("div",{className:"quest-details"},De.getQuestDescription(e.props.selectedQuestName),m.createElement(Cn,{availableSlots:5,assignedAventurers:e.props.assignedAventurers,onRemoveAdventurer:e.props.onRemoveAdventurer,onAddEventurer:e.props.onAddAdventurer}),m.createElement("button",{disabled:!t,onClick:function(){return e.props.onLaunchQuest()}},De.get("structure-tavern-button-launch-quest")))}())}}]),t}(m.Component)),Sn=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).state={assignedAventurers:[],selectedQuestName:null},n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=ie[F.tavern],n=this.props.level||0,r=t.levels[n],a=De.get(r.displayName),o=r.rooms,s=this.props.quests.filter(function(e){return e.status===_e.available});return m.createElement("details",{open:!0,className:"tavernstructureview"},m.createElement("summary",null,a),function(){var r=e.props.gold,a=t.levels[n+1],o=null!=a?a.cost.gold||0:-1,s=null!=a&&r>=o,c="Upgrade! (".concat(o<0?"max":o+" gold",")");return m.createElement("div",null,m.createElement("label",null,"level:"),n+1+" / "+t.levels.length,m.createElement("button",{style:{float:"right"},onClick:function(t){e.props.onUpgrade&&e.props.onUpgrade(o,n+1)},disabled:!s},c))}(),m.createElement("section",null,function(){for(var t=[],n=function(n){var r=e.props.adventurers.find(function(e){return e.room===n}),a=null;if(r){var o=r.name,s=e.state.assignedAventurers.indexOf(r)>-1,c=e.getQuestByAdventurer(r.id);c&&(o+=" (on a quest)"),a=[m.createElement(En,{disabled:s||null!=c,adventurer:r,className:"adventurer-icon",sourceId:"tavern",key:"avatar:".concat(r.id)}),o]}else a="(empty room)";t.push(m.createElement("div",{key:"room".concat(n),className:"room"},a))},r=0;r<o;r++)n(r);return m.createElement("div",{className:"rooms"},m.createElement("h2",null,"Rooms"),t)}(),m.createElement(xn,{availableQuests:s,selectedQuestName:this.state.selectedQuestName,assignedAventurers:this.state.assignedAventurers,onQuestClick:function(t){return e.handleQuestClick(t)},onAddAdventurer:function(t,n){return e.handleAddAdventurer(t,n)},onRemoveAdventurer:function(t){return e.handleRemoveAdventurer(t)},onLaunchQuest:function(){return e.handleLaunchQuest()}})))}},{key:"handleQuestClick",value:function(e){this.state.selectedQuestName===e?this.setState({selectedQuestName:null}):this.setState({selectedQuestName:e}),this.setState({assignedAventurers:[]})}},{key:"handleAddAdventurer",value:function(e,t){if("tavern"===e.sourceId){var n=Object(Ke.a)(this.state.assignedAventurers);n[t]=e.adventurer,this.setState({assignedAventurers:n})}}},{key:"handleRemoveAdventurer",value:function(e){var t=Object(Ke.a)(this.state.assignedAventurers);delete t[e],this.setState({assignedAventurers:t})}},{key:"handleLaunchQuest",value:function(){var e=this.state.assignedAventurers,t=this.state.selectedQuestName;this.props.onLaunchQuest(t,e)}},{key:"getQuestByAdventurer",value:function(e){return Object.values(this.props.quests).find(function(t){return t.party.indexOf(e)>-1})}}]),t}(m.Component);var qn=Object(bt.c)(Object(v.b)(function(e,t){var n=e.structures[F.tavern];return{adventurers:e.adventurers,gold:e.gold,level:n.level,quests:e.quests}},function(e,t){return{onLaunchQuest:function(t,n){e(function(e,t){return{type:pt.launchQuest,questName:e,assignedAventurers:t}}(t,n))},onUpgrade:function(t,n){e(at(t)),e(ct(F.tavern)),n++,e(h("log-town-upgrade-structure-complete",a.town,{level:n,structure:F.tavern}))}}}),Ge)(Sn),An=function(e){var t=e.sufficientResources,n=e.resources,r=e.deltaResources,a=(e.className||"")+" resourcesbox",o=Object.keys(n).map(function(n){var a="resource";t&&!t[n]&&(a+=" insufficient");var o,s=un[n],c=e.resources[n];return r[n]&&(o=m.createElement("span",{className:"animate-up"},"+ ".concat(r[n].toFixed(2)))),m.createElement("li",{className:a,key:n},m.createElement("div",{className:"icon common-icon-smallest",style:{backgroundImage:"url(".concat(s.iconImg,")")}}),m.createElement("div",{className:"name"},De.getResourceName(n)),m.createElement("div",{className:"amount"},c.toFixed(1)),m.createElement("div",{className:"max"}," / ".concat(e.maxResources[n])),m.createElement("div",{className:"delta"},o))});return m.createElement("ul",{className:a},o)},Dn=(n(207),x.warehouse),Mn=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).resourcesDelta=void 0,n.resourcesRef=void 0,n.resourcesDelta={},n.resourcesRef=null,n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=ie[F.warehouse];if(!n)throw new Error("No definition found for structure ".concat(F.warehouse," with type StructureDefinition."));var r=t.level,a=n.levels[r],o=De.get(a.displayName);return m.createElement("details",{open:!0,className:"warehouse-structureview"},m.createElement("summary",null,o),function(){var e=t.gold,a=n.levels[r+1],o=null!=a?a.cost.gold||0:-1,s=null!=a&&e>=o,c="Upgrade! (".concat(o<0?"max":o+" gold",")");return m.createElement("div",null,m.createElement("label",null,"level:"),r+1+" / "+n.levels.length,m.createElement("button",{style:{float:"right"},onClick:function(e){t.onUpgrade&&t.onUpgrade(o,r+1)},disabled:!s},c))}(),m.createElement("fieldset",{className:"resources",ref:function(t){e.resourcesRef=t}},m.createElement("legend",null,"Resources"),m.createElement(An,{resources:t.resources,maxResources:t.maxResources,deltaResources:this.resourcesDelta})),m.createElement(ze,{sourceType:Dn,items:t.items,onDropItem:function(e,n,r,a,o){switch(a){case Dn:t.onMoveItemInWarehouse&&t.onMoveItemInWarehouse(n,r);break;case x.adventurer:t.onMoveItemFromAdventurer&&t.onMoveItemFromAdventurer(o,e,n,r)}}}))}},{key:"componentDidUpdate",value:function(e){var t=this;Object.keys(e.resources).forEach(function(n){t.resourcesDelta[n]=t.props.resources[n]-e.resources[n]}),this.resourcesRef&&(this.resourcesRef.classList.remove("animate"),setTimeout(function(){t.resourcesRef&&t.resourcesRef.classList.add("animate")},200))}}]),t}(m.Component);var Rn=Object(bt.c)(Object(v.b)(function(e,t){var n=e.structures[F.warehouse],r=ie[F.warehouse],a=n.level,o=r.levels[a];if(!n)throw new Error("No structure '".concat(F.warehouse,"' found in the store!"));return{gold:e.gold,items:e.items,level:a,maxResources:o.maxResources,resources:e.resources,workers:n.workers,workersFree:yn(e)}},function(e,t){return{onMoveItemFromAdventurer:function(t,n,r,a){var o=function(e,t){return{type:f.removeItemFromInventory,adventurerId:e,fromSlot:t}}(t,r);e(o);var s=C(n,a);e(s)},onMoveItemInWarehouse:function(t,n){e(function(e,t){return{type:b.moveItemInWarehouse,fromSlot:e,toSlot:t}}(t,n))},onUpgrade:function(t,n){e(at(t)),e(ct(F.warehouse)),n++,e(h("log-town-upgrade-structure-complete",a.town,{level:n,structure:F.warehouse}))}}}),Ge)(Mn);n(208);var Bn=Object(v.b)(function(e,t){return{buildTask:e.tasks.running.filter(function(e){return"town"===e.origin&&e.name==="".concat(t.structure,".build")})[0],structures:e.structures}},function(e){return{onCheatGold:function(t){return e(rt(t))},onCheatResources:function(t){return e(ot(t))}}})(function(e){var t;if(e.structures[e.structure].state===et.Building){var n=e.buildTask?e.buildTask.progress:1;t=m.createElement("div",null,m.createElement(pn,{label:"Building...",progress:n}))}else t=function(e){switch(ie[e].type){case A.production:return m.createElement(wn,{type:e});case A.resource:return m.createElement(On,{type:e});case A.warehouse:return m.createElement(Rn,null);case A.tavern:return m.createElement(qn,null);default:return m.createElement("div",null," ",e," ")}}(e.structure);return m.createElement("fieldset",{className:"structure-details"},m.createElement("legend",null,"Structure"),t)}),Wn=["img/town/effects/plasma_beam_heavy_green.png","img/town/effects/smoke.png","img/town/sky.jpg","img/town/lighthouse.png","img/town/tavern.png","img/town/mill.png","sound/fx/button-click.ogg","sound/music/Soliloquy.mp3","sound/music/TheLoomingBattle.ogg"],Ln=n(41);n(209);var Qn,Fn=Object(v.b)(function(e){return{gold:e.gold,workers:e.workers,workersFree:yn(e)}})(function(e){var t=e.appView===Pn.Town?De.get("common-view-button-world"):De.get("common-view-button-town");return m.createElement("div",{className:"topbar"},m.createElement("div",{className:"topbar-left"},m.createElement("button",{onClick:function(){e.onViewButtonClick()}}," ",t," ")," | ",m.createElement("button",{onClick:function(){return e.persistor.purge(),void window.location.reload()},style:{color:"red"}}," Restart! ")),m.createElement("div",{className:"topbar-right"},m.createElement("span",null,"workers: ",m.createElement("b",null,e.workersFree+" / "+e.workers)),m.createElement("span",null,"gold: ",m.createElement("b",null,e.gold))))}),Hn=(n(210),n(79)),_n=function(e){function t(){return Object(k.a)(this,t),Object(T.a)(this,Object(j.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this.props,t=e.itemsLoaded,n=e.itemsTotal;return m.createElement("div",null," ","Loading (".concat(Math.floor((t||0)/(n||0)*100),")%")," ")}}]),t}(m.Component);!function(e){e[e.image=0]="image",e[e.sound=1]="sound"}(Qn||(Qn={}));var Gn=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).loadMedia=function(){n.setState({itemsLoaded:0});var e=n.props.manifest.map(function(e){return n.loadItem(e).catch(function(e){return console.error(e)})});Promise.all(e).then(function(e){n.props.onLoadComplete&&n.props.onLoadComplete(Un),n.setState({completed:!0})})},n.loadItem=function(){var e=Object(i.a)(c.a.mark(function e(t){var r,a,o,s;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Un.some(function(e){return e.url===t})&&console.warn("Loading media with url ".concat(t," more than once! Will overwrite.")),(r=zn(t))!==Qn.image){e.next=7;break}return e.next=5,Vn(t);case 5:o=e.sent,a={content:o,mediaType:r,url:t};case 7:if(r===Qn.sound&&(s=new Hn.Howl({src:[t]}),a={content:s,mediaType:r,url:t}),!a){e.next=14;break}return Un.push(a),n.setState({itemsLoaded:n.state.itemsLoaded+1}),e.abrupt("return",a);case 14:throw new Error("Unknown error while trying to load ".concat(t));case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.state={completed:!1,itemsLoaded:0},n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"componentDidMount",value:function(){this.loadMedia()}},{key:"componentDidUpdate",value:function(e){}},{key:"componentWillUnmount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.manifest,r=this.state.completed,a=m.createElement(_n,{itemsLoaded:this.state.itemsLoaded,itemsTotal:n.length});return r?t:a}}]),t}(m.Component),Un=[],Vn=function(e){var t=new Image;return t.src=e,new Promise(function(e,n){function r(){t.naturalWidth?e(t):n(null),t.removeEventListener("load",r),t.removeEventListener("error",r)}t.naturalWidth?e(t):t.complete?n(null):(t.addEventListener("load",r),t.addEventListener("error",r))})},zn=function(e){if((e=e.toLowerCase()).endsWith("png")||e.endsWith("jpg")||e.endsWith("gif"))return Qn.image;if(e.endsWith("mp3")||e.endsWith("ogg")||e.endsWith("wav"))return Qn.sound;throw Error("Could not determine type for ".concat(e))};var Pn,Kn=Object(v.b)(function(e,t){return{store:e}},function(e,t){return{handleStartConstruction:function(t){e(function(e){return{type:$e.startBuildingStructure,structure:e}}(t));var n=[st(t)],r=ie[t].cost.time,a=fn(bn.buildStructure,"".concat(t,".build"),"town",r,n);e(a)}}})(function(e){var t=e.info;switch(t.itemType){case R.deed:var n=e.store.gold,r=t,a=ie[r.structure],o=a.cost.gold||0<=n,s=!(e.store.structures[r.structure].state===et.NotBuilt)||!o;return m.createElement("div",null,m.createElement("p",null,' " ',t.subText,' " '),m.createElement("button",{disabled:s,onClick:function(){return e.handleStartConstruction(r.structure)}},"Start construction (",a.cost.gold," gold)"));default:return m.createElement("p",null,' " ',t.subText,' " ')}}),Xn=function(e){var t,n=e.info;switch(e.type){case Qe.item:default:t=m.createElement(Kn,{info:e.info})}var r=De.getItemName(n.item);return m.createElement("fieldset",null,m.createElement("legend",null," ",r," "),t)};!function(e){e[e.Town=0]="Town",e[e.World=1]="World"}(Pn||(Pn={}));var Yn=m.createContext(null),Jn=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(T.a)(this,Object(j.a)(t).call(this,e))).changeView=function(){Vt.playSound(Lt.buttonClick),n.state.view===Pn.Town?n.setState({selectedStructure:null,view:Pn.World}):n.setState({view:Pn.Town})},n.selectStructure=function(e){n.setState({selectedStructure:e})},n.closeStructureModal=function(){n.setState({selectedStructure:null})},n.handleMediaLoadComplete=function(e){var t=e.filter(function(e){return e.mediaType===Qn.sound});Vt.loadMedia(t),Vt.addSounds(Object(w.a)({},Lt.buttonClick,"sound/fx/button-click.ogg")),n.setState({media:e})},n.handleContextualObjectActivated=function(e,t){n.setState({contextInfo:t,contextType:e})},n.state={contextInfo:null,contextType:null,media:[],selectedStructure:null,view:Pn.Town},n}return Object(E.a)(t,e),Object(O.a)(t,[{key:"render",value:function(){var e=this,t=this.state.selectedStructure?m.createElement(Bn,{structure:this.state.selectedStructure}):null,n=Ln.b.div({enter:{opacity:1,transform:"scale(1)",transition:{duration:200,ease:"easeInOut"}},exit:{opacity:0,transform:"scale(0.5)",transition:{duration:150,ease:"easeInOut"}}}),r=Ln.b.div({enter:{opacity:1},exit:{opacity:0}}),a=null==this.state.contextType||null==this.state.contextInfo?null:m.createElement(Xn,{type:this.state.contextType,info:this.state.contextInfo});return m.createElement(Yn.Provider,{value:{media:this.state.media,onContextualObjectActivated:this.handleContextualObjectActivated}},m.createElement(Gn,{manifest:Wn,onLoadComplete:this.handleMediaLoadComplete},m.createElement(Fn,{appView:this.state.view,onViewButtonClick:function(){return e.changeView()},persistor:this.props.persistor}),m.createElement(Ln.a,null,!!t&&[m.createElement(n,{key:"structure-modal",className:"structure-modal"},t),m.createElement(r,{key:"structure-modal-bg",className:"structure-modal-background",onClick:function(){return e.closeStructureModal()}})]),e.state.view===Pn.Town?m.createElement(on,{onStructureClick:e.selectStructure}):m.createElement(Kt,null),m.createElement("div",{className:"app-right"},a,m.createElement(nt,null),m.createElement(dt,null)),m.createElement(vt,null)))}}]),t}(m.Component);var Zn=Object(v.b)(function(e,t){return{}},function(e,t){return{}})(Jn),$n=(n(211),function(e){var t=ie[F.warehouse],n=e.structures[F.warehouse].level;return t.levels[n].maxResources}),er=function(e,t){var n=t.structures,r={},a=e/6e4,o=$n(t);return Object.keys(n).forEach(function(e){return function(e){var t=ie[e];if(t.type===A.resource){var o=t,s=n[e].level,c=o.levels[s];Object.keys(c.generates).reduce(function(t,r){var o=c.generates[r]*n[e].workers*a;return t[r]=(t[r]||0)+o,t},r)}}(e)}),Object.keys(r).forEach(function(e){r[e]&&t.resources[e]+r[e]>=o[e]&&(r[e]=o[e]-t.resources[e])}),r},tr=function(e,t){var n=[],r=[];return t.quests.forEach(function(t){if(t.status===_e.active){var o=Dt[t.name],s=t.progress,c=Math.floor(s);if(o.nodes[c].type===xt.nothing){for(var i=e/6e4*4,u=Math.min(s+i,o.nodes.length-1),l=Math.floor(u)-c,m=t.currentEncounter,d=1;d<=l;d++){var p=o.nodes[c+d];if(p.type===xt.encounter){var g=At[p.encounter],v=Ct[t.name];u=c+d,m=p.encounter,n.push({channel:a.quest,context:t.name,key:g.getDescription(v)});break}p.type===xt.nothing&&(m=null,p.log&&n.push({channel:a.quest,context:t.name,key:p.log}))}r.push({currentEncounter:m,name:t.name,progress:u})}}}),{log:n,quests:r}},nr=function(){return It?(It=!1,ft.state()):null},rr=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ar(){if("serviceWorker"in navigator){if(new URL("/gilles-game",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/gilles-game","/service-worker.js");rr?(!function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):or(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):or(e)})}}function or(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var sr,cr=function(){return{strength:100*Math.random(),perception:100*Math.random(),endurance:100*Math.random(),charisma:100*Math.random(),intelligenge:100*Math.random(),agility:100*Math.random(),luck:100*Math.random()}},ir=function(){var e=["Burning Damnation","Fury","Some old guy","the Depths","Frozen Hells","Broken bones","the Claw","Resilience","Shattered Damnation","the Seer"],t=function(t){var n=t[Math.floor(Math.random()*t.length)],r=e[Math.floor(Math.random()*e.length)];return"".concat(n," of ").concat(r)};return{arms:t(["Fists","Grips","Hands","Handguards","Gauntlets"]),body:t(["Breastplate","Mithril Vest","Titanium Armor","Primitive Armor","Scaled Raiment"]),feet:t(["Sabatons","Footguards","Warboots","Slippers"]),head:t(["Helmet","Headguard","Obsidian Crown","Scaled Hood"])}},ur=[{id:"c4a5d270",equipment:ir(),stats:cr(),health:100*Math.random(),room:0,name:"Ximena Maddox",avatarImg:"/img/avatars/andy-victorovych-a1.jpg",inventory:[B.deedForLumbermill,null,B.crossbow,B.dagger,B.khopesh,null,B.sword,null,null,null,null,null,null,null,null,null]},{id:"2e655832",equipment:ir(),stats:cr(),name:"Donte Houston",health:100*Math.random(),room:1,avatarImg:"/img/avatars/andy-victorovych-a2.jpg",inventory:[B.crossbow,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},{id:"ec6f1050",equipment:ir(),stats:cr(),name:"Zackary Morris",health:100*Math.random(),room:2,avatarImg:"/img/avatars/andy-victorovych-a3.jpg",inventory:[B.greatswordOfGwai,null,null,null]},{id:"d299f98a",stats:cr(),equipment:ir(),name:"Mike Keith",health:100*Math.random(),room:4,avatarImg:"/img/avatars/andy-victorovych-a4.jpg",inventory:[null,null,null,null,null]},{id:"96c686c3",equipment:ir(),stats:cr(),name:"Wayne Monroe",health:100*Math.random(),room:5,avatarImg:"/img/avatars/andy-victorovych-a5.jpg",inventory:[null,null,null]},{id:"250d1a9d",stats:cr(),equipment:ir(),name:"Mike Keith",health:100*Math.random(),room:9,avatarImg:"/img/avatars/andy-victorovych-a6.jpg",inventory:[null,null,null,null,null]},{id:"169384ef",equipment:ir(),stats:cr(),name:"Karlee Nolan",health:100*Math.random(),room:3,avatarImg:"/img/avatars/andy-victorovych-a7.jpg",inventory:[B.greatswordOfGwai,null,null,null]},{id:"f22d66cb",stats:cr(),equipment:ir(),name:"Gylbarde the Earnest",health:100*Math.random(),room:8,avatarImg:"/img/avatars/andy-victorovych-a8.jpg",inventory:[null,null,null,null,null]},{id:"36c686c1",equipment:ir(),stats:cr(),name:"Lanslet of the Water",health:100*Math.random(),room:6,avatarImg:"/img/avatars/andy-victorovych-a9.jpg",inventory:[B.greatswordOfGwai,null,null,null]},{id:"12c613d4",equipment:ir(),stats:cr(),name:"Tedric the Bold",health:100*Math.random(),room:7,avatarImg:"/img/avatars/andy-victorovych-a10.jpg",inventory:[B.greatswordOfGwai,null,null,null]}],lr={lastTick:Date.now()},mr=[null,null,null,B.dagger,B.deedForWeaponsmith],dr=function(e,t){if(!t.log.length)return e;var n=t.log.map(function(e){return Object(M.a)({},e,{time:Date.now()})});return[].concat(Object(Ke.a)(n),Object(Ke.a)(e))},pr=[{name:"kill10Boars",status:_e.active,party:["c4a5d270","2e655832","ec6f1050","d299f98a"],progress:0,questVars:{},encounterResults:[],log:[],icon:"sigil1.png",currentEncounter:null},{name:"retrieveMagicAmulet",party:[],status:_e.available,progress:0,questVars:{},encounterResults:[],log:[],icon:"sigil2.png",currentEncounter:null,reward:{gold:4,items:[B.deedForWeaponsmith]}}],gr=function(e,t){var n=t.assignedAventurers.filter(function(e){return!!e}).map(function(e){return e.id});return e.map(function(e){return e.name===t.questName?Object(M.a)({},e,{status:_e.active,party:n}):e})},vr=function(e,t){return e.map(function(e){if(e.name===t.questName){var n=e.progress+1,r=Dt[e.name].nodes[Math.floor(n)],a=e.log;return r.type===xt.nothing&&r.log&&(a=[].concat(Object(Ke.a)(a),[r.log])),Object(M.a)({},e,{progress:n,log:a})}return e})},hr=function(e,t){return e.map(function(e){return e.name===t.questName?Object(M.a)({},e,{currentEncounter:t.encounter}):e})},fr=function(e,t){var n=t.quests;return e.map(function(e){var t=n.find(function(t){return t.name===e.name});if(t){var r=t.progress,a=t.currentEncounter;return Object(M.a)({},e,{progress:r,currentEncounter:a})}return e})},br=function(e,t){return e.map(function(e){if(e.name===t.questName){var n=Object.assign({},e.questVars,t.vars);return Object(M.a)({},e,{questVars:n})}return e})},yr=function(e,t){return e.map(function(e){if(e.name===t.questName){var n=e.encounterResults.concat();return n[t.nodeIndex]=t.result,Object(M.a)({},e,{encounterResults:n})}return e})},wr={fabric:0,food:0,gunpowder:0,iron:60,leather:0,stone:0,wood:40},kr=(sr={},Object(w.a)(sr,F.alchemist,{level:0,workers:1,state:et.NotBuilt}),Object(w.a)(sr,F.armoursmith,{level:0,workers:0,state:et.NotBuilt}),Object(w.a)(sr,F.garden,{level:0,workers:0,state:et.Built}),Object(w.a)(sr,F.lumberMill,{level:0,workers:0,state:et.NotBuilt}),Object(w.a)(sr,F.mine,{level:0,workers:0,state:et.NotBuilt}),Object(w.a)(sr,F.quarry,{level:0,workers:0,state:et.NotBuilt}),Object(w.a)(sr,F.tavern,{level:0,workers:0,state:et.Built}),Object(w.a)(sr,F.tannery,{level:0,workers:0,state:et.NotBuilt}),Object(w.a)(sr,F.warehouse,{level:0,workers:0,state:et.Built}),Object(w.a)(sr,F.weaponsmith,{level:0,workers:0,state:et.Built}),Object(w.a)(sr,F.weaver,{level:0,workers:0,state:et.NotBuilt}),sr),Or=function(e,t,n){var r=Object(M.a)({},e[t],{state:n});return Object(M.a)({},e,Object(w.a)({},t,r))},Tr={completed:[],running:[]},jr=function(e){return{name:e.name,origin:e.origin,type:e.taskType,callbacks:e.callbacks,timeRemaining:e.time,startTime:Date.now(),lastTick:Date.now(),progress:0}},Er=Object(bt.b)({adventurers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ur,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f.moveItemInInventory:var n=t,r=n.adventurerId,a=n.fromSlot,o=n.toSlot,s=e.find(function(e){return e.id===r}),c=s.inventory.map(function(e,t){return t===a?s.inventory[o]:t===o?s.inventory[a]:e});return e.map(function(e){return e===s?Object(M.a)({},e,{inventory:c}):e});case f.moveItemToOtherAdventurer:var i=t,u=i.adventurerId,l=i.fromSlot,m=i.toAdventurerId,d=e.find(function(e){return e.id===u}).inventory[l];return e.map(function(e){if(e.id===u){var t=e.inventory.concat();return t[l]=null,Object(M.a)({},e,{inventory:t})}if(e.id===m){var n=e.inventory.concat(),r=n.findIndex(function(e){return null===e});return n[r]=d,Object(M.a)({},e,{inventory:n})}return e});case f.addItemToInventory:var p=t.item;return e.map(function(e){if(e.id===t.adventurerId){var n=e.inventory.concat(),r=t.toSlot;return null===r&&(r=n.findIndex(function(e){return null===e||void 0===e})),n[r]=p,Object(M.a)({},e,{inventory:n})}return e});case f.removeItemFromInventory:var g=t.fromSlot;return e.map(function(e){if(e.id===t.adventurerId){var n=e.inventory.map(function(e,t){return t!==g?e:null});return Object(M.a)({},e,{inventory:n})}return e})}return e},engine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lr;switch((arguments.length>1?arguments[1]:void 0).type){case r.gameTick:return Object(M.a)({},e,{lastTick:Date.now()})}return e},gold:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Je.addGold:return e+t.amount;case $e.startBuildingStructure:return e-(ie[t.structure].cost.gold||0)}return e},items:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b.addItem:var n=t.item,r=t.toSlot;return void 0===r&&-1===(r=e.findIndex(function(e){return null===e}))?[].concat(Object(Ke.a)(e),[n]):e.map(function(e,t){return t===r?n:e});case b.moveItemInWarehouse:var a=t,o=a.fromSlot,s=a.toSlot;return e.map(function(t,n){return n===o?null:n===s?e[o]:t});case b.removeItem:var c=t.fromSlot;return e.map(function(e,t){return t!==c?e:null})}return e},log:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case o.addLogEntry:var n=t,a=n.key;return[{channel:n.channel,context:n.context,key:a,time:Date.now()}].concat(Object(Ke.a)(e));case r.gameTick:return dr(e,t)}return e},quests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case pt.launchQuest:return gr(e,t);case pt.advanceQuest:return vr(e,t);case pt.updateQuestVars:return br(e,t);case pt.updateEncounterResult:return yr(e,t);case pt.startEncounter:return hr(e,t);case r.gameTick:return fr(e,t)}return e},resources:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wr,t=arguments.length>1?arguments[1]:void 0,n=function(t){return Object.keys(e).reduce(function(n,r){return n[r]=e[r]+(t[r]||0),n},{})};switch(t.type){case Ze.addResources:return n(t.resources);case Ze.removeResources:var a=t.resources;return Object.keys(e).reduce(function(t,n){return t[n]=e[n]-(a[n]||0),t},{});case r.gameTick:return n(t.resources)}return e},rngState:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===r.gameTick&&null!=t.rngState&&(e=Object.assign({},t.rngState)),e},structures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $e.startBuildingStructure:return Or(e,t.structure,et.Building);case $e.finishBuildingStructure:return Or(e,t.structure,et.Built);case $e.upgradeStructure:var n=e[t.structure].level+1,r=Object(M.a)({},e[t.structure],{level:n});return Object(M.a)({},e,Object(w.a)({},t.structure,r));case $e.increaseWorkers:var a=t.workers,o=e[t.structure].workers+a,s=Object(M.a)({},e[t.structure],{workers:o});return Object(M.a)({},e,Object(w.a)({},t.structure,s));case $e.decreaseWorkers:var c=t.workers,i=e[t.structure].workers-c,u=Object(M.a)({},e[t.structure],{workers:i});return Object(M.a)({},e,Object(w.a)({},t.structure,u));case $e.setStructureState:var l=t.state;return Or(e,t.structure,l)}return e},tasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case gn.start:var n=jr(t),a=e.running.concat(n);return Object(M.a)({},e,{running:a});case r.gameTick:var o=Date.now(),s=[],c=[];return e.running.forEach(function(e){var t=o+e.timeRemaining,n=(o-e.startTime)/(t-e.startTime),r=e.timeRemaining-(o-e.lastTick),a=Object(M.a)({},e,{progress:n,lastTick:o,timeRemaining:r});r<0?c.push(a):s.push(a)}),{running:s,completed:c}}return e},workers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:13,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye.addWorkers:return e+t.value}return e}}),Ir=n(51),Nr=n(80),Cr={key:"root",storage:n.n(Nr).a,version:y},xr=Object(Ir.a)(Cr,Er),Sr=Object(i.a)(c.a.mark(function e(){var t,n=arguments;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",new Promise(function(e,n){var r=Object(bt.d)(xr,t,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),a=Object(Ir.b)(r,void 0,function(){var t=kt(r.getState());e({store:r,persistor:a,isHydrated:t})})}));case 2:case"end":return e.stop()}},e)})),qr=function(){var e=Object(i.a)(c.a.mark(function e(){var t,n,r,a,o;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.get("lang/en-US.json");case 2:return t=e.sent,n=t.data,De.init(n),s="GILLESROX2",It=!0,ft=Tt()(s,{state:!0}),e.next=8,Sr();case 8:r=e.sent,a=r.store,o=r.persistor,r.isHydrated?Dr(a):Ar(a),Mr(a,o);case 14:case"end":return e.stop()}var s},e)}));return function(){return e.apply(this,arguments)}}(),Ar=function(e){e.dispatch(h("test-game-welcome")),console.log("Starting new GILLES-IDLE-GAME (version ".concat("0.0.4",")"))},Dr=function(e){console.log("Continuing existing GILLES-IDLE-GAME (version ".concat("0.0.4",")"))},Mr=function(e,t){g.render(m.createElement(v.a,{store:e},m.createElement(d.b,{backend:p.a},m.createElement(Zn,{persistor:t}))),document.getElementById("root")),ar();var n=function(t){t.completed.forEach(function(t){return function(t){t.callbacks.forEach(function(t){return e.dispatch(t)})}(t)})};setInterval(function(){var t=e.getState(),a=Date.now()-t.engine.lastTick,o=er(a,t),s=nr(),c=tr(a,t),i=c.quests,u=c.log;e.dispatch(function(e,t,n,a,o){return{type:r.gameTick,delta:e,rngState:t,resources:n,quests:a,log:o}}(a,s,o,i,u)),n(t.tasks)},2500)};qr()},73:function(e,t,n){},74:function(e,t,n){},83:function(e,t,n){e.exports=n(214)}},[[83,1,2]]]);
//# sourceMappingURL=main.0f02c0e8.chunk.js.map