(this["webpackJsonpgilles-game"]=this["webpackJsonpgilles-game"]||[]).push([[0],[,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n(2),a=n(43),c=n(21),o=n(22),i=n(54),s=n(310),u=n(40),l=n(24),d=n(71),m=n(57),b=n(6),p=n(41),j=n(149),h=n(48),f=n(62),v=n(25),g=n(11),O=n(45),y=["type"],x=["type"],w=function(){function e(){Object(c.a)(this,e)}return Object(o.a)(e,null,[{key:"init",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.texts=e,this.templates={},this.notFound=[],t&&this.compileAll(),this.initialized=!0}},{key:"get",value:function(e,t){var n=this.getDefault(e,t);return null===n?(console.error("Key '".concat(e,"' not found in TextManager")),"<<'".concat(e,"' missing>>")):Object(s.decode)(n)}},{key:"getDefault",value:function(e,t){if(!this.initialized)throw new Error("Error ".concat(this," not initialized!"));var n=this.getTemplate(e);return n?n(t):null}},{key:"getTextEntry",value:function(e){return this.get(e.key,e.context)}},{key:"getTemplate",value:function(e){var t=this.templates[e];return!t&&this.texts[e]&&(this.compile(e,this.texts[e]),t=this.templates[e]),t}},{key:"getAbilityName",value:function(e){return this.get("ability-".concat(O.a[e],"-name"))}},{key:"getAdventurerName",value:function(e){return this.get("adventurer-".concat(e,"-name"))}},{key:"getAdventurerFlavor",value:function(e,t){return this.get("adventurer-".concat(e,"-flavor"),{name:t})}},{key:"getAttributeName",value:function(e){return this.get("common-attribute-".concat(e,"-name"))}},{key:"getAttributeDescription",value:function(e){return this.get("common-attribute-".concat(e,"-description"))}},{key:"getAttributeMechanics",value:function(e){return this.get("common-attribute-".concat(e,"-mechanics"))}},{key:"getEnemyName",value:function(e){return this.get("enemy-".concat(e,"-name"))}},{key:"getEquipmentSlot",value:function(e){return this.get("ui-equipmentslot-".concat(Object(i.a)(b.a[e])))}},{key:"getQuestTitle",value:function(e){return this.get("quest-".concat(Object(i.a)(e),"-title"))}},{key:"getQuestDescription",value:function(e){return this.get("quest-".concat(Object(i.a)(e),"-description"))}},{key:"getQuestSceneTitle",value:function(e){var t=e.sceneName||"";return this.get("quest-".concat(Object(i.a)(e.name),"-scene-").concat(Object(i.a)(t),"-title"))}},{key:"getResourceName",value:function(e){return this.get("resource-".concat(e,"-name"))}},{key:"getItemName",value:function(e){return Object(l.b)(e)?this.get("item-".concat(Object(i.a)(e),"-name")):this.get("item-".concat(Object(i.a)(e.type),"-name"))}},{key:"getItemCategory",value:function(e){return this.get("item-category-".concat(Object(i.a)(l.a[e])))}},{key:"getItemSubtext",value:function(e){return this.getDefault("item-".concat(Object(i.a)(e),"-subtext"))}},{key:"getRarity",value:function(e){return this.get("rarity-".concat(v.a[e],"-name"))}},{key:"getStructureName",value:function(e){return this.get("structure-".concat(Object(i.a)(e),"-name"))}},{key:"getTraitName",value:function(e){return this.get("trait-".concat(Object(i.a)(e),"-name"))}},{key:"getEffectDescription",value:function(e,t){var n=e.type,c=Object(a.a)(e,y);return this.get("effect-".concat(Object(i.a)(h.b[n]),"-description"),Object(r.a)(Object(r.a)({},c),t))}},{key:"getEffectFlavor",value:function(e){return this.get("effect-".concat(Object(i.a)(h.b[e.type]),"-flavor"))}},{key:"getEffectName",value:function(e){return this.get("effect-".concat(Object(i.a)(h.b[e.type]),"-name"))}},{key:"getTempEffectDescription",value:function(e,t){var n=e.type,c=Object(a.a)(e,x);return this.get("temp-effect-".concat(Object(i.a)(f.a[n]),"-description"),Object(r.a)(Object(r.a)({},c),t))}},{key:"getTempEffectFlavor",value:function(e){return this.get("temp-effect-".concat(Object(i.a)(f.a[e.type]),"-flavor"))}},{key:"getTempEffectName",value:function(e){return this.get("temp-effect-".concat(Object(i.a)(f.a[e.type]),"-name"))}},{key:"getTraitDescription",value:function(e){return this.get("trait-".concat(Object(i.a)(e),"-description"))}},{key:"getTraitEffect",value:function(e){return this.get("trait-".concat(Object(i.a)(e),"-effect"))}},{key:"getToastType",value:function(e){return this.get("ui-toast-type-".concat(Object(i.a)(m.a[e])))}},{key:"getWeaponType",value:function(e){return this.get("ui-weapon-type-".concat(Object(i.a)(g.c[e])))}},{key:"getSkillName",value:function(e){return this.get("skill-".concat(Object(i.a)(g.c[e]),"-name"))}},{key:"getSkillInfo",value:function(e){return this.get("skill-".concat(Object(i.a)(g.c[e]),"-info"))}},{key:"getWeaponClassification",value:function(e){return this.get("ui-weapon-class-".concat(Object(i.a)(g.b[e])))}},{key:"printNotFounds",value:function(){this.notFound.length&&(console.log("TextManager strings not found:"),console.log('"'+this.notFound.join('": "",\n"')+'": ""'))}},{key:"compileAll",value:function(){var e=this;Object.keys(this.texts).forEach((function(t){e.compile(t,e.texts[t])}))}},{key:"compile",value:function(e,t){var n=d.compile(t);this.templates[e]=n}}]),e}();w.initialized=!1,w.texts=void 0,w.templates=void 0,w.notFound=void 0;var k=function(e){var t=w.getItemName(e),n=w.getTemplate("common-article-defined");return new d.SafeString("".concat(n({noun:t})))},A=function(e){return function(e){var t=w.getItemName(e),n=w.getTemplate("common-article-undefined");return new d.SafeString("".concat(n({noun:t})))}(e)};d.registerHelper("item:name",(function(e,t){var n;if(n=Object(l.b)(e)?e:e.type,!Object(u.d)(n))return new d.SafeString("<<ITEM DEFINITION NOT FOUND: ".concat(n,">>"));switch(t){case"aA":return A(n);case"aD":case"aU":return k(n);default:return new d.SafeString(n)}})),d.registerHelper("item:trigger",(function(e){return new d.SafeString(":item[".concat(JSON.stringify(e),"]"))})),d.registerHelper("structure:name",(function(e){var t=w.get("structure-".concat(Object(i.a)(e),"-name"));return new d.SafeString(t)})),d.registerHelper("structure:link",(function(e){var t=w.get("structure-".concat(Object(i.a)(e),"-name")),n=Object(p.b)(e);return new d.SafeString("[".concat(t,"](#").concat(n,")"))})),d.registerHelper("resource:name",(function(e){var t=w.get("resource-".concat(e,"-name"));return new d.SafeString(t)})),d.registerHelper("adventurer:name",(function(e){var t=w.getAdventurerName(e);return new d.SafeString(t)})),d.registerHelper("actor:name",(function(e){if(function(e){return!(null!==e&&void 0!==e&&e.startsWith(j.a))}(e)){var t=w.getEnemyName(null===e||void 0===e?void 0:e.substring(0,e.indexOf("_")));return new d.SafeString(t)}var n=w.getAdventurerName(e);return new d.SafeString(n)}))},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return b}));var r,a=n(9),c=n(73),o=n(35),i=n(40),s=n(24),u=n(55),l=n(103),d=n(11);!function(e){e[e.feet=0]="feet",e[e.hands=1]="hands",e[e.chest=2]="chest",e[e.legs=3]="legs",e[e.head=4]="head",e[e.shoulders=5]="shoulders",e[e.mainHand=6]="mainHand",e[e.offHand=7]="offHand"}(r||(r={}));var m=function(e,t){switch(t){case r.chest:case r.feet:case r.hands:case r.head:case r.legs:return function(e,t){var n=Object(i.d)(e);return n.itemCategory===s.a.apparel&&n.equipmentType===t}(e,t);case r.mainHand:case r.offHand:var n=Object(i.d)(e);if(n.itemCategory===s.a.ammunition)return!0;if(n.itemCategory!==s.a.weapon)return!1;switch(Object(l.a)(n.weaponType).classification){case d.b.oneHanded:return!0;case d.b.mainHand:return t===r.mainHand;case d.b.offHand:case d.b.shield:return t===r.offHand}return!0;default:return!1}},b=function(e){var t=e[r.mainHand];if(t&&Object(u.c)(t.type)){var n=Object(u.b)(t.type).weaponType;if(Object(l.a)(n).classification===d.b.ranged)return!0}return!1},p=n(37),j=(n(357),n(0)),h=function(e){var t=e.adventurerId,n=e.onDrop,i=Object(p.a)(t),s=Object(c.useDrop)((function(){return{accept:o.b.ITEM,drop:function(e){n(e)},collect:function(t){var n,r=null===(n=t.getItem())||void 0===n?void 0:n.item;return{canDrop:!!r&&m(r.type,e.type)&&t.canDrop(),isOver:t.isOver()}}}}),[t,i.equipment]),u=Object(a.a)(s,2),l=u[0],d=l.isOver,b=l.canDrop,h=u[1],f=["equipment-slot"];return d&&b?f.push("drop-active"):b&&f.push("drop-possible"),Object(j.jsx)("div",{className:f.join(" "),title:r[e.type],ref:h,children:e.children})}},,,,,function(e,t,n){"use strict";var r,a,c;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return c})),function(e){e[e.oneHanded=0]="oneHanded",e[e.mainHand=1]="mainHand",e[e.offHand=2]="offHand",e[e.twoHanded=3]="twoHanded",e[e.shield=4]="shield",e[e.ranged=5]="ranged"}(r||(r={})),function(e){e.axe="axe",e.bow="bow",e.club="club",e.crossbow="crossbow",e.fist="fist",e.flail="flail",e.hammer="hammer",e.knife="knife",e.staff="staff",e.shield="shield",e.sword="sword",e.poleArm="poleArm"}(a||(a={})),function(e){e.kinetic="kinetic"}(c||(c={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"i",(function(){return b})),n.d(t,"h",(function(){return p}));var r=n(3),a=5e3,c=6e4,o=12e4,i=18e4,s=24e4,u=30*c,l=60*c,d=24*l,m=265.25*d,b=function(e,t){var n=[{unit:t?"y":"year",amount:m},{unit:t?"d":"day",amount:d},{unit:t?"h":"hour",amount:l},{unit:t?"m":"minute",amount:c},{unit:t?"s":"second",amount:1e3}],a=Math.abs(e),o=[];return n.forEach((function(e){var n=Math.floor(a/e.amount);if(a-=n*e.amount,0!==n){var c=r.a.get("common-time-".concat(e.unit).concat(n>1&&!t?"-plural":""));o.push("".concat(n).concat(c))}})),o.join(" ")},p=function(e){return new Date(e).toLocaleTimeString()}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return c}));var r,a=n(53);!function(e){e[e.player=0]="player",e[e.enemy=1]="enemy"}(r||(r={}));var c,o=function(e){return e.type===a.a.actor},i=function(e){return o(e)&&e.allegiance===r.player},s=function(e){return o(e)&&e.allegiance===r.enemy},u=function(e,t){return e.find((function(e){return i(e)&&e.adventurerId===t}))},l=function(e){return i(e)?e.adventurerId:s(e)?e.enemyId:"UNKNOWN"};!function(e){e.move="move",e.interact="interact",e.melee="melee",e.shoot="shoot"}(c||(c={}))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return v}));var r,a,c,o=n(5),i=n(70),s=n(21),u=n(22),l=n(49),d=n.n(l),m=n(99),b=n.n(m),p=n(315),j=n(81),h=n(15);!function(e){e[e.music=0]="music",e[e.ui=1]="ui",e[e.scene=2]="scene",e[e.ambient=3]="ambient"}(r||(r={})),function(e){e[e.singleInstance=0]="singleInstance",e[e.layered=1]="layered",e[e.fade=2]="fade"}(a||(a={})),function(e){e[e.town=0]="town",e[e.world=1]="world"}(c||(c={}));var f="channelVolume",v=function(){function e(){Object(s.a)(this,e)}return Object(u.a)(e,null,[{key:"init",value:function(){var e=Object(i.a)(d.a.mark((function e(){var t,n,a,c,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={},e.t0=o.a,e.t1=i,e.t2=r.music,e.next=6,b.a.getItem("".concat(f,"-").concat(r.music));case 6:if(e.t4=t=e.sent,e.t3=null!==e.t4,!e.t3){e.next=10;break}e.t3=void 0!==t;case 10:if(!e.t3){e.next=14;break}e.t5=t,e.next=15;break;case 14:e.t5=0;case 15:return e.t6=e.t5,(0,e.t0)(e.t1,e.t2,e.t6),e.t7=o.a,e.t8=i,e.t9=r.ui,e.next=22,b.a.getItem("".concat(f,"-").concat(r.ui));case 22:if(e.t11=n=e.sent,e.t10=null!==e.t11,!e.t10){e.next=26;break}e.t10=void 0!==n;case 26:if(!e.t10){e.next=30;break}e.t12=n,e.next=31;break;case 30:e.t12=1;case 31:return e.t13=e.t12,(0,e.t7)(e.t8,e.t9,e.t13),e.t14=o.a,e.t15=i,e.t16=r.scene,e.next=38,b.a.getItem("".concat(f,"-").concat(r.scene));case 38:if(e.t18=a=e.sent,e.t17=null!==e.t18,!e.t17){e.next=42;break}e.t17=void 0!==a;case 42:if(!e.t17){e.next=46;break}e.t19=a,e.next=47;break;case 46:e.t19=1;case 47:return e.t20=e.t19,(0,e.t14)(e.t15,e.t16,e.t20),e.t21=o.a,e.t22=i,e.t23=r.ambient,e.next=54,b.a.getItem("".concat(f,"-").concat(r.ambient));case 54:if(e.t25=c=e.sent,e.t24=null!==e.t25,!e.t24){e.next=58;break}e.t24=void 0!==c;case 58:if(!e.t24){e.next=62;break}e.t26=c,e.next=63;break;case 62:e.t26=.2;case 63:e.t27=e.t26,(0,e.t21)(e.t22,e.t23,e.t27),this._channelVolume=i,this._initialized=!0;case 67:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addSound",value:function(){var e=Object(i.a)(d.a.mark((function e(t,n,r){var a,c=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Promise((function(e,a){if("string"===typeof n&&(n=[n]),c._sounds[t])return null===r||void 0===r||r(c._sounds[t]),void e(c._sounds[t]);var o=new h.Loader;n.map((function(e){return o.add(e)})),o.load((function(n,a){a&&(c._sounds[t]=Object.values(a).filter(Boolean).map((function(e){return e.sound})),null===r||void 0===r||r(c._sounds[t]),e(c._sounds[t]))}))})),e.abrupt("return",a);case 2:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"playSound",value:function(){var t=Object(i.a)(d.a.mark((function t(n){var c,o,i,s,u,l,m,b,p,h,f=this,v=arguments;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=v.length>1&&void 0!==v[1]?v[1]:r.ui,s=v.length>2&&void 0!==v[2]&&v[2],u=v.length>3&&void 0!==v[3]?v[3]:a.singleInstance,l=v.length>4&&void 0!==v[4]&&v[4],this._initialized){t.next=7;break}return t.next=7,this.init();case 7:return(m=this.getSound(n)).volume=this._channelVolume[i],m.loop=s,null!==(c=this._currentSound[i])&&void 0!==c&&c.storePosition&&(b=this._currentSound[i]).instance.once("progress",(function(e,t){f._storedPositions[b.gameSound]=e*t})),p=null!==(o=this._storedPositions[n])&&void 0!==o?o:0,t.next=14,m.play({start:p});case 14:h=t.sent,this._currentSound[i]&&(u===a.fade?(e.fadeOutSound(i),j.b.from(h,{volume:0,duration:.75})):u===a.singleInstance&&this._currentSound[i].instance.stop()),this._currentSound[i]={instance:h,gameSound:n,pixiSound:m,storePosition:l},h.on("end",(function(){f._currentSound[i].instance.destroy(),delete f._currentSound[i]}));case 18:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getSound",value:function(e){var t;return null!==(t=this._sounds[e])&&void 0!==t&&t.length||console.error("No sound found for ".concat(e)),1===this._sounds[e].length?this._sounds[e][0]:this._sounds[e][Math.floor(Math.random()*this._sounds[e].length)]}},{key:"stopSound",value:function(e){var t;null===(t=this._currentSound[e])||void 0===t||t.instance.destroy(),delete this._currentSound[e]}},{key:"fadeOutSound",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.75,n=this._currentSound[e];j.b.to(n.instance,{volume:0,duration:t,onComplete:function(){n.instance.destroy()}})}},{key:"getCurrentlyPlaying",value:function(e){var t;return null===(t=this._currentSound[e])||void 0===t?void 0:t.gameSound}},{key:"hasSoundLoaded",value:function(e){return!!this._sounds[e]}},{key:"musicFiltered",set:function(e){this._currentSound[r.music]&&(this._currentSound[r.music].pixiSound.filters=e?[this._filter]:[])}},{key:"getChannelVolume",value:function(e){return this._channelVolume[e]}},{key:"setChannelVolume",value:function(e,t){var n;this._channelVolume[e]=t,null!==(n=this._currentSound[e])&&void 0!==n&&n.instance&&(this._currentSound[e].instance.volume=t),b.a.setItem("".concat(f,"-").concat(e),t)}}]),e}();v._sounds={},v._currentSound={},v._storedPositions={},v._channelVolume={},v._initialized=!1,v._filter=new p.a.TelephoneFilter},,,,,,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e[e.ammunition=0]="ammunition",e[e.apparel=1]="apparel",e[e.consumable=2]="consumable",e[e.deed=3]="deed",e[e.herb=4]="herb",e[e.material=5]="material",e[e.mineral=6]="mineral",e[e.questItem=7]="questItem",e[e.trinket=8]="trinket",e[e.weapon=9]="weapon"}(r||(r={}));var a=function(e){return!Object.prototype.hasOwnProperty.call(e,"type")}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.common=0]="common",e[e.uncommon=1]="uncommon",e[e.rare=2]="rare",e[e.epic=3]="epic",e[e.legendary=4]="legendary"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return r}));var r,a,c=n(2),o=n(43);!function(e){e.smallest="smallest",e.small="small",e.medium="medium",e.big="big",e.biggest="biggest"}(r||(r={})),function(e){e.none="none",e.gold="gold"}(a||(a={}));var i=function e(t){switch(t){case r.smallest:return"size-smallest";case r.small:return"size-small";case r.medium:return"size-medium";case r.big:return"size-big";case r.biggest:return"size-biggest"}return e(r.medium)},s=function(e){switch(e){case a.gold:return"border-gold";case a.none:default:return""}},u=(n(445),n(0)),l=["image","size","children","className","border"],d=function(e){var t=e.image,n=e.size,d=e.children,m=e.className,b=void 0===m?"":m,p=e.border,j=void 0===p?"none":p,h=Object(o.a)(e,l),f={"--img":'url("'.concat(t,'")')};return Object(u.jsxs)("div",Object(c.a)(Object(c.a)({className:"icon ".concat(i("string"===typeof n?r[n]:n)," ").concat(b)},h),{},{style:f,children:[d,"none"!==j&&j&&Object(u.jsx)("div",{className:"border ".concat(s("string"===typeof j?a[j]:j)," ")})]}))}},,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.nothing=0]="nothing",e[e.encounter=1]="encounter"}(r||(r={}))},,,,,,function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return a})),n.d(t,"m",(function(){return c})),n.d(t,"k",(function(){return o})),n.d(t,"j",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"l",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return j}));var r=function(e,t){return{type:"launchQuest",questName:e,assignedAventurers:t}},a=function(e){return{type:"exitEncounter",questName:e}},c=function(e,t){return{type:"updateQuestVars",questName:e,vars:t}},o=function(e,t){return{type:"setSceneName",questName:e,sceneName:t}},i=function(e,t){return{type:"setScene",questName:e,scene:t}},s=function(e,t){return{type:"enqueueSceneAction",questName:e,sceneAction:t}},u=function(e,t){return{type:"completeSceneAction",questName:e,actorName:t}},l=function(e,t){return{type:"setCombat",questName:e,combat:t}},d=function(e){return{type:"endPlayerTurn",questName:e}},m=function(e,t,n){return{type:"startTurn",questName:e,turn:t,adventurers:n}},b=function(e,t,n){return{type:"deductActorAp",questName:e,actor:t,ap:n}},p=function(e,t,n){return{type:"modifyEnemyHealth",questName:e,actor:t,health:n}},j=function(e,t){return{type:"setActiveSceneInteractionModal",questName:e,sceneInteractionModal:t}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));var r,a={ADVENTURER:"adventurer",ITEM:"item"};!function(e){e[e.adventurerInventory=0]="adventurerInventory",e[e.adventurerConsumeItem=1]="adventurerConsumeItem",e[e.warehouse=2]="warehouse",e[e.tavern=3]="tavern",e[e.adventurerEquipment=4]="adventurerEquipment",e[e.lootCache=5]="lootCache",e[e.resourceStructure=6]="resourceStructure"}(r||(r={}))},,function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n(5),a=n(18),c=n(77),o=n(16),i=n(1),s=n(6),u=n(76),l=function(){var e=Object(o.d)((function(e){return e.adventurers})),t=Object(o.d)((function(e){return e.quests})),n=Object(i.useMemo)((function(){return function(e,t){var n=t.reduce((function(e,t){return t.status===c.a.active&&e.push.apply(e,Object(a.a)(t.party)),e}),[]);return e.filter((function(e){return-1===n.indexOf(e.id)}))}(e,t)}),[e,t]);return n},d=function(){return Object(o.d)((function(e){return e.adventurers}))},m=function(e){var t=Object(i.useCallback)((function(t){return t.adventurers.find((function(t){return t.id===e}))}),[e]);return Object(o.d)(t)},b=function(e){var t,n=m(e),a=function(e){var t=n.equipment[e];return t&&Object(u.b)(t.type).damageReduction||0};return t={},Object(r.a)(t,s.a[s.a.head],a(s.a.head)),Object(r.a)(t,s.a[s.a.chest],a(s.a.chest)),Object(r.a)(t,s.a[s.a.hands],a(s.a.hands)),Object(r.a)(t,s.a[s.a.shoulders],a(s.a.shoulders)),Object(r.a)(t,s.a[s.a.legs],a(s.a.legs)),Object(r.a)(t,s.a[s.a.feet],a(s.a.feet)),t}},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return g}));var r=n(2),a=n(102),c=n(76),o=n(104),i=n(145),s=n(146),u=n(147),l=n(80),d=n(121),m=n(148),b=n(55),p=n(24),j=Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)({},a.a),c.a),l.a),o.a),i.a),s.a),u.a),d.a),m.a),b.a);t.b=j;var h=function(e){return j[e]},f=function(e){if(Object(c.c)(e))return Object(c.b)(e);if(Object(b.c)(e))return Object(b.b)(e);throw new Error("".concat(e," is neither a weapon nor apparel"))},v=function(e){switch(e){case p.a.ammunition:return Object.keys(a.a);case p.a.apparel:return Object.keys(c.a);case p.a.deed:return Object.keys(o.a);case p.a.herb:return Object.keys(i.a);case p.a.material:return Object.keys(s.a);case p.a.mineral:return Object.keys(u.a);case p.a.consumable:return Object.keys(l.a);case p.a.questItem:return Object.keys(d.a);case p.a.trinket:return Object.keys(m.a);case p.a.weapon:return Object.keys(b.a)}},g=function(e){return e===p.a.ammunition}},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o}));var r=function(){return"/world"},a=function(e){return"".concat(r(),"/").concat(e)},c=function(){return"/town"},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"/".concat(c(),"/").concat(e).concat(t?"":"/view")}},function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"f",(function(){return a})),n.d(t,"i",(function(){return c})),n.d(t,"a",(function(){return o})),n.d(t,"k",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"j",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"g",(function(){return m})),n.d(t,"m",(function(){return b})),n.d(t,"l",(function(){return p})),n.d(t,"c",(function(){return j}));var r=function(e,t){return{type:"modifyHealth",adventurerId:e,amount:t}},a=function(e,t){return{type:"consumeItem",adventurerId:e,fromSlot:t}},c=function(e,t,n){return{type:"moveItemInInventory",adventurerId:e,fromSlot:t,toSlot:n}},o=function(e,t,n){return{type:"addItemToInventory",adventurerId:e,item:t,toSlot:n}},i=function(e,t){return{type:"removeItemFromInventory",adventurerId:e,fromSlot:t}},s=function(e,t,n){return{type:"assignEquipment",adventurerId:e,item:n,equipmentSlot:t}},u=function(e,t){return{type:"removeEquipment",adventurerId:e,equipmentSlot:t}},l=function(e,t,n){return{type:"changeEquipmentQuantity",adventurerId:e,equipmentSlot:t,quantity:n}},d=function(e,t){return{type:"addTempEffect",adventurerId:e,tempEffect:t}},m=function(e,t){return{type:"decreaseEffectCharge",adventurerId:e,effect:t}},b=function(e,t){return{type:"setBasicAttributes",adventurerId:e,basicAttributes:t}},p=function(e,t){return{type:"renameAdventurer",adventurerId:e,name:t}},j=function(e,t){return{type:"addXp",adventurerId:e,xp:t}}},,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.aimedShot=0]="aimedShot",e[e.swing=1]="swing",e[e.block=2]="block",e[e.cut=3]="cut",e[e.cleave=4]="cleave",e[e.shoot=5]="shoot",e[e.slash=6]="slash",e[e.parry=7]="parry",e[e.riposte=8]="riposte"}(r||(r={}))},,function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return l}));var r,a=n(48),c=n(169),o=1,i=20;!function(e){e[e.base=0]="base",e[e.item=1]="item",e[e.tempEffect=2]="tempEffect"}(r||(r={}));var s=function(e){var t={type:r.base};return{str:[{origin:t,value:e.str}],for:[{origin:t,value:e.for}],int:[{origin:t,value:e.int}],agi:[{origin:t,value:e.agi}]}},u=function(e){var t=s(e.basicAttributes);return Object(c.a)(e,a.b.attributeIncrease).forEach((function(n){var c=function(e){switch(e.type){case a.a.item:return{type:r.item,item:e.itemType};case a.a.tempEffect:return{type:r.tempEffect,tempEffectType:e.tempEffectType}}}(n.source);if(n.type===a.b.attributeIncrease){var o=n.attribute;t[o].push({origin:c,value:e.basicAttributes[o]*n.factor-e.basicAttributes[o]})}})),t},l=function(e){var t=u(e);return{str:t.str.reduce((function(e,t){return e+t.value}),0),for:t.for.reduce((function(e,t){return e+t.value}),0),int:t.int.reduce((function(e,t){return e+t.value}),0),agi:t.agi.reduce((function(e,t){return e+t.value}),0)}}},function(e,t,n){"use strict";var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.attributeIncrease=0]="attributeIncrease",e[e.healthDecreaseOnMove=1]="healthDecreaseOnMove",e[e.healthDecreaseOverTime=2]="healthDecreaseOverTime"}(r||(r={})),function(e){e[e.tempEffect=0]="tempEffect",e[e.item=1]="item"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=function(e){return Math.floor(.5*Math.sqrt(e))},a=function(e){return Math.pow(e/.5,2)},c=a(80)},,,function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i}));var r,a=function(e){return e?e.reduce((function(e,t){return e[t.name]=t.value,e}),{}):{}};!function(e){e.actor="actor",e.enemySpawn="enemySpawn",e.portal="portal"}(r||(r={}));var c=function(e,t){for(var n,r=t.length-1;r>=0&&!((n=t[r]).firstgid<=e);r--);return n},o=function(e,t,n){t.data.reduce((function(e,t,r){if(t>0){var a=r%n,c=Math.floor(r/n);e.push([a,c])}return e}),e)},i=function(e,t){return e[0]===t[0]&&e[1]===t[1]}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return p}));var r=n(9),a=n(5),c=n(24),o=n(25),i=n(48),s=n(11),u=c.a.weapon,l="/img/items/weapons/",d={aegisOfValor:{itemCategory:u,weaponType:s.c.shield,rarity:o.a.legendary,iconImg:"".concat(l,"aegis-of-valor.png")},arbalest:{itemCategory:u,weaponType:s.c.crossbow,rarity:o.a.epic,iconImg:"".concat(l,"arbalest.png"),damage:Object(a.a)({},s.a.kinetic,40)},battleAxe:{itemCategory:u,weaponType:s.c.axe,rarity:o.a.common,iconImg:"".concat(l,"battle-axe.png"),damage:Object(a.a)({},s.a.kinetic,20)},boneBow:{itemCategory:u,weaponType:s.c.bow,rarity:o.a.common,iconImg:"".concat(l,"bone-bow.png"),damage:Object(a.a)({},s.a.kinetic,15)},berserkerShield:{itemCategory:u,weaponType:s.c.shield,rarity:o.a.epic,iconImg:"".concat(l,"berserker-shield.png")},brassKnuckles:{itemCategory:u,weaponType:s.c.fist,iconImg:"".concat(l,"brass-knuckles.png"),rarity:o.a.common,damage:Object(a.a)({},s.a.kinetic,10)},bronzeDagger:{itemCategory:u,weaponType:s.c.knife,iconImg:"".concat(l,"bronze-dagger.png"),rarity:o.a.common,damage:Object(a.a)({},s.a.kinetic,8)},buckler:{itemCategory:u,weaponType:s.c.shield,rarity:o.a.common,iconImg:"".concat(l,"buckler.png")},cleaver:{itemCategory:u,weaponType:s.c.knife,iconImg:"".concat(l,"cleaver.png"),rarity:o.a.common,damage:Object(a.a)({},s.a.kinetic,5)},club:{itemCategory:u,weaponType:s.c.club,iconImg:"".concat(l,"club.png"),rarity:o.a.common,damage:Object(a.a)({},s.a.kinetic,8)},dagger:{itemCategory:u,weaponType:s.c.knife,iconImg:"".concat(l,"dagger.png"),rarity:o.a.rare,damage:Object(a.a)({},s.a.kinetic,10)},dirk:{itemCategory:u,weaponType:s.c.knife,iconImg:"".concat(l,"dirk.png"),rarity:o.a.uncommon,damage:Object(a.a)({},s.a.kinetic,10)},falchion:{itemCategory:u,weaponType:s.c.sword,iconImg:"".concat(l,"falchion.png"),rarity:o.a.rare,damage:Object(a.a)({},s.a.kinetic,12)},flail:{itemCategory:u,weaponType:s.c.flail,iconImg:"".concat(l,"flail.png"),rarity:o.a.uncommon,damage:Object(a.a)({},s.a.kinetic,15)},goldenShield:{itemCategory:u,weaponType:s.c.shield,rarity:o.a.rare,iconImg:"".concat(l,"golden-shield.png")},greatswordOfGwai:{itemCategory:u,weaponType:s.c.sword,iconImg:"".concat(l,"greatsword-gwai.png"),unique:!0,rarity:o.a.legendary,damage:Object(a.a)({},s.a.kinetic,25),effects:[{type:i.b.attributeIncrease,attribute:"agi",factor:1.1},{type:i.b.attributeIncrease,attribute:"for",factor:1.1},{type:i.b.attributeIncrease,attribute:"int",factor:1.1},{type:i.b.attributeIncrease,attribute:"str",factor:1.1}]},halbert:{itemCategory:u,weaponType:s.c.poleArm,iconImg:"".concat(l,"halbert.png"),rarity:o.a.rare,damage:Object(a.a)({},s.a.kinetic,12)},huntingBow:{itemCategory:u,weaponType:s.c.bow,iconImg:"".concat(l,"hunting-bow.png"),rarity:o.a.common,damage:Object(a.a)({},s.a.kinetic,5)},indomitableCarapace:{itemCategory:u,weaponType:s.c.shield,rarity:o.a.epic,unique:!0,iconImg:"".concat(l,"indomitable-carapace.png")},jaggedBlade:{itemCategory:u,weaponType:s.c.knife,rarity:o.a.epic,iconImg:"".concat(l,"jagged-blade.png")},javelin:{itemCategory:u,weaponType:s.c.poleArm,iconImg:"".concat(l,"javelin.png"),rarity:o.a.epic,damage:Object(a.a)({},s.a.kinetic,25)},khopesh:{itemCategory:u,weaponType:s.c.sword,iconImg:"".concat(l,"khopesh.png"),rarity:o.a.epic,damage:Object(a.a)({},s.a.kinetic,15)},legionnaireSword:{itemCategory:u,weaponType:s.c.sword,iconImg:"".concat(l,"legionnaire-sword.png"),rarity:o.a.rare,damage:Object(a.a)({},s.a.kinetic,8)},longbow:{itemCategory:u,weaponType:s.c.bow,iconImg:"".concat(l,"longbow.png"),rarity:o.a.rare,damage:Object(a.a)({},s.a.kinetic,6)},mace:{itemCategory:u,weaponType:s.c.club,iconImg:"".concat(l,"mace.png"),rarity:o.a.rare,damage:Object(a.a)({},s.a.kinetic,15)},morningStar:{itemCategory:u,weaponType:s.c.club,iconImg:"".concat(l,"morning-star.png"),rarity:o.a.uncommon,damage:Object(a.a)({},s.a.kinetic,13)},oakWoodBow:{itemCategory:u,weaponType:s.c.bow,iconImg:"".concat(l,"oakwood-bow.png"),rarity:o.a.rare,damage:Object(a.a)({},s.a.kinetic,23)},paintedBuckler:{itemCategory:u,weaponType:s.c.shield,iconImg:"".concat(l,"painted-buckler.png")},poisonedDagger:{itemCategory:u,weaponType:s.c.knife,iconImg:"".concat(l,"poisoned-dagger.png"),rarity:o.a.epic,damage:Object(a.a)({},s.a.kinetic,12)},pikeStaff:{itemCategory:u,weaponType:s.c.poleArm,iconImg:"".concat(l,"pike-staff.png"),rarity:o.a.uncommon,damage:Object(a.a)({},s.a.kinetic,22)},ravenStaff:{itemCategory:u,weaponType:s.c.staff,iconImg:"".concat(l,"raven-staff.png"),rarity:o.a.epic,damage:Object(a.a)({},s.a.kinetic,13)},scythe:{itemCategory:u,weaponType:s.c.poleArm,iconImg:"".concat(l,"scythe.png"),rarity:o.a.common,damage:Object(a.a)({},s.a.kinetic,5)},savageStaff:{itemCategory:u,weaponType:s.c.staff,iconImg:"".concat(l,"savage-staff.png"),rarity:o.a.epic,damage:Object(a.a)({},s.a.kinetic,8)},simpleCrossbow:{itemCategory:u,weaponType:s.c.crossbow,iconImg:"".concat(l,"crossbow.png"),rarity:o.a.common,damage:Object(a.a)({},s.a.kinetic,5)},spear:{itemCategory:u,weaponType:s.c.poleArm,iconImg:"".concat(l,"spear.png"),rarity:o.a.rare,damage:Object(a.a)({},s.a.kinetic,10)},steelShield:{itemCategory:u,weaponType:s.c.shield,rarity:o.a.rare,iconImg:"".concat(l,"steel-shield.png")},steelSword:{itemCategory:u,weaponType:s.c.sword,iconImg:"".concat(l,"steel-sword.png"),rarity:o.a.uncommon,damage:Object(a.a)({},s.a.kinetic,14)},warhammer:{itemCategory:u,weaponType:s.c.hammer,iconImg:"".concat(l,"warhammer.png"),rarity:o.a.rare,damage:Object(a.a)({},s.a.kinetic,16)},woodenBulwark:{itemCategory:u,weaponType:s.c.shield,rarity:o.a.common,iconImg:"".concat(l,"wooden-bulwark.png")}},m=Object.entries(d).reduce((function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return e["".concat("weapon/").concat(a)]=c,e}),{});function b(e){return m[e]}t.a=m;var p=function(e){return!!m[e]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n(18),a=n(21),c=n(22),o=n(33),i=n(36),s=n(12),u=n(89),l=n.n(u),d=n(17),m="toast",b=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(){return Object(a.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,null,[{key:"addToast",value:function(e,t,n,a){var c=this;this.stack=[].concat(Object(r.a)(this.stack),[{time:Date.now(),title:e,type:t,icon:n,link:a}]),this.instance.emit(m,this.stack),d.c.playSound("ui/toast"),setTimeout((function(){c.stack=c.stack.filter((function(e){return Date.now()-e.time<c.lifeTime})),c.instance.emit(m,c.stack)}),this.lifeTime)}},{key:"instance",get:function(){return this._instance}}]),n}(l.a);b._instance=new b,b.stack=[],b.lifeTime=s.a},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r,a=n(3),c=n(30),o=n(26),i=n(0);!function(e){e[e.achievementUnlocked=0]="achievementUnlocked",e[e.cheat=1]="cheat",e[e.game=2]="game",e[e.itemCrafted=3]="itemCrafted",e[e.questCompleted=4]="questCompleted",e[e.questEncounter=5]="questEncounter",e[e.questLaunched=6]="questLaunched",e[e.questUpdate=7]="questUpdate"}(r||(r={}));t.b=function(e){var t=e.title,n=e.type,s=void 0===n?r.achievementUnlocked:n,u=e.icon,l=void 0===u?"/img/items/quest-items/dragon-eye.png":u,d=e.link,m=Object(c.h)(),b=a.a.getToastType(s);return Object(i.jsxs)("div",{className:"toast ".concat(d?"withlink":""),onClick:function(){d&&m(d)},children:[Object(i.jsx)("div",{className:"label type",children:b}),Object(i.jsx)("div",{className:"label title",children:t}),Object(i.jsx)(o.b,{size:"big",image:l,className:"toast-icon",border:"gold"}),Object(i.jsx)("div",{className:"banner"})]})}},function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return m})),n.d(t,"j",(function(){return b})),n.d(t,"i",(function(){return p})),n.d(t,"h",(function(){return j}));var r=n(5),a=n(6),c=n(96),o=1,i=2,s=1,u=1,l=6,d=function(e,t){var n=e.agi;return Math.floor(.2*(1.16^n)+1+t/10)+300},m=function(e){return 3*e.agi},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Object(c.d)();return t<=e},p=function(e){return m(e)>Object(c.c)(0,100)},j=function(){var e,t=(e={},Object(r.a)(e,a.a.head,.1),Object(r.a)(e,a.a.chest,.4),Object(r.a)(e,a.a.hands,.1),Object(r.a)(e,a.a.legs,.3),Object(r.a)(e,a.a.shoulders,.05),Object(r.a)(e,a.a.feet,.05),e);return Object(c.f)(t)}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.arrowFinder="arrowFinder",e.gloomy="gloomy",e.lucky="lucky",e.houseHouston="houseHouston",e.houseMaddox="houseMaddox",e.houseMonroe="houseMonroe"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"f",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return j})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return f})),n.d(t,"i",(function(){return v}));var r=n(18),a=n(6),c=n(55),o=n(14),i=n(53),s=n(102),u=function(e,t){return t.find((function(t){return t.party.some((function(t){return t===e.id}))}))},l=function(e,t){return e.find((function(e){return e.id===t}))},d=function(e,t){return t.party.map((function(t){return l(e,t)}))},m=function(e,t){var n=t.party[0];return l(e,n)},b=function(e){return e.inventory.filter((function(e){return null===e})).length},p=function(e){var t=function(t){var n=e.equipment[t];return!!n&&Object(c.c)(n.type)};return[].concat(Object(r.a)(t(a.a.mainHand)?[e.equipment[a.a.mainHand]]:[]),Object(r.a)(t(a.a.offHand)?[e.equipment[a.a.offHand]]:[]))},j=function(e){var t=e.equipment[a.a.offHand];return t&&Object(s.b)(t.type)?e.equipment[a.a.offHand]:void 0},h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0};return e.find((function(e){return e.location&&Object(i.d)(e.location,t)&&n(e)}))},f=function(e,t){return e.find((function(e){return Object(o.f)(e)&&e.adventurerId===t||Object(o.g)(e)&&e.enemyId===t}))},v=function(e){return void 0!==(null===e||void 0===e?void 0:e.engine.gameStarted)}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.common=0]="common",e[e.town=1]="town",e[e.quest=2]="quest"}(r||(r={}))},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.brokenLegs=0]="brokenLegs",e[e.burning=1]="burning",e[e.soma=2]="soma"}(r||(r={}))},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r;n(6);!function(e){e[e.blue=0]="blue",e[e.red=1]="red",e[e.teal=2]="teal",e[e.purple=3]="purple",e[e.orange=4]="orange",e[e.black=5]="black",e[e.white=6]="white",e[e.yellow=7]="yellow"}(r||(r={}));var a=["str","for","int","agi"]},,,function(e,t,n){"use strict";function r(e,t){return Object.hasOwnProperty.call(e,t)}function a(e){return Object.entries(e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c}));var c=function(e){return Object.keys(e).filter((function(e){return!isNaN(Number(e))})).map((function(e){return Number(e)}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return p}));var r=n(9),a=n(24),c=n(6),o=n(48),i=n(25),s=a.a.apparel,u="/img/items/apparel/",l={type:o.b.attributeIncrease,attribute:"agi",factor:1.05},d={boots1:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"boots_1.png")},boots2:{equipmentType:c.a.feet,itemCategory:s,damageReduction:1,iconImg:"".concat(u,"boots_2.png")},boots3:{equipmentType:c.a.feet,itemCategory:s,damageReduction:2,iconImg:"".concat(u,"boots_3.png")},chainmailHood:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"chainmail_hood.png"),damageReduction:3},chest:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"chest_1.png"),damageReduction:2},clothGloves:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"cloth_gloves.png"),damageReduction:1},cowl:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"cowl.png"),damageReduction:2},cultistBoots:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"cultist_boots.png"),damageReduction:2},crimsonRogueBoots:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"crimson_rogue_boots.png"),damageReduction:2,effects:[l]},crimsonRogueBritches:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"crimson_rogue_britches.png"),damageReduction:2,effects:[l]},crimsonRogueCoif:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"crimson_rogue_coif.png"),damageReduction:2,effects:[l]},crimsonRogueGrips:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"crimson_rogue_grips.png"),damageReduction:2,effects:[l]},crimsonRogueSpaulders:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"crimson_rogue_spaulders.png"),damageReduction:2,effects:[l]},crimsonRogueTunic:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"crimson_rogue_tunic.png"),damageReduction:2,effects:[l]},cultistGloves:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"cultist_gloves.png"),damageReduction:2},cultistPants:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"cultist_pants.png"),damageReduction:2},cultistRobe:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"cultist_robe.png"),damageReduction:2},cultistShoulderwraps:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"cultist_shoulderwraps.png"),damageReduction:2},darkPrinceBracers:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"dark_prince_bracers.png"),damageReduction:2},darkPrinceCape:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"dark_prince_cape.png"),damageReduction:2},darkPrinceCuirass:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"dark_prince_cuirass.png"),damageReduction:2},darkPrinceHood:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"dark_prince_hood.png"),damageReduction:2},darkPrinceSarong:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"dark_prince_sarong.png"),damageReduction:2},darkPrinceSlippers:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"dark_prince_slippers.png"),damageReduction:2},dreadnoughtBoots:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"dreadnought_boots.png"),damageReduction:8},dreadnoughtChest:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"dreadnought_chest.png"),damageReduction:8},dreadnoughtGauntlets:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"dreadnought_gauntlets.png"),damageReduction:8},dreadnoughtHelm:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"dreadnought_helm.png"),damageReduction:8},dreadnoughtLegplates:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"dreadnought_legplates.png"),damageReduction:8},dreadnoughtPauldrons:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"dreadnought_pauldrons.png"),damageReduction:8},druidChest:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"druid-chest.png")},druidFeet:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"druid-feet.png")},druidHands:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"druid-hands.png")},druidHead:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"druid-head.png")},druidLegs:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"druid-legs.png")},fedora:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"fedora.png")},footmanBoots:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"footman_boots.png")},footmanBreastplate:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"footman_breastplate.png")},footmanFaceguard:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"footman_faceguard.png")},footmanFists:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"footman_fists.png")},footmanLegplates:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"footman_legplates.png")},footmanPauldrons:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"footman_pauldrons.png")},greaves1:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"greaves_1.png"),damageReduction:2},greaves2:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"greaves_2.png")},hornedHelmet:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"horned_helmet.png")},leatherGloves:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"leather_gloves.png")},naturalistsCape:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"naturalists_cape.png")},naturalistsCowl:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"naturalists_cowl.png")},naturalistsFootwraps:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"naturalists_footwraps.png")},naturalistsVambraces:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"naturalists_vambraces.png")},naturalistsVest:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"naturalists_vest.png")},nomadHelmet:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"nomad_helmet.png")},pants1:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"pants_1.png"),damageReduction:3},pants2:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"pants_2.png"),damageReduction:3},plateChest1:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"plate_chest_1.png")},plateChest2:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"plate_chest_2.png")},plateChest3:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"plate_chest_3.png")},plateChest4:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"plate_chest_4.png")},plateGloves1:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"plate_gloves_1.png")},plateGloves2:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"plate_gloves_2.png")},plateHelmet:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"plate_helmet_1.png")},platePants:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"plate_pants1.png")},plateShoulders1:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"plate_shoulders_1.png")},plateShoulders2:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"plate_shoulders_2.png")},robe:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"robe_1.png")},shoulders1:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"shoulders_1.png")},shoulders2:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"shoulders_2.png"),damageReduction:2},shoulders3:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"shoulders_3.png")},studdedLeatherShoulderguards:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"studded_leather_shoulderguards.png")},sunchaserBritches:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"sunchaser_britches.png")},sunchaserGloves:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"sunchaser_gloves.png")},sunchaserHelm:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"sunchaser_helm.png")},sunchaserMantle:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"sunchaser_mantle.png")},sunchaserMoccasins:{equipmentType:c.a.feet,itemCategory:s,iconImg:"".concat(u,"sunchaser_moccasins.png")},sunchaserTunic:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"sunchaser_tunic.png")},templeGuardChestplate:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"temple_guard_chestplate.png")},templeGuardGloves:{equipmentType:c.a.hands,itemCategory:s,iconImg:"".concat(u,"temple_guard_gloves.png")},templeGuardGreaves:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"temple_guard_greaves.png")},templeGuardHelm:{equipmentType:c.a.head,itemCategory:s,iconImg:"".concat(u,"temple_guard_helm.png")},templeGuardLegplates:{equipmentType:c.a.legs,itemCategory:s,iconImg:"".concat(u,"temple_guard_legplates.png")},templeGuardPauldrons:{equipmentType:c.a.shoulders,itemCategory:s,iconImg:"".concat(u,"temple_guard_pauldrons.png")},vest:{equipmentType:c.a.chest,itemCategory:s,iconImg:"".concat(u,"vest_1.png")},witchhunterBoots:{equipmentType:c.a.feet,rarity:i.a.epic,itemCategory:s,iconImg:"".concat(u,"witchhunter_boots.png")},witchhunterBritches:{equipmentType:c.a.legs,rarity:i.a.epic,itemCategory:s,iconImg:"".concat(u,"witchhunter_britches.png")},witchhunterCape:{equipmentType:c.a.shoulders,rarity:i.a.epic,itemCategory:s,iconImg:"".concat(u,"witchhunter_cape.png")},witchhunterGambeson:{equipmentType:c.a.chest,rarity:i.a.epic,itemCategory:s,iconImg:"".concat(u,"witchhunter_gambeson.png")},witchhunterGrips:{equipmentType:c.a.hands,rarity:i.a.epic,itemCategory:s,iconImg:"".concat(u,"witchhunter_grips.png")},witchhunterHat:{equipmentType:c.a.head,rarity:i.a.epic,itemCategory:s,iconImg:"".concat(u,"witchhunter_hat.png")}},m=Object.entries(d).reduce((function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return e["".concat("apparel/").concat(a)]=c,e}),{});function b(e){return m[e]}t.a=m;var p=function(e){return!!m[e]}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.unavailable=0]="unavailable",e[e.available=1]="available",e[e.active=2]="active",e[e.completed=3]="completed"}(r||(r={}))},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(9),a=n(24),c=a.a.consumable,o="/img/items/consumables/",i={minorHealthPotion:{category:"health",effect:10,itemCategory:c,iconImg:"".concat(o,"minor-health-potion.png")},minorManaPotion:{category:"mana",itemCategory:c,iconImg:"".concat(o,"minor-mana-potion.png")},minorSoma:{category:"soma",itemCategory:c,iconImg:"".concat(o,"minor-soma.png"),effect:1.1},lesserHealthPotion:{category:"health",effect:25,itemCategory:c,iconImg:"".concat(o,"lesser-health-potion.png")},lesserManaPotion:{category:"mana",itemCategory:c,iconImg:"".concat(o,"lesser-mana-potion.png")},lesserSoma:{category:"soma",itemCategory:c,iconImg:"".concat(o,"lesser-soma.png"),effect:1.25},majorHealthPotion:{category:"health",effect:50,itemCategory:c,iconImg:"".concat(o,"major-health-potion.png")},majorManaPotion:{category:"mana",itemCategory:c,iconImg:"".concat(o,"major-mana-potion.png")},majorSoma:{category:"soma",itemCategory:c,iconImg:"".concat(o,"major-soma.png"),effect:1.5},greaterHealthPotion:{category:"health",effect:75,itemCategory:c,iconImg:"".concat(o,"greater-health-potion.png")},greaterManaPotion:{category:"mana",itemCategory:c,iconImg:"".concat(o,"greater-mana-potion.png")},greaterSoma:{category:"soma",itemCategory:c,iconImg:"".concat(o,"greater-soma.png"),effect:2}},s=Object.entries(i).reduce((function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return e["".concat("consumable/").concat(a)]=c,e}),{});function u(e){return s[e]}t.a=s;var l=function(e){return!!s[e]}},,function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return m}));var r,a,c=n(21),o=n(22),i=n(33),s=n(36),u=n(89),l=n.n(u),d="bubbleAdded";!function(e){e[e.combat=0]="combat",e[e.resource=1]="resource"}(r||(r={})),function(e){e[e.general=0]="general",e[e.scene=1]="scene"}(a||(a={}));var m=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,null,[{key:"addBubble",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.combat,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a.general;this.instance.emit(d,e,t,n,c)}},{key:"instance",get:function(){return this._instance}}]),n}(l.a);m._instance=new m},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(28),a=n(167),c={kill10Boars:{getQuestVars:function(e){return e.questVars},getInitialQuestVars:function(e){return a.a},nodes:[{x:0,y:1,type:r.a.encounter,startScene:"dungeon.canyon"},{x:0,y:2,log:"quest-kill10-boars-enter-dungeon",type:r.a.nothing},{x:0,y:3,type:r.a.nothing},{x:0,y:3,type:r.a.encounter,startScene:"dungeon.entrance"},{x:1,y:3,type:r.a.nothing,log:"quest-kill10-boars-leave-dungeon"},{x:1,y:3,type:r.a.nothing,log:"quest-kill10-boars-left-dungeon"},{x:2,y:3,type:r.a.nothing},{x:3,y:3,type:r.a.encounter,startScene:"dungeon.hallway"},{x:4,y:4,type:r.a.nothing,log:"The party spots a boss"},{x:5,y:4,type:r.a.nothing}]},retrieveMagicAmulet:{getQuestVars:function(e){return e.questVars},getInitialQuestVars:function(e){return{baz:!1,zux:13}},requiredItems:["questItem/torch","questItem/torch","questItem/torch","questItem/sandwich","questItem/sandwich"],nodes:[{x:0,y:1,type:r.a.nothing},{x:1,y:1,type:r.a.nothing},{x:2,y:1,type:r.a.nothing},{x:3,y:1,type:r.a.nothing},{x:4,y:1,type:r.a.nothing},{x:5,y:1,type:r.a.nothing},{x:7,y:1,type:r.a.nothing},{x:8,y:2,type:r.a.nothing},{x:8,y:3,type:r.a.nothing},{x:9,y:3,type:r.a.nothing},{x:10,y:1,type:r.a.nothing},{x:10,y:2,type:r.a.nothing},{x:10,y:3,type:r.a.nothing},{x:10,y:4,type:r.a.nothing},{x:11,y:5,type:r.a.nothing},{x:12,y:6,type:r.a.nothing},{x:12,y:7,type:r.a.nothing},{x:13,y:8,type:r.a.nothing},{x:12,y:8,type:r.a.nothing},{x:12,y:9,type:r.a.nothing},{x:11,y:8,type:r.a.nothing},{x:10,y:8,type:r.a.nothing},{x:9,y:8,type:r.a.nothing},{x:8,y:9,type:r.a.nothing},{x:7,y:8,type:r.a.encounter,startScene:"dungeon.hallway"},{x:8,y:1,type:r.a.nothing},{x:1,y:1,type:r.a.nothing},{x:1,y:1,type:r.a.nothing},{x:1,y:1,type:r.a.nothing},{x:1,y:1,type:r.a.nothing},{x:1,y:1,type:r.a.nothing},{x:1,y:1,type:r.a.nothing},{x:1,y:1,type:r.a.nothing},{x:1,y:1,type:r.a.nothing},{x:2,y:1,type:r.a.encounter,startScene:"dungeon.hallway"},{x:3,y:1,type:r.a.nothing}]}};function o(e){return c[e]}},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(61),a=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.a.common,a=arguments.length>3?arguments[3]:void 0,c={key:e,context:t};return{type:"addLogEntry",entry:c,channel:n,channelContext:a}},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.a.common,n=arguments.length>2?arguments[2]:void 0;return{type:"addLogEntry",entry:e,channel:t,channelContext:n}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d}));var r=n(70),a=n(49),c=n.n(a),o=n(15),i=n(150),s=function(e,t,n){return{x:Object(i.b)(e.x,t.x,n),y:Object(i.b)(e.y,t.y,n)}};function u(e){return l.apply(this,arguments)}function l(){return(l=Object(r.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.Loader.shared,e.abrupt("return",new Promise((function(e,r){n.resources[t]?e(n.resources[t]):n.add(t).load((function(n,r){e(r[t])}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var d=function(e,t){var n=o.Loader.shared;n.resources[e]?t(n.resources[e]):n.add(e).load((function(n,r){t(r[e])}))}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"e",(function(){return p}));var r,a=n(9),c=n(308),o=n.n(c),i=n(75),s=!1,u=function(e){s=!0,r=o()(e,{state:!0})};function l(){if(!r)throw new Error("Call init() before random()");return s=!0,r()}var d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return e=Math.ceil(e),t=Math.floor(t),Math.floor(l()*(t-e+1))+e},m=function(){return d(1,6)+d(1,6)+d(1,6)},b=function(e){var t=l(),n=0,r=Object(i.a)(e).find((function(e){var r=Object(a.a)(e,2),c=(r[0],r[1]);return t<(n+=c)}));return r?r[0]:Object(i.a)(e)[0][0]},p=function(){return s=!1,r.state()}},,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return l}));var r=n(9),a=n(11),c=n(24),o=c.a.ammunition,i="/img/items/ammunition/",s={armorPiercingArrows:{itemCategory:o,iconImg:"".concat(i,"armor-piercing-arrows.png"),weaponType:a.c.bow},basicArrows:{itemCategory:o,iconImg:"".concat(i,"basic-arrows.png"),weaponType:a.c.bow},crossbowBolts:{itemCategory:o,iconImg:"".concat(i,"crossbow-bolts.png"),weaponType:a.c.crossbow},elfenArrows:{itemCategory:o,iconImg:"".concat(i,"elfen-arrows.png"),weaponType:a.c.bow}},u=Object.entries(s).reduce((function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return e["".concat("ammunition/").concat(a)]=c,e}),{});t.a=u;var l=function(e){return!!u[e]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r,a=n(5),c=n(45),o=n(11),i=(r={},Object(a.a)(r,o.c.axe,{classification:o.b.oneHanded,abilities:[c.a.cut]}),Object(a.a)(r,o.c.bow,{classification:o.b.ranged,abilities:[c.a.shoot]}),Object(a.a)(r,o.c.club,{classification:o.b.oneHanded,abilities:[c.a.swing,c.a.parry]}),Object(a.a)(r,o.c.crossbow,{classification:o.b.ranged,abilities:[c.a.shoot]}),Object(a.a)(r,o.c.fist,{classification:o.b.oneHanded,abilities:[c.a.swing]}),Object(a.a)(r,o.c.flail,{classification:o.b.mainHand,abilities:[c.a.swing,c.a.parry]}),Object(a.a)(r,o.c.hammer,{classification:o.b.oneHanded,abilities:[c.a.swing,c.a.parry]}),Object(a.a)(r,o.c.knife,{classification:o.b.oneHanded,abilities:[c.a.cut,c.a.parry]}),Object(a.a)(r,o.c.staff,{classification:o.b.twoHanded,abilities:[c.a.swing,c.a.parry]}),Object(a.a)(r,o.c.sword,{classification:o.b.oneHanded,abilities:[c.a.swing,c.a.parry]}),Object(a.a)(r,o.c.poleArm,{classification:o.b.twoHanded,abilities:[c.a.swing,c.a.parry]}),Object(a.a)(r,o.c.shield,{classification:o.b.shield,abilities:[c.a.block]}),r),s=function(e){return i[e]}},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l}));var r=n(9),a=n(24),c=a.a.deed,o="/img/items/deeds/",i={alchemist:{structure:"alchemist",itemCategory:c,iconImg:"".concat(o,"deed.png")},armoursmith:{structure:"armoursmith",itemCategory:c,iconImg:"".concat(o,"deed.png")},lumbermill:{structure:"lumberMill",itemCategory:c,iconImg:"".concat(o,"deed.png")},tavern:{structure:"tavern",itemCategory:c,iconImg:"".concat(o,"deed.png")},weaponsmith:{structure:"weaponsmith",itemCategory:c,iconImg:"".concat(o,"deed.png")},workshop:{structure:"workshop",itemCategory:c,iconImg:"".concat(o,"deed.png")}},s=Object.entries(i).reduce((function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return e["".concat("deed/").concat(a)]=c,e}),{});function u(e){return s[e]}t.a=s;var l=function(e){return!!s[e]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return 20*e+t/4*20}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r,a,c=n(2),o=n(5),i=n(6),s=n(11),u="/img/avatars/monster/",l={"troll-developer":{attributes:{str:6,for:5,int:16,agi:8},skills:Object(o.a)({},s.c.sword,12),mainHand:{type:"weapon/steelSword"},armor:(r={},Object(o.a)(r,i.a.feet,1),Object(o.a)(r,i.a.hands,1),Object(o.a)(r,i.a.chest,1),Object(o.a)(r,i.a.legs,1),Object(o.a)(r,i.a.head,1),Object(o.a)(r,i.a.shoulders,1),r),spritesheet:"troll-sword.json",avatarImg:"".concat(u,"orc_01.png")},"troll-manager":{attributes:{str:8,for:7,int:12,agi:20},skills:Object(o.a)({},s.c.axe,12),mainHand:{type:"weapon/battleAxe"},armor:{},spritesheet:"troll-axe.json",avatarImg:"".concat(u,"orc_02.png")},"troll-accountant":{attributes:{str:8,for:7,int:12,agi:10},skills:Object(o.a)({},s.c.axe,12),mainHand:{type:"weapon/battleAxe"},armor:(a={},Object(o.a)(a,i.a.feet,2),Object(o.a)(a,i.a.hands,3),Object(o.a)(a,i.a.chest,3),Object(o.a)(a,i.a.legs,2),Object(o.a)(a,i.a.head,2),Object(o.a)(a,i.a.shoulders,2),a),spritesheet:"troll-axe.json",avatarImg:"".concat(u,"orc_03.png")}},d=Object(c.a)({},l);function m(e){return d[e]}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));var r=function(e){return{type:"addGold",amount:e}},a=function(e){return{type:"addGold",amount:-e}}},,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(9),a=n(24),c=a.a.questItem,o="/img/items/quest-items/",i={blueprints:{itemCategory:c,iconImg:"".concat(o,"blueprints.png")},crate:{itemCategory:c,iconImg:"".concat(o,"crate.png")},dynamite:{itemCategory:c,iconImg:"".concat(o,"dynamite.png")},dragonEye:{itemCategory:c,iconImg:"".concat(o,"dragon-eye.png")},eye:{itemCategory:c,iconImg:"".concat(o,"eye.png")},feather:{itemCategory:c,iconImg:"".concat(o,"feather.png")},food:{itemCategory:c,iconImg:"".concat(o,"food.png")},heart:{itemCategory:c,iconImg:"".concat(o,"heart.png")},horn:{itemCategory:c,iconImg:"".concat(o,"horn.png")},key:{itemCategory:c,iconImg:"".concat(o,"key.png")},letters:{itemCategory:c,iconImg:"".concat(o,"letters.png")},lockPicks:{itemCategory:c,iconImg:"".concat(o,"lock-picks.png")},oil:{itemCategory:c,iconImg:"".concat(o,"oil.png")},orcFinger:{itemCategory:c,iconImg:"".concat(o,"orc-finger.png")},plans:{itemCategory:c,iconImg:"".concat(o,"plans.png")},purpleGems:{itemCategory:c,iconImg:"".concat(o,"purple-gems.png")},runestone:{itemCategory:c,iconImg:"".concat(o,"runestone.png")},sandwich:{itemCategory:c,iconImg:"".concat(o,"sandwich.png")},teeth:{itemCategory:c,iconImg:"".concat(o,"teeth.png")},tooth:{itemCategory:c,iconImg:"".concat(o,"tooth.png")},torch:{itemCategory:c,iconImg:"".concat(o,"torch.png")},tusk:{itemCategory:c,iconImg:"".concat(o,"tusk.png")},vase:{itemCategory:c,iconImg:"".concat(o,"vase.png")},vial:{itemCategory:c,iconImg:"".concat(o,"vial.png")},weeds:{itemCategory:c,iconImg:"".concat(o,"weeds.png")}},s=Object.entries(i).reduce((function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return e["".concat("questItem/").concat(a)]=c,e}),{});t.a=s;var u=function(e){return!!s[e]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(21),a=n(22),c=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,null,[{key:"registerSceneController",value:function(e,t,n){this.controllerTypes["".concat(e,".").concat(t)]=n}},{key:"getSceneController",value:function(e,t,n){if(!this.store["".concat(e,".").concat(t)]){if(!this.controllerTypes["".concat(e,".").concat(t)])throw new Error("No controller registered for ".concat(e,".").concat(t));this.store["".concat(e,".").concat(t)]=new(this.controllerTypes["".concat(e,".").concat(t)])(n,e)}return this.store["".concat(e,".").concat(t)]}},{key:"destroySceneConroller",value:function(e,t){delete this.store["".concat(e,".").concat(t)]}}]),e}();c.store={},c.controllerTypes={},n(505)},,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),a=n(48),c=n(72),o=n(62),i=function(e){var t=e;switch(t.type){case o.a.brokenLegs:return[{type:a.b.healthDecreaseOnMove,damage:t.damage}];case o.a.burning:return[{type:a.b.healthDecreaseOverTime,interval:t.interval,damage:t.damage}];case o.a.soma:return c.b.map((function(e){return{type:a.b.attributeIncrease,attribute:e,factor:t.factor}}));default:return[]}},s=function(e){return Object(r.a)(Object(r.a)({},e),{},{effects:i(e)})}},,,,,,,function(e,t,n){"use strict";var r=n(9),a=n(24),c=a.a.herb,o="/img/items/herbs/",i={angelicasSorrow:{itemCategory:c,iconImg:"".concat(o,"angelicas-sorrow.png")},bansheeReeds:{itemCategory:c,iconImg:"".concat(o,"banshee-reeds.png")},blissflower:{itemCategory:c,iconImg:"".concat(o,"blissflower.png")},bloodLotus:{itemCategory:c,iconImg:"".concat(o,"blood-lotus.png")},bogroot:{itemCategory:c,iconImg:"".concat(o,"bogroot.png")},ceviorise:{itemCategory:c,iconImg:"".concat(o,"ceviorise.png")},chicory:{itemCategory:c,iconImg:"".concat(o,"chicory.png")},dragonroot:{itemCategory:c,iconImg:"".concat(o,"dragonroot.png")},heartsVine:{itemCategory:c,iconImg:"".concat(o,"hearts-vine.png")},hyacinthus:{itemCategory:c,iconImg:"".concat(o,"hyacinthus.png")},jaboticaba:{itemCategory:c,iconImg:"".concat(o,"jaboticaba.png")},kingsrose:{itemCategory:c,iconImg:"".concat(o,"kingsrose.png")},lastSupper:{itemCategory:c,iconImg:"".concat(o,"last-supper.png")},mistagold:{itemCategory:c,iconImg:"".concat(o,"mistagold.png")},monksweed:{itemCategory:c,iconImg:"".concat(o,"monksweed.png")},moonFlower:{itemCategory:c,iconImg:"".concat(o,"moon-flower.png")},mountainGrass:{itemCategory:c,iconImg:"".concat(o,"mountain-grass.png")},oakLeaf:{itemCategory:c,iconImg:"".concat(o,"oak-leaf.png")},patricksroot:{itemCategory:c,iconImg:"".concat(o,"patricksroot.png")},sunleaf:{itemCategory:c,iconImg:"".concat(o,"sunleaf.png")},trollsFeast:{itemCategory:c,iconImg:"".concat(o,"trolls-feast.png")},uwolic:{itemCategory:c,iconImg:"".concat(o,"uwolic.png")},wyrmvine:{itemCategory:c,iconImg:"".concat(o,"wyrmvine.png")},winterWeed:{itemCategory:c,iconImg:"".concat(o,"winter-weed.png")},wizardsBane:{itemCategory:c,iconImg:"".concat(o,"wizards-bane.png")}},s=Object.entries(i).reduce((function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return e["".concat("herb/").concat(a)]=c,e}),{});t.a=s},function(e,t,n){"use strict";var r=n(9),a=n(24),c=a.a.material,o="/img/items/materials/",i={arrowheads:{itemCategory:c,iconImg:"".concat(o,"arrowheads.png")},beam:{itemCategory:c,iconImg:"".concat(o,"beam.png")},bolts:{itemCategory:c,iconImg:"".concat(o,"bolts.png")},buckle:{itemCategory:c,iconImg:"".concat(o,"buckle.png")},chain:{itemCategory:c,iconImg:"".concat(o,"chain.png")},cogs:{itemCategory:c,iconImg:"".concat(o,"cogs.png")},gunpowder:{itemCategory:c,iconImg:"".concat(o,"gunpowder.png")},ingot:{itemCategory:c,iconImg:"".concat(o,"ingot.png")},nails:{itemCategory:c,iconImg:"".concat(o,"nails.png")},pile:{itemCategory:c,iconImg:"".concat(o,"pile.png")},planks:{itemCategory:c,iconImg:"".concat(o,"planks.png")},poisonVial:{itemCategory:c,iconImg:"".concat(o,"poison-vial.png")},pulley:{itemCategory:c,iconImg:"".concat(o,"pulley.png")},ribbon:{itemCategory:c,iconImg:"".concat(o,"ribbon.png")},rope:{itemCategory:c,iconImg:"".concat(o,"rope.png")},runeCarvedPlank:{itemCategory:c,iconImg:"".concat(o,"rune-carved-plank.png")},scales:{itemCategory:c,iconImg:"".concat(o,"scales.png")},spring:{itemCategory:c,iconImg:"".concat(o,"spring.png")},stake:{itemCategory:c,iconImg:"".concat(o,"stake.png")},stick:{itemCategory:c,iconImg:"".concat(o,"stick.png")},thread:{itemCategory:c,iconImg:"".concat(o,"thread.png")},woodenMask:{itemCategory:c,iconImg:"".concat(o,"wooden-mask.png")}},s=Object.entries(i).reduce((function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return e["".concat("material/").concat(a)]=c,e}),{});t.a=s},function(e,t,n){"use strict";var r=n(9),a=n(24),c=a.a.mineral,o="/img/items/minerals/",i={amethyst:{itemCategory:c,iconImg:"".concat(o,"amethyst.png")},aquamarine:{itemCategory:c,iconImg:"".concat(o,"aquamarine.png")},arminsHeart:{itemCategory:c,iconImg:"".concat(o,"armins-heart.png")},dragonsTooth:{itemCategory:c,iconImg:"".concat(o,"dragons-tooth.png")},greenOpal:{itemCategory:c,iconImg:"".concat(o,"green-opal.png")},jasper:{itemCategory:c,iconImg:"".concat(o,"jasper.png")},malachite:{itemCategory:c,iconImg:"".concat(o,"malachite.png")},moonstone:{itemCategory:c,iconImg:"".concat(o,"moonstone.png")},obsidian:{itemCategory:c,iconImg:"".concat(o,"obsidian.png")},roseQuartz:{itemCategory:c,iconImg:"".concat(o,"rose-quartz.png")},sapphire:{itemCategory:c,iconImg:"".concat(o,"sapphire.png")},spellstone:{itemCategory:c,iconImg:"".concat(o,"spellstone.png")},tigersEye:{itemCategory:c,iconImg:"".concat(o,"tigers-eye.png")},topaz:{itemCategory:c,iconImg:"".concat(o,"topaz.png")},wyrdstone:{itemCategory:c,iconImg:"".concat(o,"wyrdstone.png")}},s=Object.entries(i).reduce((function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return e["".concat("mineral/").concat(a)]=c,e}),{});t.a=s},function(e,t,n){"use strict";var r=n(9),a=n(24),c=a.a.trinket,o="/img/items/trinkets/",i={magicAmulet:{itemCategory:c,iconImg:"".concat(o,"magic_amulet.png")},ring:{itemCategory:c,iconImg:"".concat(o,"ring.png")}},s=Object.entries(i).reduce((function(e,t){var n=Object(r.a)(t,2),a=n[0],c=n[1];return e["".concat("trinket/").concat(a)]=c,e}),{});t.a=s},function(e,t,n){"use strict";n.d(t,"a",(function(){return I})),n.d(t,"c",(function(){return S})),n.d(t,"b",(function(){return T}));var r,a,c,o,i,s,u,l,d,m,b=n(18),p=n(5),j=n(2),h=n(6),f=n(72),v=n(59),g=n(50),O=n(80),y=n(105),x=n(62),w=n(138),k=n(11),A=function(){return{str:Math.floor(3*Math.random())+9,for:Math.floor(3*Math.random())+9,int:Math.floor(3*Math.random())+9,agi:Math.floor(3*Math.random())+9}},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=A(),n=Object(g.b)(e)+Math.random()*Object(g.b)(e+1),r=20+Math.random()*(Object(y.a)(e,t.for)-20);return{basicAttributes:t,xp:n,health:r}},C="/img/avatars/",I="adv_",S=[Object(j.a)(Object(j.a)({id:"".concat(I,"c4a5d270"),equipment:(r={},Object(p.a)(r,h.a.head,{type:"apparel/cowl",durability:.25}),Object(p.a)(r,h.a.chest,{type:"apparel/chest",durability:.5}),Object(p.a)(r,h.a.hands,{type:"apparel/clothGloves"}),Object(p.a)(r,h.a.shoulders,{type:"apparel/shoulders2"}),Object(p.a)(r,h.a.legs,{type:"apparel/pants2"}),Object(p.a)(r,h.a.feet,{type:"apparel/boots3"}),Object(p.a)(r,h.a.mainHand,{type:"weapon/longbow"}),Object(p.a)(r,h.a.offHand,{type:"ammunition/basicArrows",quantity:200}),r)},N()),{},{room:0,name:"Sasha Falcon",flavor:!0,traits:[v.a.houseMaddox,v.a.gloomy],avatarImg:"".concat(C,"female/f_14.png"),spritesheetPath:"elf-bow.json",color:f.a.purple,skills:(a={},Object(p.a)(a,k.c.crossbow,10),Object(p.a)(a,k.c.bow,10),a),tempEffects:[],inventory:[{type:"deed/lumbermill"},null,{type:"weapon/simpleCrossbow"},{type:"weapon/dagger"},{type:"weapon/khopesh"},null,{type:"weapon/steelSword"},null,{type:"consumable/lesserSoma"},{type:"consumable/minorSoma"},{type:"consumable/greaterManaPotion"},{type:"consumable/majorHealthPotion"},null,{type:"weapon/steelShield"},null,null,null,null]}),Object(j.a)(Object(j.a)({id:"".concat(I,"2e655832"),equipment:(c={},Object(p.a)(c,h.a.feet,{type:"apparel/boots2"}),Object(p.a)(c,h.a.mainHand,{type:"weapon/simpleCrossbow"}),Object(p.a)(c,h.a.offHand,{type:"ammunition/crossbowBolts",quantity:150}),c)},N()),{},{name:"Addison Chilson",flavor:!0,room:1,avatarImg:"".concat(C,"female/f_16.png"),spritesheetPath:"elf-bow.json",color:f.a.teal,traits:[v.a.houseHouston],skills:(o={},Object(p.a)(o,k.c.crossbow,12),Object(p.a)(o,k.c.staff,13),o),tempEffects:[],inventory:[{type:"weapon/simpleCrossbow"},null,{type:"consumable/greaterSoma"},null,null,null,{type:"apparel/boots1"},{type:"apparel/chainmailHood"},{type:"apparel/nomadHelmet"},{type:"apparel/plateChest4"},null,{type:"weapon/buckler"},null,null,null,null,null,null,null,null,null,null,null,{type:"apparel/plateHelmet"},{type:"apparel/cowl"}]}),Object(j.a)(Object(j.a)({id:"".concat(I,"ec6f1050"),equipment:(i={},Object(p.a)(i,h.a.feet,{type:"apparel/boots3"}),Object(p.a)(i,h.a.mainHand,{type:"weapon/greatswordOfGwai"}),i)},N()),{},{name:"Zackary 'bone bag' Morris",flavor:!0,room:2,traits:[v.a.gloomy],skills:(s={},Object(p.a)(s,k.c.sword,12),Object(p.a)(s,k.c.hammer,6),s),avatarImg:"".concat(C,"male/m_36.png"),spritesheetPath:"skeleton.json",color:f.a.black,tempEffects:[Object(w.a)({type:x.a.brokenLegs,damage:10,charges:10}),Object(w.a)({type:x.a.burning,damage:10,interval:500})],inventory:[{type:"weapon/greatswordOfGwai"},{type:"consumable/greaterSoma"},{type:"consumable/greaterSoma"},null,null,null,{type:"weapon/berserkerShield"},{type:"weapon/warhammer"}]}),Object(j.a)(Object(j.a)({id:"".concat(I,"d299f98a")},N()),{},{equipment:Object(p.a)({},h.a.mainHand,{type:"weapon/steelSword"}),name:"Mike Keith",flavor:!0,room:4,avatarImg:"".concat(C,"male/m_19.png"),spritesheetPath:"knight-sword.json",traits:[v.a.arrowFinder],skills:Object(p.a)({},k.c.sword,13),tempEffects:[],inventory:[null,null,null,null,{type:"weapon/khopesh"},{type:"apparel/hornedHelmet"},{type:"weapon/woodenBulwark"}]}),Object(j.a)(Object(j.a)({id:"96c686c3",equipment:{}},N()),{},{name:"Wayne Monroe",flavor:!0,room:5,avatarImg:"".concat(C,"male/m_08.png"),spritesheetPath:"orc-axe.json",traits:[v.a.houseMonroe,v.a.arrowFinder],skills:Object(p.a)({},k.c.axe,12),tempEffects:[],inventory:[null,null,null,{type:"weapon/goldenShield"}]}),Object(j.a)(Object(j.a)({id:"".concat(I,"250d1a9d")},N()),{},{name:"Alexis Ortiz ",flavor:!0,room:9,avatarImg:"".concat(C,"female/f_10.png"),spritesheetPath:"knight-sword.json",inventory:[null,null,null,null,null],skills:Object(p.a)({},k.c.axe,10),equipment:(u={},Object(p.a)(u,h.a.mainHand,{type:"weapon/longbow"}),Object(p.a)(u,h.a.offHand,{type:"ammunition/basicArrows",quantity:50}),u),tempEffects:[]}),Object(j.a)(Object(j.a)({id:"".concat(I,"169384ef")},N()),{},{name:"Karlee Nolan",flavor:!0,room:3,avatarImg:"".concat(C,"female/f_16.png"),spritesheetPath:"troll-sword.json",inventory:[{type:"weapon/greatswordOfGwai"},null,null,null],skills:Object(p.a)({},k.c.axe,10),equipment:(l={},Object(p.a)(l,h.a.mainHand,{type:"weapon/simpleCrossbow"}),Object(p.a)(l,h.a.offHand,{type:"ammunition/crossbowBolts",quantity:40}),l),tempEffects:[]}),Object(j.a)(Object(j.a)({id:"".concat(I,"f22d66cb")},N()),{},{equipment:{},name:"Gylbarde the Earnest",room:8,avatarImg:"".concat(C,"male/m_09.png"),spritesheetPath:"knight-sword.json",inventory:[null,null,null,null,null],skills:Object(p.a)({},k.c.axe,13),tempEffects:[]}),Object(j.a)(Object(j.a)({id:"".concat(I,"36c686c1"),equipment:{}},N()),{},{name:"Lanslet of the Water",room:6,avatarImg:"".concat(C,"male/m_26.png"),spritesheetPath:"knight-sword.json",inventory:[{type:"weapon/greatswordOfGwai"},null,null,null,{type:"apparel/shoulders1"},{type:"apparel/fedora"},{type:"apparel/greaves2"}],skills:Object(p.a)({},k.c.axe,3),tempEffects:[]}),Object(j.a)(Object(j.a)({id:"".concat(I,"12c613d4"),equipment:{}},N()),{},{name:"Tedric the Bold",room:7,avatarImg:"".concat(C,"male/m_33.png"),spritesheetPath:"knight-sword.json",inventory:[{type:"weapon/greatswordOfGwai"},null,null,null],skills:Object(p.a)({},k.c.axe,10),tempEffects:[Object(w.a)({type:x.a.brokenLegs,damage:8,charges:10})]}),Object(j.a)(Object(j.a)({id:"".concat(I,"5a402ef1"),equipment:(d={},Object(p.a)(d,h.a.head,{type:"apparel/crimsonRogueCoif",durability:.25}),Object(p.a)(d,h.a.chest,{type:"apparel/crimsonRogueTunic",durability:.5}),Object(p.a)(d,h.a.hands,{type:"apparel/crimsonRogueGrips"}),Object(p.a)(d,h.a.shoulders,{type:"apparel/crimsonRogueSpaulders"}),Object(p.a)(d,h.a.legs,{type:"apparel/crimsonRogueBritches"}),Object(p.a)(d,h.a.feet,{type:"apparel/crimsonRogueBoots"}),Object(p.a)(d,h.a.mainHand,{type:"weapon/dagger"}),Object(p.a)(d,h.a.offHand,{type:"weapon/dagger"}),d)},N()),{},{room:11,name:"Allynna Nerilar",flavor:!0,traits:[v.a.houseMaddox,v.a.gloomy],avatarImg:"".concat(C,"female/f_21.png"),spritesheetPath:"elf-bow.json",color:f.a.purple,skills:(m={},Object(p.a)(m,k.c.knife,15),Object(p.a)(m,k.c.bow,11),m),tempEffects:[],inventory:[{type:"deed/lumbermill"},null,{type:"weapon/simpleCrossbow"},{type:"weapon/dagger"},{type:"weapon/khopesh"},null,{type:"weapon/steelSword"},null,{type:"consumable/lesserSoma"},{type:"consumable/minorSoma"},{type:"consumable/greaterManaPotion"},{type:"consumable/majorHealthPotion"},null,{type:"weapon/steelShield"},null,null,null,null]})],T=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"modifyHealth":return t.map((function(e){if(e.id===n.adventurerId){var t=e.health+=n.amount;return Object(j.a)(Object(j.a)({},e),{},{health:t})}return e}));case"consumeItem":var r=n.adventurerId,a=n.fromSlot,c=t.find((function(e){return e.id===r}));if(!c)throw new Error("No adventurer ".concat(r," found"));var o=c.health,i=c.inventory[a];if(!i||!Object(O.c)(i.type))throw new Error("No potion found at index ".concat(a," "));var s=Object(O.b)(i.type);switch(s.category){case"health":o=Math.min((null!==(e=s.effect)&&void 0!==e?e:0)+o,100);break;case"soma":console.log("".concat(c.name," drinks a soma potion"));break;case"mana":console.log("".concat(c.name," drinks a mana potion"))}var u=c.inventory.map((function(e,t){return t!==a?e:null}));return t.map((function(e){return e===c?Object(j.a)(Object(j.a)({},e),{},{health:o,inventory:u}):e}));case"moveItemInInventory":var l=n.adventurerId,d=n.fromSlot,m=n.toSlot,h=t.find((function(e){return e.id===l}));if(!h)throw new Error("No adventurer ".concat(l," found"));var f=h.inventory.map((function(e,t){return t===d?h.inventory[m]:t===m?h.inventory[d]:e}));return t.map((function(e){return e===h?Object(j.a)(Object(j.a)({},e),{},{inventory:f}):e}));case"moveItemToOtherAdventurer":var v=n.adventurerId,x=n.fromSlot,w=n.toAdventurerId,k=t.find((function(e){return e.id===v}));if(!k)return t;var A=k.inventory[x];return t.map((function(e){if(e.id===v){var t=e.inventory.concat();return t[x]=null,Object(j.a)(Object(j.a)({},e),{},{inventory:t})}if(e.id===w){var n=e.inventory.concat(),r=n.findIndex((function(e){return null===e}));return n[r]=A,Object(j.a)(Object(j.a)({},e),{},{inventory:n})}return e}));case"addItemToInventory":var N=n.item,C=n.toSlot;return t.map((function(e){if(e.id===n.adventurerId){var t=e.inventory.concat();return null!==C&&void 0!==C||(C=t.findIndex((function(e){return null===e||void 0===e}))),t[C]=N,Object(j.a)(Object(j.a)({},e),{},{inventory:t})}return e}));case"removeItemFromInventory":var I=n.fromSlot;return t.map((function(e){if(e.id===n.adventurerId){var t=e.inventory.map((function(e,t){return t!==I?e:null}));return Object(j.a)(Object(j.a)({},e),{},{inventory:t})}return e}));case"changeItemQuantity":var T=n.slot,E=n.quantity;return t.map((function(e){if(e.id===n.adventurerId){var t=e.inventory.map((function(e,t){return t!==T?e:Object(j.a)(Object(j.a)({},e),{},{quantity:E})}));return Object(j.a)(Object(j.a)({},e),{},{inventory:t})}return e}));case"assignEquipment":var q=n.equipmentSlot,R=n.item;return t.map((function(e){return e.id===n.adventurerId?Object(j.a)(Object(j.a)({},e),{},{equipment:Object(j.a)(Object(j.a)({},e.equipment),{},Object(p.a)({},q,R))}):e}));case"removeEquipment":var D=n.equipmentSlot;return t.map((function(e){return e.id===n.adventurerId?Object(j.a)(Object(j.a)({},e),{},{equipment:Object(j.a)(Object(j.a)({},e.equipment),{},Object(p.a)({},D,null))}):e}));case"changeEquipmentQuantity":var M=n.equipmentSlot,L=n.quantity;return t.map((function(e){return e.id===n.adventurerId?Object(j.a)(Object(j.a)({},e),{},{equipment:Object(j.a)(Object(j.a)({},e.equipment),{},Object(p.a)({},M,Object(j.a)(Object(j.a)({},e.equipment[M]),{},{quantity:L})))}):e}));case"addTempEffect":return t.map((function(e){return e.id===n.adventurerId?Object(j.a)(Object(j.a)({},e),{},{tempEffects:[n.tempEffect].concat(Object(b.a)(e.tempEffects))}):e}));case"decreaseEffectCharge":return t.map((function(e){return e.id===n.adventurerId?Object(j.a)(Object(j.a)({},e),{},{tempEffects:e.tempEffects.map((function(e){return Object(j.a)(Object(j.a)({},e),{},{effects:e.effects.reduce((function(e,t){if(t===n.effect){if(t.charges&&t.charges>1){var r=t.charges-1;e.push(Object(j.a)(Object(j.a)({},t),{},{charges:r}))}}else e.push(t);return e}),[])})}))}):e}));case"renameAdventurer":var z=n.name;return t.map((function(e){return e.id===n.adventurerId?Object(j.a)(Object(j.a)({},e),{},{name:z}):e}));case"setBasicAttributes":var P=n.basicAttributes;return t.map((function(e){return e.id===n.adventurerId?Object(j.a)(Object(j.a)({},e),{},{basicAttributes:P}):e}));case"addXp":return t.map((function(e){if(e.id===n.adventurerId){var t=Object(g.c)(e.xp),r=Math.min(e.xp+n.xp,g.a),a=Object(g.c)(r),c=e.health;return a>t&&(c=Object(y.a)(a,e.basicAttributes.for)),Object(j.a)(Object(j.a)({},e),{},{xp:r,health:c})}return e}))}return t}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var r=function(e,t,n){return e+n*(t-e)},a=function(e,t,n){return e>n?n:e<t?t:e}},function(e,t,n){"use strict";var r,a,c;n.d(t,"a",(function(){return r})),function(e){e.tilelayer="tilelayer",e.objectgroup="objectgroup"}(r||(r={})),function(e){e.orthagonal="orthagonal",e.isometric="isometric",e.staggered="staggered",e.hexagonal="hexagonal"}(a||(a={})),function(e){e.rightUp="right-up",e.rightDown="right-down",e.leftUp="left-up",e.leftDown="left-down"}(c||(c={}))},,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={dungeon:{entered:!1,entrance:{chestOpen:!1,chest:{title:"encounter-dungeon-caches-chest",items:[{type:"apparel/nomadHelmet"},{type:"questItem/teeth"},{type:"material/poisonVial"},{type:"apparel/fedora"}],gold:100}},hallway:{chest:{title:"encounter-dungeon-caches-chest",items:[{type:"questItem/key"}]},chestOpen:!1,doorOpen:!1}}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r,a=n(9),c=n(2),o=n(5),i=n(40),s=n(102),u=n(75),l=n(48),d=(r={},Object(o.a)(r,l.b.attributeIncrease,{harmful:!1}),Object(o.a)(r,l.b.healthDecreaseOnMove,{harmful:!0}),Object(o.a)(r,l.b.healthDecreaseOverTime,{harmful:!0}),function(e,t){var n=[];return e.tempEffects.forEach((function(e){e.effects.forEach((function(r){if(void 0===t||t===r.type){var a={type:l.a.tempEffect,tempEffectType:e.type};n.push(Object(c.a)(Object(c.a)({},r),{},{source:a}))}}))})),Object(u.a)(e.equipment).forEach((function(e){var r;if(e){var o=Object(a.a)(e,2)[1];if(o&&!Object(s.b)(o.type))null===(r=Object(i.e)(o.type).effects)||void 0===r||r.forEach((function(e){if(void 0===t||t===e.type){var r={type:l.a.item,itemType:o.type};n.push(Object(c.a)(Object(c.a)({},e),{},{source:r}))}}))}})),n})},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return z})),n.d(t,"a",(function(){return P}));var r=n(18),a=n(2),c=n(64),o=n(70),i=n(21),s=n(22),u=n(49),l=n.n(u),d=n(53),m=n(90),b=n(151),p=n(207),j=n(34),h=n(14),f=n(56),v=n(57),g=n(41);function O(e){return"string"!==typeof e}var y=n(3),x=n(88),w=n(85),k=n(106),A=n(61),N=n(113),C=n(42),I=n(60),S=n(17),T=n(15),E=n(58),q=n(50),R=n(82),D=function(e){return{x:e[0],y:e[1]}},M=function(e){return[e[0],e[1]]},L=n(47),z=500,P=function(){function e(t,n){Object(i.a)(this,e),this.questName=void 0,this.mapData=void 0,this.aStar=void 0,this.dataLoading=!1,this.dataLoadComplete=!1,this.store=void 0,this.jsonPath=void 0,this.blockedTiles=[],this.tileTypes={},this.store=t,this.questName=n}return Object(s.a)(e,[{key:"basePath",get:function(){return"".concat(".","/scenes")}},{key:"loadData",value:function(){var e=Object(o.a)(l.a.mark((function e(t){var n,r,a,o,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.dataLoadComplete){e.next=2;break}return e.abrupt("return",t());case 2:if(this.jsonPath){e.next=4;break}throw new Error("No jsonPath defined!");case 4:return this.dataLoading=!0,e.next=7,Object(m.c)("".concat(".","/").concat(this.jsonPath));case 7:return n=[S.c.addSound("scene/bow",["sound/scene/bow-01.mp3","sound/scene/bow-02.mp3"]),S.c.addSound("scene/crossbow",["sound/scene/crossbow-01.mp3","sound/scene/crossbow-02.mp3","sound/scene/crossbow-03.mp3","sound/scene/crossbow-04.mp3"]),S.c.addSound("scene/daggerSwish",["sound/scene/dagger-swish.ogg"]),S.c.addSound("scene/meleeHit",["sound/scene/melee-hit-01.mp3","sound/scene/melee-hit-02.mp3","sound/scene/melee-hit-03.mp3"]),S.c.addSound("scene/metalBash",["sound/scene/metal-bash-01.mp3","sound/scene/metal-bash-02.mp3","sound/scene/metal-bash-03.mp3"]),S.c.addSound("scene/parry",["sound/scene/parry-01.ogg","sound/scene/parry-02.ogg"]),S.c.addSound("scene/shieldBash",["sound/scene/shield-bash-impact.mp3"]),S.c.addSound("scene/swish",["sound/scene/swish-01.mp3","sound/scene/swish-02.mp3","sound/scene/swish-03.mp3","sound/scene/swish-04.mp3"]),S.c.addSound("scene/doorOpen",["sound/scene/door.ogg"])],e.next=10,Promise.all(n);case 10:if((r=T.Loader.shared.resources["".concat(".","/").concat(this.jsonPath)]).data){e.next=13;break}throw new Error("No map data found at ".concat(".","/").concat(this.jsonPath));case 13:this.mapData=r.data,this.createBlockedTiles(),this.createTileTypes(),this.aStar=this.createAStar(),a=this.spritesheetPaths,o=Object(c.a)(a),e.prev=19,o.s();case 21:if((i=o.n()).done){e.next=27;break}return s=i.value,e.next=25,Object(m.c)("".concat("/img/scene/actors/").concat(s));case 25:e.next=21;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(19),o.e(e.t0);case 32:return e.prev=32,o.f(),e.finish(32);case 35:T.utils.clearTextureCache(),this.dataLoadComplete=!0,this.dataLoading=!1,t();case 39:case"end":return e.stop()}}),e,this,[[19,29,32,35]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createBlockedTiles",value:function(e){var t,n=this;this.blockedTiles=[],null===(t=this.mapData)||void 0===t||t.layers.filter((function(e){return e.visible})).forEach((function(e){e.properties&&e.properties.some((function(e){return"blocksMovement"===e.name&&!0===e.value}))&&Object(d.b)(n.blockedTiles,e,e.width)})),null===e||void 0===e||e.forEach((function(e){!0===e.properties.blocksMovement&&e.location&&n.blockedTiles.push(e.location)}))}},{key:"createTileTypes",value:function(){var e,t=this;null===(e=this.mapData)||void 0===e||e.tilesets.forEach((function(e){var n;null===(n=e.tiles)||void 0===n||n.forEach((function(n){t.tileTypes[n.type]=n.id+e.firstgid}))}))}},{key:"createScene",value:function(){var e=this.createObjects();this.updateScene(e,!1)}},{key:"updateScene",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sceneObjects,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.combat,n=Object(a.a)(Object(a.a)({},this.quest.scene),{},{objects:e,combat:t});this.dispatch(Object(j.j)(this.questName,n)),this.createBlockedTiles(e),this.mapData&&(this.aStar=this.createAStar())}},{key:"sceneEntered",value:function(){T.utils.clearTextureCache()}},{key:"sceneExited",value:function(){}},{key:"getTileDimensions",value:function(){var e,t;return{tileWidth:(null===(e=this.mapData)||void 0===e?void 0:e.tilewidth)||0,tileHeight:(null===(t=this.mapData)||void 0===t?void 0:t.tileheight)||0}}},{key:"actorMoved",value:function(e,t){this.combat&&this.dispatch(Object(j.b)(this.questName,e,E.c));var n=this.getObjectAtLocation(t,(function(e){return!Object(h.e)(e)}));if(n&&n.type===d.a.portal)if(n.properties.exit){var r=Math.floor(this.quest.progress)+1,a=Object(w.a)(this.questName).nodes[r];a.log&&this.log(a.log),this.dispatch(Object(j.e)(this.questName))}else n.properties.to&&this.dispatch(Object(j.k)(this.questName,n.properties.to))}},{key:"actorInteract",value:function(e,t){var n=this.getSceneAdventurer(e),r=this.getObjectAtLocation(t);r?n&&this.interactWithObject(n,r):console.warn("No object found")}},{key:"actorAttemptAction",value:function(e){var t=this,n=e.actor,r=e.action,c=e.to;if(n){var o=n.location;if(!o)throw new Error("No location found!");switch(r){case h.b.move:var i,s;if(this.dispatch(Object(j.d)(this.questName,{endsAt:performance.now()+(null!==(i=null===(s=e.path)||void 0===s?void 0:s.length)&&void 0!==i?i:1)*z,intent:e})),!this.combat){var u=this.sceneAdventurers.filter((function(e){return e!==n})),l=this.findEmptyLocationsAround(c,6);u.forEach((function(n,r){var c,o,i=null!==(c=null===(o=t.getAdventurerByActor(n))||void 0===o?void 0:o.health)&&void 0!==c?c:0;if(n.location&&!(i<=0)){var s=t.findClosestPath(n.location,l);if(s&&s.length>0){var u,m;l=l.filter((function(e){return!Object(d.d)(e,s[(null===s||void 0===s?void 0:s.length)-1])}));var b=Object(a.a)(Object(a.a)({},e),{},{from:n.location,to:s[(null===s||void 0===s?void 0:s.length)-1],actor:n,path:s});t.dispatch(Object(j.d)(t.questName,{endsAt:performance.now()+(null!==(u=null===(m=b.path)||void 0===m?void 0:m.length)&&void 0!==u?u:1)*z,intent:b,delay:(r+1)/2}))}}}))}break;case h.b.interact:var m=this.findPathNearest(o,c);null===m||void 0===m||m.forEach((function(n,r){var c={endsAt:z*(r+1)+performance.now(),intent:Object(a.a)(Object(a.a)({},e),{},{to:n})};t.dispatch(Object(j.d)(t.questName,c))}));var b={endsAt:z*m.length+performance.now(),intent:e};this.dispatch(Object(j.d)(this.questName,b));break;case h.b.melee:var p=this.findPath(o,c),f=null===p||void 0===p?void 0:p.pop();if(!p||!f)return;null===p||void 0===p||p.forEach((function(n,r){var a={endsAt:z*(r+1)+performance.now(),intent:e};t.dispatch(Object(j.d)(t.questName,a))}));var v={endsAt:z*(p.length+1)+performance.now(),intent:e};this.dispatch(Object(j.d)(this.questName,v));break;case h.b.shoot:var g={endsAt:500+performance.now(),intent:e};this.dispatch(Object(j.d)(this.questName,g))}}}},{key:"findClosestPath",value:function(e,t){var n=this;return t.reduce((function(t,r){var a=n.findPath(e,r);return(void 0===t||a&&(null===a||void 0===a?void 0:a.length)<t.length)&&(t=a),t}),void 0)}},{key:"interactWithObject",value:function(e,t){}},{key:"pointToSceneLocation",value:function(e){var t,n;return null!==(t=this.mapData)&&void 0!==t&&t.tilewidth&&null!==(n=this.mapData)&&void 0!==n&&n.tileheight?[Math.floor(e.x/this.mapData.tilewidth),Math.floor(e.y/this.mapData.tilewidth)]:[0,0]}},{key:"sceneLocationToPoint",value:function(e){var t,n;return null!==(t=this.mapData)&&void 0!==t&&t.tilewidth&&null!==(n=this.mapData)&&void 0!==n&&n.tileheight?new T.Point(e[0]*this.mapData.tilewidth,e[1]*this.mapData.tileheight):new T.Point}},{key:"locationIsBlocked",value:function(e){return this.blockedTiles.some((function(t){return Object(d.d)(t,e)}))}},{key:"locationIsOutOfBounds",value:function(e){return!this.mapData||(e[0]<0||e[1]<0||e[0]>=this.mapData.width||e[1]>=this.mapData.height)}},{key:"getLootCache",value:function(e){}},{key:"takeGoldFromCache",value:function(e){var t=this.getLootCache(e);t&&this.dispatch(Object(N.a)(t.gold||0))}},{key:"takeItemFromCache",value:function(e,t,n,r){var a=this.getLootCache(t);if(a){var c=a.items[e];this.dispatch(Object(C.a)(n,c,r))}}},{key:"discardItem",value:function(e,t){var n=this.getAdventurerById(t),r=null===n||void 0===n?void 0:n.inventory.indexOf(e);void 0!==r&&this.dispatch(Object(C.k)(t,r))}},{key:"discardItemType",value:function(e,t){var n=this.getAdventurerById(t),r=null===n||void 0===n?void 0:n.inventory.find((function(t){return(null===t||void 0===t?void 0:t.type)===e}));r&&this.discardItem(r,t)}},{key:"getSituation",value:function(e,t){}},{key:"handleSituationOptionClick",value:function(e,t,n){}},{key:"findPath",value:function(e,t){var n;return null===(n=this.aStar)||void 0===n?void 0:n.findPath(D(e),D(t)).map(M)}},{key:"findPathNearest",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=null===(n=this.aStar)||void 0===n?void 0:n.getGrid().getGridNodes();if(!a)return[];var c=a.map((function(e){return e.map((function(e){return e.getIsWalkable()?0:1}))}));c[t[1]][t[0]]=0;var o=new p.AStarFinder({grid:{matrix:c},includeStartNode:!1,heuristic:"Manhattan",weight:.2});return o.findPath(D(e),D(t)).map(M).slice(0,r?void 0:-1)}},{key:"findEmptyLocationsAround",value:function(e,t){for(var n=this,a=[],c=1,o=function(){for(var t=-c+e[1],n=[],r=-c+e[0];r<=c+e[0];r++)n.push([r,t]);return n},i=function(){for(var t=c+e[0],n=[],r=1-c+e[1];r<=c-1+e[1];r++)n.push([t,r]);return n},s=function(){for(var t=c+e[1],n=[],r=-c+e[0];r<=c+e[0];r++)n.push([r,t]);return n},u=function(){for(var t=-c+e[0],n=[],r=1-c+e[1];r<=c-1+e[1];r++)n.push([t,r]);return n};c<(null!==(l=null===(d=this.mapData)||void 0===d?void 0:d.width)&&void 0!==l?l:2);){var l,d,m=[].concat(Object(r.a)(o()),Object(r.a)(i()),Object(r.a)(s()),Object(r.a)(u())).filter((function(e){return t=e,!!n.mapData&&t[0]>=0&&t[0]<n.mapData.width&&t[1]>=1&&t[1]<n.mapData.height&&!n.locationIsBlocked(e);var t}));if(a.push.apply(a,Object(r.a)(m.slice(0,t-a.length))),a.length===t)break;c++}return a}},{key:"calculateWalkApCosts",value:function(e,t){var n;return(null===(n=this.findPath(e,t))||void 0===n?void 0:n.length)||0}},{key:"createActionIntent",value:function(e,t,n,r,a){var c=t.location,o=void 0===c?[0,0]:c,i=t.ap,s=null!==n&&void 0!==n?n:[0,0];switch(e){case h.b.move:var u=this.findPath(o,s),l=this.combat?this.calculateWalkApCosts(o,s):void 0;return{action:e,from:o,to:s,apCost:l,actor:t,actorAP:i,path:u,isValid:!(null===u||void 0===u||!u.length)&&(!this.combat||(null!==l&&void 0!==l?l:0)<=(null!==i&&void 0!==i?i:0))};case h.b.melee:var d=this.findPath(o,s);if(!d)throw new Error("No path found");var m=this.calculateWalkApCosts(o,s),b=this.getObjectAtLocation(n,h.g);if(!r)return;return{action:e,from:o,to:s,apCost:m,actor:t,actorAP:i,path:d,isValid:!!b&&(null!==m&&void 0!==m?m:0)<=(null!==i&&void 0!==i?i:0),weaponWithAbility:r};case h.b.interact:return{action:e,from:o,to:s,actor:t,path:this.findPathNearest(o,s,!0),isValid:!0};case h.b.shoot:var p=E.d,j=this.getObjectAtLocation(n,h.g);if(!r)return;if(!a)return;return{action:e,from:o,to:s,apCost:p,actor:t,actorAP:i,isValid:!!j&&(null!==p&&void 0!==p?p:0)<=(null!==i&&void 0!==i?i:0),weaponWithAbility:r,ammo:a}}}},{key:"endTurn",value:function(){this.dispatch(Object(j.c)(this.questName))}},{key:"getSceneActor",value:function(e){return Object(I.h)(this.sceneActors,e)}},{key:"getSceneAdventurer",value:function(e){return this.sceneActors.find((function(t){return Object(h.f)(t)&&t.adventurerId===e}))}},{key:"getObjectAtLocation",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){return!0};return Object(I.g)(null!==(t=null===(n=this.quest.scene)||void 0===n?void 0:n.objects)&&void 0!==t?t:[],e,r)}},{key:"createAStar",value:function(){if(this.mapData){var e=[];if(this.mapData)for(var t=0;t<this.mapData.height;t++){for(var n=[],r=0;r<this.mapData.width;r++){var a=[r,t],c=this.locationIsBlocked(a);n.push(c?1:0)}e.push(n)}return new p.AStarFinder({grid:{matrix:e},includeStartNode:!1,heuristic:"Manhattan",weight:.2})}}},{key:"createObjects",value:function(){var e=this;if(!this.mapData)throw new Error("No mapData");var t=this.mapData.layers.filter((function(e){return e.type===b.a.objectgroup})),n=[];return t.forEach((function(t){t.objects.reduce((function(n,c){var o,i,s=Object(d.e)(c.properties),u=[c.x/((null===(o=e.mapData)||void 0===o?void 0:o.tilewidth)||1),(c.y-(c.gid?c.height:0))/((null===(i=e.mapData)||void 0===i?void 0:i.tileheight)||1)],l=Object(a.a)(Object(a.a)({},c),{},{layerId:t.id,properties:s,location:u});if(l.type===d.a.portal){if(!l.properties.to&&!e.quest.sceneNamePrev||l.properties.to===e.quest.sceneNamePrev){var m=e.getAdventurers(),b=l.width,p=l.height,j=l.layerId,f=[u].concat(Object(r.a)(e.findEmptyLocationsAround(u,m.length-1)));m.forEach((function(e,t){if(!l)throw new Error;if(!(e.health<=0)){var r=Math.round(l.x),a=Math.round(l.y),c=Object(q.c)(e.xp),o={id:0,adventurerId:e.id,x:r,y:a,location:f[t],width:b,height:p,layerId:j,visible:!0,type:d.a.actor,ap:Object(E.g)(e.basicAttributes,c),allegiance:h.a.player,properties:{adventurerId:e.id,isSprite:!0,spritesheet:e.spritesheetPath}};n.push(o)}}))}}else if(l.type===d.a.enemySpawn&&(l.type=d.a.actor,Object(h.e)(l)&&(l.allegiance=h.a.enemy),Object(h.g)(l))){var v,g=Object(k.a)(l.properties.enemyType),O=null!==(v=l.properties.level)&&void 0!==v?v:1;l.enemyId="".concat(l.properties.enemyType,"_").concat(Math.random().toString(36).substring(7)),l.enemyType=l.properties.enemyType,l.health=20*Math.random(),l.ap=Object(E.g)(g.attributes,O),l.name=l.properties.name,l.level=O,l.allegiance=h.a.enemy,l.properties.isSprite=!0,l.properties.spritesheet=g.spritesheet}return l&&n.push(l),n}),n)})),n}},{key:"combat",get:function(){var e;return!(null===(e=this.quest.scene)||void 0===e||!e.combat)}},{key:"sceneObjects",get:function(){var e;return(null===(e=this.quest.scene)||void 0===e?void 0:e.objects)||[]}},{key:"sceneActors",get:function(){return this.sceneObjects.filter(h.e)}},{key:"sceneAdventurers",get:function(){return this.sceneObjects.filter(h.f)}},{key:"sceneEnemies",get:function(){return this.sceneObjects.filter(h.g)}},{key:"quest",get:function(){var e=this,t=this.store.getState().quests.find((function(t){return t.name===e.questName}));if(!t)throw new Error("No quest :(");return t}},{key:"questVars",get:function(){return this.quest.questVars}},{key:"spritesheetPaths",get:function(){var e=this.getAdventurers();return[].concat(Object(r.a)(e.map((function(e){return e.spritesheetPath}))),["troll-sword.json","troll-axe.json"])}},{key:"settings",get:function(){return this.store.getState().settings}},{key:"updateQuestVars",value:function(e){this.dispatch(Object(j.m)(this.questName,e))}},{key:"getAdventurers",value:function(){var e=this.store.getState();return Object(I.d)(e.adventurers,this.quest)}},{key:"getAdventurerByActor",value:function(e){return this.store.getState().adventurers.find((function(t){return t.id===e.adventurerId}))}},{key:"getEnemyByActor",value:function(e){return Object(k.a)(e.enemyType)}},{key:"getAdventurerById",value:function(e){return this.store.getState().adventurers.find((function(t){return t.id===e}))}},{key:"getActorSkills",value:function(e){if(Object(h.f)(e)){var t=this.getAdventurerByActor(e);if(!t)throw new Error("No adventurer found");return t.skills}return this.getEnemyByActor(e).skills}},{key:"getActorAttributes",value:function(e){if(Object(h.f)(e)){var t=this.getAdventurerByActor(e);if(!t)throw new Error("No adventurer found");return Object(L.d)(t)}return this.getEnemyByActor(e).attributes}},{key:"questUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=O(e)?e:{key:e},a=y.a.getTextEntry(r);n&&f.b.addToast(a,v.a.questUpdate,t,Object(g.a)(this.questName)),this.log(r)}},{key:"log",value:function(e){var t=O(e)?e:{key:e};this.dispatch(Object(x.a)(t,A.a.quest,this.questName))}},{key:"bubbleAtLocation",value:function(e,t,n){var r,a,c=this.sceneLocationToPoint(t);c.set(c.x+(null!==(r=null===(a=this.mapData)||void 0===a?void 0:a.tilewidth)&&void 0!==r?r:2)/2,c.y),R.b.addBubble(e,c,n,R.a.scene)}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}]),e}()},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,function(e){e.exports=JSON.parse('{"alchemist":[{"shape":[34,18,31,1,37,0]},{"shape":[37,0,53,5,45,17]},{"shape":[45,17,68,27,81,48]},{"shape":[72,67,75,168,11,168]},{"shape":[9,65,1,45,10,30]},{"shape":[31,19,29,5,45,0]},{"shape":[45,0,34,18,37,0]},{"shape":[45,17,81,48,72,67]},{"shape":[72,67,11,168,9,65]},{"shape":[9,65,10,30,31,19]},{"shape":[45,17,72,67,9,65]},{"shape":[9,65,31,19,45,0]},{"shape":[37,0,45,17,9,65]}],"garden":[{"shape":[48,45,48,0,58,0]},{"shape":[57,41,75,56,73,78]},{"shape":[73,78,11,68,2,56]},{"shape":[2,56,13,45,48,45]},{"shape":[48,45,58,0,57,41]},{"shape":[73,78,2,56,48,45]},{"shape":[48,45,57,41,73,78]}],"armoursmith":[{"shape":[53,1,55,0,93,5]},{"shape":[93,5,112,11,120,20]},{"shape":[120,20,124,36,119,49]},{"shape":[119,49,122,156,75,149]},{"shape":[75,149,57,135,33,104]},{"shape":[33,104,10,95,11,52]},{"shape":[11,52,0,35,2,20]},{"shape":[2,20,6,14,27,5]},{"shape":[27,5,53,1,93,5]},{"shape":[93,5,120,20,119,49]},{"shape":[119,49,75,149,33,104]},{"shape":[33,104,11,52,2,20]},{"shape":[2,20,27,5,93,5]},{"shape":[93,5,119,49,33,104]},{"shape":[33,104,2,20,93,5]}],"lumberMill":[{"shape":[32,11,43,1,45,0]},{"shape":[45,0,49,4,37,18]},{"shape":[39,29,50,44,49,48]},{"shape":[38,46,38,230,17,233]},{"shape":[17,233,13,232,13,48]},{"shape":[13,48,3,48,14,28]},{"shape":[14,28,1,7,6,4]},{"shape":[31,18,32,11,45,0]},{"shape":[39,29,49,48,40,43]},{"shape":[38,46,17,233,13,48]},{"shape":[14,28,6,4,19,18]},{"shape":[31,18,45,0,37,18]},{"shape":[37,18,39,29,40,43]},{"shape":[40,43,38,46,13,48]},{"shape":[13,48,14,28,19,18]},{"shape":[31,18,37,18,40,43]},{"shape":[40,43,13,48,19,18]},{"shape":[19,18,31,18,40,43]}],"mine":[{"shape":[15,0,79,1,88,13]},{"shape":[88,13,78,66,27,70]},{"shape":[27,70,2,50,11,27]},{"shape":[11,27,6,13,15,0]},{"shape":[15,0,88,13,27,70]},{"shape":[27,70,11,27,15,0]}],"quarry":[{"shape":[2,24,20,2,22,0]},{"shape":[22,0,103,2,117,15]},{"shape":[117,15,124,24,112,24]},{"shape":[112,24,112,64,104,70]},{"shape":[104,70,104,89,97,88]},{"shape":[97,68,66,67,60,43]},{"shape":[60,43,17,42,17,26]},{"shape":[17,26,2,24,22,0]},{"shape":[22,0,117,15,112,24]},{"shape":[112,24,104,70,97,88]},{"shape":[60,43,17,26,22,0]},{"shape":[112,24,97,88,97,68]},{"shape":[97,68,60,43,22,0]},{"shape":[22,0,112,24,97,68]}],"tannery":[{"shape":[4,2,4,0,61,1]},{"shape":[59,36,89,37,85,79]},{"shape":[85,79,15,77,15,47]},{"shape":[15,47,5,35,0,9]},{"shape":[0,9,4,2,61,1]},{"shape":[59,36,85,79,15,47]},{"shape":[15,47,0,9,61,1]},{"shape":[61,1,59,36,15,47]}],"tavern":[{"shape":[110,27,108,24,112,23]},{"shape":[112,23,151,27,148,60]},{"shape":[148,60,137,71,133,67]},{"shape":[133,67,136,69,132,75]},{"shape":[132,75,137,77,138,124]},{"shape":[131,131,136,136,55,119]},{"shape":[29,64,6,72,0,69]},{"shape":[27,56,76,61,85,67]},{"shape":[101,25,108,13,112,17]},{"shape":[112,17,102,18,104,6]},{"shape":[110,27,112,23,148,60]},{"shape":[132,75,138,124,131,131]},{"shape":[131,131,55,119,59,118]},{"shape":[29,64,0,69,27,56]},{"shape":[112,17,104,6,111,9]},{"shape":[92,27,110,27,148,60]},{"shape":[132,75,131,131,59,118]},{"shape":[50,68,29,64,27,56]},{"shape":[92,27,148,60,133,67]},{"shape":[133,67,132,75,59,118]},{"shape":[50,68,27,56,85,67]},{"shape":[133,67,59,118,56,72]},{"shape":[56,72,50,68,85,67]},{"shape":[133,67,56,72,85,67]},{"shape":[133,67,85,67,89,60]},{"shape":[92,27,133,67,89,60]},{"shape":[92,27,89,60,86,25]},{"shape":[104,0,92,27,86,25]}],"warehouse":[{"shape":[36,414,3,409,2,13]},{"shape":[2,13,31,-7,63,7]},{"shape":[62,197,63,126,65,218]},{"shape":[61,262,83,272,84,459]},{"shape":[84,459,36,414,2,13]},{"shape":[2,13,63,7,62,197]},{"shape":[62,197,65,218,61,262]},{"shape":[61,262,84,459,2,13]},{"shape":[2,13,62,197,61,262]}],"weaponsmith":[{"shape":[52,18,50,2,50,0]},{"shape":[50,0,114,1,109,49]},{"shape":[109,49,115,132,98,129]},{"shape":[98,129,66,95,65,34]},{"shape":[11,33,11,77,0,77]},{"shape":[0,29,18,18,52,18]},{"shape":[52,18,50,0,109,49]},{"shape":[109,49,98,129,65,34]},{"shape":[11,33,0,77,0,29]},{"shape":[52,18,109,49,65,34]},{"shape":[15,27,11,33,0,29]},{"shape":[52,18,65,34,53,26]},{"shape":[15,27,0,29,52,18]},{"shape":[52,18,53,26,15,27]}],"weaver":[{"shape":[51,41,54,0,55,6]},{"shape":[55,41,82,53,87,63]},{"shape":[87,63,86,259,62,254]},{"shape":[62,254,23,212,21,61]},{"shape":[21,61,2,56,51,41]},{"shape":[51,41,55,6,55,41]},{"shape":[55,41,87,63,62,254]},{"shape":[62,254,21,61,51,41]},{"shape":[51,41,55,41,62,254]}],"workshop":[{"shape":[11,2,13,0,68,3]},{"shape":[68,3,77,12,70,14]},{"shape":[70,14,69,38,10,37]},{"shape":[9,13,1,12,11,2]},{"shape":[11,2,68,3,70,14]},{"shape":[70,14,10,37,9,13]},{"shape":[9,13,11,2,70,14]}]}')},,,,,,,,,function(e){e.exports=JSON.parse('{"alpha":{"start":0.25,"end":0},"scale":{"start":0.04,"end":0.29,"minimumScaleMultiplier":1},"color":{"start":"#85888d","end":"#100f0c"},"speed":{"start":100,"end":200,"minimumSpeedMultiplier":1},"acceleration":{"x":10,"y":-30},"maxSpeed":200,"startRotation":{"min":265,"max":270},"noRotation":false,"rotationSpeed":{"min":8,"max":0},"lifetime":{"min":0.5,"max":3.05},"blendMode":"normal","frequency":0.0005,"emitterLifetime":-1,"maxParticles":300,"pos":{"x":0,"y":0},"addAtBack":true,"spawnType":"point"}')},,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},,,,,,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"DungeonCanyonSceneController",(function(){return j})),n.d(t,"DungeonEntranceSceneController",(function(){return h})),n.d(t,"DungeonHallwaySceneController",(function(){return f})),n.d(t,"DungeonHub1Controller",(function(){return v}));var r=n(2),a=n(65),c=n(51),o=n(22),i=n(21),s=n(33),u=n(36),l=n(174),d=n(122),m=n(34),b=n(17),p=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n)}(l.a),j=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).jsonPath="scenes/dungeon/canyon-64.json",e}return Object(o.a)(n)}(p),h=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).previousMusic=void 0,e.jsonPath="scenes/dungeon/dungeon-entrance-64.json",e}return Object(o.a)(n,[{key:"getLootCache",value:function(e){return this.questVars.dungeon.entrance.chest}},{key:"takeGoldFromCache",value:function(e){Object(a.a)(Object(c.a)(n.prototype),"takeGoldFromCache",this).call(this,e),this.updateQuestVars({dungeon:{entrance:{chest:{gold:0}}}})}},{key:"takeItemFromCache",value:function(e,t,r,o){Object(a.a)(Object(c.a)(n.prototype),"takeItemFromCache",this).call(this,e,t,r,o);var i=this.getLootCache(t);if(i){var s=i.items.filter((function(t,n){return n!==e}));this.updateQuestVars({dungeon:{entrance:{chest:{items:s}}}})}}},{key:"updateScene",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sceneObjects,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.combat;t=t.map((function(t){return"chest"===t.name?Object(r.a)(Object(r.a)({},t),{},{gid:e.questVars.dungeon.entrance.chestOpen?e.tileTypes["chest.open"]:e.tileTypes["chest.closed"]}):t})),Object(a.a)(Object(c.a)(n.prototype),"updateScene",this).call(this,t,o)}},{key:"interactWithObject",value:function(e,t){switch(t.name){case"chest":if(!this.questVars.dungeon.entrance.chestOpen){var r={key:"quest-common-adventurer-opened-chest",context:{adventurer:this.getAdventurerByActor(e)}};this.questUpdate(r,"/img/items/misc/chest-02.png"),this.updateQuestVars({dungeon:{entrance:{chestOpen:!0}}})}this.store.dispatch(Object(m.h)(this.questName,{type:"lootCache",lootCache:t.name}));break;case"altar":this.store.dispatch(Object(m.h)(this.questName,{type:"situation",situation:"altar"}))}Object(a.a)(Object(c.a)(n.prototype),"interactWithObject",this).call(this,e,t)}},{key:"sceneEntered",value:function(){this.questVars.dungeon.entered,this.previousMusic=b.c.getCurrentlyPlaying(b.a.music),this.combat?b.c.addSound("music/combat","sound/music/TribalHut.ogg",(function(){b.c.playSound("music/combat",b.a.music,!0,b.b.fade,!0)})):b.c.addSound("music/violettesElficSong",["sound/music/ViolettesElficSongForLamentandHope.ogg"],(function(){b.c.playSound("music/violettesElficSong",b.a.music,!0,b.b.fade,!0)})),Object(a.a)(Object(c.a)(n.prototype),"sceneEntered",this).call(this)}},{key:"sceneExited",value:function(){this.previousMusic&&b.c.playSound(this.previousMusic,b.a.music,!0,b.b.fade,!0),Object(a.a)(Object(c.a)(n.prototype),"sceneExited",this).call(this)}},{key:"getSituation",value:function(e,t){return Object(a.a)(Object(c.a)(n.prototype),"getSituation",this).call(this,e,t)}},{key:"handleSituationOptionClick",value:function(e,t,n){}}]),n}(p),f=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).jsonPath="scenes/dungeon/dungeon-entry-64.json",e}return Object(o.a)(n,[{key:"getLootCache",value:function(e){return this.questVars.dungeon.hallway.chest}},{key:"sceneEntered",value:function(){console.log("ENTERED THE HALLWAy"),Object(a.a)(Object(c.a)(n.prototype),"sceneEntered",this).call(this)}},{key:"interactWithObject",value:function(e,t){switch(t.name){case"chest":if(!this.questVars.dungeon.hallway.chestOpen){var r,o={key:"quest-common-adventurer-opened-chest",context:{adventurer:null===(r=this.getAdventurerByActor(e))||void 0===r?void 0:r.name}};this.questUpdate(o,"/img/items/misc/chest-02.png"),this.updateQuestVars({dungeon:{hallway:{chestOpen:!0}}})}this.store.dispatch(Object(m.h)(this.questName,{type:"lootCache",lootCache:t.name}));break;case"door1":this.questVars.dungeon.hallway.doorOpen||this.store.dispatch(Object(m.h)(this.questName,{type:"situation",situation:"door"}));break;case"latrine":this.questUpdate("quest-kill10-boars-dungeonentrance-latrine")}Object(a.a)(Object(c.a)(n.prototype),"interactWithObject",this).call(this,e,t)}},{key:"getSituation",value:function(e,t){if("door"===e){var r=this.getAdventurerById(t);return r&&r.inventory.some((function(e){return"questItem/key"===(null===e||void 0===e?void 0:e.type)}))?{title:"quest-kill10-boars-dungeonentrance-door",choices:["quest-common-scenerio-door-open"]}:{title:"quest-kill10-boars-dungeonentrance-door",text:"quest-kill10-boars-dungeonentrance-door-needs-key"}}return Object(a.a)(Object(c.a)(n.prototype),"getSituation",this).call(this,e,t)}},{key:"handleSituationOptionClick",value:function(e,t,n){if("door"===e){var r;this.updateQuestVars({dungeon:{hallway:{doorOpen:!0}}}),b.c.playSound("scene/doorOpen",b.a.scene,!1,b.b.singleInstance),this.discardItemType("questItem/key",n);var a={key:"quest-common-adventurer-opened-door",context:{adventurer:null===(r=this.getAdventurerById(n))||void 0===r?void 0:r.name}};this.questUpdate(a,"/img/items/misc/chest-02.png"),this.dispatch(Object(m.h)(this.questName))}}},{key:"takeItemFromCache",value:function(e,t,r,o){Object(a.a)(Object(c.a)(n.prototype),"takeItemFromCache",this).call(this,e,t,r,o);var i=this.getLootCache(t);if(i){var s=i.items.filter((function(t,n){return n!==e}));this.updateQuestVars({dungeon:{hallway:{chest:{items:s}}}})}}},{key:"updateScene",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sceneObjects,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.combat;t=t.map((function(t){switch(t.name){case"chest":return Object(r.a)(Object(r.a)({},t),{},{gid:e.questVars.dungeon.entrance.chestOpen?e.tileTypes["chest.open"]:e.tileTypes["chest.closed"]});case"door1":if(e.questVars.dungeon.hallway.doorOpen){var n=Object(r.a)(Object(r.a)({},t.properties),{},{blocksMovement:!1,interactive:!1});return"upper"===t.properties.part?Object(r.a)(Object(r.a)({},t),{},{gid:228,properties:n}):Object(r.a)(Object(r.a)({},t),{},{gid:240,properties:n})}return"upper"===t.properties.part?Object(r.a)(Object(r.a)({},t),{},{gid:252}):Object(r.a)(Object(r.a)({},t),{},{gid:264})}return t})),Object(a.a)(Object(c.a)(n.prototype),"updateScene",this).call(this,t,o)}}]),n}(p),v=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).jsonPath="scenes/dungeon/dungeon-hub1.json",e}return Object(o.a)(n)}(p);d.a.registerSceneController("kill10Boars","dungeon.canyon",j),d.a.registerSceneController("kill10Boars","dungeon.entrance",h),d.a.registerSceneController("kill10Boars","dungeon.hub1",v),d.a.registerSceneController("kill10Boars","dungeon.hallway",f)},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){},,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,function(e,t){},function(e,t){},,,,,function(e,t){},,function(e,t){},,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,function(e,t){},,,function(e,t){},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(70),a=n(49),c=n.n(a),o=n(307),i=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function s(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}function u(){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");i?function(e){fetch(e).then((function(t){var n;404===t.status||-1===(null===(n=t.headers.get("content-type"))||void 0===n?void 0:n.indexOf("javascript"))?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):s(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e):s(e)}))}}var l,d=n(96),m=n(3),b=n(90),p=n(335),j=n(18),h=n(9),f=n(1),v=n.n(f),g=n(16),O=function(e,t,n){return{type:"reduceTime",percentage:e,time:t,what:n}},y=function(e){return{type:"loadGame",state:e}},x=n(88),w=function(e){return"".concat(1023&e,".").concat(e>>10&1023,".").concat(e>>20&1023)},k="0.2.1",A=k,N=function(e){var t=e.split(".").map((function(e){return Number(e)}));if(3!==t.length)throw new Error("Received invalid version string: ".concat(e));t.forEach((function(e){if(e>=1024)throw new Error("Version string invalid, ".concat(e," is too large"))}));for(var n=0,r=0;r<3;r++)n|=t[r]<<10*r;return n}(k),C=n(12),I=C.e;!function(e){e[e.resource=0]="resource",e[e.production=1]="production",e[e.tavern=2]="tavern",e[e.warehouse=3]="warehouse"}(l||(l={}));var S,T,E={type:l.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-alchemist-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-alchemist-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},unlocks:[]},{displayName:"structure-alchemist-name",workerCapacity:10,cost:{gold:50,time:C.g},unlocks:[]}]},q={cost:{gold:40,time:4e3},type:l.production,levels:[{displayName:"structure-armoursmith-name",workerCapacity:2,cost:{gold:0},unlocks:["apparel/boots1"]},{displayName:"structure-armoursmith-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},unlocks:["apparel/chest"]},{displayName:"structure-armoursmith-name",workerCapacity:10,cost:{gold:50,time:C.g},unlocks:["apparel/cowl"]}]},R={type:l.resource,cost:{gold:40,time:4e3},levels:[{displayName:"structure-garden-name",workerCapacity:2,cost:{gold:0},generates:{food:2},harvest:{amount:3,lootTable:{"herb/bogroot":2,"herb/winterWeed":1}}},{displayName:"structure-garden-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},generates:{food:4},harvest:{amount:5,lootTable:{"herb/bogroot":2,"herb/winterWeed":1,"herb/hyacinthus":1,"herb/bloodLotus":1}}},{displayName:"structure-garden-name",workerCapacity:10,cost:{gold:50,time:C.g},generates:{food:8}}]},D={type:l.resource,cost:{gold:31,time:C.c},levels:[{displayName:"structure-lumber-mill-name",workerCapacity:2,cost:{gold:0},generates:{wood:2}},{displayName:"structure-lumber-mill-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},generates:{wood:2}},{displayName:"structure-lumber-mill-name",workerCapacity:10,cost:{gold:50,time:C.g},generates:{wood:2}}]},M={cost:{gold:40,time:4e3},type:l.resource,levels:[{displayName:"structure-mine-name",workerCapacity:2,cost:{gold:0},generates:{iron:2},harvest:{amount:3,lootTable:{"mineral/roseQuartz":2,"mineral/topaz":1}}},{displayName:"structure-mine-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},generates:{iron:2},harvest:{amount:5,lootTable:{"mineral/roseQuartz":2,"mineral/topaz":2,"mineral/jasper":1,"mineral/greenOpal":1}}},{displayName:"structure-mine-name",workerCapacity:10,cost:{gold:50,time:C.g},generates:{iron:2},harvest:{amount:5,lootTable:{"mineral/roseQuartz":1,"mineral/topaz":1,"mineral/jasper":1,"mineral/greenOpal":1,"mineral/malachite":1,"mineral/tigersEye":1}}}]},L={cost:{gold:40,time:4e3},type:l.resource,levels:[{displayName:"structure-quarry-name",workerCapacity:2,cost:{gold:0},generates:{stone:2}},{displayName:"structure-quarry-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},generates:{stone:4}},{displayName:"structure-quarry-name",workerCapacity:10,cost:{gold:50,time:C.g},generates:{stone:6}}]},z={cost:{gold:40,time:4e3},type:l.resource,levels:[{displayName:"structure-tannery-name",workerCapacity:2,cost:{gold:0},generates:{leather:2}},{displayName:"structure-tannery-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},generates:{leather:5}},{displayName:"structure-tannery-name",workerCapacity:10,cost:{gold:50,time:C.g},generates:{leather:7}}]},P={cost:{gold:40,time:4e3},type:l.tavern,levels:[{displayName:"structure-tavern-name",workerCapacity:2,cost:{gold:0},rooms:10},{displayName:"structure-tavern-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},rooms:12},{displayName:"structure-tavern-name",workerCapacity:10,cost:{gold:50,time:C.g},rooms:15}]},W={cost:{gold:40,time:4e3},type:l.warehouse,levels:[{displayName:"structure-warehouse-name",workerCapacity:2,cost:{gold:0},maxResources:{fabric:200,food:200,iron:200,leather:200,stone:200,wood:200},maxStockpile:16},{displayName:"structure-warehouse-name",workerCapacity:5,cost:{gold:13,resources:{wood:100,iron:100,stone:100},time:C.b},maxResources:{fabric:500,food:500,iron:500,leather:500,stone:500,wood:500},maxStockpile:32},{displayName:"structure-warehouse-name",workerCapacity:10,cost:{gold:50,resources:{wood:200,iron:200,stone:200},time:5*C.g},maxResources:{fabric:1e3,food:1e3,iron:1e3,leather:1e3,stone:1e3,wood:1e3},maxStockpile:48}]},V={type:l.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-weaponsmith-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:10,cost:{gold:50,time:C.g},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:14,cost:{gold:50,time:C.f},unlocks:["weapon/poisonedDagger"]}]},Q={cost:{gold:40,time:4e3},type:l.resource,levels:[{displayName:"structure-weaver-name",workerCapacity:2,cost:{gold:0},generates:{fabric:2}},{displayName:"structure-weaver-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},generates:{fabric:5}},{displayName:"structure-weaver-name",workerCapacity:10,cost:{gold:50,time:C.f},generates:{fabric:7}}]},B={type:l.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-workshop-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:C.e},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:10,cost:{gold:50,time:C.g},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:14,cost:{gold:50,time:C.f},unlocks:[]}]},G=n(5);!function(e){e.wood="wood",e.iron="iron",e.stone="stone",e.leather="leather",e.fabric="fabric",e.food="food"}(T||(T={}));var F,H=(S={},Object(G.a)(S,T.wood,{resource:T.wood,iconImg:"/img/resources/wood.png"}),Object(G.a)(S,T.iron,{resource:T.iron,iconImg:"/img/resources/iron.png"}),Object(G.a)(S,T.stone,{resource:T.stone,iconImg:"/img/resources/stone.png"}),Object(G.a)(S,T.leather,{resource:T.leather,iconImg:"/img/resources/leather.png"}),Object(G.a)(S,T.fabric,{resource:T.fabric,iconImg:"/img/resources/fabric.png"}),Object(G.a)(S,T.food,{resource:T.food,iconImg:"/img/resources/food.png"}),S),Z=function(e){return"alchemist"===e||"armoursmith"===e||"weaponsmith"===e||"workshop"===e},U=function(e){return"garden"===e||"lumberMill"===e||"mine"===e||"quarry"===e||"tannery"===e||"weaver"===e},Y={alchemist:E,armoursmith:q,garden:R,lumberMill:D,mine:M,quarry:L,tavern:P,tannery:z,warehouse:W,weaponsmith:V,weaver:Q,workshop:B};function J(e){return Y[e]}function X(e){switch(e){case T.fabric:return"weaver";case T.food:return"garden";case T.iron:return"mine";case T.leather:return"tannery";case T.stone:return"quarry";case T.wood:return"lumberMill"}}!function(e){e[e.questProgress=0]="questProgress",e[e.resourceGeneration=1]="resourceGeneration",e[e.cheat=2]="cheat"}(F||(F={}));var K=1,_=function(e){return F.cheat,K},$=n(78),ee=Object($.a)([function(e){return e.structures.warehouse.level}],(function(e){return J("warehouse").levels[e].maxResources})),te=function(e,t){var n=t.structures,r={},a=_(F.resourceGeneration),c=(Date.now()-e)/(I/a),o=ee(t);return c<1?null:(Object.keys(n).forEach((function(e){return function(e){var t=J(e);if(t.type===l.resource){var a=t,o=n[e].level,i=a.levels[o];Object.keys(i.generates).reduce((function(t,r){var a=r,o=i.generates[a]*n[e].workers*c;return t[a]=(t[a]||0)+o,t}),r)}}(e)})),Object.keys(r).forEach((function(e){var n=e;r[n]&&t.resources[n]+r[n]>=o[n]&&(r[n]=o[n]-t.resources[n])})),r)},ne=n(85),re=n(28),ae=n(61),ce=n(77),oe=n(56),ie=n(57),se=n(41),ue=n(34),le=n(60),de=function(e,t){var n=_(F.questProgress),r=[],a=[],c=t.getState(),o=function(e,n){t.dispatch(Object(ue.k)(e.name,n));var r=m.a.getQuestTitle(e.name),a=Object(le.f)(c.adventurers,e);oe.b.addToast(r,ie.a.questEncounter,null===a||void 0===a?void 0:a.avatarImg,Object(se.a)(e.name))};return c.quests.forEach((function(t){if(t.status===ce.a.active){var c=Object(ne.a)(t.name),i=t.progress,s=Math.floor(i),u=c.nodes[s];if(u.type===re.a.encounter&&void 0===t.sceneName&&o(t,u.startScene),u.type===re.a.nothing){for(var l=e/(6e4/n)*4,d=Math.min(i+l,c.nodes.length-1),m=Math.floor(d)-s,b=1;b<=m;b++){var p=c.nodes[s+b];if(p.type===re.a.encounter){o(t,p.startScene),p.log&&r.push({channel:ae.a.quest,channelContext:t.name,key:p.log}),d=i+b;break}p.type===re.a.nothing&&p.log&&r.push({channel:ae.a.quest,channelContext:t.name,key:p.log})}a.push({name:t.name,progress:d})}}})),{logUpdates:r,questUpdates:a}},me=function(){return d.a?d.e():null},be=n(79),pe=n(152),je=n(316),he=n(99),fe=n.n(he),ve=n(149),ge=n(2);function Oe(e){for(var t,n=null!==(t=Object.values(e).reduce((function(e,t){return(null!==e&&void 0!==e?e:0)+(null!==t&&void 0!==t?t:0)}),0))&&void 0!==t?t:0,r=Math.floor(Math.random()*n+1),a=0,c=Object.entries(e),o=0;o<c.length;o++)if(r<=(a+=c[o][1]))return c[o][0];throw new Error}var ye,xe=3*C.d,we=function(e){var t=e.engine.lastHarvest,n=e.structures,r={};return Date.now()-t>xe&&Object.keys(n).forEach((function(e){return function(e){var t=J(e);if(t.type===l.resource){var a,c=t,o=n[e].level,i=c.levels[o];if(null!==(a=i.harvest)&&void 0!==a&&a.lootTable){for(var s,u,d=null!==(s=null===(u=n[e].harvest)||void 0===u?void 0:u.length)&&void 0!==s?s:0,m=[];d<i.harvest.amount;)m.push(Oe(i.harvest.lootTable)),d++;r[e]=m}}}(e)})),r},ke=function(){return{gameStarted:void 0,previousTick:Date.now(),lastTick:Date.now(),lastProducedUpdate:Date.now(),lastHarvest:Date.now()}},Ae={version:N},Ne=n(24),Ce=n(40),Ie=function(e){var t=Object(Ce.c)(e);return t[Math.floor(Math.random()*t.length)]},Se=function(){var e={ammunition:[],apparel:[],deed:[],herb:[],material:[],mineral:[],consumable:[],questItem:[],trinket:[],weapon:[]},t=J("warehouse").levels[0].maxStockpile;return Object.keys(e).forEach((function(n){for(var r=Ne.a[n],a=0;a<t;a++)if(Math.random()<.5)e[n].push(null);else{var c={type:Ie(r)};Object(Ce.a)(r)&&(c.quantity=Math.floor(100*Math.random())),e[n].push(c)}})),e},Te=[],Ee=n(14),qe=n(167),Re=n(317),De=n.n(Re),Me=n(58),Le=n(50),ze=function(e,t){return t},Pe=[{name:"kill10Boars",status:ce.a.active,party:["adv_c4a5d270","adv_2e655832","adv_ec6f1050","adv_d299f98a"],progress:0,questVars:qe.a,encounterResults:[],icon:"sigil1.png"}],We={fabric:0,food:0,iron:10,leather:0,stone:0,wood:10},Ve={},Qe={verboseCombatLog:!1,debugEnableDebugDrawer:!0,debugSceneShowPathable:!1,debugSceneShowCellLocations:!1,debugSceneShowActionQueue:!1};!function(e){e[e.NotBuilt=0]="NotBuilt",e[e.Building=1]="Building",e[e.Built=2]="Built"}(ye||(ye={}));var Be,Ge=function(e,t,n){var r=Object(ge.a)(Object(ge.a)({},e[t]),{},{state:n});return Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},t,r))},Fe={level:0,state:ye.NotBuilt,workers:0},He={alchemist:Object(ge.a)(Object(ge.a)({},Fe),{},{produces:[]}),armoursmith:Object(ge.a)(Object(ge.a)({},Fe),{},{produces:["apparel/boots1"]}),garden:{level:0,workers:0,state:ye.Built},lumberMill:Fe,mine:{level:0,workers:0,state:ye.NotBuilt},quarry:Fe,tavern:{level:2,workers:0,state:ye.Built},tannery:Fe,warehouse:{level:0,workers:0,state:ye.Built},weaponsmith:Object(ge.a)(Object(ge.a)({},Fe),{},{produces:["weapon/simpleCrossbow","weapon/dagger"]}),weaver:Fe,workshop:Object(ge.a)(Object(ge.a)({},Fe),{},{produces:["questItem/torch","questItem/sandwich"]})},Ze=function(e){return{name:e.name,origin:e.origin,type:e.taskType,callbacks:e.callbacks,timeRemaining:e.time,startTime:Date.now(),lastTick:Date.now(),progress:0}},Ue={completed:[],running:[]},Ye=Object(be.combineReducers)({adventurers:ve.b,engine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"startGame":return Object(ge.a)(Object(ge.a)({},e),{},{gameStarted:Date.now()});case"gameTick":var n=t.resources,r=null===n?e.lastProducedUpdate:Date.now(),a=null!==t.harvest&&Object.keys(t.harvest).length?Date.now():e.lastHarvest,c=e.lastTick;return Object(ge.a)(Object(ge.a)({},e),{},{previousTick:c,lastProducedUpdate:r,lastTick:Date.now(),lastHarvest:a});case"reduceTime":if(t.percentage<0||t.percentage>100)return e;if("harvest"===t.time){var o=xe-(Date.now()-e.lastHarvest),i=o*(t.percentage/100);return Object(ge.a)(Object(ge.a)({},e),{},{lastHarvest:e.lastHarvest-i})}return e}return e},game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ae,t=arguments.length>1?arguments[1]:void 0;return"ignoreVersionDiff"===t.type?Object(ge.a)(Object(ge.a)({},e),{},{ignoreVersionDiff:N}):e},gold:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=arguments.length>1?arguments[1]:void 0;return"addGold"===t.type?e+t.amount:e},stockpile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Se(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"addItem":var n=Object(Ce.d)(t.item.type),r=t.item,a=t.toSlot,c=Ne.a[n.itemCategory];return void 0===a&&-1===(a=e[c].findIndex((function(e){return null===e})))?Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},c,[].concat(Object(j.a)(e[c]),[r]))):Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},c,e[c].map((function(e,t){return t===a?r:e}))));case"moveItemInWarehouse":var o=t.itemCategory,i=t.fromSlot,s=t.toSlot,u=Ne.a[o];return Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},u,e[u].map((function(t,n){return n===i?e[u][s]:n===s?e[u][i]:t}))));case"removeItem":var l=t.itemCategory,d=t.fromSlot,m=Ne.a[l];return Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},m,e[m].map((function(e,t){return t!==d?e:null}))))}return e},log:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"addLogEntry":var n=t.entry,r=t.channel,a=t.channelContext,c=n.key,o=n.context,i=Date.now();return[{channel:r,channelContext:a,context:o,key:c,time:i}].concat(Object(j.a)(e));case"gameTick":if(!t.log.length)return e;var s=t.log.map((function(e){return Object(ge.a)(Object(ge.a)({},e),{},{time:Date.now()})}));return[].concat(Object(j.a)(s),Object(j.a)(e))}return e},quests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"launchQuest":var n=t.assignedAventurers.filter((function(e){return!!e})).map((function(e){return e.id}));return e.map((function(e){if(e.name===t.questName){var r=Object(ne.a)(t.questName).getInitialQuestVars(e);return Object(ge.a)(Object(ge.a)({},e),{},{status:ce.a.active,party:n,questVars:r})}return e}));case"exitEncounter":return e.map((function(e){if(e.name===t.questName){var n=e.progress+1;return Object(ge.a)(Object(ge.a)({},e),{},{progress:n,scene:void 0,sceneName:void 0})}return e}));case"updateQuestVars":return e.map((function(e){return e.name===t.questName?Object(ge.a)(Object(ge.a)({},e),{},{questVars:De()(e.questVars,t.vars,{arrayMerge:ze})}):e}));case"setSceneName":return e.map((function(e){return e.name===t.questName?Object(ge.a)(Object(ge.a)({},e),{},{sceneName:t.sceneName,sceneNamePrev:e.sceneName,scene:void 0}):e}));case"setScene":return e.map((function(e){return e.name===t.questName?Object(ge.a)(Object(ge.a)({},e),{},{scene:t.scene}):e}));case"enqueueSceneAction":return e.map((function(e){if(e.name===t.questName){var n,r=e.scene;if(!r)throw new Error("Something broke. No scene");return r.actionQueue=[].concat(Object(j.a)(null!==(n=r.actionQueue)&&void 0!==n?n:[]),[t.sceneAction]),Object(ge.a)(Object(ge.a)({},e),{},{scene:r})}return e}));case"completeSceneAction":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n||!n.actionQueue)throw new Error("Something broke. No scene");var r=n.actionQueue.find((function(e){return Object(Ee.d)(e.intent.actor)===t.actorName}));if(!r)return e;if(r.intent.action===Ee.b.move)n.objects=n.objects.map((function(e){return Object(Ee.d)(e)===t.actorName?Object(ge.a)(Object(ge.a)({},e),{},{location:r.intent.to}):e}));var a=n.actionQueue.findIndex((function(e){return Object(Ee.d)(e.intent.actor)===t.actorName}));return n.actionQueue=n.actionQueue.filter((function(e,t){return t!==a})),Object(ge.a)(Object(ge.a)({},e),{},{scene:n})}return e}));case"setCombat":var r=t.combat;return e.map((function(e){if(e.name===t.questName&&e.scene){var n=Object(ge.a)(Object(ge.a)({},e.scene),{},{combat:r,turn:r?Ee.a.player:void 0});return Object(ge.a)(Object(ge.a)({},e),{},{scene:n})}return e}));case"endPlayerTurn":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.objects=n.objects.map((function(e){if(Object(Ee.e)(e)){return Object(ge.a)(Object(ge.a)({},e),{},{ap:0})}return e})),Object(ge.a)(Object(ge.a)({},e),{},{scene:n})}return e}));case"startTurn":return e.map((function(e){if(e.name===t.questName){if(!e.scene)throw new Error("Something broke. No scene");var n=t.turn,r=e.scene;return n===Ee.a.player?r.objects=r.objects.map((function(e){if(Object(Ee.f)(e)){var n,r=null===(n=t.adventurers)||void 0===n?void 0:n.find((function(t){return t.id===e.name}));if(r){var a=Object(Le.c)(r.xp),c=Object(Me.g)(r.basicAttributes,a);return Object(ge.a)(Object(ge.a)({},e),{},{ap:c})}return e}return e})):n===Ee.a.enemy&&(r.objects=r.objects.map((function(e){if(Object(Ee.g)(e)){var t=Me.e;return Object(ge.a)(Object(ge.a)({},e),{},{ap:t})}return e}))),Object(ge.a)(Object(ge.a)({},e),{},{scene:Object(ge.a)(Object(ge.a)({},r),{},{turn:n})})}return e}));case"setActorAp":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.objects=n.objects.map((function(e){if(Object(Ee.e)(e)&&e.name===t.actor){var n=t.ap;return Object(ge.a)(Object(ge.a)({},e),{},{ap:n})}return e})),Object(ge.a)(Object(ge.a)({},e),{},{scene:n})}return e}));case"deductActorAp":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.objects=n.objects.map((function(e){if(Object(Ee.f)(e)&&e.adventurerId===t.actor||Object(Ee.g)(e)&&e.enemyId===t.actor){var n=e.ap-t.ap;return Object(ge.a)(Object(ge.a)({},e),{},{ap:n})}return e})),Object(ge.a)(Object(ge.a)({},e),{},{scene:n})}return e}));case"modifyEnemyHealth":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");var r=n.objects.map((function(e){if(Object(Ee.e)(e)&&e.name===t.actor){return Object(ge.a)(Object(ge.a)({},e),{},{health:23})}return e}));return Object(ge.a)(Object(ge.a)({},e),{},{scene:Object(ge.a)(Object(ge.a)({},n),{},{objects:r})})}return e}));case"setActorLocation":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.objects=n.objects.map((function(e){if(Object(Ee.d)(e)===t.actor){var n=t.location;return Object(ge.a)(Object(ge.a)({},e),{},{location:n})}return e})),Object(ge.a)(Object(ge.a)({},e),{},{scene:n})}return e}));case"setActiveSceneInteractionModal":return e.map((function(e){return e.name===t.questName&&e.scene&&(e.scene.activeInteractionModal=t.sceneInteractionModal),e}));case"gameTick":var a=t.quests;return a.length?e.map((function(e){var t=a.find((function(t){return t.name===e.name}));if(t){var n=t.progress;return Object(ge.a)(Object(ge.a)({},e),{},{progress:n})}return e})):e}return e},resources:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:We,t=arguments.length>1?arguments[1]:void 0,n=function(t){return Object.keys(e).reduce((function(n,r){var a,c=r;return n[c]=(null!==(a=e[c])&&void 0!==a?a:0)+(t[c]||0),n}),{})};switch(t.type){case"addResources":var r=t.resources;return n(r);case"removeResources":var a=t.resources;return Object.keys(e).reduce((function(t,n){var r,c=n;return t[c]=(null!==(r=e[c])&&void 0!==r?r:0)-(a[c]||0),t}),{});case"gameTick":var c=t.resources;return null===c?e:n(c)}return e},rngState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,t=arguments.length>1?arguments[1]:void 0;return"gameTick"===t.type&&null!=t.rngState&&(e=Object.assign({},t.rngState)),e},settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe,t=arguments.length>1?arguments[1]:void 0;return"setSetting"===t.type?Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},t.setting,t.value)):e},structures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"startBuildingStructure":return Ge(e,t.structure,ye.Building);case"finishBuildingStructure":return Ge(e,t.structure,ye.Built);case"upgradeStructure":var n=e[t.structure].level+1,r=Object(ge.a)(Object(ge.a)({},e[t.structure]),{},{level:n});return Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},t.structure,r));case"increaseWorkers":var a=t.workers,c=e[t.structure].workers+a,o=Object(ge.a)(Object(ge.a)({},e[t.structure]),{},{workers:c});return Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},t.structure,o));case"decreaseWorkers":var i=t.workers,s=e[t.structure].workers-i,u=Object(ge.a)(Object(ge.a)({},e[t.structure]),{},{workers:s});return Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},t.structure,u));case"setStructureState":var l=t.state;return Ge(e,t.structure,l);case"addItemToToProduces":if(!Z(t.structure))return e;var d=t.item,m=[].concat(Object(j.a)(e[t.structure].produces),[d]),b=Object(ge.a)(Object(ge.a)({},e[t.structure]),{},{produces:m});return Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},t.structure,b));case"removeItemFromHarvest":var p;if(!U(t.structure))return e;var h=null===(p=e[t.structure].harvest)||void 0===p?void 0:p.filter((function(e,n){return n!==t.index}));return Object(ge.a)(Object(ge.a)({},e),{},Object(G.a)({},t.structure,Object(ge.a)(Object(ge.a)({},e[t.structure]),{},{harvest:h})));case"gameTick":var f;return t.harvest&&null!==(f=Object.keys(t.harvest))&&void 0!==f&&f.length?Object.keys(e).reduce((function(e,n){var r,a,c=n;if(U(c)&&null!==(r=t.harvest)&&void 0!==r&&null!==(a=r[c])&&void 0!==a&&a.length){var o,i,s=(null!==(o=t.harvest[c])&&void 0!==o?o:[]).map((function(e){return{type:e}}));e[c].harvest=[].concat(Object(j.a)(null!==(i=e[c].harvest)&&void 0!==i?i:[]),Object(j.a)(s))}return e}),e):e}return e},tasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"start":var n=Ze(t),r=e.running.concat(n);return Object(ge.a)(Object(ge.a)({},e),{},{running:r});case"gameTick":var a=Date.now(),c=[],o=[];return e.running.forEach((function(e){var t=a+e.timeRemaining,n=(a-e.startTime)/(t-e.startTime),r=e.timeRemaining-(a-e.lastTick),i=Object(ge.a)(Object(ge.a)({},e),{},{progress:n,lastTick:a,timeRemaining:r});r<0?o.push(i):c.push(i)})),{running:c,completed:o};case"reduceTime":if(t.percentage<0||t.percentage>100)return e;if("task"===t.time){var i=[];return e.running.forEach((function(e){var n=e.timeRemaining/100*t.percentage;if(e.name===t.what){var r=Object(ge.a)(Object(ge.a)({},e),{},{timeRemaining:n});i.push(r)}else i.push(e)})),Object(ge.a)(Object(ge.a)({},e),{},{running:i})}return e}return e},workers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:13,t=arguments.length>1?arguments[1]:void 0;return"addWorkers"===t.type?e+t.value:e}}),Je=function(){return{adventurers:ve.c,engine:ke(),game:Ae,gold:40,stockpile:Se(),log:Te,quests:Pe,resources:We,rngState:Ve,settings:Qe,structures:He,tasks:Ue,workers:13}},Xe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Je(),t=arguments.length>1?arguments[1]:void 0;return"loadGame"===t.type?t.state:Ye(e,t)},Ke=n(64),_e=n(169),$e=n(48),et=n(80),tt=n(138),nt=n(62),rt=n(42),at={key:"root",storage:fe.a,version:N},ct=Object(pe.b)(at,Xe),ot=[function(e){return function(t){return function(n){var r,a=e.getState(),c=Object(Ke.a)(a.adventurers);try{var o=function(){var t=r.value,a=function(e,t,n){if("completeSceneAction"===t.type){var r,a,c,o,i=n.getState(),s=Object(le.e)(e,i.quests),u=null===s||void 0===s||null===(r=s.scene)||void 0===r||null===(a=r.actionQueue)||void 0===a?void 0:a[0];if(null!==u&&void 0!==u&&u.intent.actor&&Object(Ee.d)(u.intent.actor)===e.id)return null===s||void 0===s||null===(c=s.scene)||void 0===c||null===(o=c.actionQueue)||void 0===o?void 0:o[0].intent.action}}(t,n,e);Object(_e.a)(t).forEach((function(n){if(n.type===$e.b.healthDecreaseOnMove)a===Ee.b.move&&(e.dispatch(Object(rt.h)(t.id,-5)),function(e,t,n){t.charges&&e.dispatch(Object(rt.g)(n,t))}(e,n,t.id))}))};for(c.s();!(r=c.n()).done;)o()}catch(p){c.e(p)}finally{c.f()}if("consumeItem"===n.type){var i=n.adventurerId,s=n.fromSlot,u=a.adventurers.find((function(e){return e.id===i}));if(!u)throw new Error("No adventurer ".concat(i," found"));var l=u.inventory[s];if(!l||!Object(et.c)(l.type))throw new Error("No potion found at index ".concat(s," "));var d=Object(et.b)(l.type);if("soma"===d.category){var m,b=Object(tt.a)({type:nt.a.soma,factor:null!==(m=d.effect)&&void 0!==m?m:1});e.dispatch(Object(rt.b)(i,b))}}t(n)}}},function(e){return function(e){return function(t){e(t)}}}],it=be.applyMiddleware.apply(void 0,ot),st=function(){var e=Object(r.a)(c.a.mark((function e(){var t,n=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",new Promise((function(e,n){try{var r,a=null!==t&&void 0!==t&&null!==(r=t.game)&&void 0!==r&&r.version?w(t.game.version):A,c=Object(je.composeWithDevTools)({name:"Gidletown (".concat(a,")")})(it),o=Object(be.createStore)(ct,t,c),i=Object(pe.c)(o,void 0,(function(){var t=Object(le.i)(o.getState());e({store:o,persistor:i,isHydrated:t})}))}catch(s){console.error("An error has occurred",s),n(s)}})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ut=st;!function(e){e[e.buildStructure=0]="buildStructure",e[e.upgradeStructure=1]="upgradeStructure",e[e.craftItem=2]="craftItem",e[e.studyItem=3]="studyItem"}(Be||(Be={}));var lt=function(e,t){e.completed.forEach((function(e){return function(e){if(e.callbacks.forEach((function(e){return t(e)})),e.type===Be.craftItem){var n=e.name,r={type:n},a=m.a.get("common-item-crafted",{item:r}),c=Object(Ce.d)(n);oe.b.addToast(a,ie.a.itemCrafted,c.iconImg)}}(e)}))},dt=(n(454),n(0)),mt=function(){return Object(dt.jsx)("div",{className:"loading-spinner",children:Object(j.a)(Array(5)).map((function(e,t){return Object(dt.jsx)("div",{className:"ring",children:Object(dt.jsx)("div",{className:"inner"})},t)}))})},bt=n(318),pt=n(15),jt=n(73),ht=n(334),ft=n(74),vt=n(30),gt=n(713),Ot=n(81),yt=n(17),xt=n(170),wt=n.n(xt),kt=n(319),At=n(21),Nt=n(22),Ct=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";Object(At.a)(this,e),this.shapes=void 0,this.shapes=t[n].map((function(e){var t=e.shape;return new pt.Polygon(t)}))}return Object(Nt.a)(e,[{key:"contains",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(!this.shapes||0===this.shapes.length)&&this.shapes.some((function(n){return n.contains(e,t)}))}}]),e}(),It=n(320),St=n(33),Tt=n(36),Et=function(e){return function(t){Object(St.a)(r,t);var n=Object(Tt.a)(r);function r(){return Object(At.a)(this,r),n.apply(this,arguments)}return Object(Nt.a)(r,[{key:"render",value:function(){var t=this;return Object(dt.jsx)(Es.Consumer,{children:function(n){return Object(dt.jsx)(e,Object(ge.a)(Object(ge.a)({},t.props),n))}})}}]),r}(f.Component)},qt=n(19),Rt=n(321),Dt=Object(qt.PixiComponent)("Viewport",{create:function(e){var t=new Rt.a({screenWidth:e.screenWidth,screenHeight:e.screenHeight,worldWidth:e.worldWidth,worldHeight:e.worldHeight,ticker:pt.Ticker.shared,interaction:e.app.renderer.plugins.interaction});t.on("clicked",(function(t){e.onClick&&e.onClick(t)}));var n=e.minScale,r=void 0===n?1:n,a=e.maxScale,c=void 0===a?2:a;return t.drag().pinch().wheel().clamp({direction:"all"}).clampZoom({minScale:r,maxScale:c}).decelerate(),t}}),Mt=Object(f.forwardRef)((function(e,t){var n=Object(qt.useApp)();if(n){var r="url('".concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAgCAYAAAABtRhCAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3gMODzc3YHmYGgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAE50lEQVRIx7WXW0wcVRjHfzO7y16YZbfAytACvbjU1hqkLVZMbbSXBEPUNjX6YDYanwYfTXzxrb7qm0lTJ018QhOjaWI0trFYbRoqpYVuwy2UpRS2lAF22YUdtuxt1ofKCIXShaZfMjm37+Q33zn/cxMURWHRVFXNAyiKIvCMTFwKO6Ne4ONPTpngZwoE6Lx6FYCDhwLPDLoMeKPtV8b6ewkEAssiVVU1v/gtLS+dhnUDFUUResZvUhLXuNF+ZVmkBw8F6B+4b5avXR8x82fUC+uCWhoaGsxCV1fXKZelGOvMNPcXspw9+zV60s3MzAweTwXJZBLJXYXPt8XMJ5NJbgX/pqGh4ctCgNalBUVRhId/u5tsQqf9UpDGxkZCoRCtra2mX2trK5qmAZhpoWZdrTIvCOyQihn8/RydsQSVm6uQJAnZ6zV9MjYbkUgEAL/fj6p+my9kOYmPViiKIgQn+8mLIv1jowSONtN0+OgyGEAkEkHXdTRNQ5Kkjal0qY3MJciLIsdOvslYXy9xbXxZu67rAEiSZOafCtgzfpM8Al2/deDEwJZOrYAu2lNFqKpq/rPjLTTtbWY0Psu1jovUVm7Hmk1jS6eYmXooEiH//0pYj3BWFc2RukM4HpxHMAz6x0aRvT1scfsYT0yTTwnEtXEsuQzxhbQ5j08F/O7H0+zz+ThQWsK52yGuBNs5XPcqllwOVzrOjv2HsZaXsuv1OtySnYSeort7kE+Vt56o1FWBo7EollwGQ7Sww13McHyWbE8n9VVVNLzWzMDkXSYGujl/uY1wNIamaciybO4+a0FXXRbd04P8PHydu/EYtmwaSy7NaCzOi0eO09F5kfk7/bhSSZ4T8zQ2NiLLMgCyLPPe+5+vudWtqlJFUYRF8MhsHNHIcXKnn86rfxK8P4Etk8G5kKR4YZ758F1OnDixrP9aUHGt8V6ExlMLbLP7GBoeAkGkxuWhKJfFlUoiJRNE7o0TCARM8UiS9NgjTnySqhRFEUZmR/jm5l9YsynGolG0RJQqpwd7OoU0P0dqZJD0TJyWlhZzU/D7/Txfe2wFVCxUzttLPNyaGEc0svx0+zZVW/cD4Eo/wJuIkevtwZiKLhteWZZXQAsGdk9PscluRzByODxlnL78Aw17mpDdZdizGUr0GNEbndRvKeeD5rcpLy83oRWVjeuLUFEUYTQ+jMfpwutw4CgpJVmzm6/++QVDtFDpLkU0DLxzUabbB6ir9vHGtp3mxi5JkhmluJ6zzONw/pfaMUSR0HyaL6530zYRBmBz7QFqj9YhSQ5efsXPQjxS2MJ/nJUUS8zEZ/G4nPSEQgyHLj08kCehtQuqy66w94/vEfIGNaVliEYGr6No40AAj9OBkDcYHmpb0RaO9hGO9lFdtodubQqAovQCG1IpgGgYlNlsbCqyrekXjvaZ+SlD3Dgwoc9hyWU4WP1SQf6lNbXouo6u6+ZtvmCgoihCcErDks2QCA3w4YF3ngjz+/1omsbkRMfG5nBkdoQ7bjeEe9hVVsZHe5u4FB7nXqTX9Kmvf5eKys3IskwwGGR4qG3ZW0VY+pgpxFRVze/zvcBWbylep5OMzY5hsVLsLiFd5MTqq+DedJRQKLQCtiHg0uv91k21uF1uPE4XhsVC1monlsqSmE8yOdGx6itsQ8BHwavN9+P6/Avf+1eTf20QhwAAAABJRU5ErkJggg==","'), auto");n.renderer.plugins.interaction.cursorStyles.pointer=r}return Object(dt.jsx)(Dt,Object(ge.a)(Object(ge.a)({app:n},e),{},{ref:t}))}));Mt.displayName="Viewport";var Lt=Mt,zt=n(322),Pt=n(43),Wt=["children"],Vt=function(e){var t=e.children,n=Object(Pt.a)(e,Wt);return Object(dt.jsx)(g.b.Consumer,{children:function(e){var r=e.store;return Object(dt.jsx)(qt.Stage,Object(ge.a)(Object(ge.a)({},n),{},{children:Object(dt.jsx)(g.a,{store:r,children:t})}))}})},Qt=new zt.a,Bt={autoDensity:!0,sharedLoader:!0},Gt=Object(f.forwardRef)((function(e,t){var n=e.children,r=e.screenWidth,a=e.screenHeight,c=e.worldWidth,o=e.worldHeight,i=e.blockScroll,s=Object(f.useRef)(null);return Object(f.useImperativeHandle)(t,(function(){return s.current})),Object(f.useEffect)((function(){if(Qt.enabled=!1,s.current){var e=s.current;e.on("moved",(function(){var t=Ot.b.utils.normalize(e.screenWidth,c,e.right),n=Ot.b.utils.normalize(o,e.screenHeight,e.bottom),r=Math.max(t*n-.4,0);Qt.gain=r,Qt.lacunarity=2.4,Qt.enabled=Qt.gain>0}))}var t=function(e){e.preventDefault()};return i&&window.addEventListener("wheel",t,{passive:!1}),function(){window.removeEventListener("wheel",t)}}),[i,o,c]),Object(dt.jsx)(Vt,{width:r,height:a,options:Bt,children:Object(dt.jsx)(Lt,{screenWidth:r,screenHeight:a,worldWidth:c,worldHeight:o,ref:s,children:Object(dt.jsx)(qt.Sprite,{name:"background",image:"".concat(".","/img/town/town-alpha/background.png"),filters:[Qt],children:n})})})}));Gt.displayName="TownStage";var Ft,Ht,Zt=Gt,Ut=function(){return Math.floor(2*Math.random())+1},Yt=function(){return-300*Math.random()-200},Jt=function(e){var t=e.speed,n=void 0===t?1:t,r=Object(f.useState)(Ut()),a=Object(h.a)(r,2),c=a[0],o=a[1],i="".concat(".","/img/town/clouds/cloud-0").concat(c,".png"),s=Object(f.useState)(-2e3),u=Object(h.a)(s,2),l=u[0],d=u[1],m=Object(f.useState)(Yt()),b=Object(h.a)(m,2),p=b[0],j=b[1];return Object(qt.useTick)((function(t){l>e.worldWidth?(d(2e3-1e3*Math.random()),j(Yt()),o(Ut())):d(l+n*(t||1))})),Object(dt.jsx)(qt.Sprite,{image:i,alpha:.8,x:l,y:p})},Xt=(n(456),["color","square","text"]);!function(e){e[e.auto=0]="auto",e[e.large=1]="large",e[e.medium=2]="medium",e[e.small=3]="small"}(Ft||(Ft={})),function(e){e.blue="blue",e.purple="purple",e.green="green"}(Ht||(Ht={}));var Kt,_t=function(e){var t,n,r=e.color,a=e.square,c=e.text,o=Object(Pt.a)(e,Xt),i=["button",null!==(t=e.className)&&void 0!==t?t:"","button-".concat("string"===typeof r?r:Ht[null!==r&&void 0!==r?r:Ht.blue]),"button-".concat("string"===typeof e.size?e.size:Ft[null!==(n=e.size)&&void 0!==n?n:Ft.auto]),"".concat(a?"button-square":"")];return Object(dt.jsx)("button",Object(ge.a)(Object(ge.a)({},o),{},{className:i.join(" "),onClick:function(t){var n;null===(n=e.onClick)||void 0===n||n.call(e,t)},children:Object(dt.jsxs)("span",{children:[!!c&&c,!c&&e.children]})}))},$t=function(e){var t=Object(f.useCallback)((function(t){return t.structures[e]}),[e]);return Object(g.d)(t)},en=function(e){var t=J(e);if(!t)throw new Error("No definition found for structure ".concat(e,"."));return t},tn=function(e){var t=$t(e).level;return en(e).levels[t]},nn=function(e){return Object(f.useEffect)((function(){return yt.c.musicFiltered=!0,function(){yt.c.musicFiltered=!1}})),Object(dt.jsxs)("div",{className:"window",children:[Object(dt.jsxs)("div",{className:"header",children:[!1!==e.backEnabled&&Object(dt.jsx)(_t,{className:"back-button",onClick:function(t){e.onBack&&(null===e||void 0===e||e.onBack(),yt.c.playSound("ui/buttonClick"))},square:!0,size:"medium",color:"purple",text:"<"}),Object(dt.jsx)("h3",{children:e.title}),!1!==e.closeEnabled&&Object(dt.jsx)(_t,{className:"close-button",onClick:function(t){e.onClose&&(null===e||void 0===e||e.onClose(),yt.c.playSound("ui/buttonClick"))},square:!0,size:"medium",color:"purple",text:"x"})]}),e.children]})},rn=(n(457),function(e){return function(t){Object(St.a)(r,t);var n=Object(Tt.a)(r);function r(){return Object(At.a)(this,r),n.apply(this,arguments)}return Object(Nt.a)(r,[{key:"render",value:function(){return Object(dt.jsx)(nn,Object(ge.a)(Object(ge.a)({},this.props),{},{children:Object(dt.jsx)(e,Object(ge.a)({},this.props))}))}}]),r}(f.Component)}),an=n(150);n(458);!function(e){e[e.increasing=0]="increasing",e[e.decreasing=1]="decreasing"}(Kt||(Kt={}));var cn,on=function(e){var t=e.className,n=void 0===t?"":t,r=e.animationTime,a=e.variation,c=void 0===a?"normal":a,o=Object(f.useRef)(0),i=Object(an.a)(e.progress||0,0,1);return o.current=i,Object(dt.jsxs)("div",{className:"progressbar progressbar--variation-".concat(c," ").concat(n),children:[Object(dt.jsx)("div",{className:"progressbar-label",children:e.label}),Object(dt.jsx)("div",{className:"progressbar-bar",style:Object(ge.a)({width:"".concat(100*i,"%")},r&&{transition:"width ".concat(r,"ms linear")})})]})},sn=function(){return Object(g.d)((function(e){return e.engine}))},un=function(e){var t=Object(f.useRef)();return Object(f.useEffect)((function(){t.current=e}),[e]),t.current};!function(e){e[e.increasing=0]="increasing",e[e.decreasing=1]="decreasing"}(cn||(cn={}));var ln,dn=function(e){var t=e.className,n=void 0===t?"":t,r=e.label,a=e.direction,c=e.progress,o=void 0===c?0:c,i=un(o)||0,s=function(){var e=sn();return Date.now()-e.previousTick}(),u=Object(f.useState)(!1),l=Object(h.a)(u,2),d=l[0],m=l[1];return Object(f.useEffect)((function(){m(void 0===a||a===cn.increasing&&o>i||a===cn.decreasing&&o<i)}),[a,i,o]),Object(dt.jsx)(on,{progress:o,label:r,className:n,animationTime:d?s:0})},mn=function(e){return e.tasks},bn=function(e){return Object(g.d)(function(e){return Object($.a)([mn],(function(t){return t.running.filter((function(t){return t.origin==="".concat(e,".craft")}))}))}(e))},pn=function(e){return Object(g.d)(function(e){return Object($.a)([mn],(function(t){return t.running.filter((function(t){return t.origin==="".concat(e,".study")}))}))}(e))},jn=function(e){return Object(g.d)(function(e){return Object($.a)([mn],(function(t){return t.running.filter((function(t){return t.name==="".concat(e,".upgrade")}))}))}(e))},hn=(n(459),function(e){return Object(dt.jsx)("div",{className:"structureview-header structureview-header-".concat(e.structure)})}),fn=n(26),vn=(n(460),["iconImg","children"]),gn=function(e){var t,n,r=e.iconImg,a=e.children,c=Object(Pt.a)(e,vn),o=["icon-button",null!==(t=e.className)&&void 0!==t?t:"","size-".concat("string"===typeof e.size?e.size:fn.a[null!==(n=e.size)&&void 0!==n?n:fn.a.medium])];return Object(dt.jsxs)("button",Object(ge.a)(Object(ge.a)({},c),{},{className:o.join(" "),children:[Object(dt.jsx)(fn.b,{image:r,size:e.size}),a&&Object(dt.jsx)("div",{className:"text",children:a})]}))},On=(n(461),function(e){var t=e.structure,n=e.onHelpClicked,r=Object(g.c)(),a=$t(t).level,c=en(t).levels[a+1],o=null==c?m.a.get("ui-structure-upgrade-max"):m.a.get("ui-structure-upgrade",{level:a+2}),i=jn(t);if(i.length){var s=i[0];return Object(dt.jsxs)("div",{className:"upgrade-progress-container",children:[Object(dt.jsx)(dn,{className:"upgrading",label:"".concat(m.a.get("structure-upgrade-button-upgrading")," (").concat(Object(C.i)(s.timeRemaining),")"),progress:s.progress},"".concat(s.name).concat(s.startTime)),Object(dt.jsx)(gn,{iconImg:"/img/ui/misc/clock.png",size:"smallest",onClick:function(){i.length&&r(O(50,"task",i[0].name))},children:"50%"})]})}return Object(dt.jsxs)("div",{className:"upgrade-stucture-button",children:[Object(dt.jsxs)("label",{children:[m.a.get("ui-structure-level"),a+1]}),Object(dt.jsx)(_t,{className:"upgrade",onClick:n,disabled:null==c,children:o})]})}),yn=n(323),xn=n.n(yn),wn=n(89),kn="tooltipContextUpdated",An=function(e){Object(St.a)(n,e);var t=Object(Tt.a)(n);function n(){return Object(At.a)(this,n),t.apply(this,arguments)}return Object(Nt.a)(n,null,[{key:"showContextTooltip",value:function(e,t,n,r,a){var c={type:e,info:t,referenceRect:n,className:r,source:a};xn()(c,this.lastContext)?this.clear():(this.instance.emit(kn,c),this.lastContext=c)}},{key:"clear",value:function(){this.instance.emit(kn,void 0),this.lastContext=void 0}},{key:"instance",get:function(){return this._instance}}]),n}(n.n(wn).a);An._instance=new An,An.lastContext=void 0,function(e){e[e.actor=0]="actor",e[e.attribute=1]="attribute",e[e.component=2]="component",e[e.item=3]="item",e[e.resource=4]="resource",e[e.skill=5]="skill",e[e.tempEffect=6]="tempEffect",e[e.trait=7]="trait"}(ln||(ln={}));var Nn=n(25),Cn=function e(t){switch(t){case Nn.a.common:return"item-icon-common";case Nn.a.uncommon:return"item-icon-uncommon";case Nn.a.rare:return"item-icon-rare";case Nn.a.epic:return"item-icon-epic";case Nn.a.legendary:return"item-icon-legendary"}return e(Nn.a.common)},In=function e(t){switch(t){case fn.a.smallest:return"item-icon-size-smallest";case fn.a.small:return"item-icon-size-small";case fn.a.medium:return"item-icon-size-medium";case fn.a.big:return"item-icon-size-big";case fn.a.biggest:return"item-icon-size-biggest"}return e(fn.a.medium)},Sn=(n(490),function(e){var t=e.item,n=e.size,r=e.source,a=Object(Ce.d)(t.type);if(!a)throw new Error("could not find definition for ".concat(t));var c="item-icon ".concat(Cn(a.rarity)," ").concat(In(n));return Object(dt.jsxs)("div",{className:c,children:[Object(dt.jsx)(fn.b,{image:a.iconImg,size:e.size,onClick:function(n){if(!1!==e.showContext){var a=n.currentTarget.getBoundingClientRect();An.showContextTooltip(ln.item,t,a,void 0,r),n.stopPropagation()}e.onClick&&e.onClick(n)}}),t.quantity&&t.quantity>1&&Object(dt.jsx)("div",{className:"quantity",children:t.quantity})]})}),Tn=(n(491),function(e){var t;return t=null==e.max?e.value:Object(dt.jsxs)("span",{children:[e.value," / ",Object(dt.jsx)("span",{className:"max",children:e.max})]}),Object(dt.jsxs)("div",{className:"updownvalue",children:[Object(dt.jsxs)("label",{children:[" ",e.label]}),t,Object(dt.jsx)("i",{className:"arrow up"+(e.upDisabled?" disabled":""),onClick:function(t){e.onUp&&!e.upDisabled&&e.onUp(t)}}),Object(dt.jsx)("i",{className:"arrow down"+(e.downDisabled?" disabled":""),onClick:function(t){e.onDown&&!e.downDisabled&&e.onDown(t)}})]})}),En=function(){return Object(g.d)((function(e){return e.stockpile}))},qn=function(){var e=En();return Object(f.useMemo)((function(){return Object.values(e).flat()}),[e])},Rn=(n(492),function(e){var t=e.items,n=(e.className||"")+" items-box",r=t.reduce((function(e,t){return e[t]||(e[t]=0),e[t]++,e}),{}),a=qn(),c=Object(f.useMemo)((function(){var e=Object(j.a)(a),n=[];return t.forEach((function(t){var r=e.findIndex((function(e){return e===t}));if(r>-1){var a=e.splice(r,1),c=Object(h.a)(a,1)[0];c&&n.push(c)}})),n}),[t,a]),o=Object.keys(r).map((function(e){var t=e,n=r[e],a="item";n>(c?c.filter((function(e){return e===t})).length:0)&&(a+=" missing");var o=Object(Ce.d)(t);return Object(dt.jsxs)("li",{className:a,children:[Object(dt.jsx)(fn.b,{image:o.iconImg,size:"smallest"}),Object(dt.jsx)("div",{className:"name",children:"".concat(m.a.getItemName(t)," (").concat(n,")")})]},t)}));return Object(dt.jsx)("ul",{className:n,children:o})}),Dn=function(){return Object(g.d)((function(e){return e.resources}))},Mn=function(){return Object(g.d)(ee)},Ln=function(){return Object(g.d)((function(e){return e.gold}))},zn=(n(493),function(e){var t=e.resources,n=e.gold,r=Dn(),a=Object(f.useMemo)((function(){return Object.keys(t).reduce((function(e,n){var a=n;return e[n]=r[a]>=t[a],e}),{})}),[t,r]),c=Ln(),o=void 0===n||c>=n,i=(e.className||"")+" resources-cost",s=Object.keys(e.resources).map((function(t){var n=t,r="resource";a&&!a[n]&&(r+=" insufficient");var c=H[n];if(!c)throw new Error("No resource description found for ".concat(n));return Object(dt.jsxs)("li",{className:r,children:[Object(dt.jsx)(fn.b,{image:c.iconImg,size:"smallest",onClick:function(e){var t=e.currentTarget.getBoundingClientRect();An.showContextTooltip(ln.resource,n,t),e.stopPropagation()}}),Object(dt.jsx)("div",{className:"name",children:m.a.getResourceName(n)}),Object(dt.jsx)("div",{className:"amount",children:e.resources[n]})]},n)}));return Object(dt.jsxs)("ul",{className:i,children:[s,n&&Object(dt.jsxs)("li",{className:["gold"].concat(Object(j.a)(o?[]:["insufficient"])).join(" "),children:[Object(dt.jsx)(fn.b,{image:"img/resources/gold.png",size:"smallest"}),Object(dt.jsx)("div",{className:"name",children:m.a.get("resource-gold-name")}),Object(dt.jsx)("div",{className:"amount",children:n})]})]})}),Pn=Object($.a)([function(e){return e.structures},function(e){return e.workers}],(function(e,t){return t-Object.keys(e).map((function(t){return e[t]})).reduce((function(e,t){return e+t.workers}),0)})),Wn=function(){return Object(g.d)(Pn)},Vn=function(e,t){if(t>6)throw new Error("Cannot possibly have more than ".concat(6," on one item!"));return e-.1*e*(t-1)},Qn={"weapon/aegisOfValor":{item:{type:"weapon/aegisOfValor"},levelRequired:3,cost:{resources:{wood:20,iron:5},time:C.c}},"weapon/arbalest":{item:{type:"weapon/arbalest"},cost:{resources:{wood:20,iron:5},time:C.c}},"weapon/battleAxe":{item:{type:"weapon/battleAxe"},cost:{resources:{wood:20,iron:5},time:C.c}},"weapon/berserkerShield":{item:{type:"weapon/berserkerShield"},levelRequired:2,cost:{resources:{wood:20,iron:5},time:C.c}},"weapon/brassKnuckles":{item:{type:"weapon/brassKnuckles"},cost:{resources:{wood:20,iron:5},time:C.c}},"weapon/simpleCrossbow":{item:{type:"weapon/simpleCrossbow"},cost:{resources:{wood:20,iron:5},time:C.c}},"weapon/cleaver":{item:{type:"weapon/cleaver"},cost:{resources:{wood:10,iron:15},time:C.c}},"weapon/club":{item:{type:"weapon/club"},cost:{resources:{wood:30},time:C.c}},"weapon/dagger":{item:{type:"weapon/dagger"},cost:{resources:{wood:10,iron:10},time:C.d}},"weapon/flail":{item:{type:"weapon/flail"},cost:{resources:{wood:10,iron:10},time:C.d}},"weapon/goldenShield":{item:{type:"weapon/goldenShield"},levelRequired:2,cost:{resources:{wood:20,iron:5},time:C.c}},"weapon/javelin":{item:{type:"weapon/javelin"},cost:{resources:{wood:20,iron:10},time:C.d+C.c}},"weapon/khopesh":{item:{type:"weapon/khopesh"},cost:{resources:{wood:15,iron:40},time:C.g}},"weapon/longbow":{item:{type:"weapon/longbow"},cost:{resources:{wood:40,iron:5},time:C.d}},"weapon/mace":{item:{type:"weapon/mace"},cost:{resources:{wood:15,iron:10},time:C.d}},"weapon/morningStar":{item:{type:"weapon/morningStar"},cost:{resources:{wood:15,iron:15},time:C.d}},"weapon/paintedBuckler":{item:{type:"weapon/paintedBuckler"},cost:{resources:{wood:20,iron:10},time:C.d+C.c}},"weapon/poisonedDagger":{item:{type:"weapon/poisonedDagger"},cost:{resources:{wood:50,iron:15},materials:["material/poisonVial"],time:C.d}},"weapon/ravenStaff":{item:{type:"weapon/ravenStaff"},cost:{resources:{wood:15,iron:10,food:5},time:C.d}},"weapon/savageStaff":{item:{type:"weapon/savageStaff"},cost:{resources:{wood:15,iron:10,food:5},time:C.d}},"weapon/spear":{item:{type:"weapon/spear"},cost:{resources:{wood:15,iron:15},time:C.d}},"weapon/steelShield":{item:{type:"weapon/steelShield"},cost:{resources:{wood:15,iron:15},time:C.d}},"weapon/steelSword":{item:{type:"weapon/steelSword"},cost:{resources:{wood:10,iron:30},time:C.d}},"weapon/warhammer":{item:{type:"weapon/warhammer"},cost:{resources:{wood:10,iron:30},time:C.d}},"weapon/woodenBulwark":{item:{type:"weapon/woodenBulwark"},cost:{resources:{wood:10,iron:30},time:C.d}}},Bn=Qn,Gn={"apparel/boots1":{item:{type:"apparel/boots1"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/boots2":{item:{type:"apparel/boots2"},cost:{resources:{wood:10,iron:45},time:C.d},levelRequired:2},"apparel/boots3":{item:{type:"apparel/boots3"},cost:{resources:{wood:10,iron:45},time:C.d},levelRequired:3},"apparel/chainmailHood":{item:{type:"apparel/chainmailHood"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/chest":{item:{type:"apparel/chest"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/clothGloves":{item:{type:"apparel/clothGloves"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/cowl":{item:{type:"apparel/cowl"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/druidChest":{item:{type:"apparel/druidHands"},cost:{resources:{wood:10,iron:45},time:C.d},levelRequired:2},"apparel/druidFeet":{item:{type:"apparel/druidFeet"},cost:{resources:{wood:10,iron:45},time:C.d},levelRequired:2},"apparel/druidHands":{item:{type:"apparel/druidHands"},cost:{resources:{wood:10,iron:45},time:C.d},levelRequired:2},"apparel/druidHead":{item:{type:"apparel/druidHead"},cost:{resources:{wood:10,iron:45},time:C.d},levelRequired:2},"apparel/druidLegs":{item:{type:"apparel/druidLegs"},cost:{resources:{wood:10,iron:45},time:C.d},levelRequired:2},"apparel/fedora":{item:{type:"apparel/fedora"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/greaves1":{item:{type:"apparel/greaves1"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/greaves2":{item:{type:"apparel/greaves2"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/hornedHelmet":{item:{type:"apparel/hornedHelmet"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/leatherGloves":{item:{type:"apparel/leatherGloves"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/nomadHelmet":{item:{type:"apparel/nomadHelmet"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/pants1":{item:{type:"apparel/pants1"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/pants2":{item:{type:"apparel/pants2"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/plateChest1":{item:{type:"apparel/plateChest1"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/plateChest2":{item:{type:"apparel/plateChest2"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/plateChest3":{item:{type:"apparel/plateChest3"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/plateChest4":{item:{type:"apparel/plateChest4"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/plateGloves1":{item:{type:"apparel/plateGloves1"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/plateGloves2":{item:{type:"apparel/plateGloves2"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/plateHelmet":{item:{type:"apparel/plateHelmet"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/platePants":{item:{type:"apparel/platePants"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/plateShoulders1":{item:{type:"apparel/plateShoulders1"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/plateShoulders2":{item:{type:"apparel/plateShoulders2"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/robe":{item:{type:"apparel/robe"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/shoulders1":{item:{type:"apparel/shoulders1"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/shoulders2":{item:{type:"apparel/shoulders2"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/shoulders3":{item:{type:"apparel/shoulders3"},cost:{resources:{wood:10,iron:45},time:C.d}},"apparel/vest":{item:{type:"apparel/vest"},cost:{resources:{wood:10,iron:45},time:C.d}}},Fn={"questItem/torch":{item:{type:"questItem/torch"},cost:{resources:{wood:2,fabric:1},time:C.e}},"questItem/sandwich":{item:{type:"questItem/sandwich"},cost:{resources:{food:1},time:C.e/2}}},Hn=n(55),Zn=n(76),Un=n(121),Yn=Object(ge.a)(Object(ge.a)(Object(ge.a)({},Gn),Bn),Fn),Jn=function(e){return Yn[e]},Xn=function(e,t){return{type:"addItem",item:e,toSlot:t}},Kn=function(e,t,n){return{type:"moveItemInWarehouse",itemCategory:e,fromSlot:t,toSlot:n}},_n=function(e,t){return{type:"removeItem",itemCategory:e,fromSlot:t}},$n=function(e){return{type:"addResources",resources:e}},er=function(e){return{type:"removeResources",resources:e}},tr=function(e){return{type:"finishBuildingStructure",structure:e}},nr=function(e){return{type:"upgradeStructure",structure:e}},rr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:"increaseWorkers",structure:e,workers:t}},ar=function(e,t){return{type:"setStructureState",structure:e,state:t}},cr=function(e,t){return{type:"addItemToToProduces",structure:e,item:t}};function or(e,t,n,r,a){return{type:"start",taskType:e,name:t,origin:n,time:r,callbacks:a}}var ir,sr=function(e){var t=e.item,n=e.structure,r=Object(g.c)(),a=Dn(),c=qn(),o=Wn(),i=Object(f.useState)(0),s=Object(h.a)(i,2),u=s[0],l=s[1],d=Jn(t),b=d.cost.resources||{},p=Object.keys(b).some((function(e){var t=e;return b[t]>a[t]})),j=!1,v=d.cost.materials;v&&(j=v.some((function(e){return-1===c.indexOf(e)})));var O=p||j||u<1;return Object(dt.jsxs)("div",{className:"crafting-details",children:[m.a.get("ui-structure-production-craft-a",{item:t}),Object(dt.jsxs)("div",{className:"crafting-costs",children:[Object(dt.jsx)("fieldset",{children:Object(dt.jsx)(zn,{resources:b})}),Object(dt.jsx)("fieldset",{children:v&&Object(dt.jsx)(Rn,{items:v})})]}),Object(dt.jsxs)("div",{className:"buttonrow",children:[Object(dt.jsxs)("div",{children:[Object(dt.jsx)(Tn,{value:u,label:m.a.get("ui-structure-production-workers"),onUp:function(e){e.stopPropagation(),l(u+1)},onDown:function(e){e.stopPropagation(),l(u-1)},upDisabled:u>=o||u>=6,downDisabled:u<1}),function(e){if(0===u)return"";var t=Vn(e,u),n=Object(C.i)(t);return m.a.get("ui-structure-production-crafting-time",{time:n})}(d.cost.time||0)]}),Object(dt.jsx)("div",{children:Object(dt.jsx)(_t,{disabled:O,className:"craft",onClick:function(e){e.stopPropagation(),function(e,t){var a=Vn(e.cost.time||0,t);r(er(e.cost.resources||{})),r(rr(n,t));var c=[Xn(e.item),rr(n,t)],o=or(Be.craftItem,e.item.type,"".concat(n,".craft"),a,c);r(o)}(d,u),l(0)},children:m.a.get("ui-structure-production-craft")})})]})]})},ur=function(e){var t=e.structure,n=Object(f.useState)(),r=Object(h.a)(n,2),a=r[0],c=r[1],o=$t(t);return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsxs)("div",{children:[" ",m.a.get("ui-structure-production-craft")]}),Object(dt.jsxs)("div",{className:"crafting-area",children:[Object(dt.jsx)("ul",{className:"vertical-tab-bar",children:o.produces.map((function(e){return Object(dt.jsxs)("li",{onClick:function(){c(e)},className:a===e?"selected":"",children:[Object(dt.jsx)(Sn,{item:{type:e},size:fn.a.smallest}),m.a.getItemName(e)]},"craft".concat(e))}))}),a&&Object(dt.jsx)(sr,{item:a,structure:t})]})]})},lr=n(113),dr=(n(494),function(e){var t=e.structure,n=e.level,r=e.addUpgradeCallbacks,a=e.children,c=Object(g.c)(),o=en(t).levels[n+1],i=o.cost.time,s=Ln(),u=null!=o?o.cost.gold||0:-1,l=u>s,d=Dn(),b=o.cost.resources||{},p=Object.keys(b).some((function(e){var t,n,r=e;return(null!==(t=b[r])&&void 0!==t?t:0)>(null!==(n=null===d||void 0===d?void 0:d[r])&&void 0!==n?n:0)})),h=null!=o&&!l&&!p;return Object(dt.jsxs)("div",{className:"structure-upgrade-help-modal",children:[Object(dt.jsxs)("div",{className:"top",children:[Object(dt.jsx)("h3",{children:m.a.get("ui-structure-help-upgrade-title",{structure:t})}),Object(dt.jsx)("div",{className:"level",children:m.a.get("ui-structure-help-upgrade-header-level",{level:n+2})})]}),Object(dt.jsxs)("div",{className:"cost",children:[Object(dt.jsx)("h3",{children:"Costs"}),o.cost.resources&&Object(dt.jsx)(zn,{resources:o.cost.resources,gold:o.cost.gold,className:"wrap"})]}),Object(dt.jsx)(_t,{className:"start",onClick:function(){var e;c(Object(lr.b)(u)),c(er(b));var a=[].concat(Object(j.a)((null===r||void 0===r?void 0:r(n+1))||[]),[nr(t),Object(x.b)("log-town-upgrade-structure-complete",{level:n+1,structure:t},ae.a.town)]),i=or(Be.upgradeStructure,"".concat(t,".upgrade"),"town",null!==(e=o.cost.time)&&void 0!==e?e:0,a);c(i)},disabled:!h,children:m.a.get("ui-structure-help-upgrade-start",{time:Object(C.i)(null!==i&&void 0!==i?i:0)})}),a]})}),mr=(n(495),function(e){var t=e.level,n=e.structure,r=en(n).levels[t+1];return Object(dt.jsxs)("div",{className:"upgrade-help-model-content-production",children:[Object(dt.jsx)("h3",{children:m.a.get("ui-structure-help-upgrade-unlocks-crafting")}),Object(dt.jsx)("div",{className:"unlocks",children:r.unlocks.map((function(e){return t=e,Object(dt.jsx)(Sn,{item:{type:t},size:fn.a.small},t);var t}))})]})}),br=(n(496),function(e){var t=e.structure,n=$t(t).level,r=bn(t),a=pn(t),c=en(e.structure);Object(f.useEffect)((function(){return"armoursmith"!==t&&"weaponsmith"!==t||yt.c.addSound("ambient/structure/smith","sound/structures/smith.ogg",(function(){yt.c.playSound("ambient/structure/smith",yt.a.ambient,!0)})),"alchemist"===t&&yt.c.addSound("ambient/structure/alchemist","sound/structures/alchemist.ogg",(function(){yt.c.playSound("ambient/structure/alchemist",yt.a.ambient,!0)})),function(){return yt.c.fadeOutSound(yt.a.ambient)}}),[t]);var o=function(e){return c.levels[e].unlocks.map((function(e){return cr(t,e)}))};return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)(hn,{structure:e.structure}),Object(dt.jsx)("div",{className:"production-structure-view",children:Object(dt.jsxs)("section",{children:[Object(dt.jsx)(On,{structure:t,onHelpClicked:function(e){var r=e.currentTarget.getBoundingClientRect(),a=Object(dt.jsx)(dr,{level:n,structure:t,addUpgradeCallbacks:o,children:Object(dt.jsx)(mr,{level:n,structure:t})});An.showContextTooltip(ln.component,a,r,"upgrade-structure-tooltip"),e.stopPropagation()}}),Object(dt.jsx)(ur,{structure:t}),Object(dt.jsxs)("fieldset",{children:[Object(dt.jsx)("legend",{children:m.a.get("ui-structure-production-crafting")}),r.map((function(e){return Object(dt.jsx)(dn,{label:"".concat(m.a.getItemName(e.name)," (").concat(Object(C.i)(e.timeRemaining),")"),progress:e.progress},"".concat(e.name).concat(e.startTime))}))]}),a.length>0&&Object(dt.jsxs)("fieldset",{children:[Object(dt.jsx)("legend",{children:m.a.get("ui-structure-production-studying")}),a.map((function(e){return Object(dt.jsx)(dn,{label:"".concat(m.a.getItemName(e.name)," (").concat(Object(C.i)(e.timeRemaining),")"),progress:e.progress},"".concat(e.name).concat(e.startTime))}))]})]})})]})}),pr=n(714),jr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.round((e+Number.EPSILON)*Math.pow(10,t))/Math.pow(10,t)},hr=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=["","k","M","G","T","P","E"],r=Math.log10(e)/3|0;if(0===r)return jr(e,t)+"";var a=n[r],c=Math.pow(10,3*r),o=e/c;return jr(o,t)+a},fr=n(82),vr=(n(497),function(e){var t=e.resources,n=e.deltaResources,r=Object(g.d)((function(e){return e.structures})),a="resources-box ".concat(e.className||""),c=Object(f.useRef)(null);return Object(dt.jsx)("div",{className:a,ref:c,children:Object.keys(t).map((function(t){var a,o,i=t,s=H[i],u=e.resources[i]||0;if(!s)throw new Error("No resource description found for ".concat(i));if(n[i]){var l,d,b=null===(l=c.current)||void 0===l?void 0:l.querySelector('[data-resource="'.concat(i,'"] .amount')),p=null===b||void 0===b?void 0:b.getBoundingClientRect(),j=new pt.Point(null===p||void 0===p?void 0:p.right,null===p||void 0===p?void 0:p.top);fr.b.addBubble("+ ".concat(null===(d=n[i])||void 0===d?void 0:d.toFixed(2)),j,fr.c.resource,fr.a.general)}var h=X(T[i]),f=u>=(null!==(a=null===(o=e.maxResources)||void 0===o?void 0:o[i])&&void 0!==a?a:0);return Object(dt.jsxs)("div",{className:"row","data-resource":i,children:[Object(dt.jsx)(fn.b,{image:s.iconImg,size:"smallest"}),Object(dt.jsx)("div",{className:"name",children:m.a.getResourceName(i)}),Object(dt.jsx)("div",{className:"amount".concat(f?" full":""),children:hr(u,0)}),Object(dt.jsx)("div",{className:"max",children:" /".concat(e.maxResources[i])}),Object(dt.jsx)("div",{className:"structure",children:r[h].state===ye.Built?Object(dt.jsx)(pr.a,{children:m.a.get("ui-structure-warehouse-resources-source-link",{structure:h})}):Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)(pr.a,{children:m.a.get("ui-structure-warehouse-resources-source",{structure:h})}),Object(dt.jsx)("span",{className:"unbuilt",children:m.a.get("ui-structure-warehouse-resources-source-unbuilt")})]})})]},i)}))})}),gr={fabric:0,food:0,iron:0,leather:0,stone:0,wood:0},Or=(n(502),function(e){var t=e.activeTab,n=void 0===t?null:t,r=e.onClick,a=Object(f.useState)(!1),c=Object(h.a)(a,2),o=c[0],i=c[1];!n&&e.children&&e.children;var s="".concat(e.className).concat(e.disabled?" disabled":""),u=v.a.Children.map(e.children,(function(t){return v.a.cloneElement(t,{active:t.props.id===n,onClick:function(){var n;n=t.props.id,e.onTabSelected&&!0!==e.disabled&&e.onTabSelected(n)}})}));return Object(dt.jsx)(dt.Fragment,{children:Object(dt.jsxs)("ul",{className:"tabstrip ".concat(null!==s&&void 0!==s?s:""),onClick:function(e){yt.c.playSound("ui/buttonClick"),null===r||void 0===r||r(e),i(!o)},children:[Object(dt.jsx)("input",{type:"checkbox",className:"open",id:"open",checked:o,onChange:function(){return i(!o)}}),u]})})}),yr=function(e){var t=(e.active?"active":"")+(e.className||"");return Object(dt.jsx)("li",{className:"tabstrip-tab ".concat(t),onClick:function(t){e.onClick&&e.onClick(t)},children:e.children})},xr=(n(503),function(e){var t=e.adventurer,n=e.size,r="".concat(e.className||""," avatar");return Object(dt.jsx)(fn.b,{className:r,image:t.avatarImg,size:n,onClick:function(){e.onClick&&e.onClick(e.adventurer.id)}})}),wr=function(e){var t=e.adventurers,n=e.onAdventurerTabSelected;return Object(dt.jsx)(Or,{className:"adventurers-tabstrip",onTabSelected:function(t){var r=e.adventurers.find((function(e){return e.id===t}));r&&n(r.id)},activeTab:e.selectedAdventurerId,disabled:e.disabled,children:t.map((function(e){return t=e,Object(dt.jsx)(yr,{id:t.id,children:Object(dt.jsx)(xr,{adventurer:t,size:fn.a.small})},t.id);var t}))})},kr=n(37),Ar=n(35),Nr=n(6),Cr=function(e){var t=e.item,n=e.disabled,r=e.sourceId,a=e.dependencies,c=void 0===a?[]:a,o=e.canDropHere,i=e.onDrop,s=Object(jt.useDrop)((function(){return{accept:Ar.b.ITEM,collect:function(e){return{canDrop:e.canDrop(),isOver:e.isOver()}},canDrop:function(e){var n;return e.sourceType===Ar.a.adventurerEquipment&&void 0!==e.inventorySlot?null==t||Object(Nr.c)(t.type,e.inventorySlot):null===(n=null===o||void 0===o?void 0:o(e))||void 0===n||n},drop:function(e){return i(e)}}}),[r].concat(Object(j.a)(c))),u=Object(h.a)(s,2),l=u[0],d=l.isOver,m=l.canDrop,b=u[1],p=d&&m,f=["inventory-item"].concat(Object(j.a)(n?["disabled"]:[]),Object(j.a)(p?["drop-active"]:[]),Object(j.a)(!p&&m?["drop-possible"]:[])).join(" ");return Object(dt.jsx)("div",{className:f,ref:b,children:e.children})},Ir=function(e){var t=e.item,n=e.onClick,r=e.size,a=e.index,c=e.sourceType,o=e.sourceId,i=Object(jt.useDrag)((function(){return{type:Ar.b.ITEM,item:{inventorySlot:a,item:t,sourceId:o,sourceType:c}}}),[t]),s=Object(h.a)(i,2),u=s[0],l=s[1],d=Object(f.useMemo)((function(){return{origin:c,id:o,slot:a}}),[a,o,c]);return u.isDragging?null:Object(dt.jsx)("div",{ref:l,children:Object(dt.jsx)(Sn,{item:t,source:d,onClick:function(e){null===n||void 0===n||n(e)},size:r})})},Sr=(n(504),function(e){for(var t=e.items,n=e.disabledIndex,r=e.sourceId,a=e.sourceType,c=e.iconSize,o=e.canDropHere,i=e.onStartDrag,s=[],u=function(u){var l=void 0,d=t[u];d&&(l=Object(dt.jsx)(Ir,{index:u,sourceId:r,sourceType:a,item:d,onStartDrag:function(){d&&(null===i||void 0===i||i(d,u))}}));var m=Object(dt.jsx)(Cr,{item:d,size:c,disabled:n===u,sourceId:r,onDrop:function(t){if((t.inventorySlot!==u||t.sourceType!==e.sourceType||t.sourceId!==e.sourceId)&&e.onDropItem&&void 0!==t.inventorySlot){var n=t.inventorySlot;e.onDropItem(t.item,n,u,t.sourceType,t.sourceId)}},canDropHere:function(e){return!o||o(e)},dependencies:[t],children:l},"inventory-slot-".concat(u));s.push(m)},l=0;l<t.length;l++)u(l);return Object(dt.jsx)("div",{className:"inventory ".concat(e.className?e.className:""),children:s})}),Tr=n(122),Er=Object(f.createContext)(null),qr=function(e){var t=e.questName,n=e.children,r=Object(g.e)(),a=Object(f.useState)(!1),c=Object(h.a)(a,2),o=c[0],i=c[1],s=r.getState().quests.find((function(e){return e.name===t}));if(!s)throw Error("No quest found");var u=s.scene,l=s.sceneName,d=s.questVars,m=un(d),b=Object(f.useMemo)((function(){return l?Tr.a.getSceneController(t,l,r):null}),[t,l,r]);return Object(f.useEffect)((function(){if(i(!1),l&&b&&!b.dataLoading){b.loadData((function(){i(!0),!u&&b&&b.createScene(),b.sceneEntered()}))}return function(){null===b||void 0===b||b.sceneExited()}}),[b,t,u,l]),Object(f.useEffect)((function(){d!==m&&null!==b&&void 0!==b&&b.dataLoadComplete&&b.updateScene()}),[b,m,d]),!b||!b.dataLoading&&o?Object(dt.jsx)(Er.Provider,{value:b,children:n}):Object(dt.jsx)(mt,{})},Rr=function(){var e=Object(g.c)(),t=Object(f.useContext)(Er),n=En();return{dropItemEquipment:function(t,n,r){var a=t.item,c=[];switch(yt.c.playSound("ui/equip"),t.sourceType){case Ar.a.adventurerInventory:var o;c.push(Object(rt.k)(r.id,null!==(o=t.inventorySlot)&&void 0!==o?o:-1),Object(rt.d)(r.id,n,a));var i,s=r.equipment[n];if(s)c.push(Object(rt.a)(r.id,s,null!==(i=t.inventorySlot)&&void 0!==i?i:-1));break;case Ar.a.warehouse:var u,l=Object(Ce.d)(a.type);c.push(_n(l.itemCategory,null!==(u=t.inventorySlot)&&void 0!==u?u:-1),Object(rt.d)(r.id,n,a));var d,m=r.equipment[n];if(m)c.push(Xn(m,null!==(d=t.inventorySlot)&&void 0!==d?d:-1));break;case Ar.a.adventurerEquipment:var b;c.push(Object(rt.d)(r.id,n,a));var p=r.equipment[n],j=null!==(b=t.inventorySlot)&&void 0!==b?b:-1;p?c.push(Object(rt.d)(r.id,j,p)):c.push(Object(rt.j)(r.id,j))}c.forEach((function(t){return e(t)}))},dropItemInventory:function(n,r,a,c,o,i){var s=[];switch(c){case Ar.a.adventurerInventory:s.push(Object(rt.i)(o.id,r,a));break;case Ar.a.warehouse:var u=Object(Ce.d)(n.type);s.push(_n(u.itemCategory,r),Object(rt.a)(o.id,n,a));var l=o.inventory[a];l&&s.push(Xn(l,r));break;case Ar.a.adventurerEquipment:s.push(Object(rt.a)(o.id,n,a));var d=o.inventory[a];d?s.push(Object(rt.d)(o.id,r,d)):s.push(Object(rt.j)(o.id,r));break;case Ar.a.lootCache:t&&i&&t.takeItemFromCache(r,i,o.id,a)}s.forEach((function(t){return e(t)}))},dropItemWarehouse:function(t,r,a,c){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i=[],s=Object(Ce.d)(t.type),u=Ne.a[s.itemCategory];switch(c){case Ar.a.warehouse:i.push(Kn(s.itemCategory,r,a));var l=n[u][a];l&&i.push(Object(rt.a)(o,l,r));break;case Ar.a.adventurerInventory:i.push(Object(rt.k)(o,r),Xn(t,a));var d=n[u][a];d&&i.push(Object(rt.a)(o,d,r));break;case Ar.a.adventurerEquipment:i.push(Object(rt.j)(o,r),Xn(t,a));var m=n[u][a];m&&i.push(Object(rt.d)(o,r,m))}i.forEach((function(t){return e(t)}))}}},Dr=(n(511),function(e){var t=e.adventurerId,n=Object(kr.a)(t).xp,r=Object(Le.c)(n),a=Object(Le.b)(r),c=r+1,o=Object(Le.b)(c),i=Object(f.useState)(!1),s=Object(h.a)(i,2),u=s[0],l=s[1],d=un({currentLevel:r,currentLevelXp:a,nextLevel:c,nextLevelXp:o}),b=un(t);Object(f.useEffect)((function(){var e;b!==t?l(!1):c>(null!==(e=null===d||void 0===d?void 0:d.nextLevel)&&void 0!==e?e:0)&&(yt.c.playSound("ui/levelUp"),l(!0),setTimeout((function(){l(!1)}),2e3))}),[t,b,null===d||void 0===d?void 0:d.nextLevel,c]);var p=un(u),j=Object(f.useMemo)((function(){return u?1:(n-a)/(o-a)}),[a,u,o,n]),v=Object(f.useMemo)((function(){return u?m.a.get("ui-adventurer-info-xp-level-up"):n>=Le.a?m.a.get("ui-adventurer-info-xp-level-max"):m.a.get("ui-adventurer-info-xp-progress",{xp:Math.floor(n-a),next:o-a})}),[u,n,a,o]);return Object(dt.jsxs)("div",{className:"level",children:[Object(dt.jsx)("div",{className:"text",children:m.a.get("ui-adventurer-info-level",{level:r})}),Object(dt.jsx)(on,{progress:j,animationTime:b!==t||p?0:300,label:v})]})}),Mr=n(163),Lr=n(326),zr=Object($.b)(Mr.a,Lr.a),Pr=function(e){return e.quests},Wr=function(e){return e.quests.map((function(e){return e.name}))},Vr=function(e){return e.quests.map((function(e){return e.status}))},Qr=function(e){return e.filter((function(e){return e.status===ce.a.active}))},Br=function(e){var t=Object(f.useCallback)((function(t){return t.quests.find((function(t){return t.name===e}))}),[e]);return Object(g.d)(t)},Gr=function(e){return Object(g.d)((function(t){var n;return null===(n=t.quests.find((function(t){return t.name===e})))||void 0===n?void 0:n.scene}))},Fr=function(e,t){var n=Gr(e);return Object(f.useMemo)((function(){return null===n||void 0===n?void 0:n.objects.find((function(e){return Object(Ee.f)(e)&&e.adventurerId===t}))}),[t,null===n||void 0===n?void 0:n.objects])},Hr=function(e){var t,n=e.questName,r=e.adventurer,a=Br(n),c=function(e,t){var n=Gr(e);return Object(f.useMemo)((function(){return null===n||void 0===n?void 0:n.objects.find((function(e){return e.name===t}))}),[t,null===n||void 0===n?void 0:n.objects])}(null!==n&&void 0!==n?n:"",r.id),o=(null===c||void 0===c?void 0:c.ap)||0;return null!==a&&void 0!==a&&null!==(t=a.scene)&&void 0!==t&&t.combat?Object(dt.jsx)("span",{children:m.a.get("ui-adventurer-info-ap-remaining",{ap:o})}):null},Zr=n(59),Ur=(ir={},Object(G.a)(ir,Zr.a.arrowFinder,{trait:Zr.a.arrowFinder,hasEffect:!0}),Object(G.a)(ir,Zr.a.gloomy,{trait:Zr.a.gloomy,hasEffect:!0}),Object(G.a)(ir,Zr.a.lucky,{trait:Zr.a.lucky,hasEffect:!0}),Object(G.a)(ir,Zr.a.houseHouston,{trait:Zr.a.houseHouston}),Object(G.a)(ir,Zr.a.houseMaddox,{trait:Zr.a.houseMaddox}),Object(G.a)(ir,Zr.a.houseMonroe,{trait:Zr.a.houseMonroe}),ir),Yr=(n(512),function(e){var t=Object(kr.a)(e.adventurerId),n=function(e,t){var n=function(e){return Ur[e]}(e);return Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("li",{onClick:function(e){var t=e.currentTarget.getBoundingClientRect();An.showContextTooltip(ln.trait,n,t),e.stopPropagation()},children:m.a.getTraitName(e)}),!t&&", "]},e)};return null!==t&&void 0!==t&&t.traits?Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)("h3",{className:"title",children:m.a.get("ui-adventurer-info-traits-title")}),Object(dt.jsx)("ul",{className:"adventurer-traits",children:t.traits&&t.traits.map((function(e,t,r){return n(e,t===r.length-1)}))})]}):null}),Jr=(n(513),function(e){var t=e.adventurerId,n=Object(kr.b)(t),r=function(e){var t=n[Nr.a[e]];return t?Object(dt.jsx)("div",{className:Nr.a[e],children:t},e):null};return Object(dt.jsxs)("li",{className:"guy",children:[r(Nr.a.head),r(Nr.a.chest),r(Nr.a.hands),r(Nr.a.shoulders),r(Nr.a.legs),r(Nr.a.feet)]})}),Xr=(n(514),function(e){var t=e.adventurerId,n=e.onDropItemEquipment,r=Object(kr.a)(t),a=function(e){var a=r.equipment[e],c=m.a.getEquipmentSlot(e);e===Nr.a.offHand&&Object(Nr.d)(r.equipment)&&(c=m.a.get("ui-equipmentslot-ammunition"));return Object(dt.jsxs)("li",{className:Nr.a[e],children:[Object(dt.jsx)(Nr.b,{onDrop:function(t){n(t,e)},adventurerId:t,type:e,children:a&&Object(dt.jsx)(Ir,{index:e,sourceId:r.id,sourceType:Ar.a.adventurerEquipment,item:a,size:fn.a.medium})}),Object(dt.jsx)("span",{className:"info",children:c})]})};return Object(dt.jsxs)("ul",{className:"adventurer-equipment",children:[a(Nr.a.head),a(Nr.a.chest),a(Nr.a.hands),a(Nr.a.shoulders),a(Nr.a.legs),a(Nr.a.feet),a(Nr.a.mainHand),a(Nr.a.offHand),Object(dt.jsx)(Jr,{adventurerId:r.id})]})}),Kr=n(105),_r=function(e){var t=e.adventurerId,n=Object(kr.a)(t),r=n.health,a=n.basicAttributes,c=n.xp,o=Object(Le.c)(c),i=Object(Kr.a)(o,a.for),s=r>0?"".concat(jr(Math.max(r,0)),"/").concat(i):m.a.get("ui-adventurer-info-dead");return Object(dt.jsxs)("div",{className:"health",children:[m.a.get("ui-adventurer-info-health"),Object(dt.jsx)(on,{progress:r/i,label:s,variation:"health"})]})},$r=(n(515),function(e){var t=e.onDrop,n=Object(jt.useDrop)((function(){return{accept:Ar.b.ITEM,canDrop:function(e){var t=e.item;return Object(et.c)(t.type)},drop:function(e){t(e)},collect:function(e){return{isOver:e.isOver(),canDrop:e.canDrop()}}}})),r=Object(h.a)(n,2),a=r[0],c=a.canDrop,o=a.isOver,i=r[1],s=["consume-item-slot"];return o?s.push("drop-active"):c&&s.push("drop-possible"),Object(dt.jsx)("div",{className:s.join(" "),ref:i,children:e.children})}),ea=(n(516),function(e){var t,n=e.adventurerId,r=e.questName,a=e.fromSlot,c=e.onDrop,o=e.onConsumed,i=Object(kr.a)(n),s=Br(null!==r&&void 0!==r?r:""),u=Object(g.c)(),l=!(null===s||void 0===s||null===(t=s.scene)||void 0===t||!t.combat),d=Object(f.useMemo)((function(){var e,t,r,a;return null!==(e=null===(t=Object(Ee.c)(null!==(r=null===s||void 0===s||null===(a=s.scene)||void 0===a?void 0:a.objects)&&void 0!==r?r:[],n))||void 0===t?void 0:t.ap)&&void 0!==e?e:0}),[s,n])>=Me.a,b=Object(f.useMemo)((function(){return void 0===a?null:null===i||void 0===i?void 0:i.inventory[a]}),[i,a]);return Object(dt.jsxs)("fieldset",{className:"consume-item",children:[Object(dt.jsx)("legend",{children:m.a.get("ui-adventurer-info-use-item")}),Object(dt.jsxs)("div",{className:"content",children:[Object(dt.jsx)($r,{onDrop:function(e){void 0!==e.inventorySlot&&(null===c||void 0===c||c(e.inventorySlot))},children:b&&Object(dt.jsx)(Ir,{index:0,sourceId:n,sourceType:Ar.a.adventurerConsumeItem,item:b,size:fn.a.small})}),Object(dt.jsxs)(_t,{className:"consume-button",onClick:function(){if(n&&a){var e=i.inventory[a];if(!e||!Object(et.c)(e.type))throw new Error("No potion found at index ".concat(a," "));if(l){if(!r)return;u(Object(ue.b)(r,n,Me.a))}u(Object(rt.f)(n,a)),yt.c.playSound("scene/drinking",yt.a.scene),null===o||void 0===o||o(),i&&u(Object(x.b)("adventurer-drink-potion",{item:b,adventurer:n},ae.a.common))}},disabled:!b||l&&!d,children:[m.a.get("ui-adventurer-info-use-item"),l&&" "+m.a.get("ui-adventurer-info-use-item-ap-cost",{ap:Me.a})]})]})]})}),ta=function(e){switch(e){case nt.a.brokenLegs:return"knee-bandage.svg";case nt.a.burning:return"flaming-claw.svg";case nt.a.soma:return"embrassed-energy.svg"}},na=function(e){var t=e.effectType;return Object(dt.jsx)("div",{className:"effect-icon ".concat("harmful"),style:{backgroundImage:"url(".concat(".","/img/ui/icons/").concat(ta(t),")")}})},ra=(n(517),function(e){var t=Object(kr.a)(e.adventurerId);return null!==t&&void 0!==t&&t.tempEffects?Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)("p",{children:m.a.get("ui-adventurer-info-effects-title")}),Object(dt.jsx)("ul",{className:"adventurer-effects",children:t.tempEffects&&t.tempEffects.map((function(e){return function(e){return Object(dt.jsx)(f.Fragment,{children:Object(dt.jsxs)("li",{onClick:function(t){var n=t.currentTarget.querySelector(".name");if(n){var r=n.getBoundingClientRect();An.showContextTooltip(ln.tempEffect,e,r),t.stopPropagation()}},children:[Object(dt.jsx)(na,{effectType:e.type}),Object(dt.jsx)("div",{className:"name",children:m.a.getTempEffectName(e)})]})},e.type)}(e)}))})]}):null}),aa=n(47),ca=n(75),oa=n(72),ia=(n(518),function(e){var t=e.base,n=e.additional,r=void 0===n?0:n,a=Object(f.useCallback)((function(e){return e<=Math.round(t-1)?"base":e>Math.round(t-1)&&e<=Math.round(t-1)+Math.round(r)?"additional":""}),[r,t]);return Object(dt.jsx)("div",{className:"attribute-indicator",children:Object(j.a)(Array(aa.b)).map((function(e,t){return Object(dt.jsx)("div",{className:"blip ".concat(a(t))},t)}))})}),sa=function(e){var t=e.attributes,n=e.small;return Object(dt.jsx)(dt.Fragment,{children:oa.b.map((function(e){return function(e){var r={attribute:e,components:t[e]},a=r.components.reduce((function(e,t){return t.origin.type===aa.a.base?e.base+=t.value:e.additional+=t.value,e}),{base:0,additional:0}),c=a.base,o=a.additional;return Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("div",{className:"name",children:Object(dt.jsx)("span",{onClick:function(e){var t=e.currentTarget.getBoundingClientRect();An.showContextTooltip(ln.attribute,r,t),e.stopPropagation()},children:n?e:m.a.getAttributeName(e)})}),Object(dt.jsx)(ia,{base:c,additional:o}),Object(dt.jsx)("div",{className:"value-base",children:jr(c)}),Object(dt.jsx)("div",{className:"value-additional",children:o>0&&"+".concat(jr(o))})]},e)}(e)}))})},ua=(n(519),{"--item-count":aa.b}),la=function(e){var t=e.attributes,n=Object(ca.a)(t).some((function(e){var t=Object(h.a)(e,2);t[0];return t[1].some((function(e){return e.origin.type!==aa.a.base}))}));return Object(dt.jsx)("div",{className:"attribute-list ".concat(n?"has-additional":""),style:ua,children:Object(dt.jsx)(sa,{attributes:t})})},da=function(e){var t,n=e.skills;return Object(dt.jsx)(dt.Fragment,{children:null===(t=Object.keys(n))||void 0===t?void 0:t.map((function(e){return function(e){var t,r,a=null!==(t=n[e])&&void 0!==t?t:0;return Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("div",{className:"name",children:Object(dt.jsx)("span",{onClick:function(t){var n=t.currentTarget.getBoundingClientRect();An.showContextTooltip(ln.skill,e,n),t.stopPropagation()},children:m.a.getSkillName(e)})}),Object(dt.jsx)(ia,{base:null!==(r=n[e])&&void 0!==r?r:0}),Object(dt.jsx)("div",{className:"value-base",children:jr(a)}),Object(dt.jsx)("div",{className:"value-additional"})]},e)}(e)}))})},ma=(n(520),{"--item-count":aa.b}),ba=function(e){var t=e.adventurerId,n=e.skills,r=Object(kr.a)(t),a=Object(f.useMemo)((function(){return Object(aa.e)(r)}),[r]),c=Object(ca.a)(a).some((function(e){var t=Object(h.a)(e,2);t[0];return t[1].some((function(e){return e.origin.type!==aa.a.base}))}));return Object(dt.jsxs)("section",{className:"attributes-and-skills ".concat(c?"has-additional":""),style:ma,id:"skills",children:[Object(dt.jsx)("h3",{className:"title",children:m.a.get("ui-adventurer-info-attributes-title")}),Object(dt.jsx)(sa,{attributes:a}),n&&Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)("h3",{className:"title",children:m.a.get("ui-adventurer-info-skills-title")}),Object(dt.jsx)(da,{skills:r.skills})]})]})},pa=(n(521),function(e){var t=e.adventurerId,n=e.questName,r=e.horizontalMode,a=e.name,c=void 0===a||a,o=e.levelBar,i=void 0===o||o,s=e.effects,u=void 0===s||s,l=e.traits,d=void 0===l||l,b=e.skills,p=void 0===b||b,j=e.onStartInventoryItemDrag,v=Object(kr.a)(t),g=Rr(),O=g.dropItemEquipment,y=g.dropItemInventory,x=Object(f.useState)(),w=Object(h.a)(x,2),k=w[0],A=w[1];Object(f.useEffect)((function(){A(void 0)}),[t]);return v?Object(dt.jsxs)("div",{className:"adventurer-panel".concat(r?" horizontal":""),children:[Object(dt.jsx)("section",{id:"common",children:Object(dt.jsxs)("div",{className:"info",children:[c&&Object(dt.jsxs)("div",{className:"name",children:[Object(dt.jsx)("h3",{className:"title",children:v.name}),n&&Object(dt.jsx)(Hr,{questName:n,adventurer:v})]}),i&&Object(dt.jsx)(Dr,{adventurerId:v.id}),v.flavor&&Object(dt.jsxs)("span",{className:"flavor",children:[Object(dt.jsx)("img",{className:"portrait",src:"".concat(".").concat(v.avatarImg),alt:v.name}),Object(dt.jsx)(pr.a,{children:m.a.getAdventurerFlavor(v.id,v.name)})]}),Object(dt.jsx)(_r,{adventurerId:v.id}),u&&Object(dt.jsx)(ra,{adventurerId:t}),d&&Object(dt.jsx)(Yr,{adventurerId:t})]})}),Object(dt.jsx)(ba,{adventurerId:t,skills:p}),Object(dt.jsx)("section",{id:"equipment",children:Object(dt.jsxs)("div",{className:"equipment",children:[Object(dt.jsx)("h3",{className:"title",children:m.a.get("ui-adventurer-info-equipment-title")}),Object(dt.jsx)(Xr,{adventurerId:t,onDropItemEquipment:function(e,t){O(e,t,v)}})]})}),Object(dt.jsxs)("section",{id:"inventory",children:[Object(dt.jsx)("h3",{className:"title",children:m.a.get("ui-adventurer-info-inventory-title")}),Object(dt.jsx)(Sr,{sourceType:Ar.a.adventurerInventory,sourceId:t,disabledIndex:k,items:v.inventory,className:"inventory-medium",onDropItem:function(e,t,n,r,a){r===Ar.a.adventurerConsumeItem?A(void 0):y(e,t,n,r,v,a)},onStartDrag:j}),Object(dt.jsx)(ea,{adventurerId:v.id,questName:n,fromSlot:k,onDrop:function(e){A(e)},onConsumed:function(){A(void 0)}})]})]}):null}),ja=n(153),ha=(n(522),function(){var e=Object(f.useRef)(null);return Object(f.useEffect)((function(){var t,n=null===e||void 0===e||null===(t=e.current)||void 0===t?void 0:t.parentNode,r=wt()((function(){var t,r,a=n.scrollTop;null===(t=e.current)||void 0===t||null===(r=t.querySelectorAll("a"))||void 0===r||r.forEach((function(e){var t=e.hash.substring(e.hash.lastIndexOf("#")),n=document.querySelector(t);n&&n.offsetTop<=a&&n.offsetTop+n.clientHeight>a?e.classList.add("active"):e.classList.remove("active")}))}),50);return null===n||void 0===n||n.addEventListener("scroll",r),function(){null===n||void 0===n||n.removeEventListener("scroll",r)}}),[]),Object(dt.jsxs)("ul",{className:"adventurer-section-selection",ref:e,children:[Object(dt.jsx)("li",{title:m.a.get("ui-adventurer-info-general-title"),children:Object(dt.jsx)(ja.a,{smooth:!0,to:"#common",className:"active",children:Object(dt.jsx)("img",{src:"data:image/png;base64,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UmVhZHlxyWU8AAADcWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjNmZjJmYzA3LThiNGEtNjQ0Yi1iMjNkLTViMDFlOWRlOGVjZSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2RDkzMzJCMjUxNkExMUVBOUM3MDk0RTkwOTBCRTk4NiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2RDkzMzJCMTUxNkExMUVBOUM3MDk0RTkwOTBCRTk4NiIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6N2RhZTkyNzMtYWI4NC03OTQ0LThjZjctZjliMTFkZjk3MTk4IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjNmZjJmYzA3LThiNGEtNjQ0Yi1iMjNkLTViMDFlOWRlOGVjZSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvfQy5UAAAAGUExURf///////1V89WwAAAACdFJOU/8A5bcwSgAAAkZJREFUeNrs3cGO4yAUBdHi/396dqPuie3IgOFdT9U+4ixa6gTDM21qHDV5iYe189Ws4E5Fs4g7D81C7xwzS70zzCz2jptZ7h01swM8RGaHd8jMJnA/mV3gbjLbwL1k9oE7yezzdprZCg4Us0IMe8lsBt8nsxt8m8x28F3y28Wwn0wB8D3yu8VQgUwJ8B3ym8VQg/xiMRQhK64jhipkxWXEUIasuIoY6pAVK1ZcVgyFyIoVK1asWLFixUvFfttUrFixu1iK3fFW7NMxxc+KfZK+QOyJkAXivHNCnh5bIc47U+hJ0xXivPPHgWe8A8/RB95VCLzBMpHcVonj7jW1wLtjgffzAu9AjpoHlm1byG2PuNs8tmZbT247xXn3/m+bJyzX2kLzlMXanBZx2/88h+WCPXuFlpbiyuKehy4z/rqn/Wp65kOP71f0fOhRccd/tq17m2F79GnPTNNOhLCuKWLWNi6GYmSKeb+bKef9ZqYi+JJMSfAVmZLey+8oVcGnZMqCz8jUBZ+QKQw+JlMZfEimNPiITG3wAZni4E8y1cEfZMqD/yVTHxwo5lwMAWQSwL/I0WKIIJMB/kEOFkMIOVcMKWRiwIFissWQQw4VQxA5UwxJZMVLxBBFVqz4SExWihW/Q2xmZmZmZmZmZmZmZmZmZmZmZmZmZmZmVUq7DxJ8azMCHTVx43i2QsromOJTpj68pee7HXHrzik80dact3nJbdXeOv5Ne2+acAFs14zprdiRyeN7sPveaNJHXf8miDHo3/4IMAAA0TKWRcqboAAAAABJRU5ErkJggg==",alt:m.a.get("ui-adventurer-info-general-title")})})}),Object(dt.jsx)("li",{title:m.a.get("ui-adventurer-info-skills-title"),children:Object(dt.jsx)(ja.a,{smooth:!0,to:"#skills",children:Object(dt.jsx)("img",{src:"data:image/png;base64,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UmVhZHlxyWU8AAADcWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjNmZjJmYzA3LThiNGEtNjQ0Yi1iMjNkLTViMDFlOWRlOGVjZSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyNzBDNjVEMjUxNzExMUVBODM1MkY4N0UwMUZBQ0UxNyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyNzBDNjVEMTUxNzExMUVBODM1MkY4N0UwMUZBQ0UxNyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6ODUyMmFiMmUtMjAyMS1hYTQ0LWE2NGUtODI3YjBkYzg0NTA5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjNmZjJmYzA3LThiNGEtNjQ0Yi1iMjNkLTViMDFlOWRlOGVjZSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PtCL+cMAAAAGUExURf///////1V89WwAAAACdFJOU/8A5bcwSgAAA49JREFUeNrs3VFy3DAMA1Dg/pfuBTqTFQlqBBP8TKw1X+S0WWpFgVcD/4nLGQQccMABBxxwwAEHHHDAAQcccMABBxxwwAEHvAGMP+M7YByEPRiFsAWjEX5gtMMKDEm4gCEMAzDE8TgYA/EwGEPxKBiD8SAYw/EYGBfiJTBgI4YNV0SGk1chhhNXQYaZty2GGbdNxlUvf/7imBi3vH8V8W6JccP7a9XyhhjT3tMy7bQYo9xaXXqUjEFvvRA/KMaYt7fyMCbGjFex1DIjxoT3bOjIjZTgThqCy5tiyL3Hg+fuJgH3EhANaYhx1UvVmLpYCq4NH79pB9y9tXBYUQyZt/wCd+5cAvfvqh1ZEeOql+KhBTGueqkeey7WgHkDzMtgzQOlH376U7vq5cT4w1+M9q14E8xrYNV/+yOvcPSP/VWvIrp/CQT8uLebDOy8zXRaYPItsQr8mreVUQNMPifWgOEDxiSYtJxieHrraQVs4i0nVgSTr4q7YLiBMQImbacYthNcTA6+E1zLrgImnxZ3wHAEQw0mnacYzhNcyTBgqye6kCKsJ7iQI7wn+DzJgP94LdJBXAPDF4yAq2DS/ZkO2O2JPk00YLsn+jDTgNeC4Q2GBEz6T3HAAQe8B0waic9qQrd7TfQqWG59FwIOOOCAAw444IADDjjggAMOOOCAAx7K9rNFvJRpAw444M+CP70gns94BLwBnE/ifQmcT9OuBOcT8V8Cr9vkkW08O8Ff3oq3brNlttN+HrxuS/y+pgfr2lqkcclTYgyA1zUf2tdeal0DsX0t4tL18PPgdY0897VqXdeMd1+75XUNtfe1TF/XFD/nPHwfvO7okn2H0+w7fmjdAVP7jhDbd0jcumMA9x30uO8oz32Hte47jnffgcvrjtTed2h676x6weXNd6eVN7SNNPpXd9+Nl97BSzf4QX8XOfinTY898Ngmz2KNprqPs3GZqLpULUoVt66WL5JV0+pVuNJ23doVyuJho+xY2aN8/l11sbRTZy1szD77zkRxuFVYPt+O/vMXx/bg9yrphj0HuksHdi0W2mslbi0lBItDTlwJmE5eapb/bLgqMG28lC3wenCF4FmyMEvyfbI0R/J1sjhD8m2yPD/yZfJAdpyIV7VjYAV5KjGOxYPaWXAVPZwRx+Md7CXw4DLCw+DCUkvAAQcccMABBxxwwAEHHHDAAQcccMABBxxwwB8E/xNgADKop7nSnBUxAAAAAElFTkSuQmCC",alt:m.a.get("ui-adventurer-info-skills-title")})})}),Object(dt.jsx)("li",{title:m.a.get("ui-adventurer-info-equipment-title"),children:Object(dt.jsx)(ja.a,{smooth:!0,to:"#equipment",children:Object(dt.jsx)("img",{src:"data:image/png;base64,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UmVhZHlxyWU8AAADcWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjNmZjJmYzA3LThiNGEtNjQ0Yi1iMjNkLTViMDFlOWRlOGVjZSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpDNDRDQkUzODUxNzUxMUVBQjM5REFCODVERTEzMUU2MSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpDNDRDQkUzNzUxNzUxMUVBQjM5REFCODVERTEzMUU2MSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6ZDI0YWU3ZTAtMDM1Ny04MTQ5LWJhZDQtY2Y2NjM5MWIwMWEyIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjNmZjJmYzA3LThiNGEtNjQ0Yi1iMjNkLTViMDFlOWRlOGVjZSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pm/dvNIAAAAGUExURf///////1V89WwAAAACdFJOU/8A5bcwSgAAAlpJREFUeNrs3UFy4zAMRNHG/S89s0hNZWLJIgUSQjsf+268rVBlU7FudDorl2ymLmerCLsMrUrtCrOKtWmz6rU5sx7RJsx6jHuTrAe5t8h6lHuDrIe502Q9zp0kq4N3RqwO3BmymniHxWrCHSarj3dMrEbeIbEacYfI6uW9FquZ91Ksbt4rsdp5L8Rqx70gq6P3nVgtvW/E6uk9F6up91T8KWCpq1htvSdi9fUei9XYeyhWZ++R+APAUmuxentfxWrufRG7g6XuYrX3/hB7g6X+YmuwZCCWg/e72BgsWYh9wZKH2BYsmYgBF4ElF7EpWLIRAy4BSz5iwBVgyUgMuAAsOYkBA/YG6y9YgAEDLgUzDMMwDMMwvhMPDGDAgAEDBlz442k3L+C+f1zxlNcPLDevH1hu3kqxfilYbt4qsdvXs9v3vtmJwu2oYnYH8rpd+dzcvO6EbpdNt1usAAMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAQMGDBgwYMCAAX80OLzAqdci6sGRe/GkHByRe8ipGPwVTXSUgv9FEyWV4HgFz9fUgb9HEz1l4DgDTzYVgX9EE10l4JdooqwCHNfg8br94KNoonA3+DiaaNwMjhnwUOdW8Gk00boR/CaaqN0Hjnvgq+Jd4PfRRPUe8FU00b0FHFnwm/YN4IFoon85eCiaWLAaHOvAxyvWgkejiSUrwePRxJaF4NgBftmzDDwVTSxaBY594P9XrQHPRu8vi1ggnk/eXhaxQDwf/CPAAEWCOZah9n1oAAAAAElFTkSuQmCC",alt:m.a.get("ui-adventurer-info-equipment-title")})})}),Object(dt.jsx)("li",{title:m.a.get("ui-adventurer-info-inventory-title"),children:Object(dt.jsx)(ja.a,{smooth:!0,to:"#inventory",children:Object(dt.jsx)("img",{src:"data:image/png;base64,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UmVhZHlxyWU8AAADcWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjNmZjJmYzA3LThiNGEtNjQ0Yi1iMjNkLTViMDFlOWRlOGVjZSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5OTY0QUNENDUxNzQxMUVBQjZGRENDOUJGNDMzNjU3NCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5OTY0QUNEMzUxNzQxMUVBQjZGRENDOUJGNDMzNjU3NCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6ZDI0YWU3ZTAtMDM1Ny04MTQ5LWJhZDQtY2Y2NjM5MWIwMWEyIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjNmZjJmYzA3LThiNGEtNjQ0Yi1iMjNkLTViMDFlOWRlOGVjZSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpwgK6gAAAAGUExURf///////1V89WwAAAACdFJOU/8A5bcwSgAAA19JREFUeNrc21ty4zAMRNHG/jc9qfm3RcjEo683EJ2STQINRGH50eEHjRMaJzROaJzQOKFxQuOExgmNExonNE5onNA4oXFC44TGCY0TGic0Tmic0DihcULjhMYJjRMaJzROaJzQOKFxQuOExgmNExonNE5onNBvTuivpdC/OaEPFKFPS6GvApFxm3QF15zIuD26kgJFZNwWXVFpKTJuh66sKRAZt0FX2M6JjJvXlTbiIuOmdcURisi4WV15+CUyblLXEFuKjJvTtQTOIuOmdE2jApFxM7q2IY/IuAld43hOZFy/rnWwKjKuW9c8EhcZ16trX2YQGdepG1hDERnXpxtZIBIZ16UbWv0SGdejG1vaExnXoRtctxQZV68bXZQVGVetG15xFhlXqxtfThcZV6lb8G8FIuPqdBtwZboVuCrdDlyRbgmuRrcFV6Jbg6vQ7cEV6Bbh7us24a7rVuFu63bhLuuW4e7qtuGu6tbhbur24S7qFuLu6Tbi4tYy0krc48OfLoasxJ3oZIs70skVd6aTKS4OH9wTd6qTJe5YJ0fcuU6GuAfd41/fjcvoZIdL6eSGy+lkhovkTeaFy+pkhUvr5ITL62SEe6GTD+6r7vPzmOCiq/ofwSXvOzNc9DWmA7jD3twUF52ZSTvuIK40xkVvnNeMO4qabXHRnTS34g7HBKa4gSFII+54wmWJO5/fOeIS00lDXGb26odLTZbtcLm5uRsuuRVghsvuPHjh0hsdVrj8vooT7sU2jhGu8d2Fgc4K13ZmhoHODNdUq4SBzg7X0iOEgc4Q19Cbh4HOEleeiYWBzhRXnEWHgc4WVzoDCgOdMa5y9mqgs4pRsjqvCCypM4svc7pzhOFtnnlDdpVY7utnVkVnf1tWHVD+4DDqXt+cijbJw7sj3yQ1enufWSR+7y9rg7T2l0pkfdL+W5m1fEryaw25esL1e4G8eDp5o/pfO1m+09os3Qq41bet3Oi415Tue3dXO+5tN8LlOGFXnXk9K9nUvRYEQXsSP6cINq2D4kJk3H8dFhci4/50YFxiUhBkXZB14akLMO7wzAxfXWBxR7VKeOsCijvoEcJfF0jcY28eDF0AcQ+ZWHB0gcN9TWuDpQsY7suUJHi6QOE+TieDqQsQ7sNWAAQX/wQYAPYPhm0aAm5YAAAAAElFTkSuQmCC",alt:m.a.get("ui-adventurer-info-inventory-title")})})})]})}),fa=(n(523),function(e){var t=e.level,n=en("warehouse"),r=n.levels[t],a=n.levels[t+1];return Object(dt.jsxs)("div",{className:"upgrade-help-model-content-warehouse",children:[Object(dt.jsx)("h3",{children:m.a.get("ui-structure-help-upgrade-improvements")}),Object(dt.jsxs)("div",{className:"storage-increase",children:[Object(dt.jsx)("div",{className:"header"}),Object(dt.jsx)("div",{className:"header",children:m.a.get("ui-structure-warehouse-help-upgrade-header-capacity")}),Object(dt.jsx)("div",{className:"header number",children:m.a.get("ui-structure-help-upgrade-header-level",{level:t+1})}),Object(dt.jsx)("div",{className:"header"}),Object(dt.jsx)("div",{className:"header number",children:m.a.get("ui-structure-help-upgrade-header-level",{level:t+2})}),Object.keys(a.maxResources).map((function(e){return function(e){var t=H[e];return Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("div",{children:Object(dt.jsx)(fn.b,{image:t.iconImg,size:"smallest"})}),Object(dt.jsx)("div",{children:m.a.getResourceName(e)}),Object(dt.jsx)("div",{className:"number",children:r.maxResources[e]}),Object(dt.jsx)("div",{className:"arrow",children:"\xbb"}),Object(dt.jsx)("div",{className:"number",children:a.maxResources[e]})]},e)}(e)}))]})]})}),va=(n(524),Ar.a.warehouse),ga=function(){var e=En(),t=Rr().dropItemWarehouse,n=Object(f.useState)(Object.keys(e)[0]),r=Object(h.a)(n,2),a=r[0],c=r[1],o=Object(jt.useDragDropManager)(),i=o.getMonitor().isDragging();Object(f.useEffect)((function(){if(i){var e=o.getMonitor().getItem(),t=o.getMonitor().getItemType();if(e&&t===Ar.b.ITEM){var n=e.item,r=Object(Ce.d)(n.type);c(Ne.a[r.itemCategory])}}}),[o,i]);var s=Object(f.useMemo)((function(){return e[a]}),[a,e]);return Object(dt.jsxs)("div",{className:"stockpile",children:[Object(dt.jsx)(Or,{className:"tabs auto-collapse",onTabSelected:c,activeTab:a,children:Object.keys(e).map((function(e){return Object(dt.jsx)(yr,{id:e,children:m.a.getItemCategory(Ne.a[e])},e)}))}),Object(dt.jsx)(Sr,{sourceType:va,className:"inventory-large",items:s,onDropItem:function(e,n,r,a,c){t(e,n,r,a,c)},canDropHere:function(e){return Object(Ce.d)(e.item.type).itemCategory===Ne.a[a]}})]})},Oa=(n(525),function(){var e,t=Object(kr.d)(),n=Object(f.useState)(null===(e=t[0])||void 0===e?void 0:e.id),r=Object(h.a)(n,2),a=r[0],c=r[1],o=Dn(),i=Object(f.useState)(gr),s=Object(h.a)(i,2),u=s[0],l=s[1],d=un(o),b=Object(f.useRef)(null),p=Object(g.d)((function(e){return e.structures}));Object(f.useEffect)((function(){return yt.c.addSound("ambient/structure/warehouse","sound/structures/warehouse.ogg",(function(){yt.c.playSound("ambient/structure/warehouse",yt.a.ambient,!0)})),function(){return yt.c.fadeOutSound(yt.a.ambient)}}),[]),Object(f.useEffect)((function(){var e=Object.keys(o).reduce((function(e,t){var n=t;return d&&d[n]&&(e[n]=o[n]-d[n]),e}),{});l(e)}),[o,d]);var j=$t("warehouse").level,v=tn("warehouse");return Object(dt.jsxs)("div",{className:"warehouse-structureview",children:[Object(dt.jsx)(On,{structure:"warehouse",onHelpClicked:function(e){var t=e.currentTarget.getBoundingClientRect(),n=Object(dt.jsx)(dr,{level:j,structure:"warehouse",children:Object(dt.jsx)(fa,{level:j})});An.showContextTooltip(ln.component,n,t,"upgrade-structure-tooltip"),e.stopPropagation()}}),Object(dt.jsxs)("fieldset",{className:"resources",ref:b,children:[Object(dt.jsx)("legend",{children:m.a.get("ui-structure-warehouse-resources")}),Object(dt.jsx)(vr,{resources:o,structures:p,maxResources:v.maxResources,deltaResources:u})]}),Object(dt.jsx)("h3",{children:m.a.get("ui-structure-warehouse-stockpile")}),Object(dt.jsx)(ga,{}),Object(dt.jsx)("h3",{children:m.a.get("ui-structure-warehouse-adventurers")}),Object(dt.jsxs)("div",{children:[Object(dt.jsx)(wr,{adventurers:t,selectedAdventurerId:a,onAdventurerTabSelected:function(e){c(e)}}),Object(dt.jsx)("div",{className:"adventurer-inventory",children:a&&Object(dt.jsx)(pa,{adventurerId:a,horizontalMode:!0,traits:!1,skills:!1})})]})]})}),ya=(n(526),function(e){var t=e.onDrop,n=Object(jt.useDrop)((function(){return{accept:Ar.b.ADVENTURER,collect:function(e){return{canDrop:e.canDrop(),isOver:e.isOver()}},drop:function(e){return t(e)}}})),r=Object(h.a)(n,2),a=r[0],c=a.isOver,o=a.canDrop,i=r[1],s=["droppable-adventurer-slot"].concat(Object(j.a)(c?["active-drop"]:[]),Object(j.a)(!c&&o?["can-drop"]:[])).join(" ");return Object(dt.jsx)("div",{className:s,ref:i})}),xa=(n(527),function(e){return Object(dt.jsx)("ul",{className:"assign-adventurers",children:function(){for(var t=[],n=function(n){var r=void 0,a="";if(!!e.assignedAventurers[n]){var c=e.assignedAventurers[n];r=Object(dt.jsx)(xr,{adventurer:c,displayName:!1,size:fn.a.small,onClick:function(){return e.onAdventurerClicked(c)}}),a="has-adventurer"}else r=Object(dt.jsx)(ya,{onDrop:function(t){e.onAdventurerDropped(t,n)}});t.push(Object(dt.jsx)("li",{className:a,children:r},"slot".concat(n)))},r=0;r<e.availableSlots;r++)n(r);return t}()})}),wa=(n(528),function(e){var t=qn();return Object(dt.jsxs)("div",{className:"quest-board",children:[Object(dt.jsx)("h2",{children:m.a.get("ui-structure-tavern-title-quest-board")}),Object(dt.jsx)("ul",{className:"quest-list",children:e.availableQuests.map((function(t){var n="quest ".concat(t.name===e.selectedQuestName?" selected":"");return Object(dt.jsxs)("li",{className:n,onClick:function(){e.onQuestClick(t.name)},children:[Object(dt.jsx)("div",{className:"icon",style:{backgroundImage:"url(".concat(".",")")}}),Object(dt.jsxs)("div",{className:"title",children:[m.a.getQuestTitle(t.name)," "]})]},t.name)}))}),function(){if(!e.selectedQuestName)return null;var n=e.availableQuests.find((function(t){return t.name===e.selectedQuestName}));if(!n)return Object(dt.jsxs)("div",{children:[" ",m.a.get("ui-structure-tavern-quest-launched")," "]});var r=Object(ne.a)(n.name),a=e.assignedAventurers.filter((function(e){return null!==e})).length>=3,c=function(e){return!e.requiredItems||e.requiredItems.every((function(n){var r,a=null===(r=e.requiredItems)||void 0===r?void 0:r.filter((function(e){return e===n})).length;return t.filter((function(e){return e===n})).length>=(null!==a&&void 0!==a?a:0)}))}(r),o=a&&c;return Object(dt.jsxs)("div",{className:"quest-details",children:[m.a.getQuestDescription(e.selectedQuestName),Object(dt.jsx)(xa,{availableSlots:5,assignedAventurers:e.assignedAventurers,onAdventurerClicked:e.onRemoveAdventurer,onAdventurerDropped:e.onAdventurerDropped}),Object(dt.jsx)(Rn,{items:r.requiredItems||[]}),Object(dt.jsx)(_t,{disabled:!o,onClick:function(){return e.onLaunchQuest()},children:m.a.get("ui-structure-tavern-button-launch-quest")})]})}()]})}),ka=(n(529),function(e){var t=e.adventurer,n=e.assignedAventurers,r=e.questName,a=e.onAddAdventurer,c=e.onRemoveAdventurer,o=n.indexOf(t)>-1,i=m.a.getQuestTitle(r);return o?Object(dt.jsx)(_t,{onClick:function(){c(t)},className:"adventurer-button",children:m.a.get("ui-structure-tavern-button-leave-quest")}):5===n.filter(Boolean).length?Object(dt.jsx)(_t,{disabled:!0,className:"adventurer-button",children:m.a.get("ui-structure-tavern-button-join-quest-full-party")}):Object(dt.jsx)(_t,{onClick:function(){var e=function(e){for(var t=0;t<5;t++)if(!e[t])return t;return 0}(n);a(t,e)},className:"adventurer-button",children:m.a.get("ui-structure-tavern-button-join-quest",{quest:i})})}),Aa=(n(530),function(e){var t=Object(jt.useDrag)((function(){return{type:Ar.b.ADVENTURER,item:{adventurer:e.adventurer,sourceId:e.sourceId,sourceType:Ar.a.adventurerInventory}}}),[]),n=Object(h.a)(t,2),r=n[0],a=n[1],c="draggable-adventurer-avatar";return e.disabled&&(c+=" disabled"),r.isDragging&&(c+=" dragging"),Object(dt.jsx)("div",{className:c,ref:a,children:Object(dt.jsx)(xr,Object(ge.a)({},e))})}),Na=function(e){var t=e.adventurer,n=e.onQuest,r=e.assignedAventurers,a=e.expanded,c=e.selectedQuestName,o=e.onClick,i=e.onAddAdventurer,s=e.onRemoveAdventurer,u=Object(g.c)(),l=r.indexOf(t)>-1;return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsxs)("div",{className:"room ".concat(a?"expanded":""),onClick:function(){return o(t)},children:[Object(dt.jsx)(Aa,{disabled:l||n,adventurer:t,className:"adventurer-icon",sourceId:Ta},"avatar:".concat(t.id)),Object(dt.jsxs)("div",{children:[Object(dt.jsx)("section",{children:t.name}),Object(dt.jsx)("section",{className:"on-a-quest",children:n&&m.a.get("ui-structure-tavern-on-a-quest")})]}),Object(dt.jsx)("span",{className:"rename",onClick:function(e){e.stopPropagation();var n=prompt("Enter new name",t.name);n&&n!==t.name&&u(Object(rt.l)(t.id,n))},children:"rename"})]}),a&&Object(dt.jsxs)("div",{className:"adventurer-details",children:[Object(dt.jsx)(pa,{adventurerId:t.id,name:!1}),!n&&c&&Object(dt.jsx)(ka,{adventurer:t,assignedAventurers:r,questName:c,onAddAdventurer:i,onRemoveAdventurer:s})]})]})},Ca=function(){return Object(dt.jsx)("div",{className:"room",children:"(empty room)"})},Ia=(n(531),function(e){for(var t=e.roomCount,n=e.adventurers,r=e.assignedAventurers,a=e.selectedQuestName,c=e.onAddAdventurer,o=e.onRemoveAdventurer,i=Object(f.useState)(),s=Object(h.a)(i,2),u=s[0],l=s[1],d=function(e){u===e.id?l(void 0):l(e.id)},b=[],p=function(t){var i=n.find((function(e){return e.room===t}));if(!i)return b.push(Object(dt.jsx)(Ca,{},"room".concat(t))),"continue";var s,l=(s=i.id,!!Object.values(e.quests).find((function(e){return e.party.indexOf(s)>-1})));b.push(Object(dt.jsx)(Na,{adventurer:i,assignedAventurers:r,selectedQuestName:a,expanded:u===i.id,onQuest:l,onClick:d,onAddAdventurer:c,onRemoveAdventurer:o},i.id))},j=0;j<t;j++)p(j);return Object(dt.jsxs)("div",{className:"room-list",children:[Object(dt.jsx)("h2",{children:m.a.get("ui-structure-tavern-rooms")}),b]})}),Sa=(n(532),function(e){var t=e.level,n=J("tavern"),r=n.levels[t],a=n.levels[t+1];return Object(dt.jsxs)("div",{className:"upgrade-help-model-content-tavern",children:[Object(dt.jsx)("h3",{children:m.a.get("ui-structure-help-upgrade-improvements")}),Object(dt.jsxs)("div",{className:"rooms-increase",children:[Object(dt.jsx)("div",{className:"header"}),Object(dt.jsx)("div",{className:"header",children:m.a.getStructureName("tavern")}),Object(dt.jsx)("div",{className:"header number",children:m.a.get("ui-structure-help-upgrade-header-level",{level:t+1})}),Object(dt.jsx)("div",{className:"header"}),Object(dt.jsx)("div",{className:"header number",children:m.a.get("ui-structure-help-upgrade-header-level",{level:t+2})}),Object(dt.jsx)("div",{children:Object(dt.jsx)(fn.b,{image:"img/ui/structures/tavern.png",size:"smallest"})}),Object(dt.jsx)("div",{children:m.a.get("ui-structure-tavern-rooms")}),Object(dt.jsx)("div",{className:"number",children:r.rooms}),Object(dt.jsx)("div",{className:"arrow",children:"\xbb"}),Object(dt.jsx)("div",{className:"number",children:a.rooms})]})]})}),Ta=(n(533),"tavern"),Ea=function(){var e=$t("tavern").level,t=Object(g.d)((function(e){return e.adventurers})),n=Object(g.d)((function(e){return e.quests})),r=Object(f.useState)([]),a=Object(h.a)(r,2),c=a[0],o=a[1],i=Object(f.useState)(),s=Object(h.a)(i,2),u=s[0],l=s[1],d=en("tavern").levels[e],b=Object(g.c)();Object(f.useEffect)((function(){return yt.c.addSound("ambient/structure/tavern","sound/structures/tavern.ogg",(function(){yt.c.playSound("ambient/structure/tavern",yt.a.ambient,!0)})),function(){return yt.c.fadeOutSound(yt.a.ambient)}}),[]);var p=n.filter((function(e){return e.status===ce.a.available})),v=function(e,t){var n=Object(j.a)(c);n[t]=e,o(n)},O=function(e){var t=c.indexOf(e),n=Object(j.a)(c);delete n[t],o(n)};return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)(hn,{structure:"tavern"}),Object(dt.jsxs)("div",{className:"tavern-structure-view",children:[Object(dt.jsx)(On,{structure:"tavern",onHelpClicked:function(t){var n=t.currentTarget.getBoundingClientRect(),r=Object(dt.jsx)(dr,{level:e,structure:"tavern",children:Object(dt.jsx)(Sa,{level:e})});An.showContextTooltip(ln.component,r,n,"upgrade-structure-tooltip"),t.stopPropagation()}}),Object(dt.jsxs)("section",{children:[Object(dt.jsx)(Ia,{roomCount:d.rooms,adventurers:t,assignedAventurers:c,quests:n,selectedQuestName:u,onAddAdventurer:v,onRemoveAdventurer:O}),Object(dt.jsx)(wa,{availableQuests:p,selectedQuestName:u,assignedAventurers:c,onQuestClick:function(e){return function(e){l(u===e?void 0:e),o([])}(e)},onAdventurerDropped:function(e,t){e.sourceId===Ta&&v(e.adventurer,t)},onRemoveAdventurer:O,onLaunchQuest:function(){if(u){var e,t=m.a.getQuestTitle(u),n=c[0];oe.b.addToast(t,ie.a.questLaunched,null===n||void 0===n?void 0:n.avatarImg,Object(se.a)(u)),e=u,b(Object(ue.f)(e,c))}}})]})]})]})},qa=function(e){var t,n,r=e.structure,a=e.resource,c=sn(),o=$t(r).workers,i=tn(r).generates[a]||0,s=I-(Date.now()-c.lastProducedUpdate),u=H[a],l=Dn(),d=Mn(),b=(null!==(t=l[a])&&void 0!==t?t:0)>=(null!==(n=null===d||void 0===d?void 0:d[a])&&void 0!==n?n:0);return b?Object(dt.jsx)("div",{className:"resource-generation-row",children:Object(dt.jsx)("div",{className:"error-full",children:Object(dt.jsx)(pr.a,{children:m.a.get("ui-structure-resource-warehouse-full",{structure:r,resource:a})})})}):Object(dt.jsxs)("div",{className:"resource-generation-row",children:[Object(dt.jsxs)("div",{className:"info",children:[Object(dt.jsx)(fn.b,{image:u.iconImg,size:"smallest"}),Object(dt.jsx)("div",{children:m.a.get("ui-structure-resource-generates",{amount:i,resource:a})})]}),b,o>0&&Object(dt.jsx)(dn,{className:"generating",direction:Kt.decreasing,label:"".concat(m.a.get("ui-structure-resource-next-generates",{amount:i*o,resource:a,time:Object(C.i)(s)})),progress:s/I}),!o&&m.a.get("ui-structure-resource-no-workers")]})},Ra=function(e){var t=e.item;return Object(dt.jsxs)("div",{className:"text",children:[Object(dt.jsx)("p",{className:"name",children:m.a.getItemName(t.type)}),Object(dt.jsx)("p",{className:"subtext",children:m.a.getItemSubtext(t.type)})]})},Da=(n(534),function(e){var t,n,r=e.renderButton,a=e.items,c="items-list ".concat(null!==(t=e.className)&&void 0!==t?t:""),o=null!==(n=e.slots)&&void 0!==n?n:a.length;return Object(dt.jsx)("ul",{className:c,children:Object(j.a)(Array(o)).map((function(t,n){var c=a[n];return Object(dt.jsxs)("li",{className:"item-row",children:[Object(dt.jsx)("div",{className:"item-placeholder"}),c&&Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)(Ir,{item:c,index:n,sourceId:e.sourceId,sourceType:e.sourceType}),Object(dt.jsx)(Ra,{item:c})]}),c&&r&&r(c,n)]},"".concat(c).concat(n))}))})}),Ma=(n(535),function(e){var t=e.structure,n=sn(),r=Object(g.c)(),a=xe-(Date.now()-n.lastHarvest);return Object(dt.jsxs)("div",{className:"harvest-progress",children:[Object(dt.jsx)(dn,{className:"harvest-progress",direction:cn.decreasing,label:"".concat(m.a.get("ui-structure-resource-next-harvest",{time:Object(C.i)(a)})),progress:a/xe}),Object(dt.jsx)(gn,{iconImg:"/img/ui/misc/clock.png",size:"smallest",onClick:function(){r(O(50,"harvest",t))},children:" 50%"})]})}),La=n.p+"static/media/icon.745e2ffb.png",za=(n(536),function(e){var t=e.level,n=J(e.structure),r=n.levels[t],a=n.levels[t+1];return Object(dt.jsx)("div",{className:"upgrade-help-model-content-resource",children:Object(dt.jsxs)("div",{className:"grid generates-increase",children:[Object(dt.jsx)("div",{className:"header",children:Object(dt.jsx)("h3",{children:m.a.get("ui-structure-help-upgrade-improvements")})}),Object(dt.jsx)("div",{className:"header"}),Object(dt.jsx)("div",{className:"header number",children:m.a.get("ui-structure-help-upgrade-header-level",{level:t+1})}),Object(dt.jsx)("div",{className:"header"}),Object(dt.jsx)("div",{className:"header number",children:m.a.get("ui-structure-help-upgrade-header-level",{level:t+2})}),Object(dt.jsx)("div",{children:Object(dt.jsx)(fn.b,{image:"/img/resources/worker.png",size:"smallest"})}),Object(dt.jsx)("div",{children:m.a.get("ui-structure-help-upgrade-worker-capacity")}),Object(dt.jsx)("div",{className:"number",children:r.workerCapacity}),Object(dt.jsx)("div",{className:"arrow",children:"\xbb"}),Object(dt.jsx)("div",{className:"number",children:a.workerCapacity}),Object.keys(a.generates).map((function(e){return function(e){var t=H[e];return Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("div",{children:Object(dt.jsx)(fn.b,{image:t.iconImg,size:"smallest"})}),Object(dt.jsx)("div",{children:m.a.get("ui-structure-resource-help-upgrade-resource-generates",{resource:e})}),Object(dt.jsx)("div",{className:"number",children:r.generates[e]}),Object(dt.jsx)("div",{className:"arrow",children:"\u203a"}),Object(dt.jsx)("div",{className:"number",children:a.generates[e]})]},e)}(e)}))]})})}),Pa=(n(537),function(e){var t,n=e.structure,r=$t(n),a=r.level,c=r.workers,o=Object(g.d)((function(e){return Pn(e)})),i=Object(g.d)((function(e){return function(e,t){var n;return null!==(n=e.structures[t].harvest)&&void 0!==n?n:[]}(e,n)})),s=tn(n),u=Object(g.c)(),l=c===s.workerCapacity||(o||0)<1,d=0===c;return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)(hn,{structure:e.structure}),Object(dt.jsx)("div",{className:"resource-structure-view",children:Object(dt.jsxs)("section",{children:[Object(dt.jsx)(On,{structure:n,onHelpClicked:function(e){var t=e.currentTarget.getBoundingClientRect(),r=Object(dt.jsx)(dr,{level:a,structure:n,children:Object(dt.jsx)(za,{level:a,structure:n})});An.showContextTooltip(ln.component,r,t,"upgrade-structure-tooltip"),e.stopPropagation()}}),Object(dt.jsx)(Tn,{label:m.a.get("ui-structure-production-workers"),value:c,max:s.workerCapacity,upDisabled:l,downDisabled:d,onDown:function(){u(function(e){return{type:"decreaseWorkers",structure:e,workers:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1}}(e.structure))},onUp:function(){u(rr(e.structure))}}),Object(dt.jsx)("h3",{children:"Generates"}),Object.keys(s.generates).map((function(e){return Object(dt.jsx)(qa,{structure:n,resource:e},e)})),s.harvest&&Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)("h3",{children:"Harvest"}),Object(dt.jsx)(pr.a,{children:m.a.get("ui-structure-resource-harvest-".concat(n))}),Object(dt.jsx)(Ma,{structure:n}),Object(dt.jsx)(Da,{items:i,sourceType:Ar.a.resourceStructure,sourceId:n,slots:null===(t=s.harvest)||void 0===t?void 0:t.amount,renderButton:function(e,t){return Object(dt.jsx)(gn,{iconImg:La,onClick:function(){return function(e,t){u(function(e,t){return{type:"removeItemFromHarvest",structure:e,index:t}}(n,t)),u(Xn(e))}(e,t)},children:"Take"})}})]})]})})]})}),Wa=(n(249),function(e){var t=e.structure,n=Object(g.d)((function(e){return e.tasks})).running.filter((function(e){return"town"===e.origin&&e.name==="".concat(t,".build")}))[0],r=$t(t);return Object(dt.jsx)("div",{className:"structure-details",children:function(){if(r.state===ye.Building)return n?Object(dt.jsx)("div",{className:"building",children:Object(dt.jsx)(dn,{progress:n.progress,label:"Building... (".concat(Object(C.i)(n.timeRemaining),")")})}):null;switch(J(t).type){case l.production:return Object(dt.jsx)(br,{structure:t});case l.resource:return Object(dt.jsx)(Pa,{structure:t});case l.warehouse:return Object(dt.jsx)(Oa,{});case l.tavern:return Object(dt.jsx)(Ea,{});default:return Object(dt.jsx)("div",{children:t})}}()})}),Va=Wa,Qa=(rn(Wa),function(){var e=Object(vt.i)().structure;if(!e)return null;var t=m.a.getStructureName(e);return Object(dt.jsxs)("div",{className:"structure-details-window ",children:[Object(dt.jsxs)("div",{className:"header",children:[Object(dt.jsx)("h3",{children:t}),Object(dt.jsx)(ft.b,{to:Object(se.b)(e,!0),children:Object(dt.jsx)(_t,{className:"close-button",square:!0,size:"medium",color:"purple",text:"x"})})]}),Object(dt.jsx)(Va,{structure:e,title:t})]})}),Ba=n(327),Ga=n.n(Ba),Fa=n(328),Ha=n.p+"static/media/icon.049af8e1.png",Za=n.p+"static/media/icon.c8d10643.png",Ua=n.p+"static/media/icon.0e0cc642.png",Ya=n.p+"static/media/icon.98ba42d7.png",Ja=n.p+"static/media/icon.2819a92b.png",Xa=n.p+"static/media/icon.d422c1b8.png",Ka=n.p+"static/media/icon.cb41f623.png",_a=n.p+"static/media/icon.8c08d004.png",$a=n.p+"static/media/icon.54fdc54f.png",ec=n.p+"static/media/icon.288a01cf.png",tc=n.p+"static/media/icon.701060d5.png",nc=function(e){switch(e){case"alchemist":return Ha;case"armoursmith":return Za;case"garden":return Ua;case"lumberMill":return Ya;case"mine":return Ja;case"quarry":return Xa;case"tannery":return Ka;case"tavern":return _a;case"warehouse":return La;case"weaponsmith":return $a;case"weaver":return ec;case"workshop":return tc;default:throw new Error("No such structure ".concat(e))}},rc=function(e){return Object(dt.jsx)(qt.Sprite,Object(ge.a)({image:nc(e.structure)},e))},ac=new pt.TextStyle({fontFamily:"Gabriela",fontSize:25,fill:16777215,wordWrap:!0,wordWrapWidth:200,dropShadow:!0,dropShadowAngle:.9,dropShadowBlur:10,dropShadowDistance:0}),cc=new Fa.a(2,2),oc=function(e){var t,n=e.x,r=e.y;if($t(e.structure).state!==ye.Built)return null;var a=null!==(t=m.a.getStructureName(e.structure))&&void 0!==t?t:"",c=pt.TextMetrics.measureText("".concat(a),ac);return Object(dt.jsxs)(qt.Container,{x:n,y:r,name:e.structure,children:[Object(dt.jsx)(qt.Sprite,{name:"background",image:"".concat(".","/img/town/structure-label/background.png"),scale:[(c.width+16)/190,25.5],alpha:.5,filters:[cc],y:3.5,x:8}),Object(dt.jsx)(qt.Sprite,{name:"border-top",image:"".concat(".","/img/town/structure-label/border-top.png"),scale:[(c.width+30)/985,.2],y:2}),Object(dt.jsx)(qt.Sprite,{name:"border-bottom",image:"".concat(".","/img/town/structure-label/border-top.png"),y:28,scale:[(c.width+30)/985,.2]}),Object(dt.jsx)(rc,{name:"icon",structure:e.structure,y:-2,x:c.width+12,scale:[.015,.015]}),Object(dt.jsx)(qt.Text,{anchor:[0,0],text:"  ".concat(a[0].toUpperCase()+a.slice(1),"  "),style:ac})]})},ic=function(){var e=Object(f.useState)(!1),t=Object(h.a)(e,2),n=t[0],r=t[1];return Object(f.useEffect)((function(){new Ga.a("Gabriela").load().then((function(){r(!0)}))}),[]),n?Object(dt.jsxs)(qt.Container,{name:"structure-labels",children:[Object(dt.jsx)(oc,{structure:"tavern",x:645,y:535}),Object(dt.jsx)(oc,{structure:"warehouse",x:430,y:130}),Object(dt.jsx)(oc,{structure:"lumberMill",x:235,y:410}),Object(dt.jsx)(oc,{structure:"alchemist",x:375,y:460}),Object(dt.jsx)(oc,{structure:"weaponsmith",x:435,y:495}),Object(dt.jsx)(oc,{structure:"armoursmith",x:515,y:425}),Object(dt.jsx)(oc,{structure:"weaver",x:555,y:370}),Object(dt.jsx)(oc,{structure:"tannery",x:255,y:520}),Object(dt.jsx)(oc,{structure:"mine",x:185,y:590}),Object(dt.jsx)(oc,{structure:"workshop",x:345,y:660}),Object(dt.jsx)(oc,{structure:"quarry",x:685,y:666}),Object(dt.jsx)(oc,{structure:"garden",x:785,y:776})]}):null},sc=function(e){var t=e.hitAreaShapes,n="lumberMill",r="".concat(".","/img/town/town-alpha/").concat(n,".json"),a=Object(f.useState)(),c=Object(h.a)(a,2),o=c[0],i=c[1],s=e.selected?[hc]:[],u=Object(qt.useApp)();Object(f.useEffect)((function(){Object(b.b)(r,(function(e){e&&i(e.textures)}))}),[u,u.loader,r]);var l=Object(f.useState)(0),d=Object(h.a)(l,2),m=d[0],p=d[1];return Object(qt.useTick)((function(e){return p((function(t){return t+.01*(null!==e&&void 0!==e?e:0)}))})),o?Object(dt.jsx)(qt.Sprite,{name:n,position:e.position,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(n)},hitArea:t,filters:s,texture:o["structure.png"],children:Object(dt.jsx)(qt.Sprite,{name:"blades",texture:o["blades.png"],anchor:new pt.Point(.5,.5),x:15,y:10,rotation:m})}):null},uc=n(329),lc=n(330),dc=["image","config"],mc=Object(qt.PixiComponent)("ParticleEmitter",{create:function(){return new pt.ParticleContainer(256,{})},applyProps:function(e,t,n){var r=n.image,a=n.config,c=Object(Pt.a)(n,dc);Object(qt.applyDefaultProps)(e,t,c);var o=new lc.a(e,[pt.Texture.from(r)],a),i=performance.now();o.emit=!0,function t(){if(!e.destroyed){var n=performance.now();o.update(3e-4*(n-i)),i=n,requestAnimationFrame(t)}}()}}),bc=function(e){var t=e.hitAreaShapes,n=e.position,r="tavern",a=e.selected?[hc]:[];return Object(dt.jsxs)(qt.Container,{position:n,children:[Object(dt.jsx)(qt.Sprite,{name:r,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(r)},filters:a,hitArea:t,image:"".concat(".","/img/town/town-alpha/").concat(r,".png")}),Object(dt.jsx)(mc,{name:"smoke",x:107,y:-2,image:"".concat(".","/img/town/effects/smokeparticle.png"),config:uc})]})},pc=function(e){var t=e.structure,n=e.position,r=e.hitAreaShapes,a=e.selected,c=e.onStructureClick,o=a?[hc]:[];return Object(dt.jsx)(qt.Sprite,{name:t,position:n,interactive:!0,buttonMode:!0,pointertap:function(){c(t)},hitArea:r,filters:o,image:"".concat(".","/img/town/town-alpha/").concat(t,".png")})},jc=function(e){var t,n;switch(e){case"workshop":t=373,n=610;break;case"quarry":t=632,n=633;break;case"tannery":t=372,n=460;break;case"tavern":t=500,n=469;break;case"alchemist":t=411,n=371;break;case"garden":t=822,n=689;break;case"weaponsmith":t=449,n=460;break;case"armoursmith":t=473,n=442;break;case"warehouse":t=471,n=130;break;case"lumberMill":t=403,n=320;break;case"mine":t=183,n=527;break;case"weaver":t=484,n=333}return new pt.Point(t,n)},hc=(n(538),new kt.a(8,16763904)),fc=Et((function(){var e=Object(vt.g)("".concat(Object(se.c)(),"/:structure")),t=Object(vt.g)("".concat(Object(se.c)(),"/:structure/view")),n=null===e||void 0===e?void 0:e.params.structure,r=Object(f.useRef)(null),a=Object(f.useRef)(null),c=Object(f.useRef)(!1),o=Object(vt.h)();Object(f.useEffect)((function(){yt.c.addSound("music/town","sound/music/Soliloquy.mp3",(function(){yt.c.playSound("music/town",yt.a.music,!0,yt.b.fade,!0)}))}),[]),Object(f.useEffect)((function(){var e=Ot.b.to(hc,{duration:.6,thickness:2,yoyo:!0,repeat:-1});return function(){e.pause(0),e.kill()}}),[]),Object(f.useEffect)((function(){if(a.current){var e=a.current;e.on("drag-start",(function(e){c.current=!0,e.event.stopPropagation()})),e.on("drag-end",(function(){c.current=!1}))}}),[]);var i=function(e){!c.current&&e&&(yt.c.playSound("ui/buttonClick"),o(Object(se.b)(e)))},s=Object(g.d)((function(e){return e.structures}));Object(f.useEffect)((function(){if(n&&a.current){var e=a.current;e.zoomPercent(0);var t=jc(n);e.moveCenter(t)}}),[n]);var u=Object(f.useState)(Ts),l=Object(h.a)(u,2),d=l[0],m=l[1],b=Object(f.useState)(1079),p=Object(h.a)(b,2),j=p[0],v=p[1];return Object(f.useEffect)((function(){var e=function(){var e,t,n=(null===(e=r.current)||void 0===e?void 0:e.clientWidth)||Ts,a=(null===(t=r.current)||void 0===t?void 0:t.clientHeight)||1079;m(n),v(a)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e),window.scrollY=0}}),[]),Object(dt.jsxs)("div",{className:"town-view",ref:r,children:[null===t&&Object(dt.jsxs)(Zt,{screenWidth:d,screenHeight:j,worldWidth:1024,worldHeight:1600,ref:a,blockScroll:null===t,children:[Object(dt.jsx)(Jt,{worldWidth:d}),["workshop","quarry","tavern","tannery","alchemist","garden","weaponsmith","armoursmith","warehouse","mine","lumberMill","weaver"].reverse().map((function(e){if(s[e].state===ye.NotBuilt)return null;var t=function(e){switch(e){case"workshop":case"quarry":case"tannery":case"alchemist":case"garden":case"weaponsmith":case"armoursmith":case"warehouse":case"mine":case"weaver":return pc;case"lumberMill":return sc;case"tavern":return bc}}(e),r=jc(e),a=new Ct(It,e);return Object(dt.jsx)(t,{position:r,structure:e,hitAreaShapes:a,onStructureClick:i,selected:n===e},e)})),Object(dt.jsx)(Jt,{worldWidth:d}),Object(dt.jsx)(ic,{})]}),Object(dt.jsx)(vt.d,{children:Object(dt.jsx)(vt.b,{path:":structure/view",element:Object(dt.jsx)(Qa,{})})})]})})),vc=(n(539),function(){var e=Object(f.useState)([]),t=Object(h.a)(e,2),n=t[0],r=t[1],a=function(e){e&&r(e)};return Object(f.useEffect)((function(){return oe.b.instance.addListener(oe.a,a),function(){oe.b.instance.removeListener(oe.a,a)}}),[]),Object(dt.jsx)("div",{className:"toasts",children:n.map((function(e){return Object(dt.jsx)(ie.b,Object(ge.a)({},e),e.time)}))})}),gc=function(e,t){return{type:"setSetting",setting:e,value:t}},Oc=function(){return Object(g.d)((function(e){return e.settings}))},yc=(n(540),Object(be.compose)(rn)((function(){var e=Oc(),t=Object(g.c)(),n=function(e){return Object(dt.jsxs)("p",{children:[Object(dt.jsx)("label",{children:yt.a[e]}),Object(dt.jsx)("button",{onClick:function(t){var n,r=null===(n=t.currentTarget.parentNode)||void 0===n?void 0:n.lastChild;r&&Ot.a.to(r,{duration:.5,value:0,onComplete:function(){yt.c.setChannelVolume(e,0)}})},children:Object(dt.jsx)("span",{role:"img","aria-label":"Mute",children:"\ud83d\udd07"})}),Object(dt.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",onChange:function(t){var n=parseFloat(t.target.value),r=Math.pow(n,2);yt.c.setChannelVolume(e,r)},defaultValue:"".concat(Math.sqrt(yt.c.getChannelVolume(e)))})]})},r=function(e){var n=e.currentTarget.getAttribute("setting-name");if(null===n)throw new Error("No setting");t(gc(n,e.currentTarget.checked))};return Object(dt.jsxs)("div",{className:"settings-window",children:[Object(dt.jsxs)("details",{open:!0,className:"settings-section sound",children:[Object(dt.jsx)("summary",{children:"Sound volume"}),Object(dt.jsxs)("section",{children:[n(yt.a.ui),n(yt.a.scene),n(yt.a.music),n(yt.a.ambient)]})]}),Object(dt.jsxs)("details",{open:!0,className:"settings-section combat",children:[Object(dt.jsx)("summary",{children:"Combat"}),Object(dt.jsx)("section",{children:Object(dt.jsxs)("p",{children:[Object(dt.jsx)("label",{children:"Verbose combat log"}),Object(dt.jsx)("input",{type:"checkbox",checked:e.verboseCombatLog,"setting-name":"verboseCombatLog",onChange:r})]})})]}),Object(dt.jsxs)("details",{open:!0,className:"settings-section debug",children:[Object(dt.jsx)("summary",{children:"Debug"}),Object(dt.jsx)("section",{children:Object(dt.jsxs)("p",{children:[Object(dt.jsx)("label",{children:"Enable debug drawer (~ key)"}),Object(dt.jsx)("input",{type:"checkbox",checked:e.debugEnableDebugDrawer,"setting-name":"debugEnableDebugDrawer",onChange:r})]})})]})]})}))),xc=[T.food,T.wood,T.iron,T.stone,T.fabric,T.leather],wc=n(337);function kc(e){return Object(dt.jsx)(wc.a,Object(ge.a)({styles:{control:function(e,t){return Object(ge.a)(Object(ge.a)({},e),{},{minHeight:"inherit",height:"32px",boxShadow:"0",border:t.isFocused?"1px solid orange":"1px solid #B1B1B1",":hover":{border:"1px solid orange"}})},container:function(e,t){return Object(ge.a)(Object(ge.a)({},e),{},{flex:1})},option:function(e){return Object(ge.a)(Object(ge.a)({},e),{},{padding:"4px 12px"})},placeholder:function(e){return Object(ge.a)(Object(ge.a)({},e),{},{whiteSpace:"nowrap"})},valueContainer:function(e){return Object(ge.a)(Object(ge.a)({},e),{},{marginTop:"-2px"})},indicatorsContainer:function(e){return Object(ge.a)(Object(ge.a)({},e),{},{marginTop:"-2px",div:{padding:"4px"}})}}},e))}kc.displayName="DefaultSelect";var Ac,Nc=kc,Cc=(n(545),rn((function(){var e=Object(f.useState)({gold:50,resources:50,workers:10}),t=Object(h.a)(e,2),n=t[0],r=t[1],a=Object(f.useState)(),c=Object(h.a)(a,2),o=c[0],i=c[1],s=Object(g.c)(),u=Object(f.useState)(_(F.cheat)),l=Object(h.a)(u,2),d=l[0],b=l[1],p=Object(g.d)((function(e){return e.structures})),j=function(e,t){!function(e,t){s(ar(e,t))}(e,t?ye.Built:ye.NotBuilt),t?oe.b.addToast("The ".concat(m.a.getStructureName(e)," is constructed"),ie.a.cheat):oe.b.addToast("The ".concat(m.a.getStructureName(e)," is not constructed"),ie.a.cheat)},v=Object(f.useMemo)((function(){return Object.keys(Ne.a).filter((function(e){return!isNaN(parseInt(e))})).map((function(e){return{label:Ne.a[e],value:"",subtext:"",options:Object.keys(Ce.b).filter((function(t){return Object(Ce.d)(t).itemCategory==e})).map((function(e){return{value:e,label:m.a.getItemName(e),subtext:m.a.getItemSubtext(e)}}))}}))}),[]);return Object(f.useEffect)((function(){0}),[]),Object(dt.jsxs)("div",{className:"cheat-window",children:[Object(dt.jsxs)("div",{className:"label-numberbox-button",children:[Object(dt.jsx)("label",{children:"Gold"}),Object(dt.jsx)("input",{type:"number",value:n.gold,style:{width:"50px"},onChange:function(e){var t=Number.parseFloat(e.target.value);r(Object(ge.a)(Object(ge.a)({},n),{},{gold:t}))}}),Object(dt.jsx)("button",{onClick:function(e){var t=n.gold;!function(e){s(Object(lr.a)(e)),s(Object(x.b)("common-cheat-gold-added",{amount:e},ae.a.common))}(t);var r=m.a.get("common-cheat-gold-added",{amount:t});oe.b.addToast(r,ie.a.cheat,"/img/resources/gold.png")},children:"Add"})]}),Object(dt.jsxs)("div",{className:"label-numberbox-button",children:[Object(dt.jsx)("label",{children:"Workers"}),Object(dt.jsx)("input",{type:"number",value:n.workers,style:{width:"50px"},onChange:function(e){var t=Number.parseFloat(e.target.value);r(Object(ge.a)(Object(ge.a)({},n),{},{workers:t}))}}),Object(dt.jsx)("button",{onClick:function(e){var t=n.workers;!function(e){s({type:"addWorkers",value:e}),s(Object(x.b)("common-cheat-workers-added",{amount:e},ae.a.common))}(t);var r=m.a.get("common-cheat-workers-added",{amount:t});oe.b.addToast(r,ie.a.cheat,"/img/resources/worker.png")},children:"Add"})]}),Object(dt.jsxs)("div",{className:"label-numberbox-button",children:[Object(dt.jsx)("label",{children:"Resources"}),Object(dt.jsx)("input",{type:"number",value:n.resources,style:{width:"50px"},onChange:function(e){var t=Number.parseFloat(e.target.value);r(Object(ge.a)(Object(ge.a)({},n),{},{resources:t}))}}),Object(dt.jsx)("button",{onClick:function(e){!function(e){var t=xc.reduce((function(t,n){return t[n]=e,t}),{});s($n(t)),s(Object(x.b)("common-cheat-resources-added",{amount:e},ae.a.common))}(n.resources);var t=m.a.get("common-cheat-resources-added",{amount:n.resources});oe.b.addToast(t,ie.a.cheat)},children:"Add"})]}),Object(dt.jsxs)("div",{className:"label-numberbox-button",children:[Object(dt.jsx)("label",{children:"Items"}),Object(dt.jsx)(Nc,{placeholder:"Find item in any category...",onChange:function(e){return i(null===e||void 0===e?void 0:e.value)},formatGroupLabel:function(e){return Object(dt.jsxs)("div",{className:"item-group",children:[Object(dt.jsx)("div",{className:"item-group-label",children:e.label}),Object(dt.jsxs)("div",{className:"item-group-count",children:[e.options.length," items"]})]})},formatOptionLabel:function(e){return Object(dt.jsxs)("div",{className:"item-option",children:[Object(dt.jsx)(Sn,{item:{type:e.value},size:fn.a.smallest}),Object(dt.jsxs)("div",{className:"item-label",children:[e.label,Object(dt.jsx)("span",{children:e.subtext})]})]})},options:v}),Object(dt.jsx)(_t,{onClick:function(e){var t=o;!function(e){var t={type:e};s(Xn(t)),s(Object(x.b)("common-cheat-item-added",{item:t},ae.a.common))}(t);var n=m.a.get("common-cheat-item-added",{item:t}),r=Object(Ce.d)(t).iconImg;oe.b.addToast(n,ie.a.cheat,r)},children:"Add"})]}),Object(dt.jsxs)("div",{className:"label-range-value",children:[Object(dt.jsx)("label",{children:"Speed"}),Object(dt.jsx)("input",{type:"range",min:"1",max:"10",value:d,step:1,onChange:function(e){var t=Number.parseFloat(e.target.value);b(t),function(e){K=e}(t)}}),d,"x speed"]}),Object(dt.jsx)("div",{children:Object(dt.jsx)("h2",{children:"Structures"})}),Object.keys(p).map((function(e){return function(e){var t=J(e),n=p[e],r=t.levels[n.level],a=m.a.get(r.displayName);return Object(dt.jsxs)("div",{className:"label-dropdown",children:[Object(dt.jsx)("label",{title:e,children:"".concat(a)}),Object(dt.jsx)("input",{type:"checkbox",checked:n.state===ye.Built,onChange:function(){return j(e,n.state!==ye.Built)}},e)]},e)}(e)}))]})}))),Ic=function(e){return e.adventurers},Sc=function(e){return e.quests},Tc=function(e,t){var n=[],r=Object.values(t).reduce((function(t,r){var a=Object(le.d)(e,r);return r.status===ce.a.active&&(t[r.name]=a),n.push.apply(n,Object(j.a)(a)),t}),{});return r.solo=e.filter((function(e){return-1===n.indexOf(e)})),r},Ec=(Object($.a)([Ic,Sc],Tc),function(e){return Object($.a)([Ic,Sc],(function(t,n){var r=n.find((function(t){return t.name===e}));if(!r)throw new Error("No quest named ".concat(e));return Object(le.d)(t,r)}))}),qc=(Object($.a)([Ic,Sc],(function(e,t){var n=t.reduce((function(e,t){return t.status===ce.a.active&&e.push.apply(e,Object(j.a)(t.party)),e}),[]);return e.filter((function(e){return-1===n.indexOf(e.id)}))})),n(546),function(e){var t,n=e.state,r=e.loadGameMode,a=Object(C.i)(n.engine.lastTick-(null!==(t=n.engine.gameStarted)&&void 0!==t?t:0),!0),c=Tc(n.adventurers,n.quests),o=Object(f.useMemo)((function(){var e;return null!==(e=n.game)&&void 0!==e&&e.version?n.game.version===N?w(n.game.version):Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)("span",{className:"invalid",children:w(n.game.version)}),Object(dt.jsx)("span",{className:"prop",children:" (current: "}),Object(dt.jsx)("span",{children:w(N)}),Object(dt.jsx)("span",{className:"prop",children:") "})]}):"unknown"}),[n.game.version]);return Object(dt.jsxs)("div",{className:"game-stats",children:[Object(dt.jsxs)("div",{className:"column",children:[Object(dt.jsxs)("fieldset",{children:[Object(dt.jsx)("legend",{children:"General"}),Object(dt.jsxs)("dl",{children:[Object(dt.jsx)("dt",{children:"Time playing"}),Object(dt.jsx)("dd",{children:a}),r&&Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)("dt",{children:"Time saved"}),Object(dt.jsx)("dd",{children:Object(C.h)(n.engine.lastTick)})]}),Object(dt.jsx)("dt",{children:"Version"}),Object(dt.jsx)("dd",{children:o}),Object(dt.jsx)("dt",{children:"Quests active"}),Object(dt.jsx)("dd",{children:n.quests.filter((function(e){return e.status===ce.a.active})).length}),Object(dt.jsx)("dt",{children:"Quests completed"}),Object(dt.jsx)("dd",{children:n.quests.filter((function(e){return e.status===ce.a.completed})).length})]})]}),Object(dt.jsxs)("fieldset",{children:[Object(dt.jsx)("legend",{children:"Structures"}),Object(dt.jsx)("dl",{children:Object.keys(n.structures).map((function(e){var t=e;return n.structures[t].state===ye.Built?Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("dt",{children:m.a.getStructureName(t)}),Object(dt.jsxs)("dd",{children:[m.a.get("ui-structure-level")," ",n.structures[t].level+1]})]},t):n.structures[t].state===ye.Building?Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("dt",{children:m.a.getStructureName(t)}),Object(dt.jsx)("dd",{children:"constructing..."})]},t):null}))})]})]}),Object(dt.jsxs)("div",{className:"column",children:[Object(dt.jsxs)("fieldset",{children:[Object(dt.jsx)("legend",{children:"Resources"}),Object(dt.jsxs)("dl",{children:[Object.keys(n.resources).map((function(e){var t=e;return Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("dt",{children:m.a.getResourceName(t)}),Object(dt.jsx)("dd",{children:n.resources[t]})]},t)})),Object(dt.jsx)("dt",{children:m.a.get("resource-gold-name")}),Object(dt.jsx)("dd",{children:n.gold}),Object(dt.jsx)("dt",{children:m.a.get("resource-workers-name")}),Object(dt.jsx)("dd",{children:n.workers})]})]}),Object(dt.jsxs)("fieldset",{children:[Object(dt.jsx)("legend",{children:"Adventurers"}),Object(dt.jsxs)("dl",{children:[Object(dt.jsx)("dt",{children:"In tavern"}),Object(dt.jsx)("dd",{children:c.solo.length}),Object(dt.jsx)("dt",{children:"On quest"}),Object(dt.jsx)("dd",{children:n.adventurers.length-c.solo.length})]})]})]})]})}),Rc=n(331),Dc=Object(Rc.createEncryptor)("P5mw}jD>5c6Y]yqy"),Mc=(n(649),Object(be.compose)(rn,Et)((function(e){var t=Object(g.d)((function(e){return e})),n=Object(f.useState)(),a=Object(h.a)(n,2),o=a[0],i=a[1],s=Object(f.useState)(!1),u=Object(h.a)(s,2),l=u[0],d=u[1],b=Object(g.c)(),p=function(){var t=Object(r.a)(c.a.mark((function t(){var n,r,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o){t.next=2;break}return t.abrupt("return");case 2:if(!((a=null===(n=o.game)||void 0===n?void 0:n.version)<N&&(null===(r=o.game)||void 0===r?void 0:r.ignoreVersionDiff)!==N)){t.next=7;break}if(window.confirm("This game was initialized with version ".concat(w(a)," which is older than the current client (").concat(A,"). This might cause problems. Continue anyway? \n\n "))){t.next=6;break}return t.abrupt("return");case 6:o.game.ignoreVersionDiff=N;case 7:d(!0),i(void 0),b(y(o)),oe.b.addToast(m.a.get("ui-game-loaded"),ie.a.game,"/img/items/misc/magic-eye.png"),e.onCloseWindow();case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(dt.jsxs)("div",{className:"save-and-load",children:[Object(dt.jsxs)("section",{children:["Save game to disk:\xa0",Object(dt.jsx)(_t,{onClick:function(){!function(e){var t=document.createElement("a"),n=JSON.stringify(e),r=Dc.encrypt(n);t.setAttribute("href","data:text/json;charset=utf-8,"+encodeURIComponent(r)),t.setAttribute("download","Gidletown save.json"),t.click()}(t)},children:"Save"})]}),Object(dt.jsxs)("section",{children:["Load game from disk:\xa0",Object(dt.jsx)("input",{type:"file",onChange:function(e){var t=new FileReader;t.onload=function(){var e=function(e){var t=Dc.decrypt(e);return JSON.parse(t)}(t.result);i(e)},e.target.files&&t.readAsText(e.target.files[0])},accept:".json"}),Object(dt.jsx)(_t,{onClick:p,disabled:!o,children:"Load"})]}),Object(dt.jsxs)("div",{children:[l&&Object(dt.jsx)(mt,{}),o&&Object(dt.jsx)(qc,{state:o,loadGameMode:!0})]})]})}))),Lc=(n(650),Object(be.compose)(rn,Et)((function(e){var t=Object(g.d)((function(e){return e}));return Object(dt.jsxs)("div",{className:"menu",children:[Object(dt.jsx)("p",{children:Object(dt.jsx)(_t,{onClick:function(){var t=Object(dt.jsx)(Mc,{title:"Save and Load"});e.onOpenWindow(t)},children:"Save and load"})}),Object(dt.jsx)("p",{children:Object(dt.jsx)(_t,{onClick:function(){var t=Object(dt.jsx)(Cc,{title:"Cheats"});e.onOpenWindow(t)},children:"Cheats!"})}),Object(dt.jsx)("p",{children:Object(dt.jsx)(_t,{onClick:function(){var t=Object(dt.jsx)(yc,{title:"Settings"});e.onOpenWindow(t)},children:"Settings"})}),Object(dt.jsx)("div",{children:Object(dt.jsx)(qc,{state:t})})]})}))),zc=(n(651),function(){var e=Ln(),t=Dn(),n=Wn(),r=Mn(),a=function(e,t,n){var a,c="workers"!==n&&"gold"!==n&&(null!==t&&void 0!==t?t:0)>=(null!==(a=null===r||void 0===r?void 0:r[n])&&void 0!==a?a:0);return Object(dt.jsxs)("li",{onClick:function(e){var t=e.currentTarget.getBoundingClientRect();An.showContextTooltip(ln.resource,n,t),e.stopPropagation()},children:[Object(dt.jsx)(fn.b,{image:e,size:"smallest"}),Object(dt.jsx)("div",{className:"amount ".concat(c?"full":""),children:hr(t,0)})]},n)},c=xc.map((function(e){var n;return a(H[e].iconImg,null!==(n=t[e])&&void 0!==n?n:0,e)}));return c.push(a("/img/resources/worker.png",n,"workers"),a("/img/resources/gold.png",e,"gold")),Object(dt.jsx)("ul",{className:"resourcebar",children:c})}),Pc=(n(652),function(){var e=Object(f.useContext)(Es);return Object(dt.jsxs)("div",{className:"topbar",children:[Object(dt.jsx)("div",{className:"topbar-left",children:Object(dt.jsx)(zc,{})}),Object(dt.jsx)("div",{className:"topbar-right",children:Object(dt.jsx)("div",{className:"hamburger",onClick:function(t){var n=Object(dt.jsx)(Lc,{title:"Menu"});null===e||void 0===e||e.onOpenWindow(n)},children:"\u2630"})})]})}),Wc=function(e){var t=e.quest,n=e.leader,r=e.encounterActive,a=e.position,c=e.onClick,o=e.selected?"/img/world/map-marker-selected.png":"/img/world/map-marker.png",i=Object(f.useRef)(null);return Object(f.useEffect)((function(){var e=i.current,t=new pt.Graphics;t.beginFill(12245589),t.drawCircle(0,0,256),t.endFill(),e.mask=t,e.addChild(t)}),[i]),Object(dt.jsxs)(qt.Sprite,{image:"".concat(".").concat(o),name:t.name,x:a.x,y:a.y,interactive:!0,buttonMode:!0,scale:new pt.Point(.1,.1),anchor:new pt.Point(.5,1),pointerdown:function(){c&&c(t)},children:[n&&Object(dt.jsx)(qt.Sprite,{image:"".concat(".").concat(n.avatarImg),name:"avatar",anchor:new pt.Point(.5,.5),x:0,y:-396,scale:new pt.Point(.66,.66),ref:i}),r&&Object(dt.jsx)(qt.Sprite,{image:"".concat(".","/img/world/quest-alert.png"),name:"quest-alert",anchor:new pt.Point(.5,1),x:180,y:-396,scale:new pt.Point(2,2)})]})},Vc=function(e){var t=e.positions;return e.positions.length>2?Object(dt.jsx)(qt.Graphics,{name:"questline",x:0,y:0,draw:function(e){e.lineStyle(3,16724736),e.moveTo(t[0].x,t[0].y);var n=0;for(n=1;n<t.length-2;n++){var r=(t[n].x+t[n+1].x)/2,a=(t[n].y+t[n+1].y)/2;e.quadraticCurveTo(t[n].x,t[n].y,r,a)}e.quadraticCurveTo(t[n].x,t[n].y,t[n+1].x,t[n+1].y),e.endFill()}}):null},Qc=function(e){var t,n=e.questName,r=Br(n),a=Object(g.c)();return null!==(t=r.scene)&&void 0!==t&&t.combat&&void 0!==r.scene.turn?Object(dt.jsxs)("button",{onClick:function(){return a(Object(ue.i)(n,!1))},children:["combat: on (",Ee.a[r.scene.turn],")"]}):Object(dt.jsx)("button",{onClick:function(){return a(Object(ue.i)(n,!0))},children:"combat: off"})},Bc=function(e){var t=Object(ne.a)(e.name),n=Math.floor(e.progress),r=t.nodes[n],a=t.nodes[n+1];return a?Object(b.a)(r,a,e.progress-n):r},Gc=function(e){var t=10*e.x+750,n=10*e.y+530.5;return new pt.Point(t,n)},Fc=(n(653),function(e){var t=e.retrieveWorldViewRef,n=e.smallMap,r=Object(f.useCallback)((function(t){return t.quests.find((function(t){return t.name===e.selectedQuestName}))}),[e.selectedQuestName]),a=Object(g.d)(r),c=Object(g.d)((function(e){return e.adventurers})),o=function(){var e=Object(f.useMemo)((function(){return Object($.a)([Pr],Qr)}),[]);return Object(g.d)(e)}(),i=Object(vt.h)(),s=Object(f.useRef)(null),u=Object(f.useState)(Ts),l=Object(h.a)(u,2),d=l[0],b=l[1],p=Object(f.useState)(1024),j=Object(h.a)(p,2),v=j[0],O=j[1];Object(f.useEffect)((function(){var e=function(){var e,r,a=t(),c=(null===(e=a.current)||void 0===e?void 0:e.clientWidth)||Ts,o=(null===(r=a.current)||void 0===r?void 0:r.clientHeight)||1024;b(c),O(n?c<576?32:64:o);var i=s.current;i&&i.resize(d,v)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[v,d,t,n]),Object(f.useEffect)((function(){if(a)!function(e){var t=s.current;if(t){var n=Bc(e),r=Gc(n);t.moveCenter(r.x,r.y)}}(a);else{var e=s.current,t=Gc({x:0,y:0});null===e||void 0===e||e.moveCenter(t.x,t.y)}}),[a,v]),Object(f.useEffect)((function(){if(s.current){var e=s.current,t=Gc({x:0,y:0});e.moveCenter(t.x/2,t.y/2+10)}}),[d]);var y={autoDensity:!0,sharedLoader:!0,width:d,height:v};return Object(dt.jsxs)("div",{className:"world-map",children:[Object(dt.jsx)(qt.Stage,{width:d,height:v,options:y,children:Object(dt.jsx)(Lt,{screenWidth:d,screenHeight:v,worldWidth:1500,worldHeight:1061,ref:s,children:Object(dt.jsxs)(qt.Sprite,{image:"".concat(".","/img/world/francesca-baerald-fbaerald-angeloumap-lowres.jpg"),interactive:!0,pointerdown:function(){},children:[o.map((function(e){var t=function(e){for(var t=[],n=Object(ne.a)(e.name),r=0;r<e.progress;r++)t.push(Gc(n.nodes[r]));var a=Gc(Bc(e));return t.push(a),t}(e);return Object(dt.jsx)(Vc,{positions:t},e.name)})),o.map((function(t){var n,r=Bc(t),o=Gc(r),i=null!==(n=Object(le.f)(c,t))&&void 0!==n?n:c[0],s=Object(ne.a)(t.name),u=Math.floor(t.progress),l=s.nodes[u];return Object(dt.jsx)(Wc,{quest:t,leader:i,position:o,selected:t===a,encounterActive:l.type===re.a.encounter,onClick:function(t){return n=t.name,void e.onPartyClick(n);var n}},t.name)}))]})})}),e.selectedQuestName&&Object(dt.jsxs)("div",{className:"title",children:[Object(dt.jsxs)("span",{children:[Object(dt.jsx)(Qc,{questName:e.selectedQuestName}),m.a.getQuestTitle(e.selectedQuestName)," | ",null!==a&&void 0!==a&&a.sceneName?m.a.getQuestSceneTitle(a):"..."]}),Object(dt.jsx)("span",{onClick:function(){i(Object(se.d)())},className:"close",children:"x"})]})]})}),Hc=n(151),Zc=n(53),Uc=n(173),Yc=Object(qt.PixiComponent)("RectTileLayer",{create:function(e){return new Uc.a},applyProps:function(e,t,n){var r=n.layer,a=n.tilesets,c=n.horizontalTiles,o=n.spritesheets;if(r.data)for(var i=0;i<r.data.length;i++){var s=Object(Zc.c)(r.data[i],a);if(s){var u=s.tilewidth,l=s.tileheight,d=i%c*u,m=Math.floor(i/c)*l,b=o[s.name];if(r.data[i]>0){var p="".concat(s.name,"-").concat(r.data[i]);if(!b.textures[p])continue;e.addFrame(b.textures[p],d,m)}}}}}),Jc=Object(qt.PixiComponent)("ObjectTileLayer",{create:function(e){return new Uc.a},applyProps:function(e,t,n){var r=n.objects,a=n.tilesets,c=n.spritesheets;r.length&&(e.clear(),r&&r.forEach((function(t){if(t.gid){var n=Object(Zc.c)(t.gid,a);if(n){var r=t.x,o=t.y-n.tileheight,i=c[n.name],s="".concat(n.name,"-").concat(t.gid);e.addFrame(i.textures[s],r,o)}}})))}}),Xc=Object(qt.PixiComponent)("SpriteAnimated",{create:function(e){var t=e.textures,n=e.name;return null!==t&&void 0!==t&&t[0]||console.warn("Something went wrong with ".concat(n)),new pt.AnimatedSprite(t||[],!0)},applyProps:function(e,t,n){var r,a;t.textures===n.textures&&(r=t.scale,a=n.scale,r&&a&&r[0]==a[0]&&r[1]==a[1])||(Object(qt.applyDefaultProps)(e,t,n),e.gotoAndPlay(0))}}),Kc=n(332);!function(e){e.north="n",e.northEast="ne",e.east="e",e.southEast="se",e.south="s",e.southWest="sw",e.west="w",e.northWest="nw"}(Ac||(Ac={}));var _c=142,$c=function(e,t){var n=e.map((function(n,r){return[e[r],t[r]]}));return new Kc.a(n,.15)},eo=[3679,8831,14501,21964],to=[5703680,7343104,9441280,11867904],no=[13069,25914,562031,3194533],ro=[3870010,6561118,8930966,11166141],ao=[8400140,11160082,13724945,16094999],co=[855322,1710891,2434618,3487052],oo=[3159902,6777235,11119298,15132390],io=[12748288,14069264,15323955,16644441],so=n(174),uo=n(11),lo=function(){function e(){Object(At.a)(this,e)}return Object(Nt.a)(e,null,[{key:"initialize",value:function(e){this.sceneController=e;var t=this.handleStoreChange.bind(this);this.unsubscriber=e.store.subscribe(t)}},{key:"destroy",value:function(){var e;null===(e=this.unsubscriber)||void 0===e||e.call(this)}},{key:"handleStoreChange",value:function(){var e,t=this;if(this.sceneController){var n=this.sceneController.sceneAdventurers,r=this.sceneController.sceneEnemies,a=this.sceneController.quest;if(n&&r&&a&&a.scene&&(null===(e=a.scene.actionQueue)||void 0===e||!e.length)){var c,o=n.reduce((function(e,t){return e+t.ap}),0),i=a.scene,s=i.turn;if(0===o&&s===Ee.a.player)return void this.dispatch(Object(ue.l)(a.name,Ee.a.enemy));if(s===Ee.a.enemy&&0===(null===(c=i.actionQueue)||void 0===c?void 0:c.length)){if(0===r.reduce((function(e,t){return e+t.ap}),0))return void this.dispatch(Object(ue.l)(a.name,Ee.a.player,this.sceneController.getAdventurers()));var u=this.findEnemyWithAp();if(u&&u.location){var l=this.findNearestActor(u.location,Ee.a.player);if(!l||!l.location)return;var d=this.sceneController.findPath(u.location,l.location),m=this.sceneController.createActionIntent(Ee.b.move,u,l.location);if(!m||m.action!==Ee.b.move)return;null===d||void 0===d||d.forEach((function(e,n){if(!(n>=u.ap-1)){var r={endsAt:so.b*(n+1)+performance.now(),intent:m};t.dispatch(Object(ue.d)(a.name,r))}}))}}}}}},{key:"actorMeleeStart",value:function(e,t){if(this.sceneController){yt.c.playSound("scene/swish",yt.a.scene,!1,yt.b.singleInstance);var n=this.sceneController.getSceneActor(e);if(!n)throw new Error("No actor found");var r=this.getActorMainhandItem(n);if(!r)throw new Error("No weapon found");if(Object(Hn.b)(r.type).weaponType===uo.c.knife)yt.c.playSound("scene/daggerSwish",yt.a.scene,!1,yt.b.singleInstance);else yt.c.playSound("scene/swish",yt.a.scene,!1,yt.b.singleInstance)}}},{key:"actorMeleeEnd",value:function(e,t){var n,r=t.to,a=Me.b;this.dispatch(Object(ue.b)(this.questName,e,a));var c=this.sceneController.getSceneActor(e);if(!c)throw new Error("No actor found");if(t.action!==Ee.b.melee)throw new Error("Wrong action type");var o=t.weaponWithAbility.weapon;if(!o)throw new Error("No weapon found");var i=Object(Hn.b)(o.type),s=this.sceneController.getActorSkills(c),u=Object(d.d)();if(u<=(null!==(n=s[i.weaponType])&&void 0!==n?n:0)){console.log("HIT at ",r);var l=this.sceneController.getObjectAtLocation(r),m=this.sceneController.getActorAttributes(l),b=Object(Me.f)(m);console.log("dodge ",b),this.sceneController.bubbleAtLocation("HIT",r)}else this.sceneController.bubbleAtLocation("MISS",r),this.settings.verboseCombatLog?this.log({key:"scene-combat-attack-slash-missed-verbose",context:{actor:Object(Ee.d)(c),weapon:o.type,ap:a,roll:u,weaponType:i.weaponType,skill:s[i.weaponType]}}):this.log({key:"scene-combat-attack-slash-missed",context:{actor:c,weapon:o.type}})}},{key:"actorShootStart",value:function(e,t){var n=this.sceneController.getSceneActor(e);if(!n)throw new Error("No actor found");if(t.action!==Ee.b.shoot)throw new Error("Wrong action type");var r=t.weaponWithAbility.weapon;if(!r)throw new Error("No weapon found");switch(Object(Hn.b)(r.type).weaponType){case uo.c.bow:yt.c.playSound("scene/bow",yt.a.scene,!1,yt.b.singleInstance);break;case uo.c.crossbow:yt.c.playSound("scene/crossbow",yt.a.scene,!1,yt.b.singleInstance)}var a=t.ammo;if(a&&Object(Ee.f)(n)){var c=a.quantity||1;this.dispatch(Object(rt.e)(e,Nr.a.offHand,--c))}}},{key:"actorShootEnd",value:function(e,t){var n=Me.d;this.dispatch(Object(ue.b)(this.questName,e,n));var r=this.sceneController.getSceneActor(e);if(!r)throw new Error("No actor found");if(t.action!==Ee.b.shoot)throw new Error("Wrong action type");var a=t.weaponWithAbility.weapon;if(!a)throw new Error("No weapon found");var c=Object(Hn.b)(a.type),o=this.sceneController.getActorSkills(r),i=this.sceneController.getObjectAtLocation(t.to);if(Object(Me.j)(o[c.weaponType])){var s=this.sceneController.getActorAttributes(i);if(Object(Me.i)(s))this.log({key:"scene-combat-attack-shoot-dodged",context:{attacker:Object(Ee.d)(r),weapon:a,target:Object(Ee.d)(i)}});else{var u,l,d=null!==(u=null===(l=c.damage)||void 0===l?void 0:l[uo.a.kinetic])&&void 0!==u?u:0,b=Object(Me.h)(),p=d-this.getArmor(i,b),j=d-p;this.takeDamage(i,p),this.log({key:"scene-combat-attack-shoot-hit",context:{attacker:Object(Ee.d)(r),weapon:a,bodyPart:m.a.getEquipmentSlot(b),target:Object(Ee.d)(i),damage:p,absorbed:j}})}}else this.log({key:this.settings.verboseCombatLog?"scene-combat-attack-shoot-missed-verbose":"scene-combat-attack-shoot-missed",context:{attacker:Object(Ee.d)(r),weapon:a.type,ap:n,roll:Me.j,weaponType:c.weaponType,skill:o[c.weaponType]}})}},{key:"getQuestStoreState",value:function(){var e,t=this;return null===(e=this.sceneController)||void 0===e?void 0:e.store.getState().quests.find((function(e){var n;return e.name===(null===(n=t.sceneController)||void 0===n?void 0:n.questName)}))}},{key:"findNearestActor",value:function(e,t){var n=this;if(this.sceneController){var r,a=this.sceneController.sceneActors,c=Number.MAX_VALUE;return null===a||void 0===a||a.forEach((function(a){var o;if(a.location&&n.sceneController&&!Object(Zc.d)(a.location,e)){var i=null===(o=n.sceneController.findPath(e,a.location))||void 0===o?void 0:o.length;void 0!==i&&i<c&&(void 0!==t&&a.allegiance!==t||(c=i,r=a))}})),r}}},{key:"findEnemyWithAp",value:function(){if(this.sceneController){var e=this.sceneController.sceneActors;return null===e||void 0===e?void 0:e.find((function(e){return e.allegiance===Ee.a.enemy&&e.ap>0}))}}},{key:"questName",get:function(){return this.sceneController.questName}},{key:"getActorMainhandItem",value:function(e){if(Object(Ee.f)(e)){var t=this.sceneController.getAdventurerByActor(e);if(!t)throw new Error("No adventurer found");return t.equipment[Nr.a.mainHand]}return this.sceneController.getEnemyByActor(e).mainHand}},{key:"getArmor",value:function(e,t){var n;if(Object(Ee.f)(e)){var r,a,c=this.sceneController.getAdventurerByActor(e);if(!c)throw new Error("No adventurer found");var o=null===(r=c.equipment[t])||void 0===r?void 0:r.type;return o&&Object(Zn.c)(o)&&(null!==(a=Object(Zn.b)(o).damageReduction)&&void 0!==a)?a:0}return null!==(n=this.sceneController.getEnemyByActor(e).armor[t])&&void 0!==n?n:0}},{key:"takeDamage",value:function(e,t){Object(Ee.f)(e)?this.dispatch(Object(rt.h)(e.adventurerId,-t)):this.dispatch(Object(ue.g)(this.questName,e.enemyId,-t))}},{key:"dispatch",value:function(e){var t;null===(t=this.sceneController)||void 0===t||t.store.dispatch(e)}},{key:"log",value:function(e){this.sceneController.log(e)}},{key:"settings",get:function(){return this.sceneController.settings}}]),e}();lo.sceneController=void 0,lo.unsubscriber=void 0;var mo,bo,po=["stand","attack","walk","die"],jo=function(e,t,n,r,a,c){var o,i=e.getTileDimensions(),s=i.tileWidth,u=i.tileHeight,l=Object(f.useRef)(),d=Object(f.useRef)(),m=Object(g.c)(),b=Br(e.questName),p=Object(f.useCallback)((function(){var e;if(null!==(e=b.scene)&&void 0!==e&&e.actionQueue)return b.scene.actionQueue.filter((function(e){return Object(Ee.d)(e.intent.actor)===n}))[0]}),[null===(o=b.scene)||void 0===o?void 0:o.actionQueue,n]),j=Object(g.d)(p),v=Object(f.useState)("stand"),O=Object(h.a)(v,2),y=O[0],x=O[1],w=Object(f.useRef)();return Object(f.useEffect)((function(){a<=0&&x("die")}),[a]),Object(f.useEffect)((function(){if(j&&j!==l.current){var a=j.intent;switch(j.intent.action){case Ee.b.move:var o,i=function(){x("stand"),m(Object(ue.a)(b.name,n)),e.actorMoved(n,j.intent.to)},d=(j.endsAt-performance.now())/1e3;d<0&&i(),Ot.b.killTweensOf(t.current),w.current=Ot.b.timeline({delay:j.delay,onComplete:i}),null===(o=j.intent.path)||void 0===o||o.forEach((function(e,n){var a,o,i;null===(a=w.current)||void 0===a||a.to(t.current,{duration:d/(null!==(o=null===(i=j.intent.path)||void 0===i?void 0:i.length)&&void 0!==o?o:1),ease:"linear",pixi:{x:e[0]*s,y:e[1]*u},onStart:function(){var t,a;!function(e,t){e[0]===t[0]&&e[1]>t[1]?c(Ac.north):e[0]<t[0]&&e[1]>t[1]?c(Ac.northEast):e[0]<t[0]&&e[1]===t[1]?c(Ac.east):e[0]<t[0]&&e[1]<t[1]?c(Ac.southEast):e[0]===t[0]&&e[1]<t[1]?c(Ac.south):e[0]>t[0]&&e[1]<t[1]?c(Ac.southWest):e[0]>t[0]&&e[1]===t[1]?c(Ac.west):e[0]>t[0]&&e[1]>t[1]&&c(Ac.northWest)}(null!==(t=null===(a=j.intent.path)||void 0===a?void 0:a[n-1])&&void 0!==t?t:r,e),x("walk")}})}));break;case Ee.b.melee:x("attack"),lo.actorMeleeStart(n,a);setTimeout((function(){x("stand"),m(Object(ue.a)(e.questName,n)),lo.actorMeleeEnd(n,a)}),1e3);break;case Ee.b.shoot:x("attack"),lo.actorShootStart(n,a);setTimeout((function(){x("stand"),m(Object(ue.a)(e.questName,n)),lo.actorShootEnd(n,a)}),500);break;case Ee.b.interact:e.actorInteract(n,j.intent.to),m(Object(ue.a)(e.questName,n))}l.current=j}}),[n,t,e,m,r,j,b.name,c,u,s]),Object(f.useEffect)((function(){d.current&&clearTimeout(d.current)}),[y]),Object(f.useEffect)((function(){return function(){var e;null===(e=w.current)||void 0===e||e.kill()}}),[]),y},ho=function(e,t,n){var r=Object(f.useMemo)((function(){var t,n;if(e){if(null===(t=pt.Loader.shared.resources[e])||void 0===t||!t.textures)throw new Error("No textures for ".concat(e));return Object.keys(null!==(n=pt.Loader.shared.resources[e].textures)&&void 0!==n?n:{}).reduce((function(t,n){var r,a=n.replace(/[0-9]/g,"");t[a]||(t[a]=[]);var c=null===(r=pt.Loader.shared.resources[e].textures)||void 0===r?void 0:r[n];return c&&t[a].push(c),t}),{})}}),[e]);return Object(f.useMemo)((function(){if(r){var a=pt.Loader.shared.resources[e];return r[function(){var e="".concat(a.data.meta.image.substring(0,a.data.meta.image.lastIndexOf(".")),"-");switch(n){case Ac.northWest:return"".concat(e).concat(t,"-").concat(Ac.northEast);case Ac.west:return"".concat(e).concat(t,"-").concat(Ac.east);case Ac.southWest:return"".concat(e).concat(t,"-").concat(Ac.southEast);default:return"".concat(e).concat(t,"-").concat(n)}}()]}}),[t,r,n,e])},fo=["location","controller","health","idleAnimation","color","selectionColor","children","spritesheetPath","lookAt","actor"],vo=function(e){var t=e.location,n=void 0===t?[0,0]:t,r=e.controller,a=e.health,c=e.idleAnimation,o=e.color,i=e.selectionColor,s=e.children,u=e.spritesheetPath,l=e.lookAt,d=e.actor,m=Object(Pt.a)(e,fo),b=r.getTileDimensions(),p=b.tileWidth,j=b.tileHeight,v=Object(f.useMemo)((function(){return{x:n[0]*p,y:n[1]*j}}),[n,p,j]),g=v.x,O=v.y,y=Object(f.useRef)(null),x=Object(f.useState)(Ac.north),w=Object(h.a)(x,2),k=w[0],A=w[1],N=jo(r,y,Object(Ee.d)(d),n,a,A);!function(e,t,n){Object(f.useEffect)((function(){if(e){var r=2e3+4e3*Math.random(),a=setInterval((function(){var e=Math.random()<.5;t===Ac.north&&e?n(Ac.northWest):t===Ac.northWest&&e?n(Ac.west):t===Ac.west&&e?n(Ac.southWest):t===Ac.southWest&&e?n(Ac.south):t===Ac.south&&e?n(Ac.southEast):t===Ac.southEast&&e?n(Ac.east):t===Ac.east&&e?n(Ac.northEast):t===Ac.northEast&&e&&n(Ac.north),t!==Ac.north||e?t!==Ac.northEast||e?t!==Ac.east||e?t!==Ac.southEast||e?t!==Ac.south||e?t!==Ac.southWest||e?t!==Ac.west||e?t!==Ac.northWest||e||n(Ac.north):n(Ac.northWest):n(Ac.west):n(Ac.southWest):n(Ac.south):n(Ac.southEast):n(Ac.east):n(Ac.northEast)}),r);return function(){return clearInterval(a)}}}),[e,t,n])}(!!c&&!l&&a>0,k,A);var C=ho("".concat("/img/scene/actors/").concat(u),N,k),I=Object(f.useState)(!1),S=Object(h.a)(I,2),T=S[0],E=S[1],q=Object(f.useCallback)((function(e){e.lineStyle(3,i),e.drawCircle(p/2,j/2,p/2-3),e.endFill()}),[i,j,p]);Object(f.useEffect)((function(){if(void 0!==l){var e=function(e,t){var n=Math.atan2(t[1]-e[1],t[0]-e[0]),r=Math.round((n/(2*Math.PI/8)+8)%8);return[Ac.east,Ac.southEast,Ac.south,Ac.southWest,Ac.west,Ac.northWest,Ac.north,Ac.northEast][r]}(n,l);A(e)}}),[n,l]),Object(f.useEffect)((function(){E(k===Ac.southWest||k===Ac.west||k===Ac.northWest)}),[k]);var R=Object(f.useMemo)((function(){return[T?-1:1,1]}),[T]),D=Object(f.useMemo)((function(){switch(o){case oa.a.black:return[$c(eo,co)];case oa.a.orange:return[$c(eo,ao)];case oa.a.purple:return[$c(eo,ro)];case oa.a.red:return[$c(eo,to)];case oa.a.teal:return[$c(eo,no)];case oa.a.white:return[$c(eo,oo)];case oa.a.yellow:return[$c(eo,io)];default:return[]}}),[o]);return Object(dt.jsxs)(qt.Container,Object(ge.a)(Object(ge.a)({x:g,y:O,ref:y},m),{},{children:[void 0!==i&&Object(dt.jsx)(qt.Graphics,{name:"selectioncircle-back",draw:q}),u&&C&&Object(dt.jsx)(Xc,{animationSpeed:.1,name:"".concat(d.id,"-sprite"),isPlaying:!0,textures:C,x:35.5,y:20,scale:R,anchor:[.5,.5],pivot:[0,0],filters:D}),s,void 0!==i&&Object(dt.jsx)(qt.Graphics,{name:"selectioncircle-front",alpha:.25,draw:q})]}))},go=function(e){var t=e.controller,n=e.location,r=e.actor,a=e.selected,c=e.spritesheetPath,o=Object(f.useRef)(null),i=Object(kr.a)(r.adventurerId),s=i.health;return Object(dt.jsx)(qt.Container,{ref:o,zIndex:s,children:Object(dt.jsx)(vo,{actor:r,health:i.health,controller:t,spritesheetPath:c,location:n,selectionColor:a?16777215:void 0,idleAnimation:Math.random()<.5})})},Oo=function(e){var t=e.controller,n=e.location,r=e.actor,a=e.selected,c=e.spritesheetPath,o=r.health;return Object(dt.jsx)(qt.Container,{zIndex:o,children:Object(dt.jsx)(vo,{actor:r,health:r.health,controller:t,spritesheetPath:c,selectionColor:a?9109504:void 0,location:n})})},yo=function(e){var t=e.objects,n=e.controller;return Object(dt.jsx)(qt.Container,{sortableChildren:!0,children:t.map((function(t){var r=t.location,a=t.properties,c=a.adventurerId,o=a.spritesheet;return t.type!==Zc.a.actor?null:Object(Ee.f)(t)?Object(dt.jsx)(go,{location:r,controller:n,actor:t,spritesheetPath:o,selected:e.selectedActorId===t.adventurerId},c):Object(Ee.g)(t)?Object(dt.jsx)(Oo,{actor:t,controller:n,spritesheetPath:o,location:r,idleAnimation:Math.random()<.5,lookAt:[4,3],selected:e.selectedActorId===t.enemyId},t.enemyId):null}))})},xo=function(e){var t=e.data,n=e.objects,r=e.controller,a=e.spritesheets,c=e.selectedActorId;return Object(dt.jsx)(qt.Container,{children:t.layers.filter((function(e){return e.visible})).map((function(e){if(e.type===Hc.a.objectgroup){var o=function(e,t){return e.reduce((function(e,n){return n.layerId===t.id&&(void 0!==n.gid?e.tileObjects.push(n):!0===n.properties.isSprite&&e.spriteObjects.push(n)),e}),{tileObjects:[],spriteObjects:[]})}(n,e),i=o.tileObjects,s=o.spriteObjects;return Object(dt.jsxs)(f.Fragment,{children:[!!i.length&&Object(dt.jsx)(Jc,{objects:i,tilesets:t.tilesets||[],spritesheets:a}),!!s.length&&Object(dt.jsx)(yo,{objects:s||[],controller:r,selectedActorId:c},e.name)]},e.name)}return e.type===Hc.a.tilelayer?Object(dt.jsx)(Yc,{layer:e,horizontalTiles:t.width,tilesets:t.tilesets,spritesheets:a},e.name):null}))})},wo=function(e,t){return e.find((function(e){return!t[e.name]}))},ko=function(e){var t=Object(f.useState)({}),n=Object(h.a)(t,2),r=n[0],a=n[1],c=Object(f.useState)(),o=Object(h.a)(c,2),i=o[0],s=o[1];return Object(f.useEffect)((function(){if(i){var t=wo(i,r);if(t){var n=t.name,c=t.image.substring(t.image.indexOf("/"));Object(b.b)("".concat(e,"/").concat(c),(function(o){if(o){if(o.error)throw new Error("Loading ".concat(e,"/").concat(c,"\n").concat(o.error));var i=function(e){for(var t=e.columns,n={},r=0;r<e.tilecount;r++){var a=e.tilewidth,c=e.tileheight,o=r%t*a,i=Math.floor(r/t)*c;n["".concat(e.name,"-").concat(r+e.firstgid)]={frame:{x:o,y:i,w:a,h:c},spriteSourceSize:{x:o,y:i,w:a,h:c},rotated:!1,trimmed:!1,sourceSize:{w:a,h:c}}}return{frames:n,meta:{image:e.image,size:{w:e.imagewidth,h:e.imageheight},scale:"1"}}}(t);if(!o.texture)throw new Error("No texure found ".concat(e,"/").concat(c));var s=new pt.Spritesheet(o.texture,i);s.parse((function(){var e=Object(ge.a)(Object(ge.a)({},r),{},Object(G.a)({},n,s));a(e)}))}}))}}}),[i,e,r]),{loadComplete:!!i&&void 0===wo(i,r),loadTilesets:function(e){s(e)},tileSpritesheets:r}},Ao=n(208),No=(n(654),function(e){var t=Object(f.useRef)(null),n=Object(f.useRef)([]);return Object(f.useEffect)((function(){var r=function(r,a,c,o){if(o===e.layer){var i,s=document.createElement("div");s.innerHTML="".concat(r),s.className="bubble".concat(void 0!==c&&" type-".concat(fr.c[c])),s.style.left="".concat(a.x,"px"),s.style.top="".concat(a.y,"px"),null===(i=t.current)||void 0===i||i.appendChild(s);var u=setTimeout((function(){var e;n.current=n.current.filter((function(e){return e!==u})),null===(e=t.current)||void 0===e||e.removeChild(s)}),2e3);n.current.push(u)}};return fr.b.instance.addListener(fr.d,r),function(){fr.b.instance.removeListener(fr.d,r)}}),[e.layer]),Object(f.useEffect)((function(){return function(){n.current.forEach((function(e){return clearTimeout(e)}))}}),[]),Object(dt.jsx)("div",{className:"bubbles",ref:t})}),Co=function(e,t,n){var r=Object(f.useRef)(1),a=Object(f.useCallback)((function(){var a;if(!e.current)return 1;var c=null===(a=e.current.parentNode)||void 0===a?void 0:a.querySelector("canvas");if(!c)throw Error("No canvas found as sibling of ".concat(e.current));var o=null===c||void 0===c?void 0:c.clientWidth;return r.current=o/t,e.current.style.transform="scale(".concat(r.current,")"),e.current.style.width="".concat(t,"px"),e.current.style.height="".concat(n,"px"),r.current}),[e,n,t]);return Object(f.useEffect)((function(){return window.addEventListener("resize",a),a(),function(){window.removeEventListener("resize",a)}}),[a,e,n,t]),{scale:r.current,recalculate:a}},Io=(n(655),mo={},Object(G.a)(mo,Ee.b.move,"url(".concat(".","/img/ui/icons/icons/walking-boot.svg)")),Object(G.a)(mo,Ee.b.interact,"url(".concat(".","/img/ui/icons/icons/sunken-eye.svg)")),mo),So=function(e){var t,n,r=e.location,a=Object(f.useContext)(Er),c=null!==(t=null===a||void 0===a?void 0:a.locationIsBlocked(r))&&void 0!==t&&t,o=Ee.b.move;if(c){var i=null===a||void 0===a?void 0:a.getObjectAtLocation(r);null!==i&&void 0!==i&&i.properties.interactive&&(o=Ee.b.interact,c=!1)}var s=null!==(n=null===a||void 0===a?void 0:a.getTileDimensions())&&void 0!==n?n:{tileWidth:64,tileHeight:64},u=s.tileWidth,l=s.tileHeight,d="translate(".concat(u*r[0],"px, ").concat(l*r[1],"px)"),m=Io[o],b=u,p=l;return Object(dt.jsx)("div",{className:"normal-ui-cursor ".concat(c?"invalid":""),style:{transform:d,backgroundImage:m,width:b,height:p}})},To=(n(656),function(e){var t=e.location,n=e.intents,r=Object(f.useContext)(Er);if(!r)throw Error("No scene controller");var a=r.getTileDimensions(),c=a.tileWidth,o=a.tileHeight,i="translate(".concat(c*t[0],"px, ").concat(o*t[1],"px)"),s=!(null===r||void 0===r||!r.getObjectAtLocation(t,Ee.g)),u=n.every((function(e){return!e.isValid})),l=["combat-ui-widget"].concat(Object(j.a)(u?["invalid"]:[]),Object(j.a)(s?["on-enemy"]:[]));return Object(dt.jsx)("div",{className:l.join(" "),style:{transform:i}})}),Eo=(n(657),function(e){var t=e.adventurer,n=e.location,r=e.intent,a=e.renderText,c=e.onSetActionIntent,o=e.onCloseMenu,i=Object(f.useContext)(Er);if(!i)throw new Error("No controller");var s=Object(f.useCallback)((function(){window.removeEventListener("mouseup",s),null===c||void 0===c||c(void 0)}),[c]);return Object(f.useEffect)((function(){return function(){window.removeEventListener("mouseup",s)}}),[s]),Object(dt.jsx)("div",{className:"action-button",onMouseDown:function(){null===c||void 0===c||c(r),window.addEventListener("mouseup",s)},onMouseUp:function(){var e,a=null===i||void 0===i||null===(e=i.getSceneActor(t.id))||void 0===e?void 0:e.location;a&&n&&!Object(Zc.d)(a,n)&&r&&(null===i||void 0===i||i.actorAttemptAction(r),o()),null===c||void 0===c||c(void 0)},children:a(r)})}),qo=n(106),Ro=(n(658),function(e){var t=e.actorObject,n=e.size,r="".concat(e.className||""," enemy-avatar"),a=Object(qo.a)(t.enemyType);return Object(dt.jsx)(fn.b,{className:r,image:a.avatarImg,size:n,onClick:function(){e.onClick&&e.onClick(t.enemyId)}})}),Do=n(45),Mo=(n(659),["children","className"]),Lo=function(e){var t=e.children,n=e.className,r=void 0===n?"":n,a=Object(Pt.a)(e,Mo);return Object(dt.jsx)("div",Object(ge.a)(Object(ge.a)({},a),{},{className:"diamond-frame ".concat(r),children:t}))},zo=function(e,t){var n=Object(f.useRef)(),r=Object(f.useRef)({x:0,y:0}),a=Object(f.useRef)(),c=Object(f.useRef)(!1);Object(f.useEffect)((function(){var o=e.current;if(o){t||(t=e);var i=function(e){var a,i,s;r.current={x:null!==(a=o.getBoundingClientRect().left)&&void 0!==a?a:0,y:null!==(i=o.getBoundingClientRect().top)&&void 0!==i?i:0},n.current={x:e.touches[0].clientX-r.current.x,y:e.touches[0].clientY-r.current.y},e.target===(null===(s=t)||void 0===s?void 0:s.current)&&(c.current=!0)},s=function(e){var a,i,s;r.current={x:null!==(a=o.getBoundingClientRect().left)&&void 0!==a?a:0,y:null!==(i=o.getBoundingClientRect().top)&&void 0!==i?i:0},n.current={x:e.clientX-r.current.x,y:e.clientY-r.current.y},e.target===(null===(s=t)||void 0===s?void 0:s.current)&&(c.current=!0)},u=function(){var t,n,r,c;e.current&&(e.current.style.left="".concat(null!==(t=null===(n=a.current)||void 0===n?void 0:n.x)&&void 0!==t?t:0,"px"),e.current.style.top="".concat(null!==(r=null===(c=a.current)||void 0===c?void 0:c.y)&&void 0!==r?r:0,"px"))},l=function(e){var t,o,i,s;c.current&&(e.preventDefault(),a.current={x:e.touches[0].clientX-(null!==(t=null===(o=n.current)||void 0===o?void 0:o.x)&&void 0!==t?t:0),y:e.touches[0].clientY-(null!==(i=null===(s=n.current)||void 0===s?void 0:s.y)&&void 0!==i?i:0)},r.current=a.current,u())},d=function(e){var t,o,i,s;c.current&&(e.preventDefault(),a.current={x:e.clientX-(null!==(t=null===(o=n.current)||void 0===o?void 0:o.x)&&void 0!==t?t:0),y:e.clientY-(null!==(i=null===(s=n.current)||void 0===s?void 0:s.y)&&void 0!==i?i:0)},r.current=a.current,u())},m=function(){n.current&&(n.current=a.current,c.current=!1)};return o.addEventListener("touchstart",i,!1),document.addEventListener("touchend",m,!1),document.addEventListener("touchmove",l,!1),o.addEventListener("mousedown",s,!1),document.addEventListener("mouseup",m,!1),document.addEventListener("mousemove",d,!1),function(){o.removeEventListener("touchstart",i,!1),document.removeEventListener("touchend",m,!1),document.removeEventListener("touchend",m,!1),document.removeEventListener("touchmove",l,!1),o.removeEventListener("mousedown",s,!1),document.removeEventListener("mouseup",m,!1),document.removeEventListener("mousemove",d,!1)}}}),[])},Po=(n(660),function(e){var t=e.adventurerId,n=e.location,r=e.intents,a=e.onClose,c=e.onSetActionIntent,o=Object(kr.a)(t),i=Object(f.useContext)(Er);if(!i)throw new Error("No controller");var s=Object(f.useRef)(null),u=Object(f.useRef)(null);zo(s,u);var l=Object(f.useMemo)((function(){return null===i||void 0===i?void 0:i.getObjectAtLocation(n,Ee.g)}),[i,n]),d=Object(f.useCallback)((function(e){switch(e.action){case Ee.b.move:return"Move ".concat(e.apCost," AP");case Ee.b.melee:case Ee.b.shoot:if(!e.weaponWithAbility)return;return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)(Sn,{size:fn.a.smallest,item:e.weaponWithAbility.weapon}),"-",Do.a[e.weaponWithAbility.ability],e&&JSON.stringify(null===e||void 0===e?void 0:e.apCost)]})}}),[]);return Object(dt.jsx)("div",{className:"action-menu-background",onClick:a,children:Object(dt.jsxs)("div",{className:"action-menu",ref:s,children:[Object(dt.jsxs)("div",{className:"background",ref:u,children:[Object(dt.jsx)(Lo,{className:"adventurer-frame gold",children:Object(dt.jsx)(xr,{adventurer:o,size:fn.a.big})}),(null===l||void 0===l?void 0:l.name)&&Object(dt.jsx)(Lo,{className:"enemy-frame gold",children:Object(dt.jsx)(Ro,{actorObject:l,size:fn.a.big})})]}),Object(dt.jsx)("div",{className:"action-button action-button-close",onClick:a,children:"x close"}),Object(dt.jsxs)("ul",{className:"button-list",children:[r.filter((function(e){return e.isValid})).map((function(e,t){return Object(dt.jsx)("li",{children:Object(dt.jsx)(Eo,{adventurer:o,location:n,intent:e,onSetActionIntent:c,renderText:d,onCloseMenu:a})},"".concat(e.action).concat(t))})),Object(dt.jsx)("li",{children:Object(dt.jsx)("div",{className:"action-button",children:"sdfsdfs"})}),Object(dt.jsx)("li",{children:Object(dt.jsx)("div",{className:"action-button",children:"sdfsdfs"})})]})]})})}),Wo=n(103),Vo=(bo={},Object(G.a)(bo,Do.a.aimedShot,{}),Object(G.a)(bo,Do.a.swing,{}),Object(G.a)(bo,Do.a.block,{passive:!0}),Object(G.a)(bo,Do.a.cut,{}),Object(G.a)(bo,Do.a.cleave,{}),Object(G.a)(bo,Do.a.shoot,{}),Object(G.a)(bo,Do.a.slash,{}),Object(G.a)(bo,Do.a.parry,{passive:!0}),Object(G.a)(bo,Do.a.riposte,{passive:!0}),bo),Qo=function(e){return Vo[e]},Bo=function(e,t){var n=Object(kr.a)(e),r=Object(le.c)(n),a=Object(f.useContext)(Er);if(!a)throw new Error("No controller");var c=null===a||void 0===a?void 0:a.getSceneAdventurer(n.id),o=Object(f.useMemo)((function(){if(!c||!t)return[];var e=[];return null===r||void 0===r||r.forEach((function(r){if(r){var o=Object(Hn.b)(r.type),i=Object(Wo.a)(o.weaponType),s=i.classification;i.abilities.forEach((function(o){if(!Qo(o).passive){var i={weapon:r,ability:o},u=s===uo.b.ranged?Ee.b.shoot:Ee.b.melee;if(u===Ee.b.melee){var l=null===a||void 0===a?void 0:a.createActionIntent(u,c,t,i);l&&e.push(l)}else{var d=Object(le.a)(n);if(!d)throw new Error("no ammo");var m=null===a||void 0===a?void 0:a.createActionIntent(u,c,t,i,d);m&&e.push(m)}}}))}})),e}),[c,n,a,t,r]),i=Object(f.useMemo)((function(){if(c&&t)return null===a||void 0===a?void 0:a.createActionIntent(Ee.b.move,c,t)}),[c,a,t]);return Object(f.useMemo)((function(){return[].concat(Object(j.a)(o),Object(j.a)(i?[i]:[]))}),[i,o])},Go=Object(f.forwardRef)((function(e,t){var n=e.selectedAdventurerId,r=e.cursorLocation,a=e.setCursorLocation,c=e.onSetActionIntent,o=Object(f.useState)(!1),i=Object(h.a)(o,2),s=i[0],u=i[1],l=Bo(n,r),d=Object(f.useCallback)((function(){var e=!!l.length&&l.some((function(e){return e.isValid}));r&&e?u(!0):(a(void 0),u(!1)),null===c||void 0===c||c(void 0)}),[l,r,c,a]);return Object(f.useImperativeHandle)(t,(function(){return{actionMenuOpen:s,onMouseUp:d}})),Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)(To,{location:r,intents:l,selectedActorId:n}),s&&r&&l&&Object(dt.jsx)(Po,{adventurerId:n,location:r,intents:l,onClose:function(){u(!1),a(void 0)},onSetActionIntent:c})]})}));Go.displayName="AdventurerCombatSceneUI";var Fo,Ho=Go,Zo=(n(661),function(e){var t,n,r=e.children,a=e.selectedActorId,c=e.actionIntent,o=e.sceneWidth,i=e.sceneHeight,s=e.onMouseDown,u=e.onSetActionIntent,l=Object(f.useRef)(null),d=Object(f.useRef)(null),m=Object(f.useRef)(!1),b=Object(f.useContext)(Er),p=Br(null!==(t=null===b||void 0===b?void 0:b.questName)&&void 0!==t?t:"").scene,j=null!==p&&void 0!==p?p:{},v=j.combat,g=j.actionQueue,O=Object(f.useState)(),y=Object(h.a)(O,2),x=y[0],w=y[1],k=Co(l,o,i),A=Fr(null!==(n=null===b||void 0===b?void 0:b.questName)&&void 0!==n?n:"",a);Object(f.useEffect)((function(){k.scale=k.recalculate()}),[k]);var N=function(e){if(e.target instanceof Element){var t=function(e){if(Object(ca.b)(e,"clientX")&&Object(ca.b)(e,"clientY"))return{x:e.clientX,y:e.clientY};if(Object(ca.b)(e,"touches")){var t=e.touches[0];if(t)return{x:t.clientX,y:t.clientY}}return{x:NaN,y:NaN}}(e),n=t.x,r=t.y,a=e.target.getBoundingClientRect(),c=(n-a.left)/k.scale,o=(r-a.top)/k.scale;return null===b||void 0===b?void 0:b.pointToSceneLocation(new pt.Point(c,o))}throw new Error("You didnt give me the correct event")},C=Object(Ao.useLongPress)((function(e){e&&(!function(e){var t,n,r=N(e);if(b&&r&&e.target instanceof Element){var a=b.getObjectAtLocation(r);if(a&&"actor"===a.type){var c=b.getTileDimensions(),o=c.tileWidth,i=c.tileHeight,s=o*k.scale,u=i*k.scale,l=e.target.getBoundingClientRect(),d=r[0]*s+(null!==(t=l.left)&&void 0!==t?t:0),m=r[1]*u+(null!==(n=l.top)&&void 0!==n?n:0),p=DOMRect.fromRect({x:d,y:m,width:s,height:u});An.showContextTooltip(ln.actor,a,p,""),e.stopPropagation()}}}(e),e.preventDefault(),e.stopPropagation())}),{onStart:function(e){!function(e){var t;if((null===(t=d.current)||void 0===t||!t.actionMenuOpen)&&(null===g||void 0===g||!g.length)){var n=N(e);n&&(null===s||void 0===s||s(n)),m.current=!0}}(e)},onMove:function(e){!function(e){if(m.current){var t,n=null!==(t=N(e))&&void 0!==t?t:[0,0];if(null!==b&&void 0!==b&&b.locationIsOutOfBounds(n))return w(void 0),void u(void 0);x&&Object(Zc.d)(n,x)||w(n)}}(e)},captureEvent:!0,cancelOnMovement:8,detect:Ao.LongPressDetectEvents.BOTH}),I=function(e){if(C.onMouseUp(e),m.current=!1,v){var t;null===(t=d.current)||void 0===t||t.onMouseUp()}else{var n;if(w(void 0),!c)return;var r=null===b||void 0===b||null===(n=b.getSceneAdventurer(a))||void 0===n?void 0:n.location;r&&x&&!Object(Zc.d)(r,x)&&c&&(null===b||void 0===b||b.actorAttemptAction(c),u(void 0))}e.stopPropagation()};return Object(f.useEffect)((function(){if(!v&&void 0!==x){var e=Ee.b.move,t=null===b||void 0===b?void 0:b.getObjectAtLocation(x);null!==t&&void 0!==t&&t.properties.interactive&&(e=Ee.b.interact);var n=null===b||void 0===b?void 0:b.getSceneAdventurer(a);if(e&&n&&x){var r=null===b||void 0===b?void 0:b.createActionIntent(e,n,x);r&&r.action!==Ee.b.move&&r.action!==Ee.b.interact||null===u||void 0===u||u(r)}else u(void 0)}}),[x,v,b,a,u]),Object(f.useEffect)((function(){var e=function(e){m.current&&e.preventDefault()};return window.addEventListener("touchmove",e,{passive:!1}),function(){window.removeEventListener("touchmove",e)}}),[]),Object(f.useEffect)((function(){var e;null===(e=l.current)||void 0===e||e.addEventListener("mouseleave",(function(){m.current&&(m.current=!1,w(void 0),null===u||void 0===u||u(void 0))}))}),[u]),Object(dt.jsxs)("div",Object(ge.a)(Object(ge.a)({ref:l,className:"scene-ui"},C),{},{onMouseUp:I,onTouchEnd:I,children:[r,!(null!==p&&void 0!==p&&p.combat)&&x&&Object(dt.jsx)(So,{location:x}),(null===p||void 0===p?void 0:p.combat)&&x&&!!A&&Object(dt.jsx)(Ho,{ref:d,cursorLocation:x,selectedAdventurerId:a,setCursorLocation:w,onSetActionIntent:u}),Object(dt.jsx)(No,{layer:fr.a.scene})]}))}),Uo=["points","dash","gap","speed","style"],Yo=Object(qt.PixiComponent)("DashedLine",{create:function(){return new pt.Graphics},applyProps:function(e,t,n){var r=n.points,a=void 0===r?[]:r,c=n.dash,o=void 0===c?10:c,i=n.gap,s=void 0===i?5:i,u=n.speed,l=void 0===u?40:u,d=n.style,m=Object(Pt.a)(n,Uo);Object(qt.applyDefaultProps)(e,t,m),e.clear();!function t(){var n;if(!e.destroyed){e.clear(),e.lineStyle(null!==(n=null===d||void 0===d?void 0:d.width)&&void 0!==n?n:10,null===d||void 0===d?void 0:d.color,null===d||void 0===d?void 0:d.alpha,null===d||void 0===d?void 0:d.alignment,null===d||void 0===d?void 0:d.native);var r=(Date.now()%(1e4/l)+1)/Math.abs(1e4/l),c=0,i=0;if(r>0){var u=(o+s)*r*(l<-1?1:-1);u<o?c=o-u:i=s-(u-o)}var m,b=[],p=Object(Ke.a)(a);try{for(p.s();!(m=p.n()).done;){var j=m.value.clone(),h=Math.cos(e.rotation),f=Math.sin(e.rotation),v=j.x,g=j.y;j.x=v*h-g*f,j.y=v*f+g*h,b.push(j)}}catch(I){p.e(I)}finally{p.f()}for(var O=0;O<b.length-1;O++){var y=b[O],x=b[O+1],w=x.x-y.x,k=x.y-y.y,A=Math.sqrt(w*w+k*k),N={x:w/A,y:k/A},C=0;for(e.moveTo(y.x+i*N.x,y.y+i*N.y);C<=A;)C+=i,(C+=c>0?c:o)>A?(c=C-A,C=A):c=0,e.lineTo(y.x+C*N.x,y.y+C*N.y),(C+=s)>A&&0===c?i=C-A:(i=0,e.moveTo(y.x+C*N.x,y.y+C*N.y))}0!==l&&requestAnimationFrame(t)}}()}}),Jo=function(e){var t=e.actionIntent,n=e.tileWidth,r=e.tileHeight,a=function(e){return new pt.Point(e[0]*n+n/2,e[1]*r+r/2)};switch(t.action){case Ee.b.interact:if(!t.path)return null;var c=[a(t.from)].concat(Object(j.a)(t.path.map((function(e){return a(e)}))));return Object(dt.jsx)(Yo,{points:c,dash:10,gap:15,speed:20,rotation:0,style:{width:6,color:16777215,alpha:1}});case Ee.b.move:case Ee.b.melee:if(!t.path)return null;var o=[a(t.from)].concat(Object(j.a)(t.path.map((function(e){return a(e)})))),i=!t.apCost||t.apCost<=(t.actorAP||0);return Object(dt.jsx)(Yo,{points:o,dash:10,gap:15,speed:20,rotation:0,style:{width:6,color:i?16777215:9109504,alpha:1}});case Ee.b.shoot:var s=!t.apCost||t.apCost<=(t.actorAP||0),u=a(t.from),l=a(t.to);return Object(dt.jsx)(qt.Graphics,{name:"line",draw:function(e){e.lineStyle(4,s?13339654:9109504,1),e.moveTo(u.x,u.y),e.lineTo(l.x,l.y),e.endFill()}});default:return null}},Xo=function(e){return e.log},Ko=function(e){var t=function(e){var t=Object(f.useMemo)((function(){return Object($.a)([Xo],(function(t){return t.filter((function(t){return t.channel===ae.a.quest&&t.channelContext===e}))}))}),[e]);return Object(g.d)(t)}(e.questId);return Object(f.useEffect)((function(){var e=t.shift();null===e||void 0===e||e.time,Date.now()}),[t]),null},_o=new pt.TextStyle({fontFamily:"Gabriela",fontSize:24,fill:16777215,wordWrap:!0,wordWrapWidth:200,dropShadow:!0,dropShadowAngle:.9,dropShadowBlur:10,dropShadowDistance:0}),$o=function(e){var t=Oc(),n=e.controller,r=n.mapData,a=n.getTileDimensions(),c=a.tileWidth,o=a.tileHeight,i=Object(f.useMemo)((function(){if(!r)return[];for(var e=[],t=0;t<r.height;t++)for(var n=0;n<r.width;n++)e.push([n,t]);return e}),[r]);return r?Object(dt.jsxs)(dt.Fragment,{children:[t.debugSceneShowPathable&&Object(dt.jsx)(qt.Graphics,{name:"blocked-tiles",draw:function(e){for(var t=0;t<r.height;t++)for(var a=0;a<r.width;a++){n.locationIsBlocked([a,t])?e.lineStyle(3,16711680):e.lineStyle(3,16777215),e.drawRect(a*c,t*o,c,o),e.endFill()}}}),t.debugSceneShowCellLocations&&i.map((function(e){var t=Object(h.a)(e,2),n=t[0],r=t[1];return Object(dt.jsx)(qt.Text,{anchor:.5,alpha:.5,style:_o,x:n*c+c/2,y:r*o+o/2,text:"[".concat(n,",").concat(r,"]")},"[".concat(n,",").concat(r,"]"))}))]}):null},ei=(n(662),function(e){var t=Oc(),n=e.selectedActorId,r=e.setSelectedActor,a=Object(f.useContext)(Er);if(!a)throw new Error("No controller found");var c=a.mapData,o=a.basePath;if(!o)throw new Error("No basePath found");var i=ko(o),s=i.loadComplete,u=i.loadTilesets,l=i.tileSpritesheets,d=Object(f.useRef)(null),m=Gr(a.questName),b=!0===(null===m||void 0===m?void 0:m.combat),p=a.getTileDimensions(),j=p.tileWidth,v=p.tileHeight,g=Object(f.useState)(),O=Object(h.a)(g,2),y=O[0],x=O[1];Object(f.useEffect)((function(){return b&&lo.initialize(a),function(){lo.destroy()}}),[b,a]),Object(f.useEffect)((function(){c&&u(c.tilesets)}),[u,c]);if(!s||!c||!m)return Object(dt.jsx)("div",{children:"loading scene..."});var w=c.width*c.tilewidth,k=c.height*c.tileheight;return Object(dt.jsxs)("div",{className:"scene",ref:d,children:[Object(dt.jsx)(Vt,{width:w,height:k,children:Object(dt.jsxs)(qt.Container,{interactive:!0,hitArea:new pt.Rectangle(0,0,w,k),children:[Object(dt.jsx)(xo,{basePath:o,data:c,spritesheets:l,objects:m.objects,controller:a,selectedActorId:n,setSelectedActor:r}),y&&Object(dt.jsx)(Jo,{actionIntent:y,tileWidth:j,tileHeight:v}),Object(dt.jsx)($o,{controller:a})]})}),t.debugSceneShowActionQueue&&Object(dt.jsxs)("div",{style:{position:"absolute",bottom:0},children:[Object(dt.jsx)("h2",{children:"ActionQueue"}),Object(dt.jsx)("ul",{children:m.actionQueue&&m.actionQueue.map((function(e){return Object(dt.jsx)("li",{children:JSON.stringify(e)},JSON.stringify(e))}))})]}),Object(dt.jsx)(Zo,{sceneWidth:w,sceneHeight:k,selectedActorId:n,actionIntent:y,onMouseDown:function(t){var n=a.getObjectAtLocation(t);n&&Object(Ee.f)(n)&&e.setSelectedActor(n.adventurerId),n&&Object(Ee.g)(n)&&e.setSelectedActor(n.enemyId)},onSetActionIntent:x}),Object(dt.jsx)(Ko,{questId:a.questName})]})}),ti=(n(663),function(e){var t=Br(e.questName),n=Object(ne.a)(t.name),r=Math.floor(t.progress);do{var a=n.nodes[r].log;if(a)return Object(dt.jsx)("div",{children:Object(dt.jsx)("p",{children:"".concat(m.a.get(a))})});r--}while(r>=0);return Object(dt.jsx)("h1",{className:"on-the-road questname",children:m.a.getQuestTitle(t.name)})}),ni=function(e){return Br(e.questName).sceneName?Object(dt.jsx)(ei,Object(ge.a)({},e)):Object(dt.jsx)(ti,{questName:e.questName})},ri=(n(664),function(e){var t=e.onDrop,n=Object(jt.useDrop)((function(){return{accept:Ar.b.ITEM,collect:function(e){return{canDrop:e.canDrop(),isOver:e.isOver()}},drop:function(e){return t(e)}}})),r=Object(h.a)(n,2)[1];return Object(dt.jsx)("div",{className:"droppable-adventurer-avatar",ref:r,children:Object(dt.jsx)(xr,{adventurer:e.adventurer,onClick:e.onClick})})}),ai=(n(304),n(665),function(e){var t=Object(f.useContext)(Er),n=Object(kr.a)(e.adventurerId),r=Object(le.b)(n),a=Object(f.useRef)(null);if(!t)return null;var c=t.getLootCache(e.cacheName);if(!c)return null;return Object(dt.jsxs)("div",{className:"interaction-modal loot-cache",ref:a,children:[Object(dt.jsxs)("div",{className:"header",children:[Object(dt.jsx)("div",{className:"title",children:m.a.get(c.title,{adventurer:n.name})}),Object(dt.jsx)("div",{className:"close",onClick:e.onClose})]}),c.items.length>0&&Object(dt.jsxs)("div",{className:"content",children:[Object(dt.jsx)("div",{className:"items",children:Object(dt.jsx)(Da,{items:c.items,sourceType:Ar.a.lootCache,sourceId:e.cacheName})}),Object(dt.jsxs)("div",{className:"adventurer",children:[Object(dt.jsx)(ri,{adventurer:n,onDrop:function(n){var r;t.takeItemFromCache(null!==(r=n.inventorySlot)&&void 0!==r?r:0,e.cacheName,e.adventurerId)}}),Object(dt.jsx)(_t,{onClick:function(n){n.stopPropagation(),a.current&&(a.current.querySelectorAll(".items-list .item-icon").forEach((function(e,t){t>=r||e.classList.add("taking")})),Ot.a.to(".items-list .item-icon.taking",{right:"-50vw",stagger:{each:.1,ease:"power2.inOut"},onComplete:function(){for(var n=0;n<r;n++)t.takeItemFromCache(0,e.cacheName,e.adventurerId)}}))},disabled:0===r,size:"small",children:m.a.get("quest-common-loot-cache-take-all")})]})]}),!!c.gold&&Object(dt.jsxs)("div",{className:"content",children:[Object(dt.jsxs)("div",{className:"gold",children:[Object(dt.jsx)(fn.b,{image:"img/resources/gold.png",size:"medium"}),m.a.get("quest-common-loot-cache-gold",{gold:c.gold})]}),Object(dt.jsx)("div",{className:"take-gold",children:Object(dt.jsx)(_t,{onClick:function(n){n.stopPropagation(),t.takeGoldFromCache(e.cacheName)},size:"small",children:m.a.get("quest-common-loot-cache-take")})})]})]})}),ci=(n(666),function(e){var t=Object(f.useContext)(Er),n=Object(f.useRef)(null),r=null===t||void 0===t?void 0:t.getSituation(e.situation,e.adventurerId);if(!r)return null;var a=r.title,c=r.choices,o=r.text,i=function(n){var r=n.currentTarget.getAttribute("data-option");r&&t&&(t.handleSituationOptionClick(e.situation,r,e.adventurerId),n.stopPropagation())};return Object(dt.jsxs)("div",{className:"interaction-modal situation",ref:n,children:[Object(dt.jsxs)("div",{className:"header",children:[Object(dt.jsx)("div",{className:"title",children:m.a.get(a)}),Object(dt.jsx)("div",{className:"close",onClick:function(t){e.onClose(),t.stopPropagation()}})]}),Object(dt.jsxs)("div",{className:"content",children:[o&&Object(dt.jsx)("div",{className:"text",children:m.a.get(o)}),null===c||void 0===c?void 0:c.map((function(e){return Object(dt.jsx)(_t,{"data-option":e,onClick:i,children:m.a.get(e)},e)}))]})]})}),oi=(n(667),function(e){var t=Object(f.useContext)(Er);return Object(dt.jsxs)("div",{className:"combat-bar",children:[Object(dt.jsx)("div",{className:"title",children:m.a.get("ui-combat-bar-title")}),Object(dt.jsx)(_t,{size:"medium",onClick:function(){return null===t||void 0===t?void 0:t.endTurn()},children:"End turn"})]})}),ii=function(e){var t=e.adventurerId,n=e.adventurers,r=e.onAdventurerTabSelected,a=e.disabled,c=e.questName;return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)(wr,{adventurers:n,selectedAdventurerId:t,onAdventurerTabSelected:r,disabled:a}),Object(dt.jsxs)("div",{className:"adventurer-details",children:[Object(dt.jsx)(ha,{}),t&&Object(dt.jsx)(pa,{adventurerId:t,questName:c})]})]})},si=Object(f.createContext)(null),ui=(n(668),function(e){var t=e.children,n=e.className,r=Object(f.useState)([]),a=Object(h.a)(r,2),c=a[0],o=a[1];return Object(dt.jsx)(si.Provider,{value:{itemsExpanded:c,toggleItem:function(e){c.indexOf(e)>-1?o(c.filter((function(t){return t!==e}))):o([].concat(Object(j.a)(c),[e]))}},children:Object(dt.jsx)("div",{className:"accordion ".concat(null!==n&&void 0!==n?n:""),children:t})})}),li=["title","className","id","children","onHeaderClick"],di=function(e){var t=e.title,n=void 0===t?"":t,r=e.className,a=e.id,c=e.children,o=e.onHeaderClick,i=Object(Pt.a)(e,li),s=Object(f.useContext)(si),u=Object(f.useRef)(null),l=Object(f.useState)(0),d=Object(h.a)(l,2),m=d[0],b=d[1],p=-1!==(null===s||void 0===s?void 0:s.itemsExpanded.indexOf(a)),v=["accordion-item",null!==r&&void 0!==r?r:""].concat(Object(j.a)(p?["expanded"]:[]));Object(f.useLayoutEffect)((function(){var e;!p&&u.current&&b(null===(e=u.current)||void 0===e?void 0:e.clientHeight)}),[p]);var g={"--content-height":m||1200};return Object(dt.jsxs)("div",{className:v.join(" "),style:g,children:[Object(dt.jsx)("header",Object(ge.a)(Object(ge.a)({className:"header"},i),{},{onClick:function(){null===s||void 0===s||s.toggleItem(a),null===o||void 0===o||o()},children:n})),Object(dt.jsx)("div",{className:"content",ref:u,children:c})]})},mi=function(e){var t=e.attributes,n=e.level;return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsxs)("div",{children:["AP each turn: ",Object(Me.g)(t,n)]}),Object(dt.jsxs)("div",{children:["Dodge: ",jr(Object(Me.f)(t)),"%"]})]})},bi=["adventurerId","selected","questName"],pi=function(e){var t=e.adventurerId,n=e.selected,r=e.questName,a=Object(Pt.a)(e,bi),c=Object(kr.a)(t),o=Object(aa.d)(c),i=c.xp,s=Object(Le.c)(i),u=Object(f.useMemo)((function(){return Object(aa.e)(c)}),[c]),l=Fr(null!==r&&void 0!==r?r:"",t);return Object(dt.jsx)(di,Object(ge.a)(Object(ge.a)({className:"actors-accordion-item ".concat(n?"selected":"")},a),{},{id:t,title:Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)("div",{className:"name",children:m.a.getAdventurerName(t)}),Object(dt.jsxs)("div",{className:"ap",children:["AP: ",null===l||void 0===l?void 0:l.ap]})]}),children:Object(dt.jsxs)("div",{children:[Object(dt.jsx)("div",{className:"name-and-level",children:Object(dt.jsx)("div",{className:"level",children:m.a.get("ui-tooltip-actor-level",{level:s})})}),Object(dt.jsx)(la,{attributes:u,small:!0}),Object(dt.jsx)(mi,{attributes:o,level:s})]})}))},ji=["enemyId","selected","questName"],hi=function(e){var t,n=e.enemyId,r=e.selected,a=e.questName,c=Object(Pt.a)(e,ji),o=function(e,t){var n=Gr(e);return Object(f.useMemo)((function(){return null===n||void 0===n?void 0:n.objects.find((function(e){return Object(Ee.g)(e)&&e.enemyId===t}))}),[t,null===n||void 0===n?void 0:n.objects])}(a,n);if(!o)throw new Error("No actor found with id ".concat(n));var i=Object(qo.a)(o.enemyType),s=null!==(t=o.level)&&void 0!==t?t:1,u=Object(aa.f)(i.attributes),l=i.attributes;return Object(dt.jsx)(di,Object(ge.a)(Object(ge.a)({className:"actors-accordion-item ".concat(r?"selected":"")},c),{},{id:n,title:Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)("div",{className:"name",children:m.a.getEnemyName(o.enemyType)}),Object(dt.jsx)("div",{className:"ap",children:"AP: 3"})]}),children:Object(dt.jsxs)("div",{children:[Object(dt.jsx)("div",{className:"name-and-level",children:Object(dt.jsx)("div",{className:"level",children:m.a.get("ui-tooltip-actor-level",{level:s})})}),Object(dt.jsx)(la,{attributes:u,small:!0}),Object(dt.jsx)(mi,{attributes:l,level:s})]})}))},fi=(n(669),function(e){var t=e.selectedActorId,n=e.questName,r=e.onActorSelected,a=Object(g.d)(Ec(n)),c=function(e){var t=Gr(e);return Object(f.useMemo)((function(){var e;return null!==(e=null===t||void 0===t?void 0:t.objects.filter(Ee.g))&&void 0!==e?e:[]}),[null===t||void 0===t?void 0:t.objects])}(n);return Object(dt.jsxs)(ui,{className:"actors-accordion",children:[a.map((function(e){return Object(dt.jsx)(pi,{selected:t===e.id,adventurerId:e.id,questName:n,onHeaderClick:function(){r(e.id)}},e.id)})),c.map((function(e){return Object(dt.jsx)(hi,{enemyId:e.enemyId,selected:t===e.enemyId,onHeaderClick:function(){r(e.enemyId)},questName:n},e.id)}))]})});n(670);!function(e){e[e.auto=0]="auto",e[e.vertical=1]="vertical",e[e.horizontal=2]="horizontal"}(Fo||(Fo={}));var vi,gi=function(e,t){var n=Object(le.h)(e,t);return!!n&&Object(Ee.g)(n)},Oi=function(e){var t,n,r,a,c,o,i=Object(vt.h)(),s=Object(g.c)(),u=e.layout,l=void 0===u?Fo.auto:u,d=e.questName,m=Object(g.d)(Ec(d)),b=m[0],p=Object(f.useState)(null===b||void 0===b?void 0:b.id),j=Object(h.a)(p,2),v=j[0],O=j[1],y=Br(d),x=null===y||void 0===y||null===(t=y.scene)||void 0===t?void 0:t.activeInteractionModal,w=function(e){var t,n,r;(null!==y&&void 0!==y&&null!==(t=y.scene)&&void 0!==t&&t.combat||!gi(null!==(n=null===(r=y.scene)||void 0===r?void 0:r.objects)&&void 0!==n?n:[],e))&&O(e)},k=function(){s(Object(ue.h)(d))};return Object(f.useEffect)((function(){m.length||i(Object(se.d)())}),[m.length,i]),Object(f.useEffect)((function(){var e,t,n;null!==y&&void 0!==y&&null!==(e=y.scene)&&void 0!==e&&e.combat||!v||gi(null!==(t=null===(n=y.scene)||void 0===n?void 0:n.objects)&&void 0!==t?t:[],v)&&O(null===b||void 0===b?void 0:b.id)}),[null===b||void 0===b?void 0:b.id,null===(n=y.scene)||void 0===n?void 0:n.combat,null===(r=y.scene)||void 0===r?void 0:r.objects,v]),m.length?Object(dt.jsxs)(qr,{questName:d,children:[(null===y||void 0===y||null===(a=y.scene)||void 0===a?void 0:a.combat)&&Object(dt.jsx)(oi,{questName:d,selectedAdventurerId:v}),Object(dt.jsxs)("div",{className:"quest-panel quest-panel-".concat(Fo[l]),children:[Object(dt.jsxs)("div",{className:"quest-area",children:[Object(dt.jsx)(ni,{questName:d,selectedActorId:v,setSelectedActor:w}),x&&"lootCache"===x.type&&Object(dt.jsx)("div",{className:"modal",onClick:k,children:Object(dt.jsx)(ai,{cacheName:x.lootCache,adventurerId:v,onClose:k})}),x&&"situation"===x.type&&Object(dt.jsx)("div",{className:"modal",onClick:k,children:Object(dt.jsx)(ci,{situation:x.situation,adventurerId:v,onClose:k})})]}),Object(dt.jsxs)("div",{className:"party-area",children:[!(null!==y&&void 0!==y&&null!==(c=y.scene)&&void 0!==c&&c.combat)&&Object(dt.jsx)(ii,{adventurers:m,adventurerId:v,onAdventurerTabSelected:w,disabled:void 0!==x,questName:d}),(null===y||void 0===y||null===(o=y.scene)||void 0===o?void 0:o.combat)&&Object(dt.jsx)(fi,{selectedActorId:v,questName:d,onActorSelected:w})]})]})]}):null},yi=(n(671),function(){var e=Object(f.useRef)(null),t=Object(vt.g)("".concat(Object(se.d)(),"/:questname")),n=null===t||void 0===t?void 0:t.params.questname,r=Object(vt.h)();Object(f.useEffect)((function(){yt.c.addSound("music/world","sound/music/TheLoomingBattle.ogg",(function(){yt.c.playSound("music/world",yt.a.music,!0,yt.b.fade,!0)}))}),[]);return Object(dt.jsxs)("div",{className:"world-view",ref:e,children:[Object(dt.jsx)(Fc,{selectedQuestName:n,smallMap:null!=n,onPartyClick:function(e){r(e),yt.c.playSound("ui/buttonClick")},retrieveWorldViewRef:function(){return e}}),n&&Object(dt.jsx)(Oi,{questName:n})]})}),xi=n(336),wi=n(137),ki=function(){return function(e){Object(wi.a)(e,["textDirective","leafDirective","containerDirective"],(function(e){return e.data=Object(ge.a)({hName:e.name,hProperties:e.attributes},e.data),e}))}},Ai=function(e){switch(e){case Nn.a.common:return"item-trigger-common";case Nn.a.uncommon:return"item-trigger-uncommon";case Nn.a.rare:return"item-trigger-rare";case Nn.a.epic:return"item-trigger-epic";case Nn.a.legendary:return"item-trigger-legendary"}return""},Ni=function(e){var t=e.children,n=Object(f.useMemo)((function(){if("string"===typeof t[0])return JSON.parse(t[0])}),[t]),r=Object(f.useMemo)((function(){if(n)return Object(Ce.d)(n.type)}),[n]);return Object(dt.jsxs)(dt.Fragment,{children:["[",Object(dt.jsx)("span",{className:"trigger ".concat(Ai(null===r||void 0===r?void 0:r.rarity)),onClick:function(e){var t=e.currentTarget.getBoundingClientRect();An.showContextTooltip(ln.item,n,t),e.stopPropagation()},children:m.a.getItemName(n)}),"]"]})},Ci=(n(672),function(e){var t=e.children;return Object(dt.jsx)(pr.a,{className:"markdown",remarkPlugins:[xi.a,ki],components:{item:Ni},children:t})});n(673);!function(e){e[e.all=0]="all",e[e.town=1]="town",e[e.quest=2]="quest"}(vi||(vi={}));var Ii,Si=function(){var e=Object(f.useState)(!1),t=Object(h.a)(e,2),n=t[0],r=t[1],a=Object(f.useState)("all"),c=Object(h.a)(a,2),o=c[0],i=c[1],s=Object(g.d)((function(e){return e.log})),u=function(){var e=Object(f.useMemo)((function(){return zr([Wr,Vr],(function(e,t){return e.filter((function(e,n){return t[n]===ce.a.active}))}))}),[]);return Object(g.d)(e)}(),l=Object(vt.f)();Object(f.useEffect)((function(){l.pathname!==Object(se.c)()?u.forEach((function(e){l.pathname===Object(se.a)(e)&&i("quest-".concat(e))})):i("town")}),[u,l]);var d=[{label:m.a.get("ui-log-tab-all"),tabId:"all",tabType:vi.all},{label:m.a.get("ui-log-tab-town"),tabId:"town",tabType:vi.town}];u.forEach((function(e){d.push({channelContext:e,label:m.a.getQuestTitle(e),tabId:"quest-".concat(e),tabType:vi.quest})}));var b=[],p=d.find((function(e){return e.tabId===o}));switch(null===p||void 0===p?void 0:p.tabType){case vi.all:b=s;break;case vi.town:b=s.filter((function(e){return e.channel===ae.a.town}));break;case vi.quest:b=s.filter((function(e){return e.channel===ae.a.quest&&e.channelContext===p.channelContext}))}return Object(dt.jsxs)("div",{className:"log".concat(n?" expanded":""),children:[Object(dt.jsxs)("div",{className:"tab-bar",children:[Object(dt.jsx)(Or,{className:"tabs",onTabSelected:function(e){i(e)},activeTab:o,children:d.map((function(e){return Object(dt.jsx)(yr,{id:e.tabId,children:e.label},e.tabId)}))}),Object(dt.jsx)(_t,{className:"expand-button",onClick:function(){r(!n)},square:!0,size:"medium",text:n?"\u25bc":"\u25b2"})]}),Object(dt.jsx)("div",{className:"log-entries",children:b.map((function(e){return function(e){var t=m.a.get(e.key,e.context);return Object(dt.jsx)("div",{className:"entry",children:Object(dt.jsx)(Ci,{children:t})},e.time)}(e)}))})]})},Ti=n(104),Ei=function(e){var t=e.item,n=Object(Ti.b)(t.type),r=Object(g.c)(),a=Ln(),c=en(n.structure),o=c.cost.gold||0<=a,i=!($t(n.structure).state===ye.NotBuilt)||!o,s=m.a.getItemSubtext(t.type);return Object(dt.jsxs)("div",{children:[s&&Object(dt.jsx)("p",{className:"subtext",children:'"'.concat(s,'"')}),Object(dt.jsxs)(_t,{disabled:i,size:"small",onClick:function(){return function(e){r(Object(lr.b)(c.cost.gold||0)),r(function(e){return{type:"startBuildingStructure",structure:e}}(e));var t=[tr(e)],n=c.cost.time,a=or(Be.buildStructure,"".concat(e,".build"),"town",null!==n&&void 0!==n?n:0,t);r(a)}(n.structure)},children:["Start construction (",c.cost.gold," gold)"]})]})},qi=C.g,Ri=function(e){var t=e.structure,n=$t(t),r=pn(t),a=Object(g.c)();if(!t)return null;if(n.produces.some((function(t){return t===e.item})))return Object(dt.jsxs)("p",{children:["Constructed at:\xa0",Object(dt.jsx)(ft.b,{to:Object(se.b)(t),children:m.a.getStructureName(t)})]});var c=r.find((function(t){return t.name===e.item}));if(c)return Object(dt.jsxs)("p",{children:[Object(dt.jsx)(ft.b,{to:Object(se.b)(t),children:m.a.get("ui-tooltip-study-currently-studying")}),Object(C.i)(c.timeRemaining,!0)]});var o=Jn(e.item);if(n.level<(o.levelRequired||0)||n.state!==ye.Built)return Object(dt.jsx)("p",{className:"invalid",children:m.a.get("ui-tooltip-study-requires-structure-level",{structure:t,level:(o.levelRequired||0)+1})});return Object(dt.jsxs)("p",{children:[Object(dt.jsx)(_t,{onClick:function(){var n=[cr(e.structure,e.item)],r=qi,c=or(Be.studyItem,e.item,"".concat(t,".study"),r,n);a(c)},size:"small",children:m.a.get("ui-tooltip-study-start-study")}),Object(dt.jsx)(pr.a,{children:m.a.get("ui-tooltip-study-start",{structure:t})})]})},Di=function(e){var t,n=(t=e.item,Object(Zn.c)(t)&&Gn[t]?"armoursmith":Object(Hn.c)(t)&&Bn[t]?"weaponsmith":Object(Un.b)(t)&&Fn[t]?"workshop":null);return Object(Ce.d)(e.item).unique?Object(dt.jsx)("p",{children:m.a.get("ui-tooltip-unique-item")}):n?Object(dt.jsx)(Ri,{item:e.item,structure:n}):null},Mi=function(e){var t=e.damage;return Object(dt.jsx)("dl",{children:Object.entries(t).map((function(e){var t=Object(h.a)(e,2),n=t[0],r=t[1];return Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("dd",{children:m.a.get("damage-type-".concat(n))}),Object(dt.jsx)("dt",{children:r})]},n)}))})},Li=function(e){switch(e.type){case $e.b.attributeIncrease:var t=m.a.getAttributeName(e.attribute),n=(100*e.factor-100).toFixed();return m.a.getEffectDescription(e,{attribute:t,percentage:n});case $e.b.healthDecreaseOverTime:var r=(e.interval/1e3).toFixed();return m.a.getEffectDescription(e,{interval:r});case $e.b.healthDecreaseOnMove:return m.a.getEffectDescription(e)}},zi=function(e){var t=e.effects;return Object(dt.jsx)("ul",{children:t.map((function(e,t){return Object(dt.jsx)("li",{children:Li(e)},"".concat(e.type).concat(t))}))})},Pi=function(e){var t=e.weaponType,n=Object(Wo.a)(t).abilities;return Object(dt.jsx)("ul",{className:"abilities-list",children:n.map((function(e){var t=Qo(e);return Object(dt.jsxs)("li",{children:[m.a.getAbilityName(e)," ",Object(dt.jsx)("span",{className:"passive",children:!!t.passive&&"(passive)"})]},e)}))})},Wi=(n(674),function(e){var t,n=e.item,r=Object(Hn.b)(n.type),a=m.a.getItemSubtext(n.type),c=m.a.getWeaponType(r.weaponType),o=Object(Wo.a)(r.weaponType).classification,i=m.a.getWeaponClassification(o);return Object(dt.jsxs)("div",{className:"weapon-content",children:[Object(dt.jsxs)("div",{className:"subheader",children:[c,r.weaponType!==uo.c.shield&&" (".concat(i,")")]}),Object(dt.jsx)("hr",{}),r.damage&&Object(dt.jsx)(Mi,{damage:r.damage}),!(null===(t=r.effects)||void 0===t||!t.length)&&Object(dt.jsx)(zi,{effects:r.effects}),Object(dt.jsx)("hr",{}),Object(dt.jsx)(Pi,{weaponType:r.weaponType}),Object(dt.jsx)("hr",{}),Object(dt.jsx)(Di,{item:n.type}),a&&Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)("hr",{}),Object(dt.jsx)("p",{className:"secondary",children:'"'.concat(a,'"')})]})]})}),Vi=function(e){var t,n=e.item,r=Object(Zn.b)(n.type),a=r.damageReduction,c=m.a.getItemSubtext(n.type),o=m.a.getEquipmentSlot(r.equipmentType),i=n.durability,s=void 0===i?1:i;return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsx)("div",{className:"subheader",children:"".concat(o)}),c&&Object(dt.jsx)("p",{className:"secondary",children:'"'.concat(c,'"')}),Object(dt.jsx)("hr",{}),a&&Object(dt.jsxs)("p",{children:[" ",m.a.get("ui-tooltip-damage-reduction",{damageReduction:a})," "]}),!(null===(t=r.effects)||void 0===t||!t.length)&&Object(dt.jsx)(zi,{effects:r.effects}),Object(dt.jsxs)("dl",{children:[Object(dt.jsx)("dt",{children:m.a.get("ui-tooltip-durability")}),Object(dt.jsxs)("dd",{children:[(100*s).toFixed(0),"%"]})]}),Object(dt.jsx)(Di,{item:n.type})]})},Qi=function(e){var t=e.item,n=m.a.getItemSubtext(t.type);return Object(dt.jsx)("div",{children:n&&Object(dt.jsx)("p",{className:"subtext",children:'"'.concat(n,'"')})})},Bi=function(e){var t=e.item,n=e.source;if(Object(Ti.c)(t.type))return Object(dt.jsx)(Ei,{item:t});if(Object(Hn.c)(t.type))return Object(dt.jsx)(Wi,{item:t});if(Object(Zn.c)(t.type))return Object(dt.jsx)(Vi,{item:t});if(Object(et.c)(t.type))return Object(dt.jsx)(Qi,{item:t,source:n});var r=m.a.getItemSubtext(t.type);return r&&Object(dt.jsx)("p",{className:"subtext",children:'"'.concat(r,'"')})||null},Gi=(n(675),function(e){var t=e.info,n=Dn(),r=Ln(),a=Object(g.d)((function(e){return e.workers})),c=Wn(),o=Object(g.d)((function(e){return e.structures})),i=Mn();switch(t){case T.fabric:case T.food:case T.iron:case T.leather:case T.stone:case T.wood:var s,u,l,d=hr(null!==(s=n[t])&&void 0!==s?s:0,0),b=(null!==(u=n[t])&&void 0!==u?u:0)>=(null!==(l=null===i||void 0===i?void 0:i[t])&&void 0!==l?l:0);return Object(dt.jsxs)("div",{className:"resource-context",children:[Object(dt.jsx)("hr",{}),Object(dt.jsx)("div",{className:"subheader",children:m.a.get("ui-tooltip-resource-quantity",{amount:d})}),Object(dt.jsx)("div",{children:function(){var e=X(t),n=o[e];if(n.state!==ye.Built)return Object(dt.jsx)("span",{children:m.a.get("ui-tooltip-resource-produce-row-notbuilt",{structure:m.a.getStructureName(e)})});var r=J(e).levels[n.level].generates[t];return Object(dt.jsx)("span",{className:"produced",children:Object(dt.jsx)(pr.a,{components:{p:"span"},children:m.a.get("ui-tooltip-resource-produce-row",{structure:e,amount:r})})})}()}),b&&Object(dt.jsx)("div",{className:"warning-full",children:m.a.get("ui-tooltip-resource-warehouse-full",{resource:t})}),Object(dt.jsx)("hr",{}),Object(dt.jsx)("p",{className:"secondary",children:m.a.get("resource-".concat(t,"-info"))})]});case"gold":var p=r;return Object(dt.jsx)(dt.Fragment,{children:Object(dt.jsxs)("div",{className:"resource-context",children:[Object(dt.jsx)("div",{children:m.a.get("ui-tooltip-resource-quantity",{amount:p})}),Object(dt.jsx)("p",{className:"secondary",children:" ".concat(m.a.get("resource-".concat(t,"-info")))})]})});case"workers":var j=c,h=a;return Object(dt.jsx)(dt.Fragment,{children:Object(dt.jsxs)("div",{className:"resource-context",children:[Object(dt.jsx)("div",{children:m.a.get("ui-tooltip-workers-quantity",{free:j,total:h})}),Object(dt.jsx)("p",{className:"secondary",children:" ".concat(m.a.get("resource-".concat(t,"-info")))})]})});default:throw new Error("Uknow value "+t)}}),Fi=(n(676),["className","children"]),Hi=function(e){var t=e.className,n=e.children,r=Object(Pt.a)(e,Fi);return Object(dt.jsx)("div",Object(ge.a)(Object(ge.a)({},r),{},{className:"info-window ".concat(t||""),children:n}))};n(677);!function(e){e[e.bottom=0]="bottom",e[e.top=1]="top",e[e.left=2]="left",e[e.right=3]="right"}(Ii||(Ii={}));var Zi,Ui=function(e){var t=e.children,n=e.referenceRect,r=e.className,a=void 0===r?"":r,c=Object(f.useRef)(null),o=Object(f.useState)(e.placement||Ii.bottom),i=Object(h.a)(o,2),s=i[0],u=i[1],l=Object(f.useState)(),d=Object(h.a)(l,2),m=d[0],b=d[1];Object(f.useEffect)((function(){var e=c.current;if(e&&m&&m){var t=e.getBoundingClientRect();switch(s){case Ii.top:if(t.top-t.height-8-8<m.top)return void u(Ii.bottom);break;case Ii.bottom:if(t.top+t.height+8+8>m.height)return void u(Ii.top)}e.style.opacity="1";var n=e.querySelector(".tooltip-content");if(t.left<m.left+8){var r=m.left-t.left+8;n.style.transform="translateX(".concat(r,"px)")}else if(t.right>m.right-8){var a=t.right-m.right+8;n.style.transform="translateX(".concat(-a,"px)")}else n.style.transform=""}}),[u,m,s,n]);var p=function(){An.clear()};Object(f.useEffect)((function(){var e,t;return b(null===(e=c.current)||void 0===e||null===(t=e.closest(".app"))||void 0===t?void 0:t.getBoundingClientRect()),window.addEventListener("resize",p),function(){window.removeEventListener("resize",p)}}),[]);var j=0,v=0;if(m)switch(s){case Ii.bottom:j=n.left-m.left+n.width/2,v=n.top-m.top+n.height,a+=" tooltip-bottom";break;case Ii.top:j=n.left-m.left+n.width/2,v=n.top-m.top,a+=" tooltip-top"}return Object(dt.jsxs)("div",{className:"tooltip ".concat(a),style:{left:j,opacity:0,top:v},ref:c,children:[Object(dt.jsx)("div",{className:"tooltip-arrow"}),Object(dt.jsx)(Hi,{className:"tooltip-content",children:t})]})},Yi=(n(678),function(e){var t=e.traitDefinition;return Object(dt.jsxs)("div",{className:"trait-context",children:[Object(dt.jsx)("div",{className:"description",children:m.a.getTraitDescription(t.trait)}),t.hasEffect&&Object(dt.jsx)("div",{className:"effect",children:m.a.getTraitEffect(t.trait)})]})}),Ji=(n(679),function(e){var t=e.extendedAttribute;return Object(dt.jsxs)("div",{className:"attribute-context",children:[Object(dt.jsx)("hr",{}),Object(dt.jsx)("div",{className:"mechanics",children:m.a.getAttributeMechanics(t.attribute)}),Object(dt.jsx)("hr",{}),Object(dt.jsx)("dl",{className:"values",children:t.components.map((function(e,n){var r=function(e,t){switch(e.type){case aa.a.base:return"base ".concat(m.a.getAttributeName(t));case aa.a.tempEffect:return"soma";case aa.a.item:return m.a.getItemName(e.item)}}(e.origin,t.attribute);return Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("dt",{title:r,children:r}),Object(dt.jsx)("dd",{className:e.origin.type===aa.a.base?"base":"additional",children:jr(e.value)})]},e.origin.type+n)}))}),Object(dt.jsx)("hr",{}),Object(dt.jsx)("div",{className:"description",children:m.a.getAttributeDescription(t.attribute)})]})}),Xi=function(e){var t=e.actorObject,n=Object(kr.a)(t.adventurerId),r=Object(aa.d)(n),a=n.name,c=n.xp,o=Object(Le.c)(c),i=Object(f.useMemo)((function(){return Object(aa.e)(n)}),[n]);return Object(dt.jsxs)("div",{children:[Object(dt.jsxs)("div",{className:"name-and-level",children:[Object(dt.jsx)("div",{className:"name",children:a}),Object(dt.jsx)("div",{className:"level",children:m.a.get("ui-tooltip-actor-level",{level:o})})]}),Object(dt.jsx)(la,{attributes:i,small:!0}),Object(dt.jsx)(mi,{attributes:r,level:o})]})},Ki=function(e){var t,n,r=e.actorObject,a=Object(qo.a)(r.enemyType),c=null!==(t=r.level)&&void 0!==t?t:1,o=Object(aa.f)(a.attributes);return Object(dt.jsxs)("div",{children:[Object(dt.jsxs)("div",{className:"name-and-level",children:[Object(dt.jsx)("div",{className:"name",children:m.a.getEnemyName(r.enemyType)}),Object(dt.jsx)("div",{className:"level",children:m.a.get("ui-tooltip-actor-level",{level:c})})]}),Object(dt.jsxs)("div",{children:[Object(dt.jsx)("div",{children:"health:"}),Object(dt.jsxs)("div",{children:[hr(r.health,2),"/",Object(Kr.a)(null!==(n=r.level)&&void 0!==n?n:1,a.attributes.for)]})]}),Object(dt.jsx)(la,{attributes:o,small:!0}),Object(dt.jsx)(mi,{attributes:a.attributes,level:c})]})},_i=(n(680),function(e){var t=e.actorObject;return Object(dt.jsxs)("div",{className:"actor-context",children:[t.allegiance===Ee.a.player&&Object(dt.jsx)(Xi,{actorObject:t}),t.allegiance===Ee.a.enemy&&Object(dt.jsx)(Ki,{actorObject:t})]})}),$i=function(e){switch(e.type){case nt.a.burning:var t=(e.interval/1e3).toFixed();return m.a.getTempEffectDescription(e,{interval:t});case nt.a.brokenLegs:return m.a.getTempEffectDescription(e);case nt.a.soma:var n=(100*e.factor-100).toFixed();return m.a.getTempEffectDescription(e,{percentage:n})}},es=(n(681),function(e){var t=e.effect,n=t.charges;return Object(dt.jsxs)("div",{className:"effect-context",children:[Object(dt.jsx)("hr",{}),Object(dt.jsx)("div",{className:"description",children:$i(t)}),n&&Object(dt.jsx)("div",{children:m.a.get(1===n?"ui-tooltip-effect-one-charge-remains":"ui-tooltip-effect-n-charges-remain",{charges:n})}),Object(dt.jsx)("hr",{}),Object(dt.jsx)("div",{className:"flavor secondary",children:m.a.getTempEffectFlavor(t)})]})}),ts=function(e){switch(e.rarity){case Nn.a.common:return"item-name-common";case Nn.a.uncommon:return"item-name-uncommon";case Nn.a.rare:return"item-name-rare";case Nn.a.epic:return"item-name-epic";case Nn.a.legendary:return"item-name-legendary"}return"item-name-common"},ns=(n(682),function(){var e=Object(f.useState)(),t=Object(h.a)(e,2),n=t[0],r=t[1],a=function(e){r(e)};if(Object(f.useEffect)((function(){return An.instance.addListener(kn,a),function(){An.instance.removeListener(kn,a)}}),[]),!n)return null;var c=n.info,o=n.type,i=n.className,s=n.source;return Object(dt.jsx)(Ui,{referenceRect:n.referenceRect,className:i,children:Object(dt.jsx)("div",{className:"context-tooltip",children:function(){switch(o){case ln.actor:return Object(dt.jsx)(_i,{actorObject:c});case ln.attribute:var e=c,t=m.a.getAttributeName(e.attribute);return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsxs)("div",{className:"header",children:[Object(dt.jsx)("div",{className:"name effect",children:t}),Object(dt.jsx)("div",{className:"secondary",children:m.a.get("ui-tooltip-attribute")})]}),Object(dt.jsx)(Ji,{extendedAttribute:e})]});case ln.tempEffect:var r=c,a=m.a.getTempEffectName(r);return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsxs)("div",{className:"header",children:[Object(dt.jsx)("div",{className:"name effect",children:a}),Object(dt.jsx)("div",{className:"secondary",children:m.a.get("ui-tooltip-effect")})]}),Object(dt.jsx)(es,{effect:r})]});case ln.resource:var i=m.a.getResourceName(c);return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsxs)("div",{className:"header",children:[Object(dt.jsx)("div",{className:"name resource",children:i}),Object(dt.jsx)("div",{className:"secondary",children:m.a.get("ui-tooltip-resource-resource")})]}),Object(dt.jsx)(Gi,{info:c})]});case ln.item:var u=c,l=m.a.getItemName(u.type),d=Object(Ce.d)(u.type);return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsxs)("div",{className:"header",children:[Object(dt.jsx)("div",{className:"name item ".concat(ts(d)),children:l}),Object(dt.jsx)("div",{className:"secondary",children:m.a.getItemCategory(d.itemCategory)})]}),Object(dt.jsx)(Bi,{item:u,source:s})]});case ln.trait:var b=c,p=m.a.getTraitName(b.trait);return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsxs)("div",{className:"name trait",children:[m.a.get("ui-tooltip-type-trait"),p]}),Object(dt.jsx)(Yi,{traitDefinition:b})]});case ln.skill:var j=c,h=m.a.getSkillName(j);return Object(dt.jsxs)(dt.Fragment,{children:[Object(dt.jsxs)("div",{className:"name skill",children:[m.a.get("ui-tooltip-type-skill"),h]}),m.a.getSkillInfo(j)]});case ln.component:return c;default:throw new Error("Unknown context type ".concat(n.type))}}()})})}),rs=function(){},as=Object(f.createContext)({pauseGame:rs,continueGame:rs,restartGame:rs}),cs=n(333),os=n(102),is=n(145),ss=n(146),us=n(147),ls=n(148),ds=(n(683),[function(e){var t=e;return void 0!==t.rarity?Object(ge.a)(Object(ge.a)({},t),{},{rarity:"Rarity.".concat(m.a.getRarity(t.rarity))}):t},function(e){var t=e;return void 0!==t.equipmentType?Object(ge.a)(Object(ge.a)({},t),{},{equipmentType:"EquipmentSlotType.".concat(m.a.getEquipmentSlot(t.equipmentType))}):t}]),ms=function(e){var t=ds.reduce((function(e,t){return t(e)}),e),n=JSON.stringify(t,void 0,2).replace(/\n /g,"\n").replace(/ "/g,'"').replace(/\n {3}\{/g,"{").replace(/\n {4}/g,"\n  ").replace(/\n \}/g,"\n}").replace(/\n {3}\},/g,"\n}, ").replace(/\n {3}\}\n ]/g,"\n}]");return n.substring(2,n.length-2)},bs=function(e){var t=e.items;return Object(dt.jsx)("div",{className:"debug-items-list",children:Object(ca.a)(t).map((function(e){var t=Object(h.a)(e,2),n=t[0],r=t[1];return Object(dt.jsxs)("div",{className:"item",children:[Object(dt.jsx)(Sn,{item:{type:n},size:fn.a.big}),Object(dt.jsxs)("div",{className:"info",children:[Object(dt.jsx)("h4",{children:m.a.getItemName(n)}),Object(dt.jsx)("pre",{children:ms(r)})]})]},n)}))})},ps=function(){var e=Object(f.useState)("".concat(Object(ca.c)(Ne.a)[0])),t=Object(h.a)(e,2),n=t[0],r=t[1];return Object(dt.jsxs)("div",{className:"debug-items content",children:[Object(dt.jsx)(Or,{className:"tabs auto-collapse",onTabSelected:r,activeTab:n,children:Object(ca.c)(Ne.a).map((function(e){return Object(dt.jsx)(yr,{id:"".concat(e),children:m.a.getItemCategory(e)},e)}))}),Object(dt.jsxs)("div",{className:"items",children:[n==="".concat(Ne.a.ammunition)&&Object(dt.jsx)(bs,{items:os.a}),n==="".concat(Ne.a.apparel)&&Object(dt.jsx)(bs,{items:Zn.a}),n==="".concat(Ne.a.deed)&&Object(dt.jsx)(bs,{items:Ti.a}),n==="".concat(Ne.a.herb)&&Object(dt.jsx)(bs,{items:is.a}),n==="".concat(Ne.a.material)&&Object(dt.jsx)(bs,{items:ss.a}),n==="".concat(Ne.a.mineral)&&Object(dt.jsx)(bs,{items:us.a}),n==="".concat(Ne.a.consumable)&&Object(dt.jsx)(bs,{items:et.a}),n==="".concat(Ne.a.questItem)&&Object(dt.jsx)(bs,{items:Un.a}),n==="".concat(Ne.a.trinket)&&Object(dt.jsx)(bs,{items:ls.a}),n==="".concat(Ne.a.weapon)&&Object(dt.jsx)(bs,{items:Hn.a})]})]})},js={autoDensity:!0,sharedLoader:!0},hs=function(e){var t=e.spritesheetPath,n=e.animation,r=e.orientation,a=e.currentFrame,c=Object(f.useRef)(null),o=ho(t,n,r),i=Object(f.useState)(!1),s=Object(h.a)(i,2),u=s[0],l=s[1];return Object(f.useEffect)((function(){l(r===Ac.southWest||r===Ac.west||r===Ac.northWest)}),[r]),Object(f.useEffect)((function(){var e;a&&(null===(e=c.current)||void 0===e||e.gotoAndStop(a))}),[a]),Object(dt.jsx)(qt.Stage,{options:js,width:284,height:284,children:Object(dt.jsx)(Xc,{animationSpeed:.1,isPlaying:!0,textures:o,x:_c,y:_c,scale:[u?-1:1,1],anchor:[.5,.5],pivot:[0,0],ref:c})})},fs=(n(684),["elf-bow","knight-sword","orc-axe","skeleton","troll-axe","troll-sword"]),vs=function(e){return"/img/scene/actors/".concat(e,".json")},gs=[Ac.north,Ac.northEast,Ac.east,Ac.southEast,Ac.south,Ac.southWest,Ac.west,Ac.northWest],Os=function(){var e=Object(f.useState)("elf-bow"),t=Object(h.a)(e,2),n=t[0],a=t[1],o=Object(f.useState)("stand"),i=Object(h.a)(o,2),s=i[0],u=i[1],l=Object(f.useState)(Ac.north),d=Object(h.a)(l,2),m=d[0],p=d[1],j=Object(f.useState)(0),v=Object(h.a)(j,2),g=v[0],O=v[1],y=Object(f.useState)(!1),x=Object(h.a)(y,2),w=x[0],k=x[1];return Object(f.useEffect)((function(){Object(r.a)(c.a.mark((function e(){var t,n,r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=fs.map((function(e){return vs(e)})),n=Object(Ke.a)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,Object(b.c)(a);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:k(!0);case 19:case"end":return e.stop()}}),e,null,[[2,12,15,18]])})))()})),w?Object(dt.jsxs)("div",{className:"debug-sprites",children:[Object(dt.jsxs)("div",{children:[Object(dt.jsx)("select",{value:n,onChange:function(e){a(e.currentTarget.value)},children:fs.map((function(e){return Object(dt.jsx)("option",{children:e},e)}))}),Object(dt.jsx)("select",{value:s,onChange:function(e){u(e.currentTarget.value)},children:po.map((function(e){return Object(dt.jsx)("option",{children:e},e)}))}),Object(dt.jsx)("select",{value:m,onChange:function(e){p(e.currentTarget.value)},children:gs.map((function(e){return Object(dt.jsx)("option",{children:e},e)}))}),Object(dt.jsx)("input",{type:"number",value:g,onChange:function(e){return O(e.currentTarget.value)}})]}),Object(dt.jsx)(hs,{spritesheetPath:vs(n),animation:s,orientation:m,currentFrame:g})]}):Object(dt.jsx)(mt,{})},ys=(n(685),function(e){var t=e.onSetSelectedId,n=Object(kr.c)();return Object(dt.jsx)("div",{className:"adventurers-overview",children:n.map((function(e){return Object(dt.jsxs)("div",{className:"adventurer",onClick:function(){return t(e.id)},children:[Object(dt.jsx)(xr,{adventurer:e,size:fn.a.biggest}),Object(dt.jsx)("div",{className:"name",children:m.a.getAdventurerName(e.id)})]},e.id)}))})}),xs=function(e){var t=e.xp,n=e.onChange,r=Object(Le.c)(t),a=Object(Le.b)(r+1),c=t/a;return Object(dt.jsxs)("div",{className:"xp-input input",children:[Object(dt.jsx)("input",{type:"number",min:0,max:Le.a,value:t,className:"xp",onChange:function(e){return n(Number(e.currentTarget.value)-t)}}),Object(dt.jsx)("div",{className:"progress-mini-bg",children:Object(dt.jsx)("div",{className:"progress-mini-bar",style:{width:"".concat(100*c,"%")}})})]})},ws=function(e){var t=Object(g.c)(),n=e.adventurerId,r=Object(kr.a)(n),a=r.xp,c=r.basicAttributes,o=r.health,i=Object(Le.c)(a),s=Object(Kr.a)(i,c.for),u=function(e){return Object(dt.jsxs)(f.Fragment,{children:[Object(dt.jsx)("dt",{children:m.a.getAttributeName(e)}),Object(dt.jsx)("dd",{children:Object(dt.jsxs)("div",{className:"slider",children:[Object(dt.jsx)("input",{type:"range",min:aa.c,max:aa.b,value:c[e],onChange:function(n){return function(e,n){t(Object(rt.m)(r.id,Object(ge.a)(Object(ge.a)({},c),{},Object(G.a)({},e,n))))}(e,Number(n.currentTarget.value))}}),Object(dt.jsxs)("div",{className:"value",children:["(",c[e],")"]})]})})]},e)};return Object(dt.jsxs)("div",{className:"debug-adventurer-edit",children:[Object(dt.jsx)(xr,{adventurer:r,size:fn.a.biggest}),m.a.getAdventurerFlavor(n,r.name),Object(dt.jsxs)("fieldset",{children:[Object(dt.jsx)("summary",{children:"General"}),Object(dt.jsxs)("dl",{children:[Object(dt.jsx)("dt",{children:"Name"}),Object(dt.jsx)("dd",{children:Object(dt.jsx)("div",{className:"slider",children:Object(dt.jsx)("input",{type:"text",value:r.name,onChange:function(e){t(Object(rt.l)(r.id,e.currentTarget.value))}})})}),Object(dt.jsx)("dt",{children:"XP"}),Object(dt.jsx)("dd",{children:Object(dt.jsxs)("div",{className:"slider",children:[Object(dt.jsx)(xs,{xp:a,onChange:function(e){t(Object(rt.c)(r.id,e))}}),Object(dt.jsxs)("span",{className:"info",children:["(level ",Object(Le.c)(a),")"]})]})}),Object(dt.jsx)("dt",{children:"Health"}),Object(dt.jsx)("dd",{children:Object(dt.jsxs)("div",{className:"slider",children:[Object(dt.jsx)("input",{type:"range",min:0,max:s,value:o,onChange:function(e){return n=Number(e.currentTarget.value)-o,void t(Object(rt.h)(r.id,n));var n}}),Object(dt.jsxs)("span",{className:"info value",children:["(",hr(o,2),"/",hr(s,2),")"]})]})})]})]}),Object(dt.jsxs)("fieldset",{children:[Object(dt.jsx)("summary",{children:"Attributes"}),Object(dt.jsx)("dl",{children:oa.b.map((function(e){return u(e)}))})]})]})},ks=(n(686),function(){var e=Object(f.useState)(),t=Object(h.a)(e,2),n=t[0],r=t[1],a=Object(kr.c)(),c=Object(g.d)((function(e){return e.quests})),o=Object(f.useMemo)((function(){var e=Tc(a,c);return Object.keys(e).map((function(t){var n=e[t],r="solo"===t?"solo":m.a.getQuestTitle(t);return{label:r,options:n.map((function(e){return{adventurer:e,value:e.id,label:r}}))}}))}),[a,c]);return Object(dt.jsxs)("div",{className:"debug-adventurers",children:[Object(dt.jsx)(Nc,{className:"adventurer-list",classNamePrefix:"adventurer-list",placeholder:"Adventurers (grouped by quest)",onChange:function(e){return r(null===e||void 0===e?void 0:e.value)},formatGroupLabel:function(e){return Object(dt.jsxs)("div",{className:"item-group",children:[Object(dt.jsx)("div",{className:"item-group-label",children:e.label}),Object(dt.jsxs)("div",{className:"item-group-count",children:[e.options.length," adventurers"]})]})},formatOptionLabel:function(e){var t=a.find((function(t){return t.id===e.value}));return t?Object(dt.jsxs)("div",{className:"item-option",children:[Object(dt.jsx)(xr,{adventurer:t,size:fn.a.smallest}),Object(dt.jsx)("div",{className:"item-label",children:t.name})]}):null},options:o}),n&&Object(dt.jsx)(ws,{adventurerId:n}),!n&&Object(dt.jsx)(ys,{onSetSelectedId:r})]})}),As=(n(305),function(){var e=Object(g.c)(),t=Object(g.d)((function(e){return e.structures})),n=function(t,n){!function(t,n){e(ar(t,n))}(t,n?ye.Built:ye.NotBuilt),n?oe.b.addToast("The ".concat(m.a.getStructureName(t)," is constructed"),ie.a.cheat):oe.b.addToast("The ".concat(m.a.getStructureName(t)," is not constructed"),ie.a.cheat)};return Object(dt.jsxs)("div",{className:"debug-context-town",children:[Object(dt.jsx)("h2",{children:"Structures"}),Object(dt.jsx)("div",{className:"structures",children:Object.keys(t).map((function(e){return function(e){var r=J(e),a=t[e],c=r.levels[a.level],o=m.a.get(c.displayName);return Object(dt.jsxs)("div",{className:"label-dropdown",children:[Object(dt.jsx)("label",{title:e,children:"".concat(o)}),Object(dt.jsx)("input",{type:"checkbox",checked:a.state===ye.Built,onChange:function(){return n(e,a.state!==ye.Built)}},e)]},e)}(e)}))})]})}),Ns=function(){var e=Oc(),t=Object(g.c)(),n=function(e){var n=e.currentTarget.getAttribute("setting-name");if(null===n)throw new Error("No setting");t(gc(n,e.currentTarget.checked))};return Object(dt.jsxs)("div",{className:"debug-context-world",children:[Object(dt.jsx)("h2",{children:"Scene"}),Object(dt.jsx)("section",{children:Object(dt.jsxs)("p",{children:[Object(dt.jsx)("label",{children:"Show pathable tiles"}),Object(dt.jsx)("input",{type:"checkbox",checked:e.debugSceneShowPathable,"setting-name":"debugSceneShowPathable",onChange:n})]})}),Object(dt.jsx)("section",{children:Object(dt.jsxs)("p",{children:[Object(dt.jsx)("label",{children:"Show action queue tiles"}),Object(dt.jsx)("input",{type:"checkbox",checked:e.debugSceneShowActionQueue,"setting-name":"debugSceneShowActionQueue",onChange:n})]})}),Object(dt.jsx)("section",{children:Object(dt.jsxs)("p",{children:[Object(dt.jsx)("label",{children:"Show cell locations"}),Object(dt.jsx)("input",{type:"checkbox",checked:e.debugSceneShowCellLocations,"setting-name":"debugSceneShowCellLocations",onChange:n})]})})]})},Cs=(n(687),function(){return Object(dt.jsx)("div",{className:"debug-context",children:Object(dt.jsxs)(vt.d,{children:[Object(dt.jsx)(vt.b,{path:Object(se.d)(),element:Object(dt.jsx)(Ns,{})}),Object(dt.jsx)(vt.b,{path:Object(se.c)(),element:Object(dt.jsx)(As,{})})]})})}),Is=(n(688),function(){var e=Object(f.useState)("context"),t=Object(h.a)(e,2),n=t[0],r=t[1];return Object(dt.jsxs)("div",{className:"debug",children:[Object(dt.jsxs)("ul",{className:"menu",children:[Object(dt.jsx)("li",{children:Object(dt.jsx)(_t,{onClick:function(){return r("context")},color:"context"===n?"green":"blue",children:" Context"})}),Object(dt.jsx)("li",{children:Object(dt.jsx)(_t,{onClick:function(){return r("items")},color:"items"===n?"green":"blue",children:" Items"})}),Object(dt.jsx)("li",{children:Object(dt.jsx)(_t,{onClick:function(){return r("sprites")},color:"sprites"===n?"green":"blue",children:" Sprites"})}),Object(dt.jsx)("li",{children:Object(dt.jsx)(_t,{onClick:function(){return r("adventurers")},color:"adventurers"===n?"green":"blue",children:" Adventurers"})})]}),"context"===n&&Object(dt.jsx)(Cs,{}),"items"===n&&Object(dt.jsx)(ps,{}),"sprites"===n&&Object(dt.jsx)(Os,{}),"adventurers"===n&&Object(dt.jsx)(ks,{})]})}),Ss=(n(689),function(){var e=Object(f.useState)(!1),t=Object(h.a)(e,2),n=t[0],r=t[1],a=Oc();return Object(cs.a)("~",(function(){r(!n&&a.debugEnableDebugDrawer)})),n?Object(dt.jsxs)("div",{className:"debug-drawer",children:[Object(dt.jsx)("div",{className:"close",onClick:function(){return r(!1)},children:"x"}),Object(dt.jsx)(Is,{})]}):null});n(690);gt.a.registerPIXI(pt),Ot.b.registerPlugin(gt.a),function(e){e[e.Town=0]="Town",e[e.World=1]="World"}(Zi||(Zi={}));var Ts=960,Es=Object(f.createContext)(null),qs=function(){var e=Object(f.useRef)(null),t=Object(f.useContext)(as).restartGame,n=Object(f.useState)([]),r=Object(h.a)(n,2),a=r[0],c=r[1],o=function(){yt.c.playSound("ui/buttonClick")},i=function(){c([])},s=function(){a&&a.length&&c(a.slice(0,-1))};Object(f.useEffect)((function(){yt.c.addSound("ui/buttonClick","sound/ui/button-click.ogg"),yt.c.addSound("ui/equip","sound/ui/equip.mp3"),yt.c.addSound("ui/error","sound/ui/error.ogg"),yt.c.addSound("ui/levelUp","sound/ui/level-up.ogg"),yt.c.addSound("ui/toast","sound/ui/toast.ogg"),yt.c.addSound("scene/drinking","sound/scene/drinking.ogg")}),[]);return Object(f.useEffect)((function(){var e=wt()((function(){An.clear()}),100);return window.addEventListener("scroll",e),window.addEventListener("wheel",e),function(){window.removeEventListener("resize",e),window.removeEventListener("wheel",e)}}),[]),Object(dt.jsx)(Es.Provider,{value:{onOpenWindow:function(e){c([].concat(Object(j.a)(a||[]),[e]))},onCloseWindow:i},children:Object(dt.jsx)("div",{className:"app",ref:e,style:{maxWidth:Ts},onClick:function(){An.clear()},children:Object(dt.jsx)(jt.DndProvider,{backend:ht.HTML5Backend,children:Object(dt.jsxs)(ft.a,{children:[Object(dt.jsx)(Pc,{}),Object(dt.jsxs)("div",{className:"control-bar",children:[Object(dt.jsxs)(vt.d,{children:[Object(dt.jsx)(vt.b,{path:"/",element:Object(dt.jsx)(vt.a,{to:Object(se.d)()})}),Object(dt.jsx)(vt.b,{path:"".concat(Object(se.d)(),"/*"),element:Object(dt.jsx)(ft.b,{to:Object(se.c)(),children:Object(dt.jsxs)(_t,{onClick:function(){return o()},color:"green",children:[" ",m.a.get("ui-view-button-town")," "]})})}),Object(dt.jsx)(vt.b,{path:"".concat(Object(se.c)(),"/*"),element:Object(dt.jsx)(ft.b,{to:Object(se.d)(),children:Object(dt.jsxs)(_t,{onClick:function(){return o()},color:"green",children:[" ",m.a.get("ui-view-button-world")," "]})})})]})," | ",Object(dt.jsx)(_t,{onClick:function(){t()},color:Ht.purple,children:" Restart! "})]}),Object(dt.jsxs)(vt.d,{children:[Object(dt.jsx)(vt.b,{path:"".concat(Object(se.c)(),"/*"),element:Object(dt.jsx)(fc,{})}),Object(dt.jsx)(vt.b,{path:"".concat(Object(se.d)(),"/*"),element:Object(dt.jsx)(yi,{})})]}),Object(dt.jsx)(Si,{}),function(){if(!a.length)return null;var e=a[a.length-1],t={onClose:i,onBack:s,backEnabled:a.length>1,closeEnabled:!0};return Object(f.cloneElement)(e,t)}(),Object(dt.jsx)(Ss,{}),Object(dt.jsx)(ns,{}),Object(dt.jsx)(vc,{}),Object(dt.jsx)(No,{layer:fr.a.general})]})})})})},Rs=function(){var e=Object(f.useRef)(!1),t=Object(f.useState)(),n=Object(h.a)(t,2),a=n[0],o=n[1],i=Object(f.useState)(),s=Object(h.a)(i,2),u=s[0],l=s[1],d=Object(f.useCallback)((function(){null===a||void 0===a||a.dispatch({type:"startGame"}),null===a||void 0===a||a.dispatch(Object(x.b)("test-game-welcome")),null===a||void 0===a||a.dispatch(Object(x.b)("test-you-have-found-an-item",{item:{type:"weapon/battleAxe",quantity:2}})),console.log("Starting new GAME (version ".concat(A,")"))}),[a]),m=Object(f.useCallback)(Object(r.a)(c.a.mark((function e(){var t,n,r=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,ut(t);case 3:(n=e.sent).isHydrated||d(),o(n.store),l(n.persistor);case 7:case"end":return e.stop()}}),e)}))),[d]),b=Object(f.useCallback)((function(){if(window.confirm("Are you sure you wish to reset all your progress?")){var e=Je();null===a||void 0===a||a.dispatch(y(e)),d()}}),[d,a]);Object(f.useEffect)((function(){var t;if(a){try{var n,r,c=null===(n=a.getState().game)||void 0===n?void 0:n.version;if(c<N&&(null===(r=a.getState().game)||void 0===r?void 0:r.ignoreVersionDiff)!==N){if(!window.confirm("This game was initialized with version ".concat(w(c)," which is older than the current client (").concat(A,"). This might cause problems. Continue anyway? \n\n(pressing cancel will reset progress) ")))return void b();a.dispatch({type:"ignoreVersionDiff"})}t=setInterval((function(){if(!e.current){var t=a.getState(),n=Date.now()-t.engine.lastTick,r=[],c=te(t.engine.lastProducedUpdate,t),o=we(t),i=me(),s=de(n,a),u=s.questUpdates,l=s.logUpdates;r.push.apply(r,Object(j.a)(l)),a.dispatch(function(e,t,n,r,a,c){return{type:"gameTick",delta:e,rngState:t,resources:n,quests:r,harvest:a,log:c}}(n,i,c,u,o,r)),lt(t.tasks,a.dispatch)}}),2500)}catch(o){console.warn(o)}return function(){clearInterval(t)}}}),[b,a]);var p=Object(f.useCallback)((function(){e.current=!0}),[]),v=Object(f.useCallback)((function(){e.current=!1}),[]);return Object(f.useEffect)((function(){a||m()}),[m,a]),a&&u?Object(dt.jsx)(as.Provider,{value:{pauseGame:p,continueGame:v,restartGame:b},children:Object(dt.jsx)(g.a,{store:a,children:Object(dt.jsx)(bt.a,{loading:null,persistor:u,children:Object(dt.jsx)(qs,{})})})}):Object(dt.jsx)(mt,{})},Ds=(n(702),function(e){var t=e.error,n=Object(f.useState)("stack"),a=Object(h.a)(n,2),o=a[0],i=a[1],s=Object(f.useState)("(no store state found)"),u=Object(h.a)(s,2),l=u[0],d=u[1];Object(f.useEffect)((function(){Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(pe.a)(at);case 2:t=e.sent,d(JSON.stringify(t,void 0,2));case 4:case"end":return e.stop()}}),e)})))()}));return Object(dt.jsx)("div",{className:"error",children:Object(dt.jsxs)(Hi,{className:"error-modal",title:"",children:[Object(dt.jsx)("h2",{className:"title",children:"Something went horribly wrong"}),Object(dt.jsxs)("div",{className:"content",children:[Object(dt.jsx)("pre",{children:t.message}),Object(dt.jsxs)(Or,{className:"tabs",onTabSelected:function(e){i(e)},activeTab:o,children:[Object(dt.jsx)(yr,{id:"stack",children:"Stack"}),Object(dt.jsx)(yr,{id:"store",children:"Store"})]}),"stack"===o&&Object(dt.jsx)("pre",{children:t.stack}),"store"===o&&Object(dt.jsx)("pre",{children:l}),Object(dt.jsxs)("form",{action:"https://formspree.io/f/mayvnnbp",method:"POST",className:"buttons",children:[Object(dt.jsx)("input",{type:"hidden",name:"message",value:t.message}),Object(dt.jsx)("input",{type:"hidden",name:"stack",value:t.stack}),Object(dt.jsx)("input",{type:"hidden",name:"store",value:l}),Object(dt.jsx)("button",{type:"reset",onClick:function(){fe.a.clear(),window.location.reload()},children:"Reset game"}),Object(dt.jsx)("button",{type:"submit",children:"Report bug"})]})]})]})})}),Ms=(n(703),function(){var e=Object(r.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(),e.next=3,Object(b.c)("".concat(".","/lang/en.json"));case 3:(t=e.sent)&&m.a.init(t.data),d.b("GILLESROX2"),Object(o.createRoot)(document.getElementById("root")).render(Object(dt.jsx)(p.ErrorBoundary,{FallbackComponent:Ds,children:Object(dt.jsx)(Rs,{})}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());Ms()}],[[704,1,2]]]);
//# sourceMappingURL=main.9028f292.chunk.js.map