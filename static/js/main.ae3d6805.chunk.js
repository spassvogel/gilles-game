(this["webpackJsonpgilles-game"]=this["webpackJsonpgilles-game"]||[]).push([[0],[,function(e,t,n){"use strict";var a,r;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),function(e){e[e.deed=0]="deed",e[e.apparel=1]="apparel",e[e.material=2]="material",e[e.questItem=3]="questItem",e[e.trinket=4]="trinket",e[e.weapon=5]="weapon"}(a||(a={})),function(e){e.deedForLumbermill="deedForLumbermill",e.deedForWeaponsmith="deedForWeaponsmith",e.boots1="boots1",e.boots2="boots2",e.boots3="boots3",e.chainmailHood="chainmailHood",e.chest="chest",e.clothGloves="clothGloves",e.cowl="cowl",e.fedora="fedora",e.druidChest="druidChest",e.druidFeet="druidFeet",e.druidHands="druidHands",e.druidHead="druidHead",e.druidLegs="druidLegs",e.greaves1="greaves1",e.greaves2="greaves2",e.hornedHelmet="hornedHelmet",e.leatherGloves="leatherGloves",e.nomadHelmet="nomadHelmet",e.pants1="pants1",e.pants2="pants2",e.plateChest1="plateChest1",e.plateChest2="plateChest2",e.plateChest3="plateChest3",e.plateChest4="plateChest4",e.plateGloves1="plateGloves1",e.plateGloves2="plateGloves2",e.plateHelmet="plateHelmet",e.platePants="platePants",e.plateShoulders1="plateShoulders1",e.plateShoulders2="plateShoulders2",e.robe="robe",e.shoulders1="shoulders1",e.shoulders2="shoulders2",e.shoulders3="shoulders3",e.vest="vest",e.arrowheads="arrowheads",e.bolts="bolts",e.buckle="buckle",e.chain="chain",e.cogs="cogs",e.gem="gem",e.gunpowder="gunpowder",e.ingot="ingot",e.nails="nails",e.poisonVial="poisonVial",e.ribbon="ribbon",e.rope="rope",e.scales="scales",e.spring="spring",e.thread="thread",e.blueprints="blueprints",e.crate="crate",e.dragonEye="dragonEye",e.dynamite="dynamite",e.eye="eye",e.feather="feather",e.food="food",e.heart="heart",e.horn="horn",e.key="key",e.letters="letters",e.lockPicks="lockPicks",e.oil="oil",e.orcFinger="orcFinger",e.plans="plans",e.purpleGems="purpleGems",e.runestone="runestone",e.sandwich="sandwich",e.teeth="teeth",e.tooth="tooth",e.torch="torch",e.tusk="tusk",e.vase="vase",e.vial="vial",e.weeds="weeds",e.ring="ring",e.magicAmulet="magicAmulet",e.battleAxe="battleAxe",e.brassKnuckles="brassKnuckles",e.cleaver="cleaver",e.club="club",e.crossbow="crossbow",e.dagger="dagger",e.flail="flail",e.greatswordOfGwai="greatswordOfGwai",e.khopesh="khopesh",e.longbow="longbow",e.mace="mace",e.morningStar="morningStar",e.poisonedDagger="poisonedDagger",e.ravenStaff="ravenStaff",e.savageStaff="savageStaff",e.spear="spear",e.sword="sword",e.warhammer="warhammer"}(r||(r={}))},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return q}));var a,r=n(20),o={type:r.a.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-alchemist-name",workerCapacity:2,cost:{gold:0},produces:[]},{displayName:"structure-alchemist-name",workerCapacity:5,cost:{gold:30},produces:[]},{displayName:"structure-alchemist-name",workerCapacity:10,cost:{gold:50},produces:[]}]},c=n(36),i=n(1),u={item:i.a.boots1,cost:{resources:{wood:2,iron:15},time:c.a}},s={item:i.a.chest,cost:{resources:{wood:10,iron:45},time:c.b}},l={item:i.a.cowl,cost:{resources:{iron:15},time:c.b}},m={cost:{gold:40,time:4e3},type:r.a.production,levels:[{displayName:"structure-armoursmith-name",workerCapacity:2,cost:{gold:0},produces:[u]},{displayName:"structure-armoursmith-name",workerCapacity:5,cost:{gold:30},produces:[u,s]},{displayName:"structure-armoursmith-name",workerCapacity:10,cost:{gold:50},produces:[u,s,l]}]},d={type:r.a.resource,cost:{gold:40,time:4e3},levels:[{displayName:"structure-garden-name",workerCapacity:2,cost:{gold:0},generates:{food:2}},{displayName:"structure-garden-name",workerCapacity:5,cost:{gold:30},generates:{food:2}},{displayName:"structure-garden-name",workerCapacity:10,cost:{gold:50},generates:{food:2}}]},p={type:r.a.resource,cost:{gold:31,time:5e3},levels:[{displayName:"structure-lumberMill-name",workerCapacity:2,cost:{gold:0},generates:{wood:2}},{displayName:"structure-lumberMill-name",workerCapacity:5,cost:{gold:30},generates:{wood:2}},{displayName:"structure-lumberMill-name",workerCapacity:10,cost:{gold:50},generates:{wood:2}}]},f={cost:{gold:40,time:4e3},type:r.a.resource,levels:[{displayName:"structure-mine-name",workerCapacity:2,cost:{gold:0},generates:{iron:2}},{displayName:"structure-mine-name",workerCapacity:5,cost:{gold:30},generates:{iron:2}},{displayName:"structure-mine-name",workerCapacity:10,cost:{gold:50},generates:{iron:2}}]},v={cost:{gold:40,time:4e3},type:r.a.resource,levels:[{displayName:"structure-quarry-name",workerCapacity:2,cost:{gold:0},generates:{stone:2}},{displayName:"structure-quarry-name",workerCapacity:5,cost:{gold:30},generates:{stone:4}},{displayName:"structure-quarry-name",workerCapacity:10,cost:{gold:50},generates:{stone:6}}]},h={cost:{gold:40,time:4e3},type:r.a.resource,levels:[{displayName:"structure-tannery-name",workerCapacity:2,cost:{gold:0},generates:{leather:2}},{displayName:"structure-tannery-name",workerCapacity:5,cost:{gold:30},generates:{leather:5}},{displayName:"structure-tannery-name",workerCapacity:10,cost:{gold:50},generates:{leather:7}}]},g={cost:{gold:40,time:4e3},type:r.a.tavern,levels:[{displayName:"structure-tavern-name",workerCapacity:2,cost:{gold:0},rooms:10},{displayName:"structure-tavern-name",workerCapacity:5,cost:{gold:30},rooms:12},{displayName:"structure-tavern-name",workerCapacity:10,cost:{gold:50},rooms:15}]},b={cost:{gold:40,time:4e3},type:r.a.warehouse,levels:[{displayName:"structure-warehouse-name",workerCapacity:2,cost:{gold:0},maxResources:{fabric:200,food:200,iron:200,leather:200,stone:200,wood:200}},{displayName:"structure-warehouse-name",workerCapacity:5,cost:{gold:30},maxResources:{fabric:500,food:500,iron:500,leather:500,stone:500,wood:500}},{displayName:"structure-warehouse-name",workerCapacity:10,cost:{gold:50},maxResources:{fabric:1e3,food:1e3,iron:1e3,leather:1e3,stone:1e3,wood:1e3}}]},y={item:i.a.crossbow,cost:{resources:{wood:20,iron:5},time:c.a}},w={item:i.a.longbow,cost:{resources:{wood:40,iron:5},time:c.b}},O={item:i.a.poisonedDagger,cost:{resources:{wood:50,iron:15},materials:[i.a.poisonVial],time:c.b}},E={item:i.a.dagger,cost:{resources:{wood:10,iron:10},time:c.b}},j={item:i.a.sword,cost:{resources:{wood:10,iron:30},time:c.b}},k={item:i.a.khopesh,cost:{resources:{wood:15,iron:40},time:c.d}},T={type:r.a.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-weaponsmith-name",workerCapacity:2,cost:{gold:0},produces:[y,E]},{displayName:"structure-weaponsmith-name",workerCapacity:5,cost:{gold:30},produces:[y,E,w]},{displayName:"structure-weaponsmith-name",workerCapacity:10,cost:{gold:50},produces:[y,E,w,j,k]},{displayName:"structure-weaponsmith-name",workerCapacity:14,cost:{gold:50},produces:[y,E,w,j,k,O]}]},I={cost:{gold:40,time:4e3},type:r.a.resource,levels:[{displayName:"structure-weaver-name",workerCapacity:2,cost:{gold:0},generates:{fabric:2}},{displayName:"structure-weaver-name",workerCapacity:5,cost:{gold:30},generates:{fabric:5}},{displayName:"structure-weaver-name",workerCapacity:10,cost:{gold:50},generates:{fabric:7}}]},N={item:i.a.torch,cost:{resources:{wood:2,fabric:1},time:c.c}},x={item:i.a.sandwich,cost:{resources:{food:1},time:c.c/2}},S={type:r.a.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-workshop-name",workerCapacity:2,cost:{gold:0},produces:[N,x]},{displayName:"structure-workshop-name",workerCapacity:5,cost:{gold:30},produces:[]},{displayName:"structure-workshop-name",workerCapacity:10,cost:{gold:50},produces:[]},{displayName:"structure-workshop-name",workerCapacity:14,cost:{gold:50},produces:[]}]};!function(e){e.alchemist="alchemist",e.armoursmith="armoursmith",e.garden="garden",e.lumberMill="lumberMill",e.mine="mine",e.quarry="quarry",e.tavern="tavern",e.tannery="tannery",e.warehouse="warehouse",e.weaponsmith="weaponsmith",e.weaver="weaver",e.workshop="workshop"}(a||(a={}));var C={alchemist:o,armoursmith:m,garden:d,lumberMill:p,mine:f,quarry:v,tavern:g,tannery:h,warehouse:b,weaponsmith:T,weaver:I,workshop:S};function q(e){return C[e]}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(18),r=n(19),o=n(29),c=n(1),i=n(57),u=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"init",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.texts=e,this.templates={},t&&this.compileAll(),this.initialized=!0}},{key:"get",value:function(e,t){if(!this.initialized)throw new Error("Error ".concat(this," not initialized!"));var n=this.getTemplate(e);return n?n(t):(console.error("Key '".concat(e,"' not found in TextManager")),"<<'".concat(e,"' missing>>"))}},{key:"getTextEntry",value:function(e){return this.get(e.key,e.context)}},{key:"getTemplate",value:function(e){var t=this.templates[e];return!t&&this.texts[e]&&(this.compile(e,this.texts[e]),t=this.templates[e]),t}},{key:"getQuestTitle",value:function(e){return this.get("quest-".concat(e,"-title"))}},{key:"getQuestDescription",value:function(e){return this.get("quest-".concat(e,"-description"))}},{key:"getResourceName",value:function(e){return this.get("resource-".concat(e,"-name"))}},{key:"getItemName",value:function(e){var t=c.b[Object(o.b)(e).itemType];return this.get("item-".concat(t,"-").concat(e,"-name"))}},{key:"getStructureName",value:function(e){return this.get("structure-".concat(e,"-name"))}},{key:"compileAll",value:function(){var e=this;Object.keys(this.texts).forEach((function(t){e.compile(t,e.texts[t])}))}},{key:"compile",value:function(e,t){var n=i.compile(t);this.templates[e]=n}}]),e}();u.initialized=!1,u.texts=void 0,u.templates=void 0,i.registerHelper("item:name",(function(e,t){if(!o.a[e])return new i.SafeString("<<ITEM DEFINITION NOT FOUND: ".concat(e,">>"));switch(t){case"aA":return s(e);case"aD":case"aU":return m(e);default:var n=o.a[e].name;return new i.SafeString(n)}})),i.registerHelper("structure:name",(function(e){var t=u.get("structure-".concat(e,"-name"));return new i.SafeString(t)}));var s=function(e){return l(e)},l=function(e){var t=u.getItemName(e),n=u.getTemplate("common-article-undefined");return new i.SafeString("".concat(n({noun:t})))},m=function(e){var t=u.getItemName(e),n=u.getTemplate("common-article-defined");return new i.SafeString("".concat(n({noun:t})))}},,,,,function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.nothing=0]="nothing",e[e.encounter=1]="encounter"}(a||(a={}))},,,,,,function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.resource=0]="resource",e[e.production=1]="production",e[e.tavern=2]="tavern",e[e.warehouse=3]="warehouse"}(a||(a={}))},function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.common=0]="common",e[e.town=1]="town",e[e.quest=2]="quest"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}));var a=function(){return"/world"},r=function(e){return"".concat(a(),"/").concat(e)},o=function(){return"/town"},c=function(e){return"".concat(o(),"/").concat(e)}},function(e,t,n){"use strict";var a;function r(e,t){return{type:a.launchQuest,questName:e,assignedAventurers:t}}function o(e){return{type:a.exitEncounter,questName:e}}function c(e,t){return{type:a.setSceneName,questName:e,sceneName:t}}function i(e,t){return{type:a.setScene,questName:e,scene:t}}function u(e,t){return{type:a.enqueueSceneAction,questName:e,sceneAction:t}}function s(e){return{type:a.completeSceneAction,questName:e}}n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"h",(function(){return m})),function(e){e.launchQuest="launchQuest",e.updateQuestVars="updateQuestVars",e.updateEncounterResult="updateEncounterResult",e.startEncounter="startEncounter",e.setSceneName="setSceneName",e.setScene="setScene",e.exitEncounter="exitEncounter",e.updateQuests="updateQuests",e.enqueueSceneAction="enqueueSceneAction",e.completeSceneAction="completeSceneAction",e.updateSceneObjectAction="updateSceneObjectAction",e.takeGoldFromCache="takeGoldFromCache"}(a||(a={}));var l=function(e,t,n){return{type:a.updateSceneObjectAction,questName:e,id:t,object:n}};var m=function(e,t){return{type:a.takeGoldFromCache,questName:e,cacheName:t}}},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return j}));var a,r,o,c=n(13),i=n(52),u=n(7),s=n(1),l=s.b.deed,m={deedForLumbermill:{item:s.a.deedForLumbermill,structure:u.a.lumberMill,itemType:l,subText:"It allows for the construction of a lumber mill",iconImg:"/img/items/deeds/deed.png"},deedForWeaponsmith:{item:s.a.deedForWeaponsmith,structure:u.a.weaponsmith,itemType:l,subText:"It allows for the construction of a weaponsmith",iconImg:"/img/items/deeds/deed.png"}},d=n(3),p=s.b.material,f="/img/items/materials/",v=(a={},Object(d.a)(a,s.a.arrowheads,{item:s.a.arrowheads,itemType:p,iconImg:"".concat(f,"arrowheads.png")}),Object(d.a)(a,s.a.bolts,{item:s.a.bolts,itemType:p,iconImg:"".concat(f,"bolts.png")}),Object(d.a)(a,s.a.buckle,{item:s.a.buckle,itemType:p,iconImg:"".concat(f,"buckle.png")}),Object(d.a)(a,s.a.chain,{item:s.a.chain,itemType:p,iconImg:"".concat(f,"chain.png")}),Object(d.a)(a,s.a.cogs,{item:s.a.cogs,itemType:p,iconImg:"".concat(f,"cogs.png")}),Object(d.a)(a,s.a.gem,{item:s.a.gem,itemType:p,iconImg:"".concat(f,"gem.png")}),Object(d.a)(a,s.a.ingot,{item:s.a.ingot,itemType:p,iconImg:"".concat(f,"ingot.png")}),Object(d.a)(a,s.a.nails,{item:s.a.nails,itemType:p,iconImg:"".concat(f,"nails.png")}),Object(d.a)(a,s.a.poisonVial,{item:s.a.poisonVial,itemType:p,iconImg:"".concat(f,"poison-vial.png")}),Object(d.a)(a,s.a.ribbon,{item:s.a.ribbon,itemType:p,iconImg:"".concat(f,"ribbon.png")}),Object(d.a)(a,s.a.rope,{item:s.a.rope,itemType:p,iconImg:"".concat(f,"rope.png")}),Object(d.a)(a,s.a.gem,{item:s.a.gem,itemType:p,iconImg:"".concat(f,"gem.png")}),Object(d.a)(a,s.a.gunpowder,{item:s.a.gunpowder,itemType:p,iconImg:"".concat(f,"gunpowder.png")}),Object(d.a)(a,s.a.scales,{item:s.a.scales,itemType:p,iconImg:"".concat(f,"scales.png")}),Object(d.a)(a,s.a.spring,{item:s.a.spring,itemType:p,iconImg:"".concat(f,"spring.png")}),Object(d.a)(a,s.a.thread,{item:s.a.thread,itemType:p,iconImg:"".concat(f,"thread.png")}),a),h=s.b.questItem,g="/img/items/quest-items/",b=(r={},Object(d.a)(r,s.a.blueprints,{item:s.a.blueprints,itemType:h,iconImg:"".concat(g,"blueprints.png")}),Object(d.a)(r,s.a.crate,{item:s.a.crate,itemType:h,iconImg:"".concat(g,"crate.png")}),Object(d.a)(r,s.a.dynamite,{item:s.a.dynamite,itemType:h,iconImg:"".concat(g,"dynamite.png")}),Object(d.a)(r,s.a.dragonEye,{item:s.a.dragonEye,itemType:h,iconImg:"".concat(g,"dragon-eye.png")}),Object(d.a)(r,s.a.eye,{item:s.a.eye,itemType:h,iconImg:"".concat(g,"eye.png")}),Object(d.a)(r,s.a.feather,{item:s.a.feather,itemType:h,iconImg:"".concat(g,"feather.png")}),Object(d.a)(r,s.a.food,{item:s.a.food,itemType:h,iconImg:"".concat(g,"food.png")}),Object(d.a)(r,s.a.heart,{item:s.a.heart,itemType:h,iconImg:"".concat(g,"heart.png")}),Object(d.a)(r,s.a.horn,{item:s.a.horn,itemType:h,iconImg:"".concat(g,"horn.png")}),Object(d.a)(r,s.a.key,{item:s.a.key,itemType:h,iconImg:"".concat(g,"key.png")}),Object(d.a)(r,s.a.letters,{item:s.a.letters,itemType:h,iconImg:"".concat(g,"letters.png")}),Object(d.a)(r,s.a.lockPicks,{item:s.a.lockPicks,itemType:h,iconImg:"".concat(g,"lock-picks.png")}),Object(d.a)(r,s.a.oil,{item:s.a.oil,itemType:h,iconImg:"".concat(g,"oil.png")}),Object(d.a)(r,s.a.orcFinger,{item:s.a.orcFinger,itemType:h,iconImg:"".concat(g,"orc-finger.png")}),Object(d.a)(r,s.a.plans,{item:s.a.plans,itemType:h,iconImg:"".concat(g,"plans.png")}),Object(d.a)(r,s.a.purpleGems,{item:s.a.purpleGems,itemType:h,iconImg:"".concat(g,"purple-gems.png")}),Object(d.a)(r,s.a.runestone,{item:s.a.runestone,itemType:h,iconImg:"".concat(g,"runestone.png")}),Object(d.a)(r,s.a.sandwich,{item:s.a.sandwich,itemType:h,iconImg:"".concat(g,"sandwich.png")}),Object(d.a)(r,s.a.teeth,{item:s.a.teeth,itemType:h,iconImg:"".concat(g,"teeth.png")}),Object(d.a)(r,s.a.tooth,{item:s.a.tooth,itemType:h,iconImg:"".concat(g,"tooth.png")}),Object(d.a)(r,s.a.torch,{item:s.a.torch,itemType:h,iconImg:"".concat(g,"torch.png")}),Object(d.a)(r,s.a.tusk,{item:s.a.tusk,itemType:h,iconImg:"".concat(g,"tusk.png")}),Object(d.a)(r,s.a.vase,{item:s.a.vase,itemType:h,iconImg:"".concat(g,"vase.png")}),Object(d.a)(r,s.a.vial,{item:s.a.vial,itemType:h,iconImg:"".concat(g,"vial.png")}),Object(d.a)(r,s.a.weeds,{item:s.a.weeds,itemType:h,iconImg:"".concat(g,"weeds.png")}),r),y=s.b.trinket,w=(o={},Object(d.a)(o,s.a.magicAmulet,{item:s.a.magicAmulet,itemType:y,iconImg:"".concat("/img/items/trinkets/","magic_amulet.png")}),Object(d.a)(o,s.a.ring,{item:s.a.ring,itemType:y,iconImg:"".concat("/img/items/trinkets/","ring.png")}),o),O=n(72),E=Object(c.a)({},m,{},i.b,{},v,{},b,{},w,{},O.b);t.a=E;function j(e){return E[e]}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}));var a,r=n(21);function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.a.common,o=arguments.length>3?arguments[3]:void 0,c={key:e,context:t};return{type:a.addLogEntry,entry:c,channel:n,channelContext:o}}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.a.common,n=arguments.length>2?arguments[2]:void 0;return{type:a.addLogEntry,entry:e,channel:t,channelContext:n}}!function(e){e.addLogEntry="addLogEntry"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(28),r=n(18),o=n(19),c=n(26),i=n(27),u=n(82),s=function(e){Object(i.a)(n,e);var t=Object(c.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,null,[{key:"addToast",value:function(e,t,n,r){var o=this;this.stack=[].concat(Object(a.a)(this.stack),[{time:Date.now(),title:e,type:t,icon:n,link:r}]),this.emit(this.EVENT_TOASTS_UPDATED,this.stack),setTimeout((function(){o.stack=o.stack.filter((function(e){return Date.now()-e.time<o.lifeTime})),o.emit(o.EVENT_TOASTS_UPDATED,o.stack)}),this.lifeTime)}}]),n}(Object(u.a)());s.stack=[],s.lifeTime=5e3,s.EVENT_TOASTS_UPDATED="toast"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a,r=n(0),o=n.n(r),c=n(9),i=n(34);!function(e){e[e.achievementUnlocked=0]="achievementUnlocked",e[e.cheat=1]="cheat",e[e.itemCrafted=2]="itemCrafted",e[e.questCompleted=3]="questCompleted",e[e.questEncounter=4]="questEncounter",e[e.questLaunched=5]="questLaunched",e[e.questUpdate=6]="questUpdate"}(a||(a={}));t.b=function(e){var t=e.title,n=e.type,r=void 0===n?a.achievementUnlocked:n,u=e.icon,s=void 0===u?"/img/items/quest-items/dragon-eye.png":u,l=e.link,m=Object(i.g)(),d=c.a.get("ui-toast-type-".concat(a[r]));return o.a.createElement("div",{className:"toast ".concat(l&&"withlink"),onClick:function(){l&&m.push(l)}},o.a.createElement("div",{className:"label type"},d),o.a.createElement("div",{className:"label title app-h2-white"},t),o.a.createElement("div",{className:"icon"},o.a.createElement("div",{className:"background"}),o.a.createElement("img",{className:"image",width:"300",alt:"dragon eye",src:"".concat("/gilles-game").concat(s)}),o.a.createElement("div",{className:"foreground"})),o.a.createElement("div",{className:"banner"}))}},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return l}));var a=n(9),r=6e4,o=12e4,c=30*r,i=60*r,u=24*i,s=265.25*u,l=function(e){var t=[{unit:"year",amount:s},{unit:"day",amount:u},{unit:"hour",amount:i},{unit:"minute",amount:r},{unit:"second",amount:1e3}],n=Math.abs(e),o=[];return t.forEach((function(e){var t=Math.floor(n/e.amount);if(n-=t*e.amount,0!==t){var r=a.a.get("common-time-".concat(e.unit).concat(t>1?"-plural":""));o.push("".concat(t," ").concat(r))}})),o.join(" ")}},,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var a=n(14),r={getQuestVars:function(e){return e.questVars},getInitialQuestVars:function(e){return{foo:!1,bar:3}},nodes:[{x:0,y:1,type:a.a.nothing,log:"quest-kill10Boars-node0"},{x:0,y:3,type:a.a.encounter,log:"quest-kill10Boars-enter-dungeon",startScene:"dungeon.entrance"},{x:1,y:3,type:a.a.nothing,log:"quest-kill10Boars-leave-dungeon"},{x:1,y:3,type:a.a.nothing,log:"quest-kill10Boars-left-dungeon"},{x:2,y:3,type:a.a.nothing},{x:3,y:3,type:a.a.encounter,startScene:"dungeon.hallway"},{x:4,y:4,type:a.a.nothing,log:"The party spots a boss"},{x:5,y:4,type:a.a.nothing}]},o=n(1),c={kill10Boars:r,retrieveMagicAmulet:{getQuestVars:function(e){return e.questVars},getInitialQuestVars:function(e){return{baz:!1,zux:13}},requiredItems:[o.a.torch,o.a.torch,o.a.torch,o.a.sandwich,o.a.sandwich],nodes:[{x:0,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:2,y:1,type:a.a.nothing},{x:3,y:1,type:a.a.nothing},{x:4,y:1,type:a.a.nothing},{x:5,y:1,type:a.a.nothing},{x:7,y:1,type:a.a.nothing},{x:8,y:2,type:a.a.nothing},{x:8,y:3,type:a.a.nothing},{x:9,y:3,type:a.a.nothing},{x:10,y:1,type:a.a.nothing},{x:10,y:2,type:a.a.nothing},{x:10,y:3,type:a.a.nothing},{x:10,y:4,type:a.a.nothing},{x:11,y:5,type:a.a.nothing},{x:12,y:6,type:a.a.nothing},{x:12,y:7,type:a.a.nothing},{x:13,y:8,type:a.a.nothing},{x:12,y:8,type:a.a.nothing},{x:12,y:9,type:a.a.nothing},{x:11,y:8,type:a.a.nothing},{x:10,y:8,type:a.a.nothing},{x:9,y:8,type:a.a.nothing},{x:8,y:9,type:a.a.nothing},{x:7,y:8,type:a.a.encounter,startScene:"dungeon.hallway"},{x:8,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:2,y:1,type:a.a.encounter,startScene:"dungeon.hallway"},{x:3,y:1,type:a.a.nothing}]}};t.a=c;function i(e){return c[e]}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c}));var a=function(e,t){return t.party.map((function(t){return o(e,t)}))},r=function(e,t){var n=t.party[0];return o(e,n)},o=function(e,t){return e.find((function(e){return e.id===t}))},c=function(e){return!!e.rngState}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l}));var a=n(44),r=n.n(a),o=n(59),c=function(e,t,n){return{x:i(e.x,t.x,n),y:i(e.y,t.y,n)}},i=function(e,t,n){return e+n*(t-e)};function u(e){return s.apply(this,arguments)}function s(){return(s=Object(o.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=PIXI.Loader.shared,e.abrupt("return",new Promise((function(e,a){n.resources[t]?e(n.resources[t]):n.add(t).load((function(n,a){e(a[t])}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var l=function(e,t){var n=PIXI.Loader.shared;n.resources[e]?t(n.resources[e]):n.add(e).load((function(n,a){t(a[e])}))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return l}));var a,r,o=n(3),c=n(1),i=c.b.apparel,u="/img/items/apparel/";!function(e){e[e.feet=0]="feet",e[e.hands=1]="hands",e[e.chest=2]="chest",e[e.legs=3]="legs",e[e.head=4]="head",e[e.shoulders=5]="shoulders"}(r||(r={}));var s=(a={},Object(o.a)(a,c.a.boots1,{item:c.a.boots1,equipmentType:r.feet,itemType:i,subText:"These boots are made for questin'",iconImg:"".concat(u,"boots_1.png")}),Object(o.a)(a,c.a.boots2,{item:c.a.boots2,equipmentType:r.feet,itemType:i,subText:"",iconImg:"".concat(u,"boots_2.png")}),Object(o.a)(a,c.a.boots3,{item:c.a.boots3,equipmentType:r.feet,itemType:i,subText:"",iconImg:"".concat(u,"boots_3.png")}),Object(o.a)(a,c.a.chainmailHood,{item:c.a.chainmailHood,equipmentType:r.head,itemType:i,subText:"",iconImg:"".concat(u,"chainmail_hood.png"),armourRating:3}),Object(o.a)(a,c.a.chest,{item:c.a.chest,equipmentType:r.chest,itemType:i,subText:"",iconImg:"".concat(u,"chest_1.png"),armourRating:2}),Object(o.a)(a,c.a.clothGloves,{item:c.a.clothGloves,equipmentType:r.hands,itemType:i,subText:"",iconImg:"".concat(u,"cloth_gloves.png")}),Object(o.a)(a,c.a.cowl,{item:c.a.cowl,equipmentType:r.head,itemType:i,subText:"",iconImg:"".concat(u,"cowl.png"),armourRating:20}),Object(o.a)(a,c.a.druidChest,{item:c.a.druidHands,equipmentType:r.chest,itemType:i,subText:"",iconImg:"".concat(u,"druid-chest.png")}),Object(o.a)(a,c.a.druidFeet,{item:c.a.druidFeet,equipmentType:r.feet,itemType:i,subText:"",iconImg:"".concat(u,"druid-feet.png")}),Object(o.a)(a,c.a.druidHands,{item:c.a.druidHands,equipmentType:r.hands,itemType:i,subText:"",iconImg:"".concat(u,"druid-hands.png")}),Object(o.a)(a,c.a.druidHead,{item:c.a.druidHead,equipmentType:r.head,itemType:i,subText:"",iconImg:"".concat(u,"druid-head.png")}),Object(o.a)(a,c.a.druidLegs,{item:c.a.druidLegs,equipmentType:r.legs,itemType:i,subText:"",iconImg:"".concat(u,"druid-legs.png")}),Object(o.a)(a,c.a.fedora,{item:c.a.fedora,equipmentType:r.head,itemType:i,subText:"I study the blade",iconImg:"".concat(u,"fedora.png")}),Object(o.a)(a,c.a.greaves1,{item:c.a.greaves1,equipmentType:r.feet,itemType:i,subText:"",iconImg:"".concat(u,"greaves_1.png"),armourRating:10}),Object(o.a)(a,c.a.greaves2,{item:c.a.greaves2,equipmentType:r.hands,itemType:i,subText:"",iconImg:"".concat(u,"greaves_2.png")}),Object(o.a)(a,c.a.hornedHelmet,{item:c.a.hornedHelmet,equipmentType:r.head,itemType:i,subText:"",iconImg:"".concat(u,"horned_helmet.png")}),Object(o.a)(a,c.a.leatherGloves,{item:c.a.leatherGloves,equipmentType:r.hands,itemType:i,subText:"",iconImg:"".concat(u,"leather_gloves.png")}),Object(o.a)(a,c.a.nomadHelmet,{item:c.a.nomadHelmet,equipmentType:r.head,itemType:i,subText:"",iconImg:"".concat(u,"nomad_helmet.png")}),Object(o.a)(a,c.a.pants1,{item:c.a.pants1,equipmentType:r.legs,itemType:i,subText:"",iconImg:"".concat(u,"pants_1.png"),armourRating:10}),Object(o.a)(a,c.a.pants2,{item:c.a.pants2,equipmentType:r.legs,itemType:i,subText:"",iconImg:"".concat(u,"pants_2.png")}),Object(o.a)(a,c.a.plateChest1,{item:c.a.plateChest1,equipmentType:r.chest,itemType:i,subText:"",iconImg:"".concat(u,"plate_chest_1.png")}),Object(o.a)(a,c.a.plateChest2,{item:c.a.plateChest2,equipmentType:r.chest,itemType:i,subText:"",iconImg:"".concat(u,"plate_chest_2.png")}),Object(o.a)(a,c.a.plateChest3,{item:c.a.plateChest3,equipmentType:r.chest,itemType:i,subText:"",iconImg:"".concat(u,"plate_chest_3.png")}),Object(o.a)(a,c.a.plateChest4,{item:c.a.plateChest4,equipmentType:r.chest,itemType:i,subText:"",iconImg:"".concat(u,"plate_chest_4.png")}),Object(o.a)(a,c.a.plateGloves1,{item:c.a.plateGloves1,equipmentType:r.hands,itemType:i,subText:"",iconImg:"".concat(u,"plate_gloves_1.png")}),Object(o.a)(a,c.a.plateGloves2,{item:c.a.plateGloves2,equipmentType:r.hands,itemType:i,subText:"",iconImg:"".concat(u,"plate_gloves_2.png")}),Object(o.a)(a,c.a.plateHelmet,{item:c.a.plateHelmet,equipmentType:r.head,itemType:i,subText:"",iconImg:"".concat(u,"plate_helmet_1.png")}),Object(o.a)(a,c.a.platePants,{item:c.a.platePants,equipmentType:r.legs,itemType:i,subText:"",iconImg:"".concat(u,"plate_pants1.png")}),Object(o.a)(a,c.a.plateShoulders1,{item:c.a.plateShoulders1,equipmentType:r.shoulders,itemType:i,subText:"",iconImg:"".concat(u,"plate_shoulders_1.png")}),Object(o.a)(a,c.a.plateShoulders2,{item:c.a.plateShoulders2,equipmentType:r.shoulders,itemType:i,subText:"",iconImg:"".concat(u,"plate_shoulders_2.png")}),Object(o.a)(a,c.a.robe,{item:c.a.robe,equipmentType:r.chest,itemType:i,subText:"",iconImg:"".concat(u,"robe_1.png")}),Object(o.a)(a,c.a.shoulders1,{item:c.a.shoulders1,equipmentType:r.shoulders,itemType:i,subText:"",iconImg:"".concat(u,"shoulders_1.png")}),Object(o.a)(a,c.a.shoulders2,{item:c.a.shoulders2,equipmentType:r.shoulders,itemType:i,subText:"",iconImg:"".concat(u,"shoulders_2.png")}),Object(o.a)(a,c.a.shoulders3,{item:c.a.shoulders3,equipmentType:r.shoulders,itemType:i,subText:"",iconImg:"".concat(u,"shoulders_3.png")}),Object(o.a)(a,c.a.vest,{item:c.a.vest,equipmentType:r.chest,itemType:i,subText:"",iconImg:"".concat(u,"vest_1.png")}),a);function l(e){return s[e]}t.b=s},,,,,,,,,,,,function(e,t,n){},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return m}));var a,r,o,c=n(3),i=n(1),u=i.b.weapon,s="/img/items/weapons/";!function(e){e[e.axe=0]="axe",e[e.bow=1]="bow",e[e.club=2]="club",e[e.crossbow=3]="crossbow",e[e.fist=4]="fist",e[e.flail=5]="flail",e[e.hammer=6]="hammer",e[e.melee=7]="melee",e[e.knife=8]="knife",e[e.staff=9]="staff",e[e.sword=10]="sword",e[e.poleArm=11]="poleArm"}(r||(r={})),function(e){e.kinetic="kinetic"}(o||(o={}));var l=(a={},Object(c.a)(a,i.a.battleAxe,{item:i.a.battleAxe,itemType:u,weaponType:r.axe,subText:"It's an axe for battle",iconImg:"".concat(s,"battle_axe.png"),damage:Object(c.a)({},o.kinetic,20)}),Object(c.a)(a,i.a.brassKnuckles,{item:i.a.brassKnuckles,itemType:u,weaponType:r.melee,subText:"Brass knuckles are pieces of metal shaped to fit around the knuckles.",iconImg:"".concat(s,"brass_knuckles.png"),damage:Object(c.a)({},o.kinetic,10)}),Object(c.a)(a,i.a.crossbow,{item:i.a.crossbow,itemType:u,weaponType:r.crossbow,subText:"Shoots and reloads fast",iconImg:"".concat(s,"crossbow.png"),damage:Object(c.a)({},o.kinetic,3)}),Object(c.a)(a,i.a.cleaver,{item:i.a.cleaver,itemType:u,weaponType:r.knife,subText:"A cleaver is a large knife that varies in its shape but usually resembles a rectangular-bladed hatchet.",iconImg:"".concat(s,"cleaver.png"),damage:Object(c.a)({},o.kinetic,5)}),Object(c.a)(a,i.a.club,{item:i.a.club,itemType:u,weaponType:r.club,subText:"A club is among the simplest of all weapons: a short staff or stick, usually made of wood, wielded as a weapon",iconImg:"".concat(s,"club.png"),damage:Object(c.a)({},o.kinetic,8)}),Object(c.a)(a,i.a.dagger,{item:i.a.dagger,itemType:u,weaponType:r.knife,subText:"Excellent for ritual sacrifice and cheese platters",iconImg:"".concat(s,"dagger.png"),damage:Object(c.a)({},o.kinetic,8)}),Object(c.a)(a,i.a.flail,{item:i.a.flail,itemType:u,weaponType:r.flail,subText:"A flail is a weapon consisting of a striking head attached to a handle by a flexible rope, strap, or chain. ",iconImg:"".concat(s,"flail.png"),damage:Object(c.a)({},o.kinetic,15)}),Object(c.a)(a,i.a.greatswordOfGwai,{item:i.a.greatswordOfGwai,itemType:u,weaponType:r.sword,subText:"Finer steel was seldom forged",iconImg:"".concat(s,"greatsword-gwai.png"),unique:!0,damage:Object(c.a)({},o.kinetic,25)}),Object(c.a)(a,i.a.khopesh,{item:i.a.khopesh,itemType:u,weaponType:r.sword,subText:"Dafuq is this. Can I get garlic sauce with that?",iconImg:"".concat(s,"khopesh.png"),damage:Object(c.a)({},o.kinetic,15)}),Object(c.a)(a,i.a.longbow,{item:i.a.longbow,itemType:u,weaponType:r.bow,subText:"A deadly killer from long range",iconImg:"".concat(s,"longbow.png"),damage:Object(c.a)({},o.kinetic,2)}),Object(c.a)(a,i.a.mace,{item:i.a.mace,itemType:u,weaponType:r.club,subText:"A mace is a blunt weapon, a type of club or virge that uses a heavy head on the end of a handle to deliver powerful blows.",iconImg:"".concat(s,"mace.png"),damage:Object(c.a)({},o.kinetic,15)}),Object(c.a)(a,i.a.morningStar,{item:i.a.morningStar,itemType:u,weaponType:r.club,subText:"A morning star is any of several medieval club-like weapons consisting of a shaft with an attached ball adorned with one or more spikes.",iconImg:"".concat(s,"morning-star.png"),damage:Object(c.a)({},o.kinetic,13)}),Object(c.a)(a,i.a.poisonedDagger,{item:i.a.poisonedDagger,itemType:u,weaponType:r.knife,subText:"Excellent for ritual sacrifice and cheese platters",iconImg:"".concat(s,"poisoned-dagger.png"),damage:Object(c.a)({},o.kinetic,12)}),Object(c.a)(a,i.a.ravenStaff,{item:i.a.ravenStaff,itemType:u,weaponType:r.staff,subText:"Kaa, kaa!",iconImg:"".concat(s,"raven-staff.png"),damage:Object(c.a)({},o.kinetic,13)}),Object(c.a)(a,i.a.savageStaff,{item:i.a.savageStaff,itemType:u,weaponType:r.staff,subText:"Savage dude",iconImg:"".concat(s,"savage-staff.png"),damage:Object(c.a)({},o.kinetic,8)}),Object(c.a)(a,i.a.spear,{item:i.a.spear,itemType:u,weaponType:r.poleArm,subText:"A spear is a pole weapon consisting of a shaft, usually of wood, with a pointed head. ",iconImg:"".concat(s,"sword.png"),damage:Object(c.a)({},o.kinetic,10)}),Object(c.a)(a,i.a.sword,{item:i.a.sword,itemType:u,weaponType:r.sword,subText:"An elegant weapon for a more civilized age",iconImg:"".concat(s,"sword.png"),damage:Object(c.a)({},o.kinetic,14)}),Object(c.a)(a,i.a.warhammer,{item:i.a.warhammer,itemType:u,weaponType:r.hammer,subText:"A war hammer is a late medieval weapon of war intended for close combat action, whose design resembles the hammer",iconImg:"".concat(s,"warhammer.png"),damage:Object(c.a)({},o.kinetic,16)}),a);function m(e){return l[e]}t.b=l},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(18),r=n(19),o=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"registerSceneController",value:function(e,t,n){this.controllerTypes["".concat(e,".").concat(t)]=n}},{key:"getSceneController",value:function(e,t,n){if(!this.store["".concat(e,".").concat(t)]){if(!this.controllerTypes["".concat(e,".").concat(t)])throw console.log(this.controllerTypes),new Error("No controller registered for ".concat(e,".").concat(t));this.store["".concat(e,".").concat(t)]=new(this.controllerTypes["".concat(e,".").concat(t)])(n,e)}return this.store["".concat(e,".").concat(t)]}},{key:"destroySceneConroller",value:function(e,t){delete this.store["".concat(e,".").concat(t)]}}]),e}();o.store={},o.controllerTypes={},n(272)},,,,,,,function(e,t,n){"use strict";var a=n(18),r=n(19);t.a=function(){var e=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"addEventListener",value:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(this.events[e])for(var n=0;n<this.events[e].length;n++)if(this.events[e][n]===t){this.events[e].splice(n,1);break}}},{key:"emit",value:function(e,t){this.events[e]&&this.events[e].forEach((function(e){return e(t)}))}}]),e}();return e.events={},e}},,,function(e,t,n){"use strict";var a,r,o;n.d(t,"a",(function(){return a})),function(e){e.tilelayer="tilelayer",e.objectgroup="objectgroup"}(a||(a={})),function(e){e.orthagonal="orthagonal",e.isometric="isometric",e.staggered="staggered",e.hexagonal="hexagonal"}(r||(r={})),function(e){e.rightUp="right-up",e.rightDown="right-down",e.leftUp="left-up",e.leftDown="left-down"}(o||(o={}))},,,,,,function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},,,function(e,t,n){},,,,,,,,,,,,function(e){e.exports=JSON.parse('{"alchemist":[{"shape":[34,18,31,1,37,0]},{"shape":[37,0,53,5,45,17]},{"shape":[45,17,68,27,81,48]},{"shape":[72,67,75,168,11,168]},{"shape":[9,65,1,45,10,30]},{"shape":[31,19,29,5,45,0]},{"shape":[45,0,34,18,37,0]},{"shape":[45,17,81,48,72,67]},{"shape":[72,67,11,168,9,65]},{"shape":[9,65,10,30,31,19]},{"shape":[45,17,72,67,9,65]},{"shape":[9,65,31,19,45,0]},{"shape":[37,0,45,17,9,65]}],"garden":[{"shape":[48,45,48,0,58,0]},{"shape":[57,41,75,56,73,78]},{"shape":[73,78,11,68,2,56]},{"shape":[2,56,13,45,48,45]},{"shape":[48,45,58,0,57,41]},{"shape":[73,78,2,56,48,45]},{"shape":[48,45,57,41,73,78]}],"armoursmith":[{"shape":[53,1,55,0,93,5]},{"shape":[93,5,112,11,120,20]},{"shape":[120,20,124,36,119,49]},{"shape":[119,49,122,156,75,149]},{"shape":[75,149,57,135,33,104]},{"shape":[33,104,10,95,11,52]},{"shape":[11,52,0,35,2,20]},{"shape":[2,20,6,14,27,5]},{"shape":[27,5,53,1,93,5]},{"shape":[93,5,120,20,119,49]},{"shape":[119,49,75,149,33,104]},{"shape":[33,104,11,52,2,20]},{"shape":[2,20,27,5,93,5]},{"shape":[93,5,119,49,33,104]},{"shape":[33,104,2,20,93,5]}],"lumberMill":[{"shape":[32,11,43,1,45,0]},{"shape":[45,0,49,4,37,18]},{"shape":[39,29,50,44,49,48]},{"shape":[38,46,38,230,17,233]},{"shape":[17,233,13,232,13,48]},{"shape":[13,48,3,48,14,28]},{"shape":[14,28,1,7,6,4]},{"shape":[31,18,32,11,45,0]},{"shape":[39,29,49,48,40,43]},{"shape":[38,46,17,233,13,48]},{"shape":[14,28,6,4,19,18]},{"shape":[31,18,45,0,37,18]},{"shape":[37,18,39,29,40,43]},{"shape":[40,43,38,46,13,48]},{"shape":[13,48,14,28,19,18]},{"shape":[31,18,37,18,40,43]},{"shape":[40,43,13,48,19,18]},{"shape":[19,18,31,18,40,43]}],"mine":[{"shape":[15,0,79,1,88,13]},{"shape":[88,13,78,66,27,70]},{"shape":[27,70,2,50,11,27]},{"shape":[11,27,6,13,15,0]},{"shape":[15,0,88,13,27,70]},{"shape":[27,70,11,27,15,0]}],"quarry":[{"shape":[2,24,20,2,22,0]},{"shape":[22,0,103,2,117,15]},{"shape":[117,15,124,24,112,24]},{"shape":[112,24,112,64,104,70]},{"shape":[104,70,104,89,97,88]},{"shape":[97,68,66,67,60,43]},{"shape":[60,43,17,42,17,26]},{"shape":[17,26,2,24,22,0]},{"shape":[22,0,117,15,112,24]},{"shape":[112,24,104,70,97,88]},{"shape":[60,43,17,26,22,0]},{"shape":[112,24,97,88,97,68]},{"shape":[97,68,60,43,22,0]},{"shape":[22,0,112,24,97,68]}],"tannery":[{"shape":[4,2,4,0,61,1]},{"shape":[59,36,89,37,85,79]},{"shape":[85,79,15,77,15,47]},{"shape":[15,47,5,35,0,9]},{"shape":[0,9,4,2,61,1]},{"shape":[59,36,85,79,15,47]},{"shape":[15,47,0,9,61,1]},{"shape":[61,1,59,36,15,47]}],"tavern":[{"shape":[110,27,108,24,112,23]},{"shape":[112,23,151,27,148,60]},{"shape":[148,60,137,71,133,67]},{"shape":[133,67,136,69,132,75]},{"shape":[132,75,137,77,138,124]},{"shape":[131,131,136,136,55,119]},{"shape":[29,64,6,72,0,69]},{"shape":[27,56,76,61,85,67]},{"shape":[101,25,108,13,112,17]},{"shape":[112,17,102,18,104,6]},{"shape":[110,27,112,23,148,60]},{"shape":[132,75,138,124,131,131]},{"shape":[131,131,55,119,59,118]},{"shape":[29,64,0,69,27,56]},{"shape":[112,17,104,6,111,9]},{"shape":[92,27,110,27,148,60]},{"shape":[132,75,131,131,59,118]},{"shape":[50,68,29,64,27,56]},{"shape":[92,27,148,60,133,67]},{"shape":[133,67,132,75,59,118]},{"shape":[50,68,27,56,85,67]},{"shape":[133,67,59,118,56,72]},{"shape":[56,72,50,68,85,67]},{"shape":[133,67,56,72,85,67]},{"shape":[133,67,85,67,89,60]},{"shape":[92,27,133,67,89,60]},{"shape":[92,27,89,60,86,25]},{"shape":[104,0,92,27,86,25]}],"warehouse":[{"shape":[36,414,3,409,2,13]},{"shape":[2,13,31,-7,63,7]},{"shape":[62,197,63,126,65,218]},{"shape":[61,262,83,272,84,459]},{"shape":[84,459,36,414,2,13]},{"shape":[2,13,63,7,62,197]},{"shape":[62,197,65,218,61,262]},{"shape":[61,262,84,459,2,13]},{"shape":[2,13,62,197,61,262]}],"weaponsmith":[{"shape":[52,18,50,2,50,0]},{"shape":[50,0,114,1,109,49]},{"shape":[109,49,115,132,98,129]},{"shape":[98,129,66,95,65,34]},{"shape":[11,33,11,77,0,77]},{"shape":[0,29,18,18,52,18]},{"shape":[52,18,50,0,109,49]},{"shape":[109,49,98,129,65,34]},{"shape":[11,33,0,77,0,29]},{"shape":[52,18,109,49,65,34]},{"shape":[15,27,11,33,0,29]},{"shape":[52,18,65,34,53,26]},{"shape":[15,27,0,29,52,18]},{"shape":[52,18,53,26,15,27]}],"weaver":[{"shape":[51,41,54,0,55,6]},{"shape":[55,41,82,53,87,63]},{"shape":[87,63,86,259,62,254]},{"shape":[62,254,23,212,21,61]},{"shape":[21,61,2,56,51,41]},{"shape":[51,41,55,6,55,41]},{"shape":[55,41,87,63,62,254]},{"shape":[62,254,21,61,51,41]},{"shape":[51,41,55,41,62,254]}],"workshop":[{"shape":[11,2,13,0,68,3]},{"shape":[68,3,77,12,70,14]},{"shape":[70,14,69,38,10,37]},{"shape":[9,13,1,12,11,2]},{"shape":[11,2,68,3,70,14]},{"shape":[70,14,10,37,9,13]},{"shape":[9,13,11,2,70,14]}]}')},function(e){e.exports=JSON.parse('{"alpha":{"start":0.25,"end":0},"scale":{"start":0.04,"end":0.29,"minimumScaleMultiplier":1},"color":{"start":"#85888d","end":"#100f0c"},"speed":{"start":100,"end":200,"minimumSpeedMultiplier":1},"acceleration":{"x":10,"y":-30},"maxSpeed":200,"startRotation":{"min":265,"max":270},"noRotation":false,"rotationSpeed":{"min":8,"max":0},"lifetime":{"min":0.5,"max":3.05},"blendMode":"normal","frequency":0.0005,"emitterLifetime":-1,"maxParticles":300,"pos":{"x":0,"y":0},"addAtBack":true,"spawnType":"point"}')},,,,,,,function(e,t,n){e.exports=n(271)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,function(e,t){},,,function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a,r,o,c=n(28),i=n(44),u=n.n(i),s=n(59);!function(e){e.clearCombatAction="clearCombatAction",e.startCombatAction="startCombatAction",e.moveActor="moveActor"}(a||(a={})),function(e){e[e.player=0]="player",e[e.enemy=1]="enemy"}(r||(r={})),function(e){e.move="move",e.slash="slash",e.shoot="shoot"}(o||(o={}));var l,m={actors:[{allegiance:r.player,health:100,location:[3,5],name:"c4a5d270",remainingAP:5},{allegiance:r.player,health:100,location:[4,6],name:"2e655832",remainingAP:4}],turn:r.player},d=function(e,t){var n,c,i=t.getState().combat;if(i.action&&i.action.endsAt<Date.now())if(i.turn===r.enemy);else if(i.turn===r.player){switch(i.action.type){case o.move:t.dispatch((n=i.action.actor,c=i.action.target,{type:a.moveActor,actor:n,location:c})),t.dispatch({type:a.clearCombatAction})}return{action:null}}return null},p=n(0),f=n.n(p),v=n(80),h=n(12);!function(e){e.gameTick="gameTick"}(l||(l={}));var g,b,y=n(31),w=function(e){var t=e.split(".").map((function(e){return Number(e)}));if(3!==t.length)throw new Error("Received invalid version string: ".concat(e));t.forEach((function(e){if(e>=1024)throw new Error("Version string invalid, ".concat(e," is too large"))}));for(var n=0,a=0;a<3;a++)n|=t[a]<<10*a;return n}("0.0.5"),O=n(3),E=n(15),j=n(29),k=n(9),T=(n(64),n(181),function(e){var t=e.itemsInInventory,n=(e.className||"")+" itemsbox",a=e.items.reduce((function(e,t){return e[t]||(e[t]=0),e[t]++,e}),{}),r=Object.keys(a).map((function(e){var n=e,r=a[e],o="item";r>(t?t.filter((function(e){return e===n})).length:0)&&(o+=" missing");var c=j.a[n];return p.createElement("li",{className:o,key:n},p.createElement("div",{className:"icon common-icon-smallest",style:{backgroundImage:"url(".concat("/gilles-game").concat(c.iconImg,")")}}),p.createElement("div",{className:"name"},"".concat(k.a.getItemName(n)," (").concat(r,")")))}));return p.createElement("ul",{className:n},r)}),I=Object(h.c)((function(e,t){var n=[],a=Object(c.a)(e.stockpile);return t.items.forEach((function(e){var t=a.findIndex((function(t){return t===e}));if(t>-1){var r=a.splice(t,1),o=Object(E.a)(r,1)[0];o&&n.push(o)}})),{itemsInInventory:n}}))(T);!function(e){e.wood="wood",e.iron="iron",e.stone="stone",e.leather="leather",e.fabric="fabric",e.food="food"}(b||(b={}));var N,x,S=(g={},Object(O.a)(g,b.wood,{resource:b.wood,iconImg:"/img/resources/wood.png"}),Object(O.a)(g,b.iron,{resource:b.iron,iconImg:"/img/resources/iron.png"}),Object(O.a)(g,b.stone,{resource:b.stone,iconImg:"/img/resources/stone.png"}),Object(O.a)(g,b.leather,{resource:b.leather,iconImg:"/img/resources/leather.png"}),Object(O.a)(g,b.fabric,{resource:b.fabric,iconImg:"/img/resources/fabric.png"}),Object(O.a)(g,b.food,{resource:b.food,iconImg:"/img/resources/food.png"}),g),C=(n(91),function(e){var t=e.sufficientResources,n=(e.className||"")+" resourcesbox",a=Object.keys(e.resources).map((function(n){var a="resource";t&&!t[n]&&(a+=" insufficient");var r=S[n];if(!r)throw new Error("No resource description found for ".concat(n));return p.createElement("li",{className:a,key:n},p.createElement("div",{className:"icon",style:{backgroundImage:"url(".concat("/gilles-game").concat(r.iconImg,")")}}),p.createElement("div",{className:"name"},k.a.getResourceName(n)),p.createElement("div",{className:"amount"},e.resources[n]))}));return p.createElement("ul",{className:n},a)}),q=Object(h.c)((function(e,t){var n={};return Object.keys(t.resources).forEach((function(a){n[a]=e.resources[a]>=t.resources[a]})),{sufficientResources:n}}))(C),A=n(7),D=function(e,t){if(t>6)throw new Error("Cannot possibly have more than ".concat(6," on one item!"));return e-.1*e*(t-1)},R=n(36);!function(e){e[e.item=0]="item"}(N||(N={})),function(e){e[e.smallest=0]="smallest",e[e.small=1]="small",e[e.medium=2]="medium",e[e.big=3]="big",e[e.biggest=4]="biggest"}(x||(x={}));var M=function e(t){switch(t){case x.smallest:return"common-icon-smallest";case x.small:return"common-icon-small";case x.medium:return"common-icon-medium";case x.big:return"common-icon-big";case x.biggest:return"common-icon-biggest"}return e(x.medium)},P=(n(182),n(18)),_=n(19),L=n(26),W=n(27),F=n(133),B=n.n(F),Q=n(82),H=function(e){Object(W.a)(n,e);var t=Object(L.a)(n);function n(){return Object(P.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n,null,[{key:"showContextTooltip",value:function(e,t,n){var a={type:e,info:t,referenceRect:n};B()(a,this.lastContext)?this.clear():(this.emit(this.EVENT_CONTEXT_UPDATED,a),this.lastContext=a)}},{key:"clear",value:function(){this.emit(this.EVENT_CONTEXT_UPDATED,void 0),this.lastContext=void 0}}]),n}(Object(Q.a)());H.EVENT_CONTEXT_UPDATED="tooltipContextUpdated",H.lastContext=void 0;var U=function(e){var t=e.item,n=Object(j.b)(t);n||console.warn("could not find definition for ".concat(t));var a="item-icon ".concat(M(e.size));return p.createElement("div",{className:a,onClick:function(n){if(!1!==e.showContext){var a=n.currentTarget.getBoundingClientRect();H.showContextTooltip(N.item,Object(j.b)(t),a),n.stopPropagation()}e.onClick&&e.onClick(n)},style:{backgroundImage:"url(".concat("/gilles-game").concat(n.iconImg,")")}})},G=(n(211),function(e){var t,n,a,r=(t=e.progress||0,n=0,t>(a=1)?a:t<n?n:t);return p.createElement("div",{className:"progressbar"},p.createElement("div",{className:"progressbar-label"},e.label),p.createElement("div",{className:"progressbar-bar",style:{width:"".concat(100*r,"%")}}))});n(212);var V,z,X,K,J,Z=function(e){var t;return t=null==e.max?e.value:p.createElement("span",null,e.value," / ",p.createElement("span",{className:"max"},e.max)),p.createElement("div",{className:"updownvalue"},p.createElement("label",null," ",e.label),t,p.createElement("i",{className:"arrow up"+(e.upDisabled?" disabled":""),onClick:function(t){e.onUp&&!e.upDisabled&&e.onUp(t)}}),p.createElement("i",{className:"arrow down"+(e.downDisabled?" disabled":""),onClick:function(t){e.onDown&&!e.downDisabled&&e.onDown(t)}}))},$=(n(213),function(e){return f.a.createElement("div",{className:"structureview-header structureview-header-".concat(e.structure)})}),Y=(n(214),function(e){var t=Object(p.useState)(),n=Object(E.a)(t,2),a=n[0],r=n[1],o=Object(p.useState)(0),c=Object(E.a)(o,2),i=c[0],u=c[1],s=Object(A.b)(e.type);if(!s)throw new Error("No definition found for structure ".concat(e.type,"\n            with type ProductionStructureDefinition."));var l=e.level||0,m=s.levels[l],d=k.a.getStructureName(e.type);return p.createElement(p.Fragment,null,p.createElement($,{structure:e.type}),p.createElement("details",{open:!0,className:"productionstructureview"},p.createElement("summary",null,d),p.createElement("section",null,function(){var t=e.gold,n=s.levels[l+1],a=null!=n?n.cost.gold||0:-1,r=null!=n&&t>=a,o="Upgrade! (".concat(a<0?"max":a+" gold",")");return p.createElement("div",null,p.createElement("label",null,"level:"),"".concat(l+1," / ").concat(s.levels.length),p.createElement("button",{style:{float:"right"},onClick:function(t){e.onUpgrade&&e.onUpgrade(a,l+1)},disabled:!r},o))}(),p.createElement("div",null,"craft:"),p.createElement("div",{className:"crafting-area"},p.createElement("ul",{className:"vertical-tab-bar"},m.produces.map((function(e){return p.createElement("li",{key:"craft".concat(e.item),onClick:function(t){t.stopPropagation(),r(e.item)},className:a===e.item?"selected":""},p.createElement(U,{item:e.item}),k.a.getItemName(e.item))}))),function(){var t=a;if(!t)return null;var n=m.produces.find((function(e){return e.item===t})),r=e.resources||{},o=n.cost.resources,c=Object.keys(o).some((function(e){return o[e]>r[e]})),s=!1,l=n.cost.materials;l&&(s=l.some((function(t){return-1===e.items.indexOf(t)})));var d=c||s||i<1,f=j.a[t];return p.createElement("div",{className:"crafting-details"},"Craft a ",k.a.getItemName(f.item),p.createElement("div",{className:"crafting-costs"},p.createElement("fieldset",null,p.createElement(q,{resources:o})),p.createElement("fieldset",null,l&&p.createElement(I,{items:l}))),p.createElement("div",{style:{display:"flex"}},p.createElement(Z,{value:i,label:"Workers: ",onUp:function(e){e.stopPropagation(),u(i+1)},onDown:function(e){e.stopPropagation(),u(i-1)},upDisabled:i>=e.workersFree||i>=6,downDisabled:i<1}),"\xa0",function(e){if(0===i)return"";var t=D(e,i),n=Object(R.e)(t);return" Crafting time: ".concat(n)}(n.cost.time||0)),p.createElement("div",null,p.createElement("button",{disabled:d,onClick:function(t){t.stopPropagation(),e.onCraft&&(e.onCraft(n,i),u(0))}},"Craft")))}()),p.createElement("fieldset",null,p.createElement("legend",null,"Currently crafting:"),(e.tasks||[]).map((function(e){return p.createElement(G,{key:"".concat(e.name).concat(e.startTime),label:"".concat(e.name," (").concat(Object(R.e)(e.timeRemaining),")"),progress:e.progress})}))))))});function ee(e){return{type:V.addGold,amount:e}}function te(e){return{type:V.addGold,amount:-e}}function ne(e,t){return{type:z.addItem,item:e,toSlot:t}}function ae(e){return{type:z.removeItem,fromSlot:e}}function re(e){return{type:X.addResources,resources:e}}function oe(e){return{type:K.finishBuildingStructure,structure:e}}function ce(e){return{type:K.upgradeStructure,structure:e}}function ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:K.increaseWorkers,structure:e,workers:t}}function ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:K.decreaseWorkers,structure:e,workers:t}}function se(e,t,n,a,r){return{type:J.start,taskType:e,name:t,origin:n,time:a,callbacks:r}}!function(e){e.addGold="addGold"}(V||(V={})),function(e){e.addItem="addItem",e.moveItemInWarehouse="moveItemInWarehouse",e.removeItem="removeItem"}(z||(z={})),function(e){e.addResources="addResources",e.removeResources="removeResources"}(X||(X={})),function(e){e.upgradeStructure="upgradeStructure",e.increaseWorkers="increaseWorkers",e.decreaseWorkers="decreaseWorkers",e.startBuildingStructure="startBuildingStructure",e.finishBuildingStructure="finishBuildingStructure",e.setStructureState="setStructureState"}(K||(K={})),function(e){e.start="startTask",e.update="updateTasks"}(J||(J={}));var le,me=n(53),de=Object(me.a)([function(e){return e.structures},function(e){return e.workers}],(function(e,t){return t-Object.keys(e).map((function(t){return e[t]})).reduce((function(e,t){return e+t.workers}),0)})),pe=n(21);!function(e){e[e.buildStructure=0]="buildStructure",e[e.craftItem=1]="craftItem"}(le||(le={}));var fe,ve=Object(h.c)((function(e,t){var n=e.structures[t.type],a=e.tasks.running.filter((function(e){return e.origin==="".concat(t.type,".craft")}));return{gold:e.gold,items:e.stockpile,level:n.level,resources:e.resources,tasks:a,workersFree:de(e)}}),(function(e,t){return{onCraft:function(n,a){var r,o=D(n.cost.time||0,a);e((r=n.cost.resources||{},{type:X.removeResources,resources:r})),e(ie(t.type,a));var c=[ne(n.item),ue(t.type,a)],i=se(le.craftItem,n.item,"".concat(t.type,".craft"),o,c);e(i)},onUpgrade:function(n,a){e(te(n)),e(ce(t.type)),a++,e(Object(y.c)("log-town-upgrade-structure-complete",{level:a,structure:t.type},pe.a.town))}}}))(Y),he=n(24),ge=n(43),be=(n(215),function(e){var t=e.adventurer,n=(e.className||"")+" avatar";return p.createElement("div",{className:n,style:{backgroundImage:"url(".concat("/gilles-game").concat(t.avatarImg,")")},onClick:function(){e.onClick&&e.onClick(e.adventurer.id)}},p.createElement("div",{className:"sizer"}),e.displayName&&p.createElement("div",{className:"name"},t.name))}),ye="adventurer",we="item";!function(e){e[e.adventurerInventory=0]="adventurerInventory",e[e.warehouse=1]="warehouse",e[e.tavern=2]="tavern",e[e.adventurerEquipment=3]="adventurerEquipment",e[e.lootCache=4]="lootCache"}(fe||(fe={}));var Oe=n(277),Ee=(n(216),Object(Oe.a)(ye,{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){return!0}},(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,a="droppable-adventurer-slot";return t?a+=" active-drop":n&&(a+=" can-drop"),(0,e.connectDropTarget)(p.createElement("div",{className:a}))}))),je=(n(218),function(e){return p.createElement("ul",{className:"assign-adventurers"},function(){for(var t=[],n=function(n){var a=void 0,r="";if(!!e.assignedAventurers[n]){var o=e.assignedAventurers[n];a=p.createElement(be,{adventurer:o,displayName:!1,onClick:function(){return e.onAdventurerClicked(o)}}),r="has-adventurer"}else a=p.createElement(Ee,{onDrop:function(t){e.onAdventurerDropped(t,n)}});t.push(p.createElement("li",{key:"slot".concat(n),className:r}," ",a," "))},a=0;a<e.availableSlots;a++)n(a);return t}())}),ke=(n(219),function(e){var t=function(t){return!t.requiredItems||t.requiredItems.every((function(n){var a=t.requiredItems.filter((function(e){return e===n})).length;return e.items.filter((function(e){return e===n})).length>=a}))};return p.createElement("div",{className:"quest-board"},p.createElement("h2",null,k.a.get("structure-tavern-title-quest-board")),p.createElement("ul",{className:"quest-list"},e.availableQuests.map((function(t){var n="".concat("/gilles-game","img/sigils/").concat(t.icon),a="quest ".concat(t.name===e.selectedQuestName?" selected":"");return p.createElement("li",{key:t.name,className:a,onClick:function(){e.onQuestClick(t.name)}},p.createElement("div",{className:"icon",style:{backgroundImage:"url(".concat("/gilles-game").concat(n,")")}}),p.createElement("div",{className:"title"},k.a.getQuestTitle(t.name)," "))}))),function(){if(!e.selectedQuestName)return null;var n=e.availableQuests.find((function(t){return t.name===e.selectedQuestName}));if(!n)return p.createElement("div",null," ",k.a.get("structure-tavern-quest-launched")," ");var a=Object(ge.b)(n.name),r=e.assignedAventurers.filter((function(e){return null!==e})).length>=3,o=t(a),c=r&&o;return p.createElement("div",{className:"quest-details"},k.a.getQuestDescription(e.selectedQuestName),p.createElement(je,{availableSlots:5,assignedAventurers:e.assignedAventurers,onAdventurerClicked:e.onRemoveAdventurer,onAdventurerDropped:e.onAdventurerDropped}),p.createElement(I,{items:a.requiredItems||[]}),p.createElement("button",{disabled:!c,onClick:function(){return e.onLaunchQuest()}},k.a.get("structure-tavern-button-launch-quest")))}())});var Te,Ie=Object(h.c)((function(e,t){return{items:e.stockpile}}))(ke);!function(e){e[e.unavailable=0]="unavailable",e[e.available=1]="available",e[e.active=2]="active",e[e.completed=3]="completed"}(Te||(Te={}));n(220);var Ne=n(32),xe=n(35),Se=n(23),Ce=n(278),qe=(n(222),{beginDrag:function(e){return{adventurer:e.adventurer,sourceId:e.sourceId,sourceType:fe.adventurerInventory}}});var Ae,De=Object(Ce.a)(ye,qe,(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.isDragging,n=e.connectDragSource,a="draggable-adventurer-avatar";return e.disabled&&(a+=" disabled"),t&&(a+=" dragging"),n(p.createElement("div",{className:a},p.createElement(be,e)))})),Re=n(52),Me=n(1),Pe=(n(223),{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){var n=t.getItem().item;return _e(n,e.type)}});!function(e){e[e.feet=0]="feet",e[e.hands=1]="hands",e[e.chest=2]="chest",e[e.legs=3]="legs",e[e.head=4]="head",e[e.shoulders=5]="shoulders",e[e.mainHand=6]="mainHand",e[e.offHand=7]="offHand"}(Ae||(Ae={}));var _e=function(e,t){switch(t){case Ae.chest:return We(e,Re.a.chest);case Ae.feet:return We(e,Re.a.feet);case Ae.hands:return We(e,Re.a.hands);case Ae.head:return We(e,Re.a.head);case Ae.legs:return We(e,Re.a.legs);case Ae.mainHand:case Ae.offHand:return Object(j.b)(e).itemType===Me.b.weapon;default:return!1}},Le=Object(Oe.a)(we,Pe,(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,a="grey";return t&&n?a="green":n&&(a="orange"),(0,e.connectDropTarget)(p.createElement("div",{className:"equipment-slot",style:{borderColor:a},title:Ae[e.type]},e.children))})),We=function(e,t){var n=Object(j.b)(e);return n.itemType===Me.b.apparel&&n.equipmentType===t};var Fe,Be=Object(Ce.a)(we,{beginDrag:function(e){return{inventorySlot:e.index,item:e.item,sourceId:e.sourceId,sourceType:e.sourceType}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.item,n=e.onClick,a=e.isDragging,r=e.connectDragSource,o=e.size;return a?null:r(p.createElement("div",null,p.createElement(U,{item:t,onClick:function(e){n&&n(e)},size:o})))})),Qe=function(e){var t=e.adventurer,n=e.onDropItemEquipment,a=function(e){var a=t.equipment[Ae[e]],r=null;if(a){var o=f.a.createRef();r=f.a.createElement(Be,{index:e,sourceId:t.id,sourceType:fe.adventurerEquipment,item:a,ref:o,size:x.medium})}return f.a.createElement(f.a.Fragment,null,f.a.createElement(Le,{onDrop:function(t){return n(t,e)},type:e},r),f.a.createElement("span",{className:"info"},k.a.get("ui-equipmentslot-".concat(Ae[e]))))};return f.a.createElement("ul",null,f.a.createElement("li",null,a(Ae.head)),f.a.createElement("li",null,a(Ae.shoulders)),f.a.createElement("li",null,a(Ae.chest)),f.a.createElement("li",null,a(Ae.hands)),f.a.createElement("li",null,a(Ae.legs)),f.a.createElement("li",null,a(Ae.feet)),f.a.createElement("li",null,a(Ae.mainHand)),f.a.createElement("li",null,a(Ae.offHand)))},He=(n(224),{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){var n=t.getItem();return n.sourceType!==fe.adventurerEquipment||(null==e.item||_e(e.item,n.inventorySlot))}}),Ue=Object(Oe.a)(we,He,(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,a=e.connectDropTarget,r=t&&n,o=["inventory-item",M(e.size)];return r?o.push("drop-active"):n&&o.push("drop-possible"),a(p.createElement("div",{className:o.join(" ")},e.children))})),Ge=function(e){for(var t=[],n=function(n){var a=void 0,r=e.items[n];r&&(a=p.createElement(Be,{index:n,sourceId:e.sourceId,sourceType:e.sourceType,item:r}));var o=p.createElement(Ue,{key:"inventory-slot-".concat(n),item:r,size:e.iconSize,onDrop:function(t){if((t.inventorySlot!==n||t.sourceType!==e.sourceType||t.sourceId!==e.sourceId)&&e.onDropItem){var a=t.inventorySlot;e.onDropItem(t.item,a,n,t.sourceType,t.sourceId)}}},a);t.push(o)},a=0;a<e.items.length;a++)n(a);return p.createElement("div",{className:"inventory ".concat(e.className)},t)};function Ve(e,t,n){return{type:Fe.moveItemInInventory,adventurerId:e,fromSlot:t,toSlot:n}}function ze(e,t,n){return{type:Fe.addItemToInventory,adventurerId:e,item:t,toSlot:n}}function Xe(e,t){return{type:Fe.removeItemFromInventory,adventurerId:e,fromSlot:t}}function Ke(e,t,n){return{type:Fe.assignEquipment,adventurerId:e,item:n,equipmentSlot:t}}function Je(e,t){return{type:Fe.removeEquipment,adventurerId:e,equipmentSlot:t}}!function(e){e.moveItemInInventory="moveItemInInventory",e.moveItemToOtherAdventurer="moveItemToOtherAdventurer",e.moveItemFromWarehouseToAdventurer="moveItemFromWarehouseToAdventurer",e.addItemToInventory="addItemToInventory",e.removeItemFromInventory="removeItemFromInventory",e.assignEquipment="assignEquipment",e.removeEquipment="removeEquipment"}(Fe||(Fe={}));n(225);var Ze=function(e){var t=e.adventurer,n=Object(h.d)();return f.a.createElement("div",{className:"adventurer-panel"},f.a.createElement("div",{className:"info"},f.a.createElement("div",{className:"name"},f.a.createElement("b",null,t.name))),f.a.createElement("div",{className:"equipment"},f.a.createElement(Qe,{adventurer:t,onDropItemEquipment:function(e,a){var r=e.item,o=[];switch(e.sourceType){case fe.adventurerInventory:o.push(Xe(t.id,e.inventorySlot),Ke(t.id,a,r));var c=t.equipment[Ae[a]];c&&o.push(ze(t.id,c,e.inventorySlot));break;case fe.warehouse:o.push(ae(e.inventorySlot),Ke(t.id,a,r));var i=t.equipment[Ae[a]];i&&o.push(ne(i,e.inventorySlot));break;case fe.adventurerEquipment:o.push(Ke(t.id,a,r));var u=t.equipment[Ae[a]],s=e.inventorySlot;u?o.push(Ke(t.id,s,u)):o.push(Je(t.id,s))}o.forEach((function(e){return n(e)}))}})),f.a.createElement("div",{className:"right"},f.a.createElement(Ge,{sourceType:fe.adventurerInventory,sourceId:t.id,items:t.inventory,className:"inventory-small",onDropItem:function(e,a,r,o,c){var i=[];switch(o){case fe.adventurerInventory:i.push(Ve(t.id,a,r));break;case fe.warehouse:i.push(ae(a),ze(t.id,e,r));var u=t.inventory[r];u&&i.push(ne(u,a));break;case fe.adventurerEquipment:i.push(ze(t.id,e,r));var s=t.inventory[r];s?i.push(Ke(t.id,a,s)):i.push(Je(t.id,a))}i.forEach((function(e){return n(e)}))}})))},$e=(n(226),function(e){var t=e.adventurer,n=e.assignedAventurers,a=e.onAddAdventurer,r=e.onRemoveAdventurer;return n.indexOf(t)>-1?p.createElement("button",{onClick:function(){r(t)},className:"adventurer-button"},"Leave"):5===n.filter(Boolean).length?p.createElement("button",{disabled:!0,className:"adventurer-button"},"Party full"):p.createElement("button",{onClick:function(){var e=Ye(n);a(t,e)},className:"adventurer-button"},"Join")}),Ye=function(e){for(var t=0;t<5;t++)if(!e[t])return t;return 0},et=function(e){var t=e.adventurer,n=e.onQuest,a=e.assignedAventurers,r=e.expanded,o=e.selectedQuestName,c=e.onClick,i=e.onAddAdventurer,u=e.onRemoveAdventurer,s=a.indexOf(t)>-1;return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"room ".concat(r?"expanded":"")},f.a.createElement(De,{disabled:s||n,adventurer:t,className:"adventurer-icon",sourceId:at,key:"avatar:".concat(t.id)}),f.a.createElement("span",{key:t.id,onClick:function(){return c(t)}},t.name,n&&" (on a quest)")),r&&f.a.createElement("div",{className:"adventurer-details"},f.a.createElement(Ze,{adventurer:t}),!n&&o&&f.a.createElement($e,{adventurer:t,assignedAventurers:a,onAddAdventurer:i,onRemoveAdventurer:u})))},tt=function(){return f.a.createElement("div",{className:"room"},"(empty room)")},nt=function(e){for(var t=e.roomCount,n=e.adventurers,a=e.assignedAventurers,r=e.selectedQuestName,o=e.onAddAdventurer,c=e.onRemoveAdventurer,i=Object(p.useState)(),u=Object(E.a)(i,2),s=u[0],l=u[1],m=function(e){s===e.id?l(void 0):l(e.id)},d=[],v=function(t){var i=n.find((function(e){return e.room===t}));if(!i)return d.push(f.a.createElement(tt,{key:"room".concat(t)})),"continue";var u,l=(u=i.id,!!Object.values(e.quests).find((function(e){return e.party.indexOf(u)>-1})));d.push(f.a.createElement(et,{key:i.id,adventurer:i,assignedAventurers:a,selectedQuestName:r,expanded:s===i.id,onQuest:l,onClick:m,onAddAdventurer:o,onRemoveAdventurer:c}))},h=0;h<t;h++)v(h);return f.a.createElement("div",{className:"rooms"},f.a.createElement("h2",null,"Rooms"),d)},at="tavern",rt=function(e){var t=e.adventurers,n=e.quests,a=Object(p.useState)([]),r=Object(E.a)(a,2),o=r[0],i=r[1],u=Object(p.useState)(),s=Object(E.a)(u,2),l=s[0],m=s[1],d=Object(A.b)(A.a.tavern),f=e.level||0,v=d.levels[f],h=k.a.getStructureName(A.a.tavern),g=e.quests.filter((function(e){return e.status===Te.available})),b=function(e,t){var n=Object(c.a)(o);n[t]=e,i(n)},y=function(e){var t=o.indexOf(e),n=Object(c.a)(o);delete n[t],i(n)};return p.createElement("details",{open:!0,className:"tavernstructureview"},p.createElement("summary",null,h),function(){var t=e.gold,n=d.levels[f+1],a=null!=n?n.cost.gold||0:-1,r=null!=n&&t>=a,o="Upgrade! (".concat(a<0?"max":a+" gold",")");return p.createElement("div",null,p.createElement("label",null,"level:"),"".concat(f+1," / ").concat(d.levels.length),p.createElement("button",{style:{float:"right"},onClick:function(t){e.onUpgrade&&e.onUpgrade(a,f+1)},disabled:!r},o))}(),p.createElement("section",null,p.createElement(nt,{roomCount:v.rooms,adventurers:t,assignedAventurers:o,quests:n,selectedQuestName:l,onAddAdventurer:b,onRemoveAdventurer:y}),p.createElement(Ie,{availableQuests:g,selectedQuestName:l,assignedAventurers:o,onQuestClick:function(e){return function(e){m(l===e?void 0:e),i([])}(e)},onAdventurerDropped:function(e,t){e.sourceId===at&&b(e.adventurer,t)},onRemoveAdventurer:y,onLaunchQuest:function(){return function(){var t=k.a.getQuestTitle(l),n=o[0];Ne.a.addToast(t,xe.a.questLaunched,null===n||void 0===n?void 0:n.avatarImg,Object(Se.a)(l)),e.onLaunchQuest(l,o)}()}})))};var ot=Object(h.c)((function(e,t){var n=e.structures[A.a.tavern];return{adventurers:e.adventurers,gold:e.gold,level:n.level,quests:e.quests}}),(function(e,t){return{onLaunchQuest:function(t,n){e(Object(he.e)(t,n))},onUpgrade:function(t,n){e(te(t)),e(ce(A.a.tavern)),n++,e(Object(y.c)("log-town-upgrade-structure-complete",{level:n,structure:A.a.tavern},pe.a.town))}}}))(rt),ct=n(60),it=function(e){return function(t){Object(W.a)(a,t);var n=Object(L.a)(a);function a(){return Object(P.a)(this,a),n.apply(this,arguments)}return Object(_.a)(a,[{key:"render",value:function(){var t=this;return p.createElement(Ea.Consumer,null,(function(n){return p.createElement(e,Object.assign({},t.props,n))}))}}]),a}(p.Component)},ut=it((function(e){var t=e.sufficientResources,n=e.resources,a=e.deltaResources,r=(e.className||"")+" resourcesbox",o=Object.keys(n).map((function(n){var r="resource";t&&!t[n]&&(r+=" insufficient");var o,c=S[n],i=e.resources[n];if(!c)throw new Error("No resource description found for ".concat(n));a[n]&&(o=p.createElement("span",{className:"animate-up"},"+ ".concat(a[n].toFixed(2))));var u=st(n);return p.createElement("li",{className:r,key:n},p.createElement("div",{className:"icon common-icon-smallest",style:{backgroundImage:"url(".concat("/gilles-game").concat(c.iconImg,")")}}),p.createElement("div",{className:"name"},k.a.getResourceName(n)),p.createElement("div",{className:"amount"},i.toFixed(1)),p.createElement("div",{className:"max"}," / ".concat(e.maxResources[n])),p.createElement("div",{className:"delta"},o),p.createElement("div",{className:"structure"},"source:",p.createElement(ct.b,{to:Object(Se.b)(u),onClick:function(){e.onCloseWindow()}},k.a.getStructureName(u))))}));return p.createElement("ul",{className:r},o)})),st=function(e){switch(e){case b.fabric:return A.a.weaver;case b.food:return A.a.garden;case b.iron:return A.a.mine;case b.leather:return A.a.tannery;case b.stone:return A.a.quarry;case b.wood:return A.a.lumberMill}throw new Error("Unknown structure for resource ".concat(e))},lt=(n(126),function(e){var t=(e.active?"active":"")+(e.className||"");return p.createElement("li",{className:"tabstrip-tab ".concat(t),onClick:function(t){e.onClick&&e.onClick(t)}},e.children)}),mt=(n(227),function(e){var t=e.adventurer,n=Object.keys(t.stats).map((function(e){var n=t.stats[e];return p.createElement("div",{key:"".concat(t.id,"-").concat(e)}," ",p.createElement("b",null,e),": ",n.toFixed(1)," ")})),a=function(n){var a=t.equipment[Ae[n]],r=null;if(a){var o=p.createRef();r=p.createElement(Be,{index:n,sourceId:t.id,sourceType:fe.adventurerEquipment,item:a,onClick:function(e){var t=e.currentTarget.getBoundingClientRect();H.showContextTooltip(N.item,Object(j.b)(a),t),e.stopPropagation()},ref:o,size:x.medium})}return p.createElement(p.Fragment,null,p.createElement(Le,{onDrop:function(a){return function(n,a){var r=n.item;switch(n.sourceType){case fe.adventurerInventory:e.onRemoveItemFromInventory(t.id,n.inventorySlot),e.onAssignEquipment(t.id,a,r);var o=t.equipment[Ae[a]];o&&e.onAddItemToInventory(t.id,o,n.inventorySlot);break;case fe.warehouse:e.onAssignEquipmentFromWarehouse(t.id,n.inventorySlot,r,a);var c=t.equipment[Ae[a]];c&&e.onAddItemToWarehouse(c,n.inventorySlot);break;case fe.adventurerEquipment:e.onAssignEquipment(t.id,a,r);var i=t.equipment[Ae[a]],u=n.inventorySlot;i?e.onAssignEquipment(t.id,u,i):e.onRemoveEquipment(t.id,u)}}(a,n)},type:n},r),p.createElement("span",{className:"info"},k.a.get("ui-equipmentslot-".concat(Ae[n]))))},r=p.createElement("ul",null,p.createElement("li",null,a(Ae.head)),p.createElement("li",null,a(Ae.shoulders)),p.createElement("li",null,a(Ae.chest)),p.createElement("li",null,a(Ae.hands)),p.createElement("li",null,a(Ae.legs)),p.createElement("li",null,a(Ae.feet)),p.createElement("li",null,a(Ae.mainHand)),p.createElement("li",null,a(Ae.offHand)));return p.createElement("div",{className:"adventurer-info"},p.createElement("div",{className:"left"},p.createElement("div",{className:"name"},p.createElement("b",null,t.name)),p.createElement("div",{className:"attributes"},n),p.createElement("div",{className:"equipment"},r)),p.createElement("div",{className:"right"},p.createElement(Ge,{sourceType:fe.adventurerInventory,sourceId:t.id,items:t.inventory,onDropItem:function(n,a,r,o,c){switch(o){case fe.adventurerInventory:e.onMoveItemInInventory&&e.onMoveItemInInventory(t.id,a,r);break;case fe.warehouse:var i=t.inventory[r];e.onMoveItemFromWarehouseToInventory(t.id,a,r,n,i);break;case fe.adventurerEquipment:e.onAddItemToInventory&&e.onRemoveEquipment&&e.onAddItemToInventory(t.id,n,r);var u=t.inventory[r];u?e.onAssignEquipment(t.id,a,u):e.onRemoveEquipment(t.id,a)}}})))}),dt=Object(h.c)((function(e,t){return{adventurer:e.adventurers.find((function(e){return e.id===t.adventurerId})),warehouse:e.stockpile}}),(function(e){return{onAddItemToInventory:function(t,n,a){var r=ze(t,n,a);e(r)},onAddItemToWarehouse:function(t,n){var a=ne(t,n);e(a)},onAssignEquipment:function(t,n,a){var r=Ke(t,n,a);e(r)},onAssignEquipmentFromWarehouse:function(t,n,a,r){var o=ae(n);e(o);var c=Ke(t,r,a);e(c)},onMoveItemFromWarehouseToInventory:function(t,n,a,r,o){var c=ae(n);e(c);var i=ze(t,r,a);if(e(i),o){var u=ne(o,n);e(u)}},onMoveItemInInventory:function(t,n,a){var r=Ve(t,n,a);e(r)},onRemoveEquipment:function(t,n){var a=Je(t,n);e(a)},onRemoveItemFromInventory:function(t,n){var a=Xe(t,n);e(a)}}}))(mt),pt=function(e){var t=Object(p.useRef)();return Object(p.useEffect)((function(){t.current=e})),t.current},ft={fabric:0,food:0,iron:60,leather:0,stone:0,wood:40},vt={fabric:0,food:0,iron:0,leather:0,stone:0,wood:0},ht=(n(228),function(e){var t=e.activeTab,n=void 0===t?null:t;!n&&e.children&&e.children.length&&(n=e.children[0].props.id);var a="".concat(e.className," ").concat(e.disabled?"disabled":""),r=f.a.Children.map(e.children,(function(e){return f.a.cloneElement(e,{active:e.props.id===n,onClick:function(){o(e.props.id)}})})),o=function(t){e.onTabSelected&&!0!==e.disabled&&e.onTabSelected(t)};return f.a.createElement("ul",{className:"tabstrip ".concat(a),onClick:function(t){e.onClick&&e.onClick(t)}},r)}),gt=function(e){var t=e.adventurers,n=e.onAdventurerTabSelected;return f.a.createElement(ht,{className:"adventurers-tabstrip",onTabSelected:function(t){var a=e.adventurers.find((function(e){return e.id===t}));n(a.id)},activeTab:e.selectedAdventurerId,disabled:e.disabled},t.map((function(e){return t=e,f.a.createElement(lt,{id:t.id,key:t.id},f.a.createElement(be,{adventurer:t,className:"common-icon-small"}));var t})))},bt=fe.warehouse,yt=function(e){var t=Object(p.useState)(),n=Object(E.a)(t,2),a=n[0],r=n[1],o=Object(p.useState)(vt),c=Object(E.a)(o,2),i=c[0],u=c[1],s=pt(e.resources),l=Object(p.useRef)(null);Object(p.useEffect)((function(){var t=Object.keys(e.resources).reduce((function(t,n){return s&&s[n]&&(t[n]=e.resources[n]-s[n]),t}),{});u(t)}),[e.resources,s]),Object(p.useEffect)((function(){if(l.current){var e=l.current;e.classList.remove("animate"),setTimeout((function(){l&&e.classList.add("animate")}),200)}}),[i]);var m=Object(A.b)(A.a.warehouse);if(!m)throw new Error("No definition found for structure ".concat(A.a.warehouse," with type StructureDefinition."));var d=e.level,f=k.a.getStructureName(A.a.warehouse);return p.createElement("details",{open:!0,className:"warehouse-structureview"},p.createElement("summary",null,f),function(){var t=e.gold,n=m.levels[d+1],a=null!=n?n.cost.gold||0:-1,r=null!=n&&t>=a,o="Upgrade! (".concat(a<0?"max":a+" gold",")");return p.createElement("div",null,p.createElement("label",null,"level:"),d+1+" / "+m.levels.length,p.createElement("button",{style:{float:"right"},onClick:function(t){e.onUpgrade&&e.onUpgrade(a,d+1)},disabled:!r},o))}(),p.createElement("fieldset",{className:"resources",ref:l},p.createElement("legend",null,"Resources"),p.createElement(ut,{resources:e.resources,structures:e.structures,maxResources:e.maxResources,deltaResources:i})),p.createElement("h3",null,"Stockpile"),p.createElement(Ge,{sourceType:bt,items:e.items,onDropItem:function(t,n,a,r,o){switch(r){case bt:e.onMoveItemInWarehouse&&e.onMoveItemInWarehouse(n,a);break;case fe.adventurerInventory:if(e.onMoveItemFromAdventurer){var c=e.items[a];e.onMoveItemFromAdventurer(o,t,n,a,c)}}}}),p.createElement("h3",null,"Adventurers"),p.createElement("div",null,p.createElement(gt,{adventurers:e.adventurersInTown,selectedAdventurerId:a,onAdventurerTabSelected:function(e){r(e)}}),p.createElement("div",{className:"adventurer-inventory"},a?p.createElement(dt,{adventurerId:a}):null)))},wt=n(47),Ot=function(e){return e.adventurers},Et=function(e){return e.quests},jt=(Object(me.a)([Ot,Et],(function(e,t){var n=[],a=Object.values(t).reduce((function(t,a){var r=Object(wt.a)(e,a);return a.status===Te.active&&(t[a.name]=r),n.push.apply(n,Object(c.a)(r)),t}),{});return a.solo=e.filter((function(e){return-1===n.indexOf(e)})),a})),Object(me.a)([Ot,Et],(function(e,t){var n=t.reduce((function(e,t){return t.status===Te.active&&e.push.apply(e,Object(c.a)(t.party)),e}),[]);return e.filter((function(e){return-1===n.indexOf(e.id)}))})));var kt,Tt=Object(h.c)((function(e,t){var n=e.structures[A.a.warehouse],a=Object(A.b)(A.a.warehouse),r=n.level,o=a.levels[r],c=jt(e);if(!n)throw new Error("No structure '".concat(A.a.warehouse,"' found in the store!"));return{adventurersInTown:c,gold:e.gold,items:e.stockpile,level:r,maxResources:o.maxResources,resources:e.resources,structures:e.structures,workers:n.workers,workersFree:de(e)}}),(function(e,t){return{onMoveItemFromAdventurer:function(t,n,a,r,o){var c=Xe(t,a);e(c);var i=ne(n,r);if(e(i),o){var u=ze(t,o,a);e(u)}},onMoveItemInWarehouse:function(t,n){e(function(e,t){return{type:z.moveItemInWarehouse,fromSlot:e,toSlot:t}}(t,n))},onMoveItemInInventory:function(t,n,a){var r=Ve(t,n,a);e(r)},onMoveItemToAdventurer:function(t,n,a,r){var o=ae(a);e(o);var c=ze(t,n,r);e(c)},onUpgrade:function(t,n){e(te(t)),e(ce(A.a.warehouse)),n++,e(Object(y.c)("log-town-upgrade-structure-complete",{level:n,structure:A.a.warehouse},pe.a.town))}}}))(yt),It=n(20);!function(e){e[e.NotBuilt=0]="NotBuilt",e[e.Building=1]="Building",e[e.Built=2]="Built"}(kt||(kt={}));var Nt,xt,St,Ct={level:0,state:kt.NotBuilt,workers:0},qt=(n(229),function(e){var t=Object(h.e)((function(e){return e.gold})),n=Object(h.e)((function(t){var n=t.structures[e.type];if(!n)throw new Error("No structure '".concat(e.type,"' found in the store!"));return n.level})),a=Object(h.e)((function(t){var n=t.structures[e.type];if(!n)throw new Error("No structure '".concat(e.type,"' found in the store!"));return n.workers})),r=Object(h.e)((function(e){return de(e)})),o=Object(A.b)(e.type);if(!o)throw new Error("No definition found for structure ".concat(e.type," with type ResourceStructureDefinition."));var c=Object(h.d)(),i=function(){c(ue(e.type))},u=function(){c(ie(e.type))},s=o.levels[n];return p.createElement(p.Fragment,null,p.createElement($,{structure:e.type}),p.createElement("details",{open:!0,className:"structureview"},p.createElement("section",null,function(){var e=a===s.workerCapacity||(r||0)<1,t=0===a;return p.createElement(Z,{label:"workers:",value:a,max:s.workerCapacity,upDisabled:e,downDisabled:t,onDown:i,onUp:u})}(),function(){var a=o.levels[n+1],r=null!=a?a.cost.gold||0:-1,i=null!=a&&t>=r,u="Upgrade! (".concat(r<0?"max":r+" gold",")");return p.createElement("div",null,p.createElement("label",null,"level:"),n+1+" / "+o.levels.length,p.createElement("button",{style:{float:"right"},onClick:function(t){!function(t,n){c(te(t)),c(ce(e.type)),n++,c(Object(y.c)("log-town-upgrade-structure-complete",{level:n,structure:e.type},pe.a.town))}(r,n+1)},disabled:!i},u))}(),function(){var e=s.generates,t=Object.keys(e).reduce((function(t,n){return e[n]&&t.push("".concat(e[n]," x ").concat(a," = ").concat(e[n]*(a||0)," ").concat(n)),t}),[]).join(",");return p.createElement("div",null,"Generates (every minute): ",p.createElement("br",null),t)}())))}),At=function(e){return p.createElement("div",{className:"structure-details"},function(){if(e.structures[e.structure].state===kt.Building){var t=e.buildTask?e.buildTask.progress:1;return p.createElement("div",null,p.createElement(G,{label:"Building...",progress:t}))}switch(Object(A.b)(e.structure).type){case It.a.production:return p.createElement(ve,{type:e.structure});case It.a.resource:return p.createElement(qt,{type:e.structure});case It.a.warehouse:return p.createElement(Tt,null);case It.a.tavern:return p.createElement(ot,null);default:return p.createElement("div",null," ",e.structure," ")}}())},Dt=(n(230),n(231),function(e){var t=e.className||"";return p.createElement("div",{className:"ui-button widgets-squareiconbutton ".concat(t),onClick:function(t){e.onClick&&e.onClick(t)}},e.text)});!function(e){e[e.town=0]="town",e[e.world=1]="world"}(Nt||(Nt={})),function(e){e[e.buttonClick=0]="buttonClick",e[e.error=1]="error"}(xt||(xt={}));var Rt={},Mt=null,Pt={},_t=function(){function e(){Object(P.a)(this,e)}return Object(_.a)(e,null,[{key:"loadMedia",value:function(e){St=e}},{key:"addSounds",value:function(e){Object.entries(e).forEach((function(e){var t=Object(E.a)(e,2),n=t[0],a=t[1];Pt[n]=St.find((function(e){return e.url===a})).content}))}},{key:"playSound",value:function(e){Pt[e].play()}},{key:"addMusicTrack",value:function(e,t){if(St){var n=St.find((function(e){return e.url===t}));if(!n)throw new Error("No sound found at ".concat(t));Rt.hasOwnProperty(e)||(Rt[e]=n.content)}}},{key:"playMusicTrack",value:function(t){if(St){if(null!==Mt)Rt[Mt].fade(e.musicVolume,0,500);var n=Rt[t];n.playing()||(n.loop(!0),n.play()),n.fade(0,e.musicVolume,500),Mt=t}}},{key:"soundVolume",value:function(e){}},{key:"musicVolume",set:function(e){Mt&&Rt[Mt].volume(e),this._musicVolume=e;try{localStorage.setItem("musicVolume","".concat(e))}catch(t){}},get:function(){if(void 0!==this._musicVolume)return this._musicVolume;var e=localStorage.getItem("musicVolume");return this._musicVolume=null==e?.8:parseFloat(e),this._musicVolume}}]),e}();_t._musicVolume=void 0,_t._soundVolume=void 0;var Lt=function(e){var t=null;!1!==e.backEnabled&&(t=p.createElement(Dt,{className:"back-button",onClick:function(t){e.onBack&&(e.onBack(),_t.playSound(xt.buttonClick))},text:"<"}));var n=null;return!1!==e.closeEnabled&&(n=p.createElement(Dt,{className:"close-button",onClick:function(t){e.onClose&&(e.onClose(),_t.playSound(xt.buttonClick))},text:"x"})),p.createElement("div",{className:"window"},p.createElement("div",{className:"header"},t,p.createElement("h3",null,e.title),n),e.children)},Wt=function(e){return function(t){Object(W.a)(a,t);var n=Object(L.a)(a);function a(){return Object(P.a)(this,a),n.apply(this,arguments)}return Object(_.a)(a,[{key:"render",value:function(){return p.createElement(Lt,this.props,p.createElement(e,this.props))}}]),a}(p.Component)},Ft=n(30);var Bt,Qt=Object(Ft.c)(Object(h.c)((function(e,t){return{buildTask:e.tasks.running.filter((function(e){return"town"===e.origin&&e.name==="".concat(t.structure,".build")}))[0],structures:e.structures}})),Wt)(At),Ht=["sound/fx/button-click.ogg","sound/fx/error.ogg","sound/music/Soliloquy.mp3","sound/music/TheLoomingBattle.ogg"],Ut=n(276),Gt=n(147),Vt=n(34),zt=n(275),Xt=n(76),Kt=n(136),Jt=n.n(Kt),Zt=(n(232),n(137)),$t=function(e){var t=e.itemsLoaded,n=e.itemsTotal;return p.createElement("div",null," ","Loading (".concat(Math.floor((t||0)/(n||0)*100),")%")," ")};!function(e){e[e.image=0]="image",e[e.sound=1]="sound"}(Bt||(Bt={}));var Yt,en=[],tn=function(e){var t=new Image;return t.src=e,new Promise((function(e,n){function a(){t.naturalWidth?e(t):n(null),t.removeEventListener("load",a),t.removeEventListener("error",a)}t.naturalWidth?e(t):t.complete?n(null):(t.addEventListener("load",a),t.addEventListener("error",a))}))},nn=function(e){if((e=e.toLowerCase()).endsWith("png")||e.endsWith("jpg")||e.endsWith("gif"))return Bt.image;if(e.endsWith("mp3")||e.endsWith("ogg")||e.endsWith("wav"))return Bt.sound;throw Error("Could not determine type for ".concat(e))},an=function(e){var t=Object(p.useState)(!1),n=Object(E.a)(t,2),a=n[0],r=n[1],o=Object(p.useState)(0),c=Object(E.a)(o,2),i=c[0],l=c[1];Object(p.useEffect)((function(){v()}),[]);var m=e.children,d=e.manifest,f=p.createElement($t,{itemsLoaded:i,itemsTotal:d.length}),v=function(){l(0);var t=e.manifest.map((function(e){return h(e).catch((function(e){return console.error(e)}))}));Promise.all(t).then((function(t){e.onLoadComplete&&e.onLoadComplete(en),r(!0)}))},h=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,a,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(en.some((function(e){return e.url===t}))&&console.warn("Loading media with url ".concat(t," more than once! Will overwrite.")),(n=nn(t))!==Bt.image){e.next=7;break}return e.next=5,tn(t);case 5:r=e.sent,a={content:r,mediaType:n,url:t};case 7:if(n===Bt.sound&&(o=new Zt.Howl({src:["".concat("/gilles-game","/").concat(t)]}),a={content:o,mediaType:n,url:t}),!a){e.next=14;break}return en.push(a),l(i+1),e.abrupt("return",a);case 14:throw new Error("Unknown error while trying to load ".concat(t));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a?m:f},rn=n(16),on=n(139),cn=n(140),un=Object(p.forwardRef)((function(e,t){var n=Object(rn.useApp)();if(n){var a="url('".concat("/gilles-game","/img/cursors/dwarven_gauntlet_extra_6.png'), auto");n.renderer.plugins.interaction.cursorStyles.pointer=a}return f.a.createElement(sn,Object.assign({app:n},e,{ref:t}))})),sn=Object(rn.PixiComponent)("Viewport",{create:function(e){var t=new cn.a({screenWidth:e.screenWidth,screenHeight:e.screenHeight,worldWidth:e.worldWidth,worldHeight:e.worldHeight,ticker:e.app.ticker,interaction:e.app.renderer.plugins.interaction});t.on("clicked",(function(t){e.onClick&&e.onClick(t)}));var n=e.minScale,a=void 0===n?1:n,r=e.maxScale,o=void 0===r?2:r;return t.drag().pinch().wheel().clamp({direction:"all"}).clampZoom({minScale:a,maxScale:o}).decelerate(),t}}),ln=un,mn=(n(242),n(8)),dn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";Object(P.a)(this,e),this.shapes=void 0,this.shapes=t[n].map((function(e){var t=e.shape;return new mn.Polygon(t)}))}return Object(_.a)(e,[{key:"contains",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(!this.shapes||0===this.shapes.length)&&this.shapes.some((function(n){return n.contains(e,t)}))}}]),e}(),pn=n(141),fn=n(50),vn=function(e){var t=e.hitAreaShapes,n=A.a.lumberMill,a="".concat("/gilles-game","/img/town/town-alpha/").concat(n,".json"),r=Object(p.useState)(),o=Object(E.a)(r,2),c=o[0],i=o[1],u=e.selected?[jn]:[],s=Object(rn.useApp)();Object(p.useEffect)((function(){Object(fn.b)(a,(function(e){i(e.textures)}))}),[s,s.loader,a]);var l=Object(p.useState)(0),m=Object(E.a)(l,2),d=m[0],v=m[1];return Object(rn.useTick)((function(e){return v((function(t){return t+.01*e}))})),c?f.a.createElement(rn.Sprite,{name:n,position:e.position,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(n)},hitArea:t,filters:u,texture:c["structure.png"]},f.a.createElement(rn.Sprite,{name:"blades",texture:c["blades.png"],anchor:new mn.Point(.5,.5),x:15,y:10,rotation:d})):null},hn=n(142),gn=n(87),bn=n(143),yn=Object(rn.PixiComponent)("ParticleEmitter",{create:function(){return new mn.ParticleContainer},applyProps:function(e,t,n){var a=n.image,r=n.config,o=Object(gn.a)(n,["image","config"]);Object(rn.applyDefaultProps)(e,t,o);var c=this._emitter;if(!c){c=new bn.a(e,[mn.Texture.from(a)],r);var i=performance.now();c.emit=!0,function e(){c.raf=requestAnimationFrame(e);var t=performance.now();c.update(3e-4*(t-i)),i=t}()}this._emitter=c},willUnmount:function(){this._emitter&&(this._emitter.emit=!1,cancelAnimationFrame(this._emitter.raf))}}),wn=function(e){var t=e.hitAreaShapes,n=e.position,a=A.a.tavern,r=e.selected?[jn]:[];return f.a.createElement(rn.Container,{position:n},f.a.createElement(rn.Sprite,{name:a,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(a)},filters:r,hitArea:t,image:"".concat("/gilles-game","/img/town/town-alpha/").concat(a,".png")}),f.a.createElement(yn,{name:"smoke",x:107,y:-2,image:"".concat("/gilles-game","/img/town/effects/smokeparticle.png"),config:hn}))},On=function(e){var t=e.structure,n=e.position,a=e.hitAreaShapes,r=e.selected,o=e.onStructureClick,c=r?[jn]:[];return f.a.createElement(rn.Sprite,{name:t,position:n,interactive:!0,buttonMode:!0,pointertap:function(){o(t)},hitArea:a,filters:c,image:"".concat("/gilles-game","/img/town/town-alpha/").concat(t,".png")})},En=(n(243),function(e){var t=e.structures,n=[A.a.workshop,A.a.quarry,A.a.tavern,A.a.tannery,A.a.alchemist,A.a.garden,A.a.weaponsmith,A.a.armoursmith,A.a.warehouse,A.a.mine,A.a.lumberMill,A.a.weaver],a=Object(Vt.h)("".concat(Object(Se.c)(),"/:structure"));return f.a.createElement("div",{className:"legenda"},f.a.createElement("ul",null,n.map((function(e){return t[e].state===kt.NotBuilt?null:f.a.createElement("li",{key:e},function(e){return(null===a||void 0===a?void 0:a.params.structure)===e.toString()?f.a.createElement("span",{className:"highlighted"},"".concat(k.a.getStructureName(e))):f.a.createElement(ct.b,{to:Object(Se.b)(e)},"".concat(k.a.getStructureName(e)))}(e))}))))}),jn=new on.a(4,16763904),kn=it((function(e){var t=Object(Vt.h)("".concat(Object(Se.c)(),"/:structurename")),n=null===t||void 0===t?void 0:t.params.structurename;Object(p.useEffect)((function(){_t.addMusicTrack(Nt.town,"sound/music/Soliloquy.mp3"),_t.playMusicTrack(Nt.town)}),[]);var a=function(t){o.current||e.onStructureClick(t)},r=Object(h.e)((function(e){return e.structures})),o=Object(p.useRef)(!1),c=Object(p.useRef)(null);Object(p.useEffect)((function(){if(c.current){var e=c.current;e.on("drag-start",(function(){o.current=!0})),e.on("drag-end",(function(){o.current=!1}))}var t=function(e){e.preventDefault()};return window.addEventListener("wheel",t,{passive:!1}),function(){window.removeEventListener("wheel",t)}}),[]),Object(p.useEffect)((function(){if(n&&c.current){var e=c.current;e.zoomPercent(2);var t=In(n);e.moveCenter(t)}}),[n]);return f.a.createElement("div",{className:"town-view"},f.a.createElement(En,{structures:r}),f.a.createElement(rn.Stage,{width:Oa,height:1079,options:{sharedLoader:!0}},f.a.createElement(ln,{screenWidth:Oa,screenHeight:1079,worldWidth:1024,worldHeight:1600,ref:c},f.a.createElement(rn.Sprite,{name:"background",image:"".concat("/gilles-game","/img/town/town-alpha/background.png")},[A.a.workshop,A.a.quarry,A.a.tavern,A.a.tannery,A.a.alchemist,A.a.garden,A.a.weaponsmith,A.a.armoursmith,A.a.warehouse,A.a.mine,A.a.lumberMill,A.a.weaver].reverse().map((function(e){if(r[e].state===kt.NotBuilt)return null;var t=Tn(e),o=In(e),c=new dn(pn,e);return f.a.createElement(t,{position:o,structure:e,hitAreaShapes:c,onStructureClick:a,key:e,selected:n===e})}))))))})),Tn=function(e){switch(e){case A.a.workshop:case A.a.quarry:case A.a.tannery:case A.a.alchemist:case A.a.garden:case A.a.weaponsmith:case A.a.armoursmith:case A.a.warehouse:case A.a.mine:case A.a.weaver:return On;case A.a.lumberMill:return vn;case A.a.tavern:return wn}},In=function(e){var t,n;switch(e){case A.a.workshop:t=373,n=610;break;case A.a.quarry:t=632,n=633;break;case A.a.tannery:t=372,n=460;break;case A.a.tavern:t=500,n=469;break;case A.a.alchemist:t=411,n=371;break;case A.a.garden:t=822,n=689;break;case A.a.weaponsmith:t=449,n=460;break;case A.a.armoursmith:t=473,n=442;break;case A.a.warehouse:t=471,n=130;break;case A.a.lumberMill:t=403,n=320;break;case A.a.mine:t=183,n=527;break;case A.a.weaver:t=484,n=333}return new PIXI.Point(t,n)},Nn=(n(244),function(){var e=Object(p.useState)([]),t=Object(E.a)(e,2),n=t[0],a=t[1],r=function(e){a(e)};return Object(p.useEffect)((function(){return Ne.a.addEventListener(Ne.a.EVENT_TOASTS_UPDATED,r),function(){Ne.a.removeEventListener(Ne.a.EVENT_TOASTS_UPDATED,r)}}),[]),f.a.createElement("div",{className:"toasts"},n.map((function(e){return f.a.createElement(xe.b,Object.assign({key:e.time},e))})))});!function(e){e.addWorkers="addWorkers"}(Yt||(Yt={}));var xn=n(13),Sn=(n(129),function(e){var t=Object(p.useRef)(null),n=Object(p.useState)({gold:50,resources:50,workers:10}),a=Object(E.a)(n,2),r=a[0],o=a[1],c=Object.keys(e.structures).map((function(t){return function(t){var n=Object(A.b)(t),a=e.structures[t],r=n.levels[a.level],o=k.a.get(r.displayName);return p.createElement("div",{className:"label-dropdown",key:t},p.createElement("label",{title:t},"".concat(o)),p.createElement("input",{key:t,type:"checkbox",checked:e.structures[t].state===kt.Built,onChange:function(){return s(t,e.structures[t].state!==kt.Built)}}))}(t)})),i=function(e){return p.createElement("option",{value:e,key:e},k.a.getItemName(e))},u=Object.keys(Me.b).filter((function(e){return!isNaN(e)})).map((function(e){return p.createElement("optgroup",{label:Me.b[e],key:e},function(e){return Object.keys(Me.a).filter((function(t){return Object(j.b)(t).itemType==e})).map((function(e){return i(e)}))}(e))})),s=function(t,n){e.onCheatStructureState&&e.onCheatStructureState(t,n?kt.Built:kt.NotBuilt),n?Ne.a.addToast("The ".concat(k.a.getStructureName(t)," is constructed"),xe.a.cheat):Ne.a.addToast("The ".concat(k.a.getStructureName(t)," is not constructed"),xe.a.cheat)};return p.createElement("div",{className:"cheat-box"},p.createElement("div",{className:"label-numberbox-button"},p.createElement("label",null,"Gold"),p.createElement("input",{type:"number",value:r.gold,style:{width:"50px"},onChange:function(e){var t=Number(e.target.value);o(Object(xn.a)({},r,{gold:t}))}}),p.createElement("button",{onClick:function(t){var n=r.gold;e.onCheatGold&&e.onCheatGold(n);var a=k.a.get("common-cheat-gold-added",{amount:n});Ne.a.addToast(a,xe.a.cheat,"/img/resources/gold.png")}},"Add")),p.createElement("div",{className:"label-numberbox-button"},p.createElement("label",null,"Workers"),p.createElement("input",{type:"number",value:r.workers,style:{width:"50px"},onChange:function(e){var t=Number(e.target.value);o(Object(xn.a)({},r,{workers:t}))}}),p.createElement("button",{onClick:function(t){var n=r.workers;e.onCheatWorkers&&e.onCheatWorkers(n);var a=k.a.get("common-cheat-workers-added",{amount:n});Ne.a.addToast(a,xe.a.cheat,"/img/resources/worker.png")}},"Add")),p.createElement("div",{className:"label-numberbox-button"},p.createElement("label",null,"Resources"),p.createElement("input",{type:"number",value:r.resources,style:{width:"50px"},onChange:function(e){var t=Number(e.target.value);o(Object(xn.a)({},r,{resources:t}))}}),p.createElement("button",{onClick:function(t){e.onCheatResources&&e.onCheatResources(r.resources);var n=k.a.get("common-cheat-resources-added",{amount:r.resources});Ne.a.addToast(n,xe.a.cheat)}},"Add")),p.createElement("div",{className:"label-numberbox-button"},p.createElement("label",null,"Items"),p.createElement("select",{style:{width:"150px"},ref:t},u),p.createElement("button",{onClick:function(n){var a=t.current.value;e.onCheatItem&&e.onCheatItem(a);var r=k.a.get("common-cheat-item-added",{item:a}),o=Object(j.b)(a).iconImg;Ne.a.addToast(r,xe.a.cheat,o)}},"Add")),c)}),Cn=[b.food,b.wood,b.stone,b.fabric,b.leather],qn=Object(Ft.c)(Object(h.c)((function(e){return{structures:e.structures}}),(function(e){return{onCheatGold:function(t){e(ee(t)),e(Object(y.c)("common-cheat-gold-added",{amount:t},pe.a.common))},onCheatItem:function(t){e(ne(t)),e(Object(y.c)("common-cheat-item-added",{item:t},pe.a.common))},onCheatResources:function(t){var n=Cn.reduce((function(e,n){return e[n]=t,e}),{});e(re(n)),e(Object(y.c)("common-cheat-resources-added",{amount:t},pe.a.common))},onCheatStructureState:function(t,n){return e(function(e,t){return{type:K.setStructureState,structure:e,state:t}}(t,n))},onCheatWorkers:function(t){var n;e((n=t,{type:Yt.addWorkers,value:n})),e(Object(y.c)("common-cheat-workers-added",{amount:t},pe.a.common))}}})),Wt)(Sn),An=(n(245),Object(Ft.c)(Wt)((function(e){return p.createElement("div",{className:"settings-window"},p.createElement("details",{open:!0},p.createElement("summary",null,"Sound"),p.createElement("section",null,p.createElement("p",null,p.createElement("label",null,"Music"),p.createElement("input",{type:"range",min:"0",max:"1",step:"0.05",onChange:function(e){var t=parseFloat(e.target.value),n=Math.pow(t,2);_t.musicVolume=n},defaultValue:"".concat(Math.sqrt(_t.musicVolume))})),p.createElement("p",null,p.createElement("label",null,"Sound"),p.createElement("input",{type:"range",min:"0",max:"1",step:"0.1"})))))}))),Dn=Object(Ft.c)(Wt,it)((function(e){return p.createElement("div",{className:"menu"},p.createElement("p",null,p.createElement("button",{onClick:function(){var t=p.createElement(qn,{title:"Cheats"});e.onOpenWindow(t)}},"Cheats!")),p.createElement("p",null,p.createElement("button",{onClick:function(){var t=p.createElement(An,{title:"Settings"});e.onOpenWindow(t)}},"Settings")))})),Rn=(n(246),n(247),function(){var e=Object(h.e)((function(e){return{gold:e.gold,resources:e.resources,workers:e.workers,workersFree:de(e)}})),t=function(e,t,n){return p.createElement("li",{title:n,key:n},p.createElement("div",{className:"icon common-icon-smallest",style:{backgroundImage:"url(".concat("/gilles-game").concat(e,")")}}),p.createElement("div",{className:"amount"},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=["","k","M","G","T","P","E"],a=Math.log10(e)/3|0;if(0===a)return e.toFixed(t);var r=n[a],o=Math.pow(10,3*a),c=e/o;return c.toFixed(t)+r}(t,0)))},n=Cn.map((function(n){return t(S[n].iconImg,e.resources[n],k.a.getResourceName(n))}));return n.push(t("/img/resources/worker.png",e.workersFree,"workers"),t("/img/resources/gold.png",e.gold,"gold")),p.createElement("ul",{className:"resourcebar"},n)}),Mn=function(){var e=Object(p.useContext)(Ea);return p.createElement("div",{className:"topbar"},p.createElement("div",{className:"topbar-left"},p.createElement(Rn,null)),p.createElement("div",{className:"topbar-right"},p.createElement("div",{className:"hamburger",onClick:function(t){var n=p.createElement(Dn,{title:"Menu"});e.onOpenWindow(n)}},"\u2630")))},Pn=n(14);window.PIXI=mn;var _n=function(e){var t=e.quest,n=e.leader,a=e.encounterActive,r=e.position,o=e.onClick,c=e.selected?"/img/world/map-marker-selected.png":"/img/world/map-marker.png",i=Object(p.useRef)(null);return Object(p.useEffect)((function(){var e=i.current,t=new mn.Graphics;t.beginFill(12245589),t.drawCircle(0,0,256),t.endFill(),e.mask=t,e.addChild(t)}),[i]),f.a.createElement(rn.Sprite,{image:"".concat("/gilles-game").concat(c),name:t.name,x:r.x,y:r.y,interactive:!0,buttonMode:!0,scale:new mn.Point(.1,.1),anchor:new mn.Point(.5,1),pointerdown:function(){o&&o(t)}},n&&f.a.createElement(rn.Sprite,{image:"".concat("/gilles-game").concat(n.avatarImg),name:"avatar",anchor:new mn.Point(.5,.5),x:0,y:-396,scale:new mn.Point(.66,.66),ref:i}),a&&f.a.createElement(rn.Sprite,{image:"".concat("/gilles-game","/img/world/quest-alert.png"),name:"quest-alert",anchor:new mn.Point(.5,1),x:180,y:-396,scale:new mn.Point(2,2)}))},Ln=function(e){var t=e.positions;return e.positions.length>2?f.a.createElement(rn.Graphics,{name:"questline",x:0,y:0,draw:function(e){e.lineStyle(3,16724736),e.moveTo(t[0].x,t[0].y);var n=0;for(n=1;n<t.length-2;n++){var a=(t[n].x+t[n+1].x)/2,r=(t[n].y+t[n+1].y)/2;e.quadraticCurveTo(t[n].x,t[n].y,a,r)}e.quadraticCurveTo(t[n].x,t[n].y,t[n+1].x,t[n+1].y),e.endFill()}}):null},Wn=Object(me.a)([function(e){return e.quests}],(function(e){return e.filter((function(e){return e.status===Te.active})).map((function(e){return e}))}));window.PIXI=mn;var Fn=function(e){var t=e.retrieveWorldViewRef,n=e.smallMap,a=Object(p.useCallback)((function(t){return t.quests.find((function(t){return t.name===e.selectedQuestName}))}),[e.selectedQuestName]),r=Object(h.e)(a),o=Object(h.e)((function(e){return e.adventurers})),c=Object(h.e)((function(e){return Wn(e)})),i=Object(p.useState)(Oa),u=Object(E.a)(i,2),s=u[0],l=u[1],m=Object(p.useState)(1024),d=Object(E.a)(m,2),v=d[0],g=d[1];Object(p.useEffect)((function(){var e=function(){var e,a,r=t(),o=(null===(e=r.current)||void 0===e?void 0:e.clientWidth)||Oa,c=(null===(a=r.current)||void 0===a?void 0:a.clientHeight)||1024;l(o),g(n?o<576?64:128:c)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[t,n]),Object(p.useEffect)((function(){r&&y(r)}),[r,v]);var b=Object(p.useRef)(null);Object(p.useEffect)((function(){if(b.current){var e=b.current,t=Qn({x:0,y:0});e.moveCenter(t.x,t.y)}}),[s]);var y=function(e){var t=b.current;if(t){var n=Bn(e),a=Qn(n);t.moveCenter(a.x,a.y)}};return f.a.createElement(rn.Stage,{width:s,height:v},f.a.createElement(ln,{screenWidth:s,screenHeight:v,worldWidth:1500,worldHeight:1061,ref:b},f.a.createElement(rn.Sprite,{image:"".concat("/gilles-game","/img/world/francesca-baerald-fbaerald-angeloumap-lowres.jpg"),interactive:!0,pointerdown:function(){}},c.map((function(e){var t=Hn(e);return f.a.createElement(Ln,{positions:t,key:e.name})})),c.map((function(t){var n=Bn(t),a=Qn(n),c=Object(wt.b)(o,t),i=Object(ge.b)(t.name),u=Math.floor(t.progress),s=i.nodes[u];return f.a.createElement(_n,{quest:t,leader:c,position:a,key:t.name,selected:t===r,encounterActive:s.type===Pn.a.encounter,onClick:function(t){return n=t.name,void e.onPartyClick(n);var n}})})))))},Bn=function(e){var t=Object(ge.b)(e.name),n=Math.floor(e.progress),a=t.nodes[n],r=t.nodes[n+1];return r?Object(fn.a)(a,r,e.progress-n):a},Qn=function(e){var t=10*e.x+750,n=10*e.y+530.5;return new mn.Point(t,n)},Hn=function(e){for(var t=[],n=Object(ge.b)(e.name),a=0;a<e.progress;a++)t.push(Qn(n.nodes[a]));var r=Qn(Bn(e));return t.push(r),t},Un=(n(248),n(249),n(85));n(95);window.PIXI=mn;var Gn=Object(rn.PixiComponent)("RectTileLayer",{create:function(e){return new window.PIXI.tilemap.CompositeRectTileLayer(0,[e.texture])},applyProps:function(e,t,n){var a=n.layer,r=n.tileset,o=n.horizontalTiles,c=n.spritesheet;if(a.data)for(var i=0;i<a.data.length;i++){var u=r.tilewidth,s=r.tileheight,l=i%o*u,m=Math.floor(i/o)*s;if(a.data[i]>0){var d="".concat(r.name,"-").concat(a.data[i]);e.addFrame(c.textures[d],l,m)}}}});window.PIXI=mn;var Vn,zn=Object(rn.PixiComponent)("ObjectTileLayer",{create:function(e){return new window.PIXI.tilemap.CompositeRectTileLayer(0,[e.texture])},applyProps:function(e,t,n){var a=n.objects,r=n.tileset,o=n.spritesheet;e.clear();for(var c=0;c<a.length;c++){var i=r.tilewidth,u=r.tileheight,s=a[c].location[0]*i,l=a[c].location[1]*u,m="".concat(r.name,"-").concat(a[c].gid);e.addFrame(o.textures[m],s,l)}}}),Xn=function(e){var t=e.basePath,n=e.data,a=e.tileObjects,r=Object(p.useState)(),o=Object(E.a)(r,2),c=o[0],i=o[1],u=Object(p.useState)(),s=Object(E.a)(u,2),l=s[0];s[1];return Object(p.useEffect)((function(){var e=$n(n),r=Kn(n);Object(fn.b)("".concat(t,"/").concat(r.image),(function(t){var o=t.texture;if(o){mn.utils.clearTextureCache();var c=new mn.Spritesheet(o,e);c.parse((function(){var e=n.layers.filter((function(e){return e.visible&&e.type===Un.a.tilelayer})).map((function(e){return Jn(e,o,n.width,r,c)}));e.push(Zn(a,o,r,c)),i(e)}))}}))}),[t,n,a]),f.a.createElement(rn.Container,null,c,l)},Kn=function(e){if(!e.tilesets.length)throw new Error("No tilesets found! Can't continue");if(e.tilesets.length>1&&console.warn("Found more than one tileset. But we currently only support one."),e.tilesets[0].source)throw new Error("Please embed tilemaps in Tiled! Can't continue");return e.tilesets[0]},Jn=function(e,t,n,a,r){return f.a.createElement(Gn,{key:e.name,texture:t,layer:e,horizontalTiles:n,tileset:a,spritesheet:r})},Zn=function(e,t,n,a){return f.a.createElement(zn,{key:"objects",objects:e,texture:t,tileset:n,spritesheet:a})},$n=function(e){for(var t=Kn(e),n=t.columns,a={},r=0;r<t.tilecount;r++){var o=t.tilewidth,c=t.tileheight,i=r%n*o,u=Math.floor(r/n)*c;a["".concat(t.name,"-").concat(r+t.firstgid)]={frame:{x:i,y:u,w:o,h:c},spriteSourceSize:{x:i,y:u,w:o,h:c},rotated:!1,trimmed:!1,sourceSize:{w:o,h:c}}}return{frames:a,meta:{image:t.image,size:{w:t.imagewidth,h:t.imageheight},scale:1}}},Yn=Object(p.forwardRef)((function(e,t){var n=Object(p.useRef)(null);return Object(p.useImperativeHandle)(t,(function(){return{drawAction:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=n.current;if(r){var o=a?65280:16724736;r.clear().lineStyle(3,o).moveTo(e.x,e.y).lineTo(t.x,t.y)}},clear:function(){var e=n.current;null===e||void 0===e||e.clear()}}})),f.a.createElement(rn.Graphics,{name:"ActionPath",ref:n})}));!function(e){e.move="move"}(Vn||(Vn={}));var ea=function(e){var t=e.children,n=Object(gn.a)(e,["children"]);return f.a.createElement(h.b.Consumer,null,(function(e){var a=e.store;return f.a.createElement(rn.Stage,n,f.a.createElement(h.a,{store:a},t))}))},ta=function(e){var t=e.location,n=void 0===t?[0,0]:t,a=e.tileWidth,r=void 0===a?0:a,o=e.tileHeight,c=void 0===o?0:o,i=e.children,u=Object(p.useRef)(null),s=Object(h.d)(),l=Object(p.useCallback)((function(t){var n=t.quests.find((function(t){return t.name===e.controller.questName}));return n.scene.actionQueue?n.scene.actionQueue.filter((function(t){return t.actor===e.actor})):[]}),[e.actor,e.controller.questName]),m=Object(h.e)(l);Object(p.useEffect)((function(){if(u){var t=m[0];if(t)switch(t.actionType){case Vn.move:var n=function(){s(Object(he.b)(e.controller.questName)),e.controller.actorMoved(e.actor,t.target)},a=(t.endsAt-performance.now())/1e3;a<0&&n(),Xt.a.killTweensOf(u.current),Xt.a.to(u.current,{duration:a,ease:"linear",pixi:{x:t.target[0]*r,y:t.target[1]*c},onComplete:n})}}}),[s,r,c,m,e.controller,e.actor]);var d=Object(p.useMemo)((function(){return{x:n[0]*r,y:n[1]*c}}),[n,r,c]),v=d.x,g=d.y;return f.a.createElement(rn.Container,{x:v,y:g,ref:u},i)},na=function(e){var t=Object(p.useCallback)((function(t){return t.quests.find((function(t){return t.name===e}))}),[e]);return Object(h.e)(t)};window.PIXI=mn;var aa,ra=function(e){var t,n=e.controller,a=Object(p.useState)(null),r=Object(E.a)(a,2),o=r[0],c=r[1],i=n.mapData,u=n.basePath,s=Object(h.d)(),l=Object(p.useRef)(null),m=na(e.questName).scene,d=Object(p.useMemo)((function(){var t;return(null===(t=m.actors)||void 0===t?void 0:t.find((function(t){return t.name===e.selectedActor})))||null}),[m.actors,e.selectedActor]),v=function(e){c(null),e.stopPropagation()},g=function(t){var a;if(!(null===(a=m.actionQueue)||void 0===a?void 0:a.length)&&o){e.onLootCacheChanged("chest");var r=n.pointToSceneLocation(new mn.Point(t.data.global.x,t.data.global.y));if(!n.locationIsBlocked(r)){var i,u=n.pointToSceneLocation(t.data.global),l=function(e){return{x:e[0],y:e[1]}},d=o.location,p=null===(i=n.aStar)||void 0===i?void 0:i.findPath(l(d),l(u));null===p||void 0===p||p.forEach((function(t,n){var a={actionType:Vn.move,actor:o.name,target:t,endsAt:500*(n+1)+performance.now()};s(Object(he.c)(e.questName,a))}))}c(null);var f=w.current;null===f||void 0===f||f.clear()}},b=i.width*i.tilewidth,y=i.height*i.tileheight,w=Object(p.useRef)(null);Object(p.useEffect)((function(){var e,t=l.current,a=w.current;if(t&&o&&!(null===(e=m.actionQueue)||void 0===e?void 0:e.length)){var r=o.location,c=function(e){if(t&&a&&i&&o){var c=n.pointToSceneLocation(new mn.Point(e.data.global.x,e.data.global.y)),u=n.locationIsBlocked(c),s=new mn.Point(r[0]*i.tilewidth+i.tilewidth/2,r[1]*i.tileheight+i.tileheight/2);a.drawAction(s,e.data.global,!u)}};return t.on("pointermove",c),function(){t.off("pointermove",c)}}}),[i,o,n,m.actionQueue]);var O=function(t){var a=t.name,r=t.location;return f.a.createElement(ta,{key:a,actor:a,controller:n,tileWidth:i.tilewidth,tileHeight:i.tilewidth,location:r},(null===d||void 0===d?void 0:d.name)===a&&f.a.createElement(rn.Graphics,{name:"selectioncircle",draw:function(e){e.lineStyle(3,16777215),e.drawCircle(i.tilewidth/2,i.tileheight/2,i.tilewidth/2-3),e.endFill()}}),f.a.createElement(rn.Sprite,{y:-80,image:"".concat("/gilles-game","/img/scene/actors/wizard.png"),interactive:!0,pointerdown:function(){return function(t){m.actionQueue&&0!==m.actionQueue.length||c(t),e.setSelectedActor(t.name)}(t)},pointerup:v,pointerupoutside:g}),(null===d||void 0===d?void 0:d.name)===a&&n.actorCanInteract(d.name)&&f.a.createElement(rn.Container,{interactive:!0,pointerdown:function(){n.actorInteract(d.name)}},f.a.createElement(rn.Graphics,{draw:function(e){e.beginFill(14561865),e.drawCircle(i.tilewidth/2,i.tileheight,i.tilewidth/4),e.endFill()}}),f.a.createElement(rn.Sprite,{image:"".concat("/gilles-game","/img/ui/scene/icons/interact.png"),scale:[.3,.3],y:i.tileheight,x:i.tilewidth/2,anchor:.5})))};return f.a.createElement(f.a.Fragment,null,f.a.createElement(ea,{width:b,height:y},f.a.createElement(rn.Container,{ref:l,interactive:!0,hitArea:new mn.Rectangle(0,0,b,y)},f.a.createElement(Xn,{basePath:u,data:i,tileObjects:m.tileObjects}),f.a.createElement(Yn,{ref:w}),null===(t=m.actors)||void 0===t?void 0:t.map((function(e){return O(e)})))),!1)},oa=n(75),ca=function(e){var t=na(e.questName);return t.sceneName?f.a.createElement(ia,Object.assign({},e,{sceneName:t.sceneName,scene:t.scene})):null},ia=function(e){var t=function(e,t){var n=Object(h.f)(),a=Object(p.useMemo)((function(){return oa.a.getSceneController(e,t,n)}),[e,t,n]),r=Object(p.useState)(!1),o=Object(E.a)(r,2),c=o[0],i=o[1],u=n.getState().quests.find((function(t){return t.name===e})).scene;return Object(p.useEffect)((function(){if(t){i(!1);a.loadData((function(){i(!0),u||a.createScene()}))}}),[a,e,u,t]),{controller:a,loaded:c}}(e.questName,e.sceneName),n=t.controller,a=t.loaded;return e.scene&&a&&n.mapData?f.a.createElement(ra,Object.assign({},e,{controller:n})):null},ua=(n(255),n(256),function(e){var t=(e.className||"")+" itemsbox";return p.createElement("ul",{className:t},e.items.map((function(t,n){return p.createElement("li",{key:"".concat(t).concat(n),className:"item"},p.createElement(Be,{item:t,index:n,sourceId:e.sourceId,sourceType:e.sourceType}),k.a.getItemName(t))})))}),sa=function(e){var t=Object(p.useCallback)((function(t){return t.adventurers.find((function(t){return t.id===e}))}),[e]);return Object(h.e)(t)},la=function(e){var t=Object(h.d)(),n=na(e.questName).scene,a=null===n||void 0===n?void 0:n.caches[e.cacheName],r=sa(e.adventurerId);if(!a)return null;return f.a.createElement("div",{className:"lootCache"},f.a.createElement("div",{className:"header"},f.a.createElement("div",{className:"title"},a.title),f.a.createElement("div",{className:"close",onClick:e.onClose})),a.items.length>0&&f.a.createElement("div",{className:"content"},f.a.createElement("div",{className:"items"},f.a.createElement(ua,{items:a.items,sourceType:fe.lootCache,sourceId:e.cacheName})),f.a.createElement("div",{className:"adventurer"},f.a.createElement(be,{adventurer:r}),f.a.createElement("button",{onClick:function(n){n.stopPropagation(),a.items.forEach((function(n){t(ze(e.adventurerId,n))}))}},k.a.get("quest-common-loot-cache-take-all")))),!!a.gold&&f.a.createElement("div",{className:"content"},f.a.createElement("div",{className:"gold"},f.a.createElement("div",{className:"icon common-icon-medium",style:{backgroundImage:"url(".concat("/gilles-game","/img/resources/gold.png)")}}),k.a.get("quest-common-loot-cache-gold",{gold:a.gold})),f.a.createElement("div",{className:"take-gold"},f.a.createElement("button",{onClick:function(n){n.stopPropagation(),t(ee(a.gold||0)),t(Object(he.h)(e.questName,e.cacheName))}},k.a.get("quest-common-loot-cache-take")))))};!function(e){e[e.auto=0]="auto",e[e.vertical=1]="vertical",e[e.horizontal=2]="horizontal"}(aa||(aa={}));var ma,da=function(e){var t,n=Object(Vt.g)(),a=e.layout,r=void 0===a?aa.auto:a,o=Object(h.e)((t=e.questName,Object(me.a)([Ot,Et],(function(e,n){var a=n.find((function(e){return e.name===t}));return Object(wt.a)(e,a)})))),c=Object(p.useState)(),i=Object(E.a)(c,2),u=i[0],s=i[1],l=o[0],m=Object(p.useState)(null===l||void 0===l?void 0:l.id),d=Object(E.a)(m,2),v=d[0],g=d[1],b=Object(p.useMemo)((function(){return o.find((function(e){return e.id===v}))}),[o,v]),y=function(e){g(e)};return Object(p.useEffect)((function(){o.length||n.push(Object(Se.d)())}),[o.length,n]),o.length?f.a.createElement("div",{className:"quest-panel quest-panel-".concat(aa[r])},f.a.createElement("div",{className:"quest-area"},f.a.createElement(ca,{questName:e.questName,selectedActor:v,onLootCacheChanged:function(e){s(e)},setSelectedActor:y}),u&&f.a.createElement("div",{className:"modal",onClick:function(){return s(void 0)}},f.a.createElement(la,{questName:e.questName,cacheName:u,adventurerId:v,onClose:function(){return s(void 0)}}))),f.a.createElement("div",{className:"party-area"},f.a.createElement(gt,{adventurers:o,selectedAdventurerId:v,onAdventurerTabSelected:y,disabled:void 0!==u}),f.a.createElement("div",{className:"adventurer-details"},b&&f.a.createElement(Ze,{adventurer:b})))):null},pa=function(){var e=Object(p.useRef)(null),t=Object(Vt.h)("".concat(Object(Se.d)(),"/:questname")),n=null===t||void 0===t?void 0:t.params.questname,a=Object(Vt.g)();Object(p.useEffect)((function(){_t.addMusicTrack(Nt.world,"sound/music/TheLoomingBattle.ogg"),_t.playMusicTrack(Nt.world)}),[]);return f.a.createElement("div",{className:"world-view",ref:e},f.a.createElement(Fn,{selectedQuestName:n,smallMap:null!=n,onPartyClick:function(e){e===n?a.push(Object(Se.d)()):a.push(Object(Se.a)(e)),_t.playSound(xt.buttonClick)},retrieveWorldViewRef:function(){return e}}),n&&f.a.createElement(da,{questName:n}))};n(257);!function(e){e[e.all=0]="all",e[e.town=1]="town",e[e.quest=2]="quest"}(ma||(ma={}));var fa=function(e){var t=Object(p.useState)(!1),n=Object(E.a)(t,2),a=n[0],r=n[1],o=Object(p.useState)("all"),c=Object(E.a)(o,2),i=c[0],u=c[1],s=Object(h.e)((function(e){return e.log})),l=Object(h.e)((function(e){return Wn(e)})),m=[{label:k.a.get("ui-log-tab-all"),tabId:"all",tabType:ma.all},{label:k.a.get("ui-log-tab-town"),tabId:"town",tabType:ma.town}];l.forEach((function(e){var t=e.name;m.push({channelContext:t,label:k.a.getQuestTitle(t),tabId:"quest-".concat(t),tabType:ma.quest})}));var d=[],f=m.find((function(e){return e.tabId===i}));switch(f.tabType){case ma.all:d=s;break;case ma.town:d=s.filter((function(e){return e.channel===pe.a.town}));break;case ma.quest:d=s.filter((function(e){return e.channel===pe.a.quest&&e.channelContext===f.channelContext}))}var v=m.map((function(e){return p.createElement(lt,{id:e.tabId,key:e.tabId},e.label)}));return p.createElement("div",{className:"log ".concat(a?"expanded":"")},p.createElement("div",{className:"tab-bar"},p.createElement(ht,{className:"tabs",onTabSelected:function(e){u(e)},activeTab:i},v),p.createElement(Dt,{className:"expand-button",onClick:function(){r(!a)},text:a?"\u25bc":"\u25b2"})),p.createElement("div",{className:"log-entries"},d.map((function(e){return function(e){var t=k.a.get(e.key,e.context);return p.createElement("div",{className:"entry",key:e.time},t)}(e)}))))},va=n(72);var ha,ga=Object(h.c)((function(e,t){return{store:e}}),(function(e,t){return{handleStartConstruction:function(t){var n=Object(A.b)(t);e(te(n.cost.gold||0)),e(function(e){return{type:K.startBuildingStructure,structure:e}}(t));var a=[oe(t)],r=n.cost.time,o=se(le.buildStructure,"".concat(t,".build"),"town",r,a);e(o)}}}))((function(e){var t=e.info;switch(t.itemType){case Me.b.deed:var n=e.store.gold,a=t,r=Object(A.b)(a.structure),o=r.cost.gold||0<=n,c=!(e.store.structures[a.structure].state===kt.NotBuilt)||!o;return p.createElement("div",null,p.createElement("p",null,' " ',t.subText,' " '),p.createElement("button",{disabled:c,onClick:function(){return e.handleStartConstruction(a.structure)}},"Start construction (",r.cost.gold," gold)"));case Me.b.weapon:var i=Object(va.c)(t.item);return p.createElement(p.Fragment,null,p.createElement("p",null,' " ',t.subText,' " '),p.createElement("p",null," damage: ",i.damage[va.a.kinetic]," "));case Me.b.apparel:var u=Object(Re.c)(t.item);return p.createElement(p.Fragment,null,p.createElement("p",null,' " ',t.subText,' " '),u.armourRating&&p.createElement("p",null," armour: ",u.armourRating," "));default:return p.createElement("p",null,' " ',t.subText,' " ')}}));n(258);!function(e){e[e.bottom=0]="bottom",e[e.top=1]="top",e[e.left=2]="left",e[e.right=3]="right"}(ha||(ha={}));var ba,ya=function(e){var t=e.children,n=e.referenceRect,a=Object(p.useRef)(null),r=Object(p.useState)(e.placement||ha.bottom),o=Object(E.a)(r,2),c=o[0],i=o[1],u=Object(p.useState)(),s=Object(E.a)(u,2),l=s[0],m=s[1];Object(p.useEffect)((function(){var e=a.current;if(e&&l){var t=e.getBoundingClientRect();switch(c){case ha.top:if(t.top-t.height-8-8<l.top)return void i(ha.bottom);break;case ha.bottom:if(t.top+t.height+8+8>l.height)return void i(ha.top)}e.style.opacity="1";var n=e.querySelector(".tooltip-content");if(t.left<l.left+8){var r=l.left-t.left+8;n.style.transform="translateX(".concat(r,"px)")}else if(t.right>l.right-8){var o=t.right-l.right+8;n.style.transform="translateX(".concat(-o,"px)")}else n.style.transform=""}}),[i,l,c,n]);var d=function(){H.clear()};Object(p.useEffect)((function(){var e,t;return m(null===(e=a.current)||void 0===e||null===(t=e.closest(".app"))||void 0===t?void 0:t.getBoundingClientRect()),window.addEventListener("resize",d),function(){window.removeEventListener("resize",d)}}),[]);var v=0,h=0,g="";if(l)switch(c){case ha.bottom:v=n.left-l.left+n.width/2,h=n.top-l.top+n.height,g="tooltip-bottom";break;case ha.top:v=n.left-l.left+n.width/2,h=n.top-l.top,g="tooltip-top"}return f.a.createElement("div",{className:"tooltip ".concat(g),style:{left:v,opacity:0,top:h},ref:a},f.a.createElement("div",{className:"tooltip-arrow"}),f.a.createElement("div",{className:"tooltip-content"},t))},wa=(n(259),function(e){var t=Object(p.useState)(),n=Object(E.a)(t,2),a=n[0],r=n[1],o=function(e){r(e)};if(Object(p.useEffect)((function(){return H.addEventListener(H.EVENT_CONTEXT_UPDATED,o),function(){H.removeEventListener(H.EVENT_CONTEXT_UPDATED,o)}}),[]),!a)return null;var c,i=a.info;switch(a.type){case N.item:default:c=f.a.createElement(ga,{info:i})}var u=k.a.getItemName(i.item);return f.a.createElement(ya,{referenceRect:a.referenceRect},f.a.createElement("div",{className:"context-tooltip"},f.a.createElement("div",null,u),c))});zt.a.registerPIXI(PIXI),Xt.a.registerPlugin(zt.a),function(e){e[e.Town=0]="Town",e[e.World=1]="World"}(ba||(ba={}));var Oa=960,Ea=Object(p.createContext)(null),ja=function(e){var t=Object(p.useRef)(null),n=Object(p.useState)([]),a=Object(E.a)(n,2),r=a[0],o=a[1],i=Object(p.useState)([]),u=Object(E.a)(i,2),s=u[0],l=u[1],m=function(){_t.playSound(xt.buttonClick)},d=function(e){if(e){var t=k.a.getStructureName(e);f(p.createElement(Qt,{structure:e,title:t})),_t.playSound(xt.buttonClick)}},f=function(e){l([].concat(Object(c.a)(s||[]),[e]))},v=function(){l([])},h=function(){s&&s.length&&l(s.slice(0,-1))};return Object(p.useEffect)((function(){var e=Jt()((function(){H.clear()}),100);return window.addEventListener("scroll",e),window.addEventListener("wheel",e),function(){window.removeEventListener("resize",e),window.removeEventListener("wheel",e)}}),[]),p.createElement(Ea.Provider,{value:{media:r,onOpenWindow:f,onCloseWindow:v}},p.createElement("div",{className:"app",ref:t,style:{maxWidth:Oa},onClick:function(){H.clear()}},p.createElement(Ut.a,{backend:Gt.a},p.createElement(ct.a,null,p.createElement(an,{manifest:Ht,onLoadComplete:function(e){var t,n=e.filter((function(e){return e.mediaType===Bt.sound}));_t.loadMedia(n),_t.addSounds((t={},Object(O.a)(t,xt.buttonClick,"sound/fx/button-click.ogg"),Object(O.a)(t,xt.error,"sound/fx/error.ogg"),t)),o(e)}},p.createElement(Mn,null),p.createElement("div",null,p.createElement(Vt.d,null,p.createElement(Vt.b,{path:"/",exact:!0},p.createElement(Vt.a,{from:"/",to:Object(Se.d)()})),p.createElement(Vt.b,{path:Object(Se.d)()},p.createElement(ct.b,{to:Object(Se.c)()},p.createElement("button",{onClick:function(){return m()}}," ",k.a.get("ui-view-button-town")," "))),p.createElement(Vt.b,{path:Object(Se.c)()},p.createElement(ct.b,{to:Object(Se.d)()},p.createElement("button",{onClick:function(){return m()}}," ",k.a.get("ui-view-button-world")," "))))," | ",p.createElement("button",{"data-for":"global2","data-tip2":!0,onClick:function(){return e.persistor.purge(),void window.location.reload()},style:{color:"red"}}," Restart! ")),p.createElement(Vt.d,null,p.createElement(Vt.b,{path:Object(Se.c)(),render:function(){return p.createElement(kn,{onStructureClick:d})}}),p.createElement(Vt.b,{path:Object(Se.d)(),render:function(){return p.createElement(pa,null)}})),p.createElement(fa,null),function(){if(!s.length)return null;var e=s[s.length-1],t={onClose:v,onBack:h,backEnabled:s.length>1,closeEnabled:!0};return p.cloneElement(e,t)}(),p.createElement(wa,null),p.createElement(Nn,null))))))};var ka,Ta=Object(h.c)((function(e,t){return{}}),(function(e,t){return{}}))(ja),Ia=function(e){var t=Object(A.b)(A.a.warehouse),n=e.structures[A.a.warehouse].level;return t.levels[n].maxResources},Na=function(e,t){var n=t.structures,a={},r=(Date.now()-e)/2e4,o=Ia(t);return r<1?null:(Object.keys(n).forEach((function(e){return function(e){var t=Object(A.b)(e);if(t.type===It.a.resource){var o=t,c=n[e].level,i=o.levels[c];Object.keys(i.generates).reduce((function(t,a){var o=i.generates[a]*n[e].workers*r;return t[a]=(t[a]||0)+o,t}),a)}}(e)})),Object.keys(a).forEach((function(e){a[e]&&t.resources[e]+a[e]>=o[e]&&(a[e]=o[e]-t.resources[e])})),a)},xa=function(e,t){var n=[],a=[],r=t.getState();return r.quests.forEach((function(o){if(o.status===Te.active){var c=ge.a[o.name],i=o.progress,u=Math.floor(i);if(c.nodes[u].type===Pn.a.nothing){for(var s=e/6e4*4,l=Math.min(i+s,c.nodes.length-1),m=Math.floor(l)-u,d=1;d<=m;d++){var p=c.nodes[u+d];if(p.type===Pn.a.encounter){t.dispatch(Object(he.g)(o.name,p.startScene));var f=k.a.getQuestTitle(o.name),v=Object(wt.b)(r.adventurers,o);Ne.a.addToast(f,xe.a.questEncounter,null===v||void 0===v?void 0:v.avatarImg,Object(Se.a)(o.name)),p.log&&n.push({channel:pe.a.quest,channelContext:o.name,key:p.log});break}p.type===Pn.a.nothing&&p.log&&n.push({channel:pe.a.quest,channelContext:o.name,key:p.log})}a.push({name:o.name,progress:l})}}})),{logUpdates:n,questUpdates:a}},Sa=n(145),Ca=n.n(Sa);var qa=!1,Aa=function(){return qa?(qa=!1,ka.state()):null},Da=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ra(){if("serviceWorker"in navigator){if(new URL("/gilles-game",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/gilles-game","/service-worker.js");Da?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Ma(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Ma(e)}))}}function Ma(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Pa,_a=function(){return{strength:100*Math.random(),perception:100*Math.random(),endurance:100*Math.random(),charisma:100*Math.random(),intelligenge:100*Math.random(),agility:100*Math.random(),luck:100*Math.random()}},La=[{id:"c4a5d270",equipment:{chest:Me.a.chest,head:Me.a.cowl},stats:_a(),health:100*Math.random(),room:0,name:"Ximena Maddox",avatarImg:"".concat("/img/avatars","/female/f_14.png"),inventory:[Me.a.deedForLumbermill,null,Me.a.crossbow,Me.a.dagger,Me.a.khopesh,null,Me.a.sword,null,null,null,null,null,null,null,null,null]},{id:"2e655832",equipment:{},stats:_a(),name:"Donte Houston",health:100*Math.random(),room:1,avatarImg:"".concat("/img/avatars","/male/m_05.png"),inventory:[Me.a.crossbow,null,null,null,null,Me.a.boots1,Me.a.chainmailHood,Me.a.nomadHelmet,Me.a.plateChest4,null,null,null,null,null,null,null,null,null,null,null,null,null,Me.a.plateHelmet,Me.a.cowl]},{id:"ec6f1050",equipment:{},stats:_a(),name:"Zackary Morris",health:100*Math.random(),room:2,avatarImg:"".concat("/img/avatars","/male/m_09.png"),inventory:[Me.a.greatswordOfGwai,null,null,null]},{id:"d299f98a",stats:_a(),equipment:{},name:"Mike Keith",health:100*Math.random(),room:4,avatarImg:"".concat("/img/avatars","/male/m_19.png"),inventory:[null,null,null,null,Me.a.khopesh,Me.a.hornedHelmet]},{id:"96c686c3",equipment:{},stats:_a(),name:"Wayne Monroe",health:100*Math.random(),room:5,avatarImg:"".concat("/img/avatars","/male/m_08.png"),inventory:[null,null,null]},{id:"250d1a9d",stats:_a(),equipment:{},name:"Alexis Ortiz ",health:100*Math.random(),room:9,avatarImg:"".concat("/img/avatars","/female/f_10.png"),inventory:[null,null,null,null,null]},{id:"169384ef",equipment:{},stats:_a(),name:"Karlee Nolan",health:100*Math.random(),room:3,avatarImg:"".concat("/img/avatars","/female/f_16.png"),inventory:[Me.a.greatswordOfGwai,null,null,null]},{id:"f22d66cb",stats:_a(),equipment:{},name:"Gylbarde the Earnest",health:100*Math.random(),room:8,avatarImg:"".concat("/img/avatars","/male/m_09.png"),inventory:[null,null,null,null,null]},{id:"36c686c1",equipment:{},stats:_a(),name:"Lanslet of the Water",health:100*Math.random(),room:6,avatarImg:"".concat("/img/avatars","/male/m_26.png"),inventory:[Me.a.greatswordOfGwai,null,null,null,Me.a.shoulders1,Me.a.fedora,Me.a.greaves2]},{id:"12c613d4",equipment:{},stats:_a(),name:"Tedric the Bold",health:100*Math.random(),room:7,avatarImg:"".concat("/img/avatars","/male/m_33.png"),inventory:[Me.a.greatswordOfGwai,null,null,null]}],Wa={lastTick:Date.now(),lastProducedUpdate:Date.now()},Fa=[null,null,null,Me.a.dagger,Me.a.deedForWeaponsmith,null,Me.a.sandwich,Me.a.sandwich,null,null,Me.a.torch,Me.a.torch,null,Me.a.torch],Ba=function(e,t){if(!t.log.length)return e;var n=t.log.map((function(e){return Object(xn.a)({},e,{time:Date.now()})}));return[].concat(Object(c.a)(n),Object(c.a)(e))},Qa=[{name:"kill10Boars",status:Te.active,party:["c4a5d270","2e655832","ec6f1050","d299f98a"],progress:0,questVars:{},encounterResults:[],icon:"sigil1.png"},{name:"retrieveMagicAmulet",party:[],status:Te.available,progress:0,questVars:{},encounterResults:[],icon:"sigil2.png",reward:{gold:4,items:[Me.a.deedForWeaponsmith]}}],Ha=function(e,t){var n=t.assignedAventurers.filter((function(e){return!!e})).map((function(e){return e.id}));return e.map((function(e){if(e.name===t.questName){var a=Object(ge.b)(t.questName).getInitialQuestVars(e);return Object(xn.a)({},e,{status:Te.active,party:n,questVars:a})}return e}))},Ua=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.progress+1;return Object(xn.a)({},e,{progress:n,scene:void 0,sceneName:void 0})}return e}))},Ga=function(e,t){return e.map((function(e){return e.name===t.questName?Object(xn.a)({},e,{sceneName:t.sceneName}):e}))},Va=function(e,t){return e.map((function(e){return e.name===t.questName?Object(xn.a)({},e,{scene:t.scene}):e}))},za=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.actionQueue=[].concat(Object(c.a)(n.actionQueue||[]),[t.sceneAction]),Object(xn.a)({},e,{scene:n})}return e}))},Xa=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");var a=n.actionQueue[0];if(!a)return e;switch(a.actionType){case Vn.move:n.actors=n.actors.map((function(e){return e.name===a.actor?Object(xn.a)({},e,{location:a.target}):e}))}return n.actionQueue=Object(c.a)(n.actionQueue.slice(1)),Object(xn.a)({},e,{scene:n})}return e}))},Ka=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.tileObjects=n.tileObjects.map((function(e){return e.id===t.id?Object(xn.a)({},e,{},t.object):e})),Object(xn.a)({},e,{scene:n})}return e}))},Ja=function(e,t){var n=t.quests;return n.length?e.map((function(e){var t=n.find((function(t){return t.name===e.name}));if(t){var a=t.progress;return Object(xn.a)({},e,{progress:a})}return e})):e},Za=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=Object.assign({},e.questVars,t.vars);return Object(xn.a)({},e,{questVars:n})}return e}))},$a=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.encounterResults.concat();return n[t.nodeIndex]=t.result,Object(xn.a)({},e,{encounterResults:n})}return e}))},Ya=function(e,t){return e.map((function(e){if(e.name===t.questName&&e.scene){var n,a,r=Object(xn.a)({},null===(n=e.scene)||void 0===n?void 0:n.caches,Object(O.a)({},t.cacheName,Object(xn.a)({},null===(a=e.scene)||void 0===a?void 0:a.caches[t.cacheName],{gold:0})));e.scene.caches=r}return e}))},er=(Pa={},Object(O.a)(Pa,A.a.alchemist,{level:0,workers:1,state:kt.NotBuilt}),Object(O.a)(Pa,A.a.armoursmith,Ct),Object(O.a)(Pa,A.a.garden,{level:0,workers:0,state:kt.Built}),Object(O.a)(Pa,A.a.lumberMill,Ct),Object(O.a)(Pa,A.a.mine,{level:0,workers:0,state:kt.NotBuilt}),Object(O.a)(Pa,A.a.quarry,Ct),Object(O.a)(Pa,A.a.tavern,{level:0,workers:0,state:kt.Built}),Object(O.a)(Pa,A.a.tannery,Ct),Object(O.a)(Pa,A.a.warehouse,{level:0,workers:0,state:kt.Built}),Object(O.a)(Pa,A.a.weaponsmith,{level:0,workers:0,state:kt.Built}),Object(O.a)(Pa,A.a.weaver,Ct),Object(O.a)(Pa,A.a.workshop,Ct),Pa),tr=function(e,t,n){var a=Object(xn.a)({},e[t],{state:n});return Object(xn.a)({},e,Object(O.a)({},t,a))},nr={completed:[],running:[]},ar=function(e){return{name:e.name,origin:e.origin,type:e.taskType,callbacks:e.callbacks,timeRemaining:e.time,startTime:Date.now(),lastTick:Date.now(),progress:0}},rr=Object(Ft.b)({adventurers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:La,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Fe.moveItemInInventory:var n=t,a=n.adventurerId,r=n.fromSlot,o=n.toSlot,c=e.find((function(e){return e.id===a})),i=c.inventory.map((function(e,t){return t===r?c.inventory[o]:t===o?c.inventory[r]:e}));return e.map((function(e){return e===c?Object(xn.a)({},e,{inventory:i}):e}));case Fe.moveItemToOtherAdventurer:var u=t,s=u.adventurerId,l=u.fromSlot,m=u.toAdventurerId,d=e.find((function(e){return e.id===s})),p=d.inventory[l];return e.map((function(e){if(e.id===s){var t=e.inventory.concat();return t[l]=null,Object(xn.a)({},e,{inventory:t})}if(e.id===m){var n=e.inventory.concat(),a=n.findIndex((function(e){return null===e}));return n[a]=p,Object(xn.a)({},e,{inventory:n})}return e}));case Fe.addItemToInventory:var f=t,v=f.item;return e.map((function(e){if(e.id===t.adventurerId){var n=e.inventory.concat(),a=t.toSlot;return null!==a&&void 0!==a||(a=n.findIndex((function(e){return null===e||void 0===e}))),n[a]=v,Object(xn.a)({},e,{inventory:n})}return e}));case Fe.removeItemFromInventory:var h=t,g=h.fromSlot;return e.map((function(e){if(e.id===t.adventurerId){var n=e.inventory.map((function(e,t){return t!==g?e:null}));return Object(xn.a)({},e,{inventory:n})}return e}));case Fe.assignEquipment:var b=t,y=b.equipmentSlot,w=b.item;return e.map((function(e){return e.id===t.adventurerId?Object(xn.a)({},e,{equipment:Object(xn.a)({},e.equipment,Object(O.a)({},Ae[y],w))}):e}));case Fe.removeEquipment:var E=t,j=E.equipmentSlot;return e.map((function(e){return e.id===t.adventurerId?Object(xn.a)({},e,{equipment:Object(xn.a)({},e.equipment,Object(O.a)({},Ae[j],null))}):e}))}return e},combat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.startCombatAction:var n=t;return Object(xn.a)({},e,{action:{actor:n.actor,endsAt:n.endsAt,target:n.target,type:n.combatType}});case a.moveActor:var r=t,o=e.actors.map((function(e){return e.name===r.actor?Object(xn.a)({},e,{location:r.location}):e}));return Object(xn.a)({},e,{actors:o});case a.clearCombatAction:return Object(xn.a)({},e,{action:void 0})}return e},engine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.gameTick:var n=t.resources,a=null===n?e.lastProducedUpdate:Date.now();return Object(xn.a)({},e,{lastProducedUpdate:a,lastTick:Date.now()})}return e},gold:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case V.addGold:return console.log("addgold",t.amount),e+t.amount}return e},stockpile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case z.addItem:var n=t,a=n.item,r=t,o=r.toSlot;return void 0===o&&-1===(o=e.findIndex((function(e){return null===e})))?[].concat(Object(c.a)(e),[a]):e.map((function(e,t){return t===o?a:e}));case z.moveItemInWarehouse:var i=t,u=i.fromSlot,s=i.toSlot;return e.map((function(t,n){return n===u?null:n===s?e[u]:t}));case z.removeItem:var l=t,m=l.fromSlot;return e.map((function(e,t){return t!==m?e:null}))}return e},log:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y.a.addLogEntry:var n=t,a=n.entry,r=n.channel,o=n.channelContext,i=a.key,u=a.context,s=Date.now();return[{channel:r,channelContext:o,context:u,key:i,time:s}].concat(Object(c.a)(e));case l.gameTick:return Ba(e,t)}return e},quests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he.a.launchQuest:return Ha(e,t);case he.a.exitEncounter:return Ua(e,t);case he.a.updateQuestVars:return Za(e,t);case he.a.updateEncounterResult:return $a(e,t);case he.a.setSceneName:return Ga(e,t);case he.a.setScene:return Va(e,t);case he.a.enqueueSceneAction:return za(e,t);case he.a.completeSceneAction:return Xa(e,t);case he.a.updateSceneObjectAction:return Ka(e,t);case he.a.takeGoldFromCache:return Ya(e,t);case l.gameTick:return Ja(e,t)}return e},resources:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft,t=arguments.length>1?arguments[1]:void 0,n=function(t){return Object.keys(e).reduce((function(n,a){return n[a]=e[a]+(t[a]||0),n}),{})};switch(t.type){case X.addResources:var a=t.resources;return n(a);case X.removeResources:var r=t.resources;return Object.keys(e).reduce((function(t,n){return t[n]=e[n]-(r[n]||0),t}),{});case l.gameTick:var o=t.resources;return null===o?e:n(o)}return e},rngState:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===l.gameTick&&null!=t.rngState&&(e=Object.assign({},t.rngState)),e},structures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:er,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case K.startBuildingStructure:return tr(e,t.structure,kt.Building);case K.finishBuildingStructure:return tr(e,t.structure,kt.Built);case K.upgradeStructure:var n=e[t.structure].level+1,a=Object(xn.a)({},e[t.structure],{level:n});return Object(xn.a)({},e,Object(O.a)({},t.structure,a));case K.increaseWorkers:var r=t,o=r.workers,c=e[t.structure].workers+o,i=Object(xn.a)({},e[t.structure],{workers:c});return Object(xn.a)({},e,Object(O.a)({},t.structure,i));case K.decreaseWorkers:var u=t,s=u.workers,l=e[t.structure].workers-s,m=Object(xn.a)({},e[t.structure],{workers:l});return Object(xn.a)({},e,Object(O.a)({},t.structure,m));case K.setStructureState:var d=t,p=d.state;return tr(e,t.structure,p)}return e},tasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case J.start:var n=ar(t),a=e.running.concat(n);return Object(xn.a)({},e,{running:a});case l.gameTick:var r=Date.now(),o=[],c=[];return e.running.forEach((function(e){var t=r+e.timeRemaining,n=(r-e.startTime)/(t-e.startTime),a=e.timeRemaining-(r-e.lastTick),i=Object(xn.a)({},e,{progress:n,lastTick:r,timeRemaining:a});a<0?c.push(i):o.push(i)})),{running:o,completed:c}}return e},workers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:13,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Yt.addWorkers:return e+t.value}return e}}),or=n(103),cr=n(146),ir={key:"root",storage:n.n(cr).a,version:w},ur=Object(or.a)(ir,rr),sr=Object(s.a)(u.a.mark((function e(){var t,n=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",new Promise((function(e,n){var a=Object(Ft.d)(ur,t,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),r=Object(or.b)(a,void 0,(function(){var t=Object(wt.c)(a.getState());e({store:a,persistor:r,isHydrated:t})}))})));case 2:case"end":return e.stop()}}),e)}))),lr=function(e,t){e.completed.forEach((function(e){return function(e){switch(e.callbacks.forEach((function(e){return t(e)})),e.type){case le.craftItem:var n=e.name,a=k.a.get("common-item-crafted",{item:n}),r=Object(j.b)(n);Ne.a.addToast(a,xe.a.itemCrafted,r.iconImg)}}(e)}))},mr=(n(270),function(){var e=Object(s.a)(u.a.mark((function e(){var t,n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(fn.c)("".concat("/gilles-game","/lang/en-US.json"));case 2:return t=e.sent,k.a.init(t.data),o="GILLESROX2",qa=!0,ka=Ca()(o,{state:!0}),e.next=7,sr();case 7:n=e.sent,a=n.store,r=n.persistor,n.isHydrated?pr(a):dr(a),fr(a,r);case 13:case"end":return e.stop()}var o}),e)})));return function(){return e.apply(this,arguments)}}()),dr=function(e){e.dispatch(Object(y.c)("test-game-welcome")),console.log("Starting new GILLES-IDLE-GAME (version ".concat("0.0.5",")"))},pr=function(e){console.log("Continuing existing GILLES-IDLE-GAME (version ".concat("0.0.5",")"))},fr=function(e,t){v.render(p.createElement(h.a,{store:e},p.createElement(Ta,{persistor:t})),document.getElementById("root")),Ra();setInterval((function(){var t=e.getState(),n=Date.now()-t.engine.lastTick,a=[],r=Na(t.engine.lastProducedUpdate,t),o=Aa();d(n,e);var i=xa(n,e),u=i.questUpdates,s=i.logUpdates;a.push.apply(a,Object(c.a)(s)),e.dispatch(function(e,t,n,a,r){return{type:l.gameTick,delta:e,rngState:t,resources:n,quests:a,log:r}}(n,o,r,u,a)),lr(t.tasks,e.dispatch)}),2500)};mr()},function(e,t,n){"use strict";n.r(t),n.d(t,"DungeonEntranceSceneController",(function(){return N})),n.d(t,"DungeonHallwaySceneController",(function(){return x}));var a=n(18),r=n(19),o=n(51),c=n(77),i=n(26),u=n(27),s=n(13),l=n(85),m=function(e){if(e)return e.reduce((function(e,t){return e[t.name]=t.value,e}),{})},d=function(e,t){return e[0]===t[0]&&e[1]===t[1]},p=n(47),f=n(50),v=n(144),h=n(24),g=n(32),b=n(35),y=n(23),w=n(9),O=n(31),E=n(43),j=n(21),k=n(1),T=function(){function e(t,n){Object(a.a)(this,e),this.mapData=void 0,this.aStar=void 0,this.questName=void 0,this.tilemapObjects=void 0,this.jsonPath=void 0,this.store=void 0,this.blockedTiles=[],this.store=t,this.questName=n}return Object(r.a)(e,[{key:"loadData",value:function(e){var t=this;if(this.dataLoaded)return e();if(!this.jsonPath)throw new Error("No jsonPath defined!");Object(f.b)("".concat("/gilles-game","/").concat(this.jsonPath),(function(n){t.mapData=n.data,t.tilemapObjects=function(e){var t=e.layers.filter((function(e){return e.type===l.a.objectgroup})),n={};return t.forEach((function(t){t.objects.reduce((function(t,n){var a=n.x,r=n.y;"tileobject"===n.type&&(r-=n.height);var o=[a/e.tilewidth,r/e.tileheight],c=m(n.properties),i=Object(s.a)({location:o,ezProps:c},n);return t["".concat(o[0],",").concat(o[1])]=i,t}),n)})),n}(n.data),t.mapData.layers.filter((function(e){return e.visible})).forEach((function(e){e.properties&&e.properties.some((function(e){return"blocksMovement"===e.name&&!0===e.value}))&&function(e,t,n){t.data.reduce((function(e,t,a){if(t>0){var r=a%n,o=Math.floor(a/n);e.push([r,o])}return e}),e)}(t.blockedTiles,e,e.width)})),t.aStar=t.createAStar(),e()}))}},{key:"createScene",value:function(){var e={tileObjects:this.createTileObjects(),actors:this.createActors(),caches:{chest:{title:"test-title",gold:3,items:[k.a.savageStaff,k.a.savageStaff,k.a.savageStaff,k.a.shoulders1]}}};this.store.dispatch(Object(h.f)(this.questName,e))}},{key:"actorMoved",value:function(e,t){var n,a=this.tilemapObjects["".concat(t[0],",").concat(t[1])];if(a&&"exit"===a.type)if(null===(n=a.ezProps)||void 0===n?void 0:n.loadScene)this.store.dispatch(Object(h.g)(this.questName,a.ezProps.loadScene));else{var r=Math.floor(this.getQuest().progress)+1,o=Object(E.b)(this.questName).nodes[r];o.log&&this.store.dispatch(Object(O.c)(o.log,null,j.a.quest,this.questName)),this.store.dispatch(Object(h.d)(this.questName))}}},{key:"actorCanInteract",value:function(e){var t=this.getQuest().scene,n=null===t||void 0===t?void 0:t.actors.find((function(t){return t.name===e}));return!!(null===t||void 0===t?void 0:t.tileObjects.find((function(e){return d(e.location,n.location)})))}},{key:"actorInteract",value:function(e){if(this.actorCanInteract(e)){var t=this.getQuest().scene,n=null===t||void 0===t?void 0:t.actors.find((function(t){return t.name===e})),a=null===t||void 0===t?void 0:t.tileObjects.find((function(e){return d(e.location,n.location)}));a&&"tileobject"===a.type?this.interactWithObject(n,a):console.warn("No object found")}else console.warn("Can't interact")}},{key:"interactWithObject",value:function(e,t){}},{key:"pointToSceneLocation",value:function(e){var t,n;return(null===(t=this.mapData)||void 0===t?void 0:t.tilewidth)&&(null===(n=this.mapData)||void 0===n?void 0:n.tileheight)?[Math.floor(e.x/this.mapData.tilewidth),Math.floor(e.y/this.mapData.tilewidth)]:[0,0]}},{key:"locationIsBlocked",value:function(e){return this.blockedTiles.some((function(t){return d(t,e)}))}},{key:"createAStar",value:function(){for(var e=[],t=0;t<this.mapData.height;t++){for(var n=[],a=0;a<this.mapData.width;a++){var r=[a,t],o=this.locationIsBlocked(r);n.push(o?1:0)}e.push(n)}return new v.AStarFinder({grid:{matrix:e},includeStartNode:!1,heuristic:"Manhatten",weight:0})}},{key:"createActors",value:function(){if(!this.tilemapObjects)throw new Error("No tilemapObjects");var e=this.getAdventurers(),t=Object.values(this.tilemapObjects).filter((function(e){return"adventurerStart"===e.type})).map((function(e){return e.location}));if(e.length>t.length)throw new Error("Not enough objects with 'adventurerStart' property set to true");return e.reduce((function(e,n,a){var r=t[a];return e.push({health:100,location:r,name:n.id}),e}),[])}},{key:"createTileObjects",value:function(){if(!this.tilemapObjects)throw new Error("No tilemapObjects");return Object.values(this.tilemapObjects).filter((function(e){return"tileobject"===e.type})).map((function(e){return{id:e.id,gid:e.gid,location:e.location,name:e.name,type:"tileobject"}}))}},{key:"getQuest",value:function(){var e=this;return this.store.getState().quests.find((function(t){return t.name===e.questName}))}},{key:"getAdventurers",value:function(){var e=this.store.getState(),t=this.getQuest();return Object(p.a)(e.adventurers,t)}},{key:"getAdventurerByActor",value:function(e){return this.store.getState().adventurers.find((function(t){return t.id===e.name}))}},{key:"questUpdate",value:function(e,t){var n=w.a.getTextEntry(e);g.a.addToast(n,b.a.questUpdate,t,Object(y.a)(this.questName)),this.store.dispatch(Object(O.b)(e,j.a.quest,this.questName))}},{key:"basePath",get:function(){return this.jsonPath?"".concat("/gilles-game","/").concat(this.jsonPath.substr(0,this.jsonPath.lastIndexOf("/"))):null}},{key:"dataLoaded",get:function(){return!!this.mapData}}]),e}(),I=n(75),N=function(e){Object(u.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).jsonPath="scenes/ork-dungeon-level1.json",e}return Object(r.a)(n,[{key:"interactWithObject",value:function(e,t){switch(t.name){case"chest":if(33===t.gid){var a,r={key:"quest-common-adventurer-opened-chest",context:{adventurer:null===(a=this.getAdventurerByActor(e))||void 0===a?void 0:a.name}};this.questUpdate(r,"/img/items/misc/chest-02.png"),this.store.dispatch(Object(h.i)(this.questName,t.id,{gid:34}))}}Object(c.a)(Object(o.a)(n.prototype),"interactWithObject",this).call(this,e,t)}}]),n}(T),x=function(e){Object(u.a)(n,e);var t=Object(i.a)(n);function n(){var e;Object(a.a)(this,n);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).jsonPath="scenes/ork-dungeon-level2.json",e}return n}(T);I.a.registerSceneController("kill10Boars","dungeon.entrance",N),I.a.registerSceneController("kill10Boars","dungeon.hallway",x)}],[[149,1,2]]]);
//# sourceMappingURL=main.ae3d6805.chunk.js.map