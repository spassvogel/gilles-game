(this["webpackJsonpgilles-game"]=this["webpackJsonpgilles-game"]||[]).push([[0],[,,function(e,t,n){"use strict";var a,r;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),function(e){e[e.deed=0]="deed",e[e.apparel=1]="apparel",e[e.material=2]="material",e[e.questItem=3]="questItem",e[e.trinket=4]="trinket",e[e.weapon=5]="weapon"}(a||(a={})),function(e){e.deedForLumbermill="deedForLumbermill",e.deedForWeaponsmith="deedForWeaponsmith",e.boots1="boots1",e.boots2="boots2",e.boots3="boots3",e.chainmailHood="chainmailHood",e.chest="chest",e.clothGloves="clothGloves",e.cowl="cowl",e.fedora="fedora",e.druidChest="druidChest",e.druidFeet="druidFeet",e.druidHands="druidHands",e.druidHead="druidHead",e.druidLegs="druidLegs",e.greaves1="greaves1",e.greaves2="greaves2",e.hornedHelmet="hornedHelmet",e.leatherGloves="leatherGloves",e.nomadHelmet="nomadHelmet",e.pants1="pants1",e.pants2="pants2",e.plateChest1="plateChest1",e.plateChest2="plateChest2",e.plateChest3="plateChest3",e.plateChest4="plateChest4",e.plateGloves1="plateGloves1",e.plateGloves2="plateGloves2",e.plateHelmet="plateHelmet",e.platePants="platePants",e.plateShoulders1="plateShoulders1",e.plateShoulders2="plateShoulders2",e.robe="robe",e.shoulders1="shoulders1",e.shoulders2="shoulders2",e.shoulders3="shoulders3",e.vest="vest",e.arrowheads="arrowheads",e.bolts="bolts",e.buckle="buckle",e.chain="chain",e.cogs="cogs",e.gem="gem",e.gunpowder="gunpowder",e.ingot="ingot",e.nails="nails",e.poisonVial="poisonVial",e.ribbon="ribbon",e.rope="rope",e.scales="scales",e.spring="spring",e.thread="thread",e.blueprints="blueprints",e.crate="crate",e.dragonEye="dragonEye",e.dynamite="dynamite",e.eye="eye",e.feather="feather",e.food="food",e.heart="heart",e.horn="horn",e.key="key",e.letters="letters",e.lockPicks="lockPicks",e.oil="oil",e.orcFinger="orcFinger",e.plans="plans",e.purpleGems="purpleGems",e.runestone="runestone",e.sandwich="sandwich",e.teeth="teeth",e.tooth="tooth",e.torch="torch",e.tusk="tusk",e.vase="vase",e.vial="vial",e.weeds="weeds",e.ring="ring",e.magicAmulet="magicAmulet",e.aegisOfValor="aegisOfValor",e.arbalest="arbalest",e.battleAxe="battleAxe",e.berserkerShield="berserkerShield",e.brassKnuckles="brassKnuckles",e.buckler="buckler",e.cleaver="cleaver",e.club="club",e.dagger="dagger",e.flail="flail",e.goldenShield="goldenShield",e.greatswordOfGwai="greatswordOfGwai",e.indomitableCarapace="indomitableCarapace",e.javelin="javelin",e.khopesh="khopesh",e.longbow="longbow",e.mace="mace",e.morningStar="morningStar",e.paintedBuckler="paintedBuckler",e.poisonedDagger="poisonedDagger",e.ravenStaff="ravenStaff",e.savageStaff="savageStaff",e.simpleCrossbow="simpleCrossbow",e.spear="spear",e.steelShield="steelShield",e.sword="sword",e.warhammer="warhammer",e.woodenBulwark="woodenBulwark"}(r||(r={}))},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(22),r=n(27),c=n(56),o=n(53),i=n(2),s=n(82),u=n(47),l=n(13),d=n(39),m=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"init",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.texts=e,this.templates={},t&&this.compileAll(),this.initialized=!0}},{key:"get",value:function(e,t){var n=this.getDefault(e,t);return null===n?(console.error("Key '".concat(e,"' not found in TextManager")),"<<'".concat(e,"' missing>>")):n}},{key:"getDefault",value:function(e,t){if(!this.initialized)throw new Error("Error ".concat(this," not initialized!"));var n=this.getTemplate(e);return n?n(t):null}},{key:"getTextEntry",value:function(e){return this.get(e.key,e.context)}},{key:"getTemplate",value:function(e){var t=this.templates[e];return!t&&this.texts[e]&&(this.compile(e,this.texts[e]),t=this.templates[e]),t}},{key:"getEquipmentSlot",value:function(e){return this.get("ui-equipmentslot-".concat(Object(c.a)(l.a[e])))}},{key:"getQuestTitle",value:function(e){return this.get("quest-".concat(Object(c.a)(e),"-title"))}},{key:"getQuestDescription",value:function(e){return this.get("quest-".concat(Object(c.a)(e),"-description"))}},{key:"getResourceName",value:function(e){return this.get("resource-".concat(e,"-name"))}},{key:"getItemName",value:function(e){var t=i.b[Object(o.a)(e).itemType];return this.get("item-".concat(Object(c.a)(t),"-").concat(Object(c.a)(e),"-name"))}},{key:"getItemSubtext",value:function(e){var t=i.b[Object(o.a)(e).itemType];return this.getDefault("item-".concat(Object(c.a)(t),"-").concat(Object(c.a)(e),"-subtext"))}},{key:"getStructureName",value:function(e){return this.get("structure-".concat(Object(c.a)(e),"-name"))}},{key:"getTraitName",value:function(e){return this.get("trait-".concat(Object(c.a)(e),"-name"))}},{key:"getTraitDescription",value:function(e){return this.get("trait-".concat(Object(c.a)(e),"-description"))}},{key:"getTraitEffect",value:function(e){return this.get("trait-".concat(Object(c.a)(e),"-effect"))}},{key:"getToastType",value:function(e){return this.get("ui-toast-type-".concat(Object(c.a)(u.a[e])))}},{key:"getWeaponType",value:function(e){return this.get("ui-weapon-type-".concat(Object(c.a)(d.c[e])))}},{key:"getSkillName",value:function(e){return this.get("skill-".concat(Object(c.a)(d.c[e]),"-name"))}},{key:"getSkillInfo",value:function(e){return this.get("skill-".concat(Object(c.a)(d.c[e]),"-info"))}},{key:"getWeaponClassification",value:function(e){return this.get("ui-weapon-class-".concat(Object(c.a)(d.b[e])))}},{key:"compileAll",value:function(){var e=this;Object.keys(this.texts).forEach((function(t){e.compile(t,e.texts[t])}))}},{key:"compile",value:function(e,t){var n=s.compile(t);this.templates[e]=n}}]),e}();m.initialized=!1,m.texts=void 0,m.templates=void 0,s.registerHelper("item:name",(function(e,t){if(!Object(o.a)(e))return new s.SafeString("<<ITEM DEFINITION NOT FOUND: ".concat(e,">>"));switch(t){case"aA":return h(e);case"aD":case"aU":return p(e);default:return new s.SafeString(e)}})),s.registerHelper("structure:name",(function(e){var t=m.get("structure-".concat(Object(c.a)(e),"-name"));return new s.SafeString(t)})),s.registerHelper("resource:name",(function(e){var t=m.get("resource-".concat(e,"-name"));return new s.SafeString(t)}));var h=function(e){return b(e)},b=function(e){var t=m.getItemName(e),n=m.getTemplate("common-article-undefined");return new s.SafeString("".concat(n({noun:t})))},p=function(e){var t=m.getItemName(e),n=m.getTemplate("common-article-defined");return new s.SafeString("".concat(n({noun:t})))}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return h}));var a=n(7),r=5e3,c=6e4,o=12e4,i=18e4,s=24e4,u=30*c,l=60*c,d=24*l,m=265.25*d,h=function(e,t){var n=[{unit:t?"y":"year",amount:m},{unit:t?"d":"day",amount:d},{unit:t?"h":"hour",amount:l},{unit:t?"m":"minute",amount:c},{unit:t?"s":"second",amount:1e3}],r=Math.abs(e),o=[];return n.forEach((function(e){var n=Math.floor(r/e.amount);if(r-=n*e.amount,0!==n){var c=a.a.get("common-time-".concat(e.unit).concat(n>1&&!t?"-plural":""));o.push("".concat(n).concat(c))}})),o.join(" ")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return x}));var a,r=n(10),c=n(38),o={type:c.a.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-alchemist-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-alchemist-name",workerCapacity:5,cost:{gold:30,time:r.e},unlocks:[]},{displayName:"structure-alchemist-name",workerCapacity:10,cost:{gold:50,time:r.g},unlocks:[]}]},i=n(2),s={cost:{gold:40,time:4e3},type:c.a.production,levels:[{displayName:"structure-armoursmith-name",workerCapacity:2,cost:{gold:0},unlocks:[i.a.boots1]},{displayName:"structure-armoursmith-name",workerCapacity:5,cost:{gold:30,time:r.e},unlocks:[i.a.chest]},{displayName:"structure-armoursmith-name",workerCapacity:10,cost:{gold:50,time:r.g},unlocks:[i.a.cowl]}]},u={type:c.a.resource,cost:{gold:40,time:4e3},levels:[{displayName:"structure-garden-name",workerCapacity:2,cost:{gold:0},generates:{food:2}},{displayName:"structure-garden-name",workerCapacity:5,cost:{gold:30,time:r.e},generates:{food:4}},{displayName:"structure-garden-name",workerCapacity:10,cost:{gold:50,time:r.g},generates:{food:8}}]},l={type:c.a.resource,cost:{gold:31,time:r.c},levels:[{displayName:"structure-lumber-mill-name",workerCapacity:2,cost:{gold:0},generates:{wood:2}},{displayName:"structure-lumber-mill-name",workerCapacity:5,cost:{gold:30,time:r.e},generates:{wood:2}},{displayName:"structure-lumber-mill-name",workerCapacity:10,cost:{gold:50,time:r.g},generates:{wood:2}}]},d={cost:{gold:40,time:4e3},type:c.a.resource,levels:[{displayName:"structure-mine-name",workerCapacity:2,cost:{gold:0},generates:{iron:2}},{displayName:"structure-mine-name",workerCapacity:5,cost:{gold:30,time:r.e},generates:{iron:2}},{displayName:"structure-mine-name",workerCapacity:10,cost:{gold:50,time:r.g},generates:{iron:2}}]},m={cost:{gold:40,time:4e3},type:c.a.resource,levels:[{displayName:"structure-quarry-name",workerCapacity:2,cost:{gold:0},generates:{stone:2}},{displayName:"structure-quarry-name",workerCapacity:5,cost:{gold:30,time:r.e},generates:{stone:4}},{displayName:"structure-quarry-name",workerCapacity:10,cost:{gold:50,time:r.g},generates:{stone:6}}]},h={cost:{gold:40,time:4e3},type:c.a.resource,levels:[{displayName:"structure-tannery-name",workerCapacity:2,cost:{gold:0},generates:{leather:2}},{displayName:"structure-tannery-name",workerCapacity:5,cost:{gold:30,time:r.e},generates:{leather:5}},{displayName:"structure-tannery-name",workerCapacity:10,cost:{gold:50,time:r.g},generates:{leather:7}}]},b={cost:{gold:40,time:4e3},type:c.a.tavern,levels:[{displayName:"structure-tavern-name",workerCapacity:2,cost:{gold:0},rooms:10},{displayName:"structure-tavern-name",workerCapacity:5,cost:{gold:30,time:r.e},rooms:12},{displayName:"structure-tavern-name",workerCapacity:10,cost:{gold:50,time:r.g},rooms:15}]},p={cost:{gold:40,time:4e3},type:c.a.warehouse,levels:[{displayName:"structure-warehouse-name",workerCapacity:2,cost:{gold:0},maxResources:{fabric:200,food:200,iron:200,leather:200,stone:200,wood:200},maxStockpile:16},{displayName:"structure-warehouse-name",workerCapacity:5,cost:{gold:13,time:r.b},maxResources:{fabric:500,food:500,iron:500,leather:500,stone:500,wood:500},maxStockpile:32},{displayName:"structure-warehouse-name",workerCapacity:10,cost:{gold:50,time:5*r.g},maxResources:{fabric:1e3,food:1e3,iron:1e3,leather:1e3,stone:1e3,wood:1e3},maxStockpile:48}]},j={type:c.a.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-weaponsmith-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:5,cost:{gold:30,time:r.e},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:10,cost:{gold:50,time:r.g},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:14,cost:{gold:50,time:r.f},unlocks:[i.a.poisonedDagger]}]},f={cost:{gold:40,time:4e3},type:c.a.resource,levels:[{displayName:"structure-weaver-name",workerCapacity:2,cost:{gold:0},generates:{fabric:2}},{displayName:"structure-weaver-name",workerCapacity:5,cost:{gold:30,time:r.e},generates:{fabric:5}},{displayName:"structure-weaver-name",workerCapacity:10,cost:{gold:50,time:r.f},generates:{fabric:7}}]},v={type:c.a.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-workshop-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:5,cost:{gold:30,time:r.e},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:10,cost:{gold:50,time:r.g},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:14,cost:{gold:50,time:r.f},unlocks:[]}]},g=n(32);!function(e){e.alchemist="alchemist",e.armoursmith="armoursmith",e.garden="garden",e.lumberMill="lumberMill",e.mine="mine",e.quarry="quarry",e.tavern="tavern",e.tannery="tannery",e.warehouse="warehouse",e.weaponsmith="weaponsmith",e.weaver="weaver",e.workshop="workshop"}(a||(a={}));var O={alchemist:o,armoursmith:s,garden:u,lumberMill:l,mine:d,quarry:m,tavern:b,tannery:h,warehouse:p,weaponsmith:j,weaver:f,workshop:v};function y(e){return O[e]}function x(e){switch(e){case g.a.fabric:return a.weaver;case g.a.food:return a.garden;case g.a.iron:return a.mine;case g.a.leather:return a.tannery;case g.a.stone:return a.quarry;case g.a.wood:return a.lumberMill}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return d}));n(1);var a,r=n(503),c=n(40),o=n(53),i=n(2),s=n(39),u=(n(282),n(0)),l={drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){var n=t.getItem().item;return d(n,e.type)}};!function(e){e[e.feet=0]="feet",e[e.hands=1]="hands",e[e.chest=2]="chest",e[e.legs=3]="legs",e[e.head=4]="head",e[e.shoulders=5]="shoulders",e[e.mainHand=6]="mainHand",e[e.offHand=7]="offHand"}(a||(a={}));var d=function(e,t){switch(t){case a.chest:case a.feet:case a.hands:case a.head:case a.legs:return m(e,t);case a.mainHand:case a.offHand:var n=Object(o.a)(e);if(n.itemType!==i.b.weapon)return!1;switch(s.d[n.weaponType].classification){case s.b.oneHanded:return!0;case s.b.mainHand:return t===a.mainHand;case s.b.offHand:case s.b.shield:return t===a.offHand}return!0;default:return!1}};t.b=Object(r.a)(c.b.ITEM,l,(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,r="grey";return t&&n?r="green":n&&(r="orange"),(0,e.connectDropTarget)(Object(u.jsx)("div",{className:"equipment-slot",style:{borderColor:r},title:a[e.type],children:e.children}))}));var m=function(e,t){var n=Object(o.a)(e);return n.itemType===i.b.apparel&&n.equipmentType===t}},,,,,,,function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.nothing=0]="nothing",e[e.encounter=1]="encounter"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return v}));var a,r,c,o=n(42),i=n.n(o),s=n(3),u=n(58),l=n(22),d=n(27),m=n(88),h=n.n(m),b=n(249),p=n(57),j=n(12);!function(e){e[e.music=0]="music",e[e.ui=1]="ui",e[e.scene=2]="scene"}(a||(a={})),function(e){e[e.singleInstance=0]="singleInstance",e[e.layered=1]="layered",e[e.fade=2]="fade"}(r||(r={})),function(e){e[e.town=0]="town",e[e.world=1]="world"}(c||(c={}));var f="channelVolume",v=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,null,[{key:"init",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,n,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={},e.t0=s.a,e.t1=c,e.t2=a.music,e.next=6,h.a.getItem("".concat(f,"-").concat(a.music));case 6:if(e.t4=t=e.sent,e.t3=null!==e.t4,!e.t3){e.next=10;break}e.t3=void 0!==t;case 10:if(!e.t3){e.next=14;break}e.t5=t,e.next=15;break;case 14:e.t5=0;case 15:return e.t6=e.t5,(0,e.t0)(e.t1,e.t2,e.t6),e.t7=s.a,e.t8=c,e.t9=a.ui,e.next=22,h.a.getItem("".concat(f,"-").concat(a.ui));case 22:if(e.t11=n=e.sent,e.t10=null!==e.t11,!e.t10){e.next=26;break}e.t10=void 0!==n;case 26:if(!e.t10){e.next=30;break}e.t12=n,e.next=31;break;case 30:e.t12=1;case 31:return e.t13=e.t12,(0,e.t7)(e.t8,e.t9,e.t13),e.t14=s.a,e.t15=c,e.t16=a.scene,e.next=38,h.a.getItem("".concat(f,"-").concat(a.scene));case 38:if(e.t18=r=e.sent,e.t17=null!==e.t18,!e.t17){e.next=42;break}e.t17=void 0!==r;case 42:if(!e.t17){e.next=46;break}e.t19=r,e.next=47;break;case 46:e.t19=1;case 47:e.t20=e.t19,(0,e.t14)(e.t15,e.t16,e.t20),this._channelVolume=c,this._initialized=!0;case 51:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addSound",value:function(){var e=Object(u.a)(i.a.mark((function e(t,n,a){var r,c=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"===typeof n&&(n=[n]),!this._sounds[t]){e.next=4;break}return null===a||void 0===a||a(this._sounds[t]),e.abrupt("return");case 4:r=new j.Loader,n.map((function(e){return r.add(e)})),r.load((function(e,n){n&&(c._sounds[t]=Object.values(n).filter(Boolean).map((function(e){return e.sound})),null===a||void 0===a||a(c._sounds[t]))}));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"playSound",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var n,c,o,s,u,l,d,m,h,b,j,f=this,v=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=v.length>1&&void 0!==v[1]?v[1]:a.ui,s=v.length>2&&void 0!==v[2]&&v[2],u=v.length>3&&void 0!==v[3]?v[3]:r.singleInstance,l=v.length>4&&void 0!==v[4]&&v[4],this._initialized){e.next=7;break}return e.next=7,this.init();case 7:return(d=this.getSound(t)).volume=this._channelVolume[o],d.loop=s,(null===(n=this._currentSound[o])||void 0===n?void 0:n.storePosition)&&(m=this._currentSound[o]).instance.once("progress",(function(e,t){f._storedPositions[m.gameSound]=e*t})),h=null!==(c=this._storedPositions[t])&&void 0!==c?c:0,e.next=14,d.play({start:h});case 14:b=e.sent,this._currentSound[o]&&(u===r.fade?(j=this._currentSound[o],p.b.to(j.instance,{volume:0,duration:.75,onComplete:function(){j.instance.destroy()}}),p.b.from(b,{volume:0,duration:.75})):u===r.singleInstance&&this._currentSound[o].instance.stop()),this._currentSound[o]={instance:b,gameSound:t,pixiSound:d,storePosition:l},b.on("end",(function(){f._currentSound[o].instance.destroy(),delete f._currentSound[o]}));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSound",value:function(e){var t;if(!(null===(t=this._sounds[e])||void 0===t?void 0:t.length))throw new Error("No sound found for ".concat(e));return 1===this._sounds[e].length?this._sounds[e][0]:this._sounds[e][Math.floor(Math.random()*this._sounds[e].length)]}},{key:"musicFiltered",set:function(e){this._currentSound[a.music]&&(this._currentSound[a.music].pixiSound.filters=e?[this._filter]:[])}},{key:"getChannelVolume",value:function(e){return this._channelVolume[e]}},{key:"setChannelVolume",value:function(e,t){var n;this._channelVolume[e]=t,(null===(n=this._currentSound[e])||void 0===n?void 0:n.instance)&&(this._currentSound[e].instance.volume=t),h.a.setItem("".concat(f,"-").concat(e),t)}}]),e}();v._sounds={},v._currentSound={},v._storedPositions={},v._channelVolume={},v._initialized=!1,v._filter=new b.a.filters.TelephoneFilter},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var a,r=n(49),c=n(61),o=function(e){return e.type===r.a.actor},i=function(e){return o(e)&&e.allegiance===c.a.player};!function(e){e.move="move",e.interact="interact",e.attack="attack",e.slash="slash"}(a||(a={}));var s=function(e){return Array.from(new Set(e.filter((function(e){return e.properties.isSprite})).map((function(e){return e.properties.spritesheet}))))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a,r,c=n(6),o=n(66),i=(n(1),n(305),n(0));!function(e){e.smallest="smallest",e.small="small",e.medium="medium",e.big="big",e.biggest="biggest"}(a||(a={})),function(e){e.none="none",e.gold="gold"}(r||(r={}));t.b=function(e){var t=e.image,n=e.size,l=e.children,d=e.className,m=void 0===d?"":d,h=e.border,b=void 0===h?"none":h,p=Object(o.a)(e,["image","size","children","className","border"]);return Object(i.jsxs)("div",Object(c.a)(Object(c.a)({className:"icon ".concat(s("string"===typeof n?a[n]:n)," ").concat(m)},p),{},{style:{backgroundImage:"url(".concat(".").concat(t,")")},children:[l,"none"!==b&&b&&Object(i.jsx)("div",{className:"border ".concat(u("string"===typeof b?r[b]:b)," ")})]}))};var s=function e(t){switch(t){case a.smallest:return"size-smallest";case a.small:return"size-small";case a.medium:return"size-medium";case a.big:return"size-big";case a.biggest:return"size-biggest"}return e(a.medium)},u=function(e){switch(e){case r.gold:return"border-gold";case r.none:default:return""}}},,,function(e,t,n){"use strict";var a;function r(e,t){return{type:a.launchQuest,questName:e,assignedAventurers:t}}function c(e){return{type:a.exitEncounter,questName:e}}function o(e,t){return{type:a.updateQuestVars,questName:e,vars:t}}function i(e,t){return{type:a.setSceneName,questName:e,sceneName:t}}function s(e,t){return{type:a.setScene,questName:e,scene:t}}function u(e,t){return{type:a.enqueueSceneAction,questName:e,sceneAction:t}}function l(e){return{type:a.completeSceneAction,questName:e}}function d(e,t){return{type:a.setCombat,questName:e,combat:t}}n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"j",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"f",(function(){return m})),function(e){e.launchQuest="launchQuest",e.updateQuestVars="updateQuestVars",e.updateEncounterResult="updateEncounterResult",e.startEncounter="startEncounter",e.setSceneName="setSceneName",e.setScene="setScene",e.exitEncounter="exitEncounter",e.enqueueSceneAction="enqueueSceneAction",e.completeSceneAction="completeSceneAction",e.setCombat="setCombat",e.deductActorAp="deductActorAp",e.updateSceneObjectAction="updateSceneObjectAction",e.setActiveSceneInteractionModal="setActiveSceneInteractionModal"}(a||(a={}));var m=function(e,t){return{type:a.setActiveSceneInteractionModal,questName:e,sceneInteractionModal:t}}},function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.common=0]="common",e[e.uncommon=1]="uncommon",e[e.rare=2]="rare",e[e.epic=3]="epic",e[e.legendary=4]="legendary"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o}));var a=function(){return"/world"},r=function(e){return"".concat(a(),"/").concat(e)},c=function(){return"/town"},o=function(e){return"".concat(c(),"/").concat(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a,r,c=n(3);!function(e){e.wood="wood",e.iron="iron",e.stone="stone",e.leather="leather",e.fabric="fabric",e.food="food"}(r||(r={}));var o=(a={},Object(c.a)(a,r.wood,{resource:r.wood,iconImg:"/img/resources/wood.png"}),Object(c.a)(a,r.iron,{resource:r.iron,iconImg:"/img/resources/iron.png"}),Object(c.a)(a,r.stone,{resource:r.stone,iconImg:"/img/resources/stone.png"}),Object(c.a)(a,r.leather,{resource:r.leather,iconImg:"/img/resources/leather.png"}),Object(c.a)(a,r.fabric,{resource:r.fabric,iconImg:"/img/resources/fabric.png"}),Object(c.a)(a,r.food,{resource:r.food,iconImg:"/img/resources/food.png"}),a);t.b=o},,,,,,function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.resource=0]="resource",e[e.production=1]="production",e[e.tavern=2]="tavern",e[e.warehouse=3]="warehouse"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return h}));var a,r,c,o,i,s=n(3),u=n(2),l=n(29),d=u.b.weapon,m="/img/items/weapons/";!function(e){e.axe="axe",e.bow="bow",e.club="club",e.crossbow="crossbow",e.fist="fist",e.flail="flail",e.hammer="hammer",e.knife="knife",e.staff="staff",e.shield="shield",e.sword="sword",e.poleArm="poleArm"}(c||(c={})),function(e){e[e.aimedShot=0]="aimedShot",e[e.swing=1]="swing",e[e.block=2]="block",e[e.cut=3]="cut",e[e.cleave=4]="cleave",e[e.shoot=5]="shoot",e[e.slash=6]="slash",e[e.parry=7]="parry"}(o||(o={})),function(e){e[e.oneHanded=0]="oneHanded",e[e.mainHand=1]="mainHand",e[e.offHand=2]="offHand",e[e.twoHanded=3]="twoHanded",e[e.shield=4]="shield"}(i||(i={}));var h,b=(a={},Object(s.a)(a,c.axe,{classification:i.oneHanded,abilities:[o.cut]}),Object(s.a)(a,c.bow,{classification:i.oneHanded,abilities:[o.shoot]}),Object(s.a)(a,c.club,{classification:i.oneHanded,abilities:[o.swing,o.parry]}),Object(s.a)(a,c.crossbow,{classification:i.mainHand,abilities:[o.aimedShot,o.shoot]}),Object(s.a)(a,c.fist,{classification:i.oneHanded,abilities:[o.swing]}),Object(s.a)(a,c.flail,{classification:i.mainHand,abilities:[o.swing,o.parry]}),Object(s.a)(a,c.hammer,{classification:i.oneHanded,abilities:[o.swing,o.parry]}),Object(s.a)(a,c.knife,{classification:i.oneHanded,abilities:[o.cut,o.parry]}),Object(s.a)(a,c.staff,{classification:i.twoHanded,abilities:[o.swing,o.parry]}),Object(s.a)(a,c.sword,{classification:i.oneHanded,abilities:[o.swing,o.parry]}),Object(s.a)(a,c.poleArm,{classification:i.twoHanded,abilities:[o.swing,o.parry]}),Object(s.a)(a,c.shield,{classification:i.shield,abilities:[o.block]}),a);!function(e){e.kinetic="kinetic"}(h||(h={}));var p=(r={},Object(s.a)(r,u.a.aegisOfValor,{item:u.a.aegisOfValor,itemType:d,weaponType:c.shield,rarity:l.a.legendary,iconImg:"".concat(m,"aegis-of-valor.png")}),Object(s.a)(r,u.a.arbalest,{item:u.a.arbalest,itemType:d,weaponType:c.crossbow,rarity:l.a.epic,iconImg:"".concat(m,"arbalest.png"),damage:Object(s.a)({},h.kinetic,40)}),Object(s.a)(r,u.a.battleAxe,{item:u.a.battleAxe,itemType:d,weaponType:c.axe,rarity:l.a.common,iconImg:"".concat(m,"battle_axe.png"),damage:Object(s.a)({},h.kinetic,20)}),Object(s.a)(r,u.a.berserkerShield,{item:u.a.berserkerShield,itemType:d,weaponType:c.shield,rarity:l.a.epic,iconImg:"".concat(m,"berserker-shield.png")}),Object(s.a)(r,u.a.brassKnuckles,{item:u.a.brassKnuckles,itemType:d,weaponType:c.fist,iconImg:"".concat(m,"brass_knuckles.png"),rarity:l.a.common,damage:Object(s.a)({},h.kinetic,10)}),Object(s.a)(r,u.a.buckler,{item:u.a.buckler,itemType:d,weaponType:c.shield,rarity:l.a.common,iconImg:"".concat(m,"buckler.png")}),Object(s.a)(r,u.a.cleaver,{item:u.a.cleaver,itemType:d,weaponType:c.knife,iconImg:"".concat(m,"cleaver.png"),rarity:l.a.common,damage:Object(s.a)({},h.kinetic,5)}),Object(s.a)(r,u.a.club,{item:u.a.club,itemType:d,weaponType:c.club,iconImg:"".concat(m,"club.png"),rarity:l.a.common,damage:Object(s.a)({},h.kinetic,8)}),Object(s.a)(r,u.a.dagger,{item:u.a.dagger,itemType:d,weaponType:c.knife,iconImg:"".concat(m,"dagger.png"),rarity:l.a.uncommon,damage:Object(s.a)({},h.kinetic,8)}),Object(s.a)(r,u.a.flail,{item:u.a.flail,itemType:d,weaponType:c.flail,iconImg:"".concat(m,"flail.png"),rarity:l.a.uncommon,damage:Object(s.a)({},h.kinetic,15)}),Object(s.a)(r,u.a.goldenShield,{item:u.a.goldenShield,itemType:d,weaponType:c.shield,rarity:l.a.rare,iconImg:"".concat(m,"golden-shield.png")}),Object(s.a)(r,u.a.greatswordOfGwai,{item:u.a.greatswordOfGwai,itemType:d,weaponType:c.sword,iconImg:"".concat(m,"greatsword-gwai.png"),unique:!0,rarity:l.a.legendary,damage:Object(s.a)({},h.kinetic,25)}),Object(s.a)(r,u.a.indomitableCarapace,{item:u.a.indomitableCarapace,itemType:d,weaponType:c.shield,rarity:l.a.epic,unique:!0,iconImg:"".concat(m,"indomitable-carapace.png")}),Object(s.a)(r,u.a.javelin,{item:u.a.javelin,itemType:d,weaponType:c.poleArm,iconImg:"".concat(m,"javelin.png"),rarity:l.a.epic,damage:Object(s.a)({},h.kinetic,25)}),Object(s.a)(r,u.a.khopesh,{item:u.a.khopesh,itemType:d,weaponType:c.sword,iconImg:"".concat(m,"khopesh.png"),rarity:l.a.epic,damage:Object(s.a)({},h.kinetic,15)}),Object(s.a)(r,u.a.longbow,{item:u.a.longbow,itemType:d,weaponType:c.bow,iconImg:"".concat(m,"longbow.png"),rarity:l.a.rare,damage:Object(s.a)({},h.kinetic,2)}),Object(s.a)(r,u.a.mace,{item:u.a.mace,itemType:d,weaponType:c.club,iconImg:"".concat(m,"mace.png"),rarity:l.a.rare,damage:Object(s.a)({},h.kinetic,15)}),Object(s.a)(r,u.a.morningStar,{item:u.a.morningStar,itemType:d,weaponType:c.club,iconImg:"".concat(m,"morning-star.png"),rarity:l.a.uncommon,damage:Object(s.a)({},h.kinetic,13)}),Object(s.a)(r,u.a.paintedBuckler,{item:u.a.paintedBuckler,itemType:d,weaponType:c.shield,iconImg:"".concat(m,"painted-buckler.png")}),Object(s.a)(r,u.a.poisonedDagger,{item:u.a.poisonedDagger,itemType:d,weaponType:c.knife,iconImg:"".concat(m,"poisoned-dagger.png"),rarity:l.a.epic,damage:Object(s.a)({},h.kinetic,12)}),Object(s.a)(r,u.a.ravenStaff,{item:u.a.ravenStaff,itemType:d,weaponType:c.staff,iconImg:"".concat(m,"raven-staff.png"),rarity:l.a.epic,damage:Object(s.a)({},h.kinetic,13)}),Object(s.a)(r,u.a.savageStaff,{item:u.a.savageStaff,itemType:d,weaponType:c.staff,iconImg:"".concat(m,"savage-staff.png"),rarity:l.a.epic,damage:Object(s.a)({},h.kinetic,8)}),Object(s.a)(r,u.a.simpleCrossbow,{item:u.a.simpleCrossbow,itemType:d,weaponType:c.crossbow,iconImg:"".concat(m,"crossbow.png"),rarity:l.a.common,damage:Object(s.a)({},h.kinetic,3)}),Object(s.a)(r,u.a.spear,{item:u.a.spear,itemType:d,weaponType:c.poleArm,iconImg:"".concat(m,"sword.png"),rarity:l.a.rare,damage:Object(s.a)({},h.kinetic,10)}),Object(s.a)(r,u.a.steelShield,{item:u.a.steelShield,itemType:d,weaponType:c.shield,rarity:l.a.rare,iconImg:"".concat(m,"steel-shield.png")}),Object(s.a)(r,u.a.sword,{item:u.a.sword,itemType:d,weaponType:c.sword,iconImg:"".concat(m,"sword.png"),rarity:l.a.uncommon,damage:Object(s.a)({},h.kinetic,14)}),Object(s.a)(r,u.a.warhammer,{item:u.a.warhammer,itemType:d,weaponType:c.hammer,iconImg:"".concat(m,"warhammer.png"),rarity:l.a.rare,damage:Object(s.a)({},h.kinetic,16)}),Object(s.a)(r,u.a.woodenBulwark,{item:u.a.woodenBulwark,itemType:d,weaponType:c.shield,rarity:l.a.common,iconImg:"".concat(m,"wooden-bulwark.png")}),r);t.e=p},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var a,r={ADVENTURER:"adventurer",ITEM:"item"};!function(e){e[e.adventurerInventory=0]="adventurerInventory",e[e.warehouse=1]="warehouse",e[e.tavern=2]="tavern",e[e.adventurerEquipment=3]="adventurerEquipment",e[e.lootCache=4]="lootCache"}(a||(a={}))},function(e,t,n){"use strict";var a;function r(e,t,n){return{type:a.moveItemInInventory,adventurerId:e,fromSlot:t,toSlot:n}}function c(e,t,n){return{type:a.addItemToInventory,adventurerId:e,item:t,toSlot:n}}function o(e,t){return{type:a.removeItemFromInventory,adventurerId:e,fromSlot:t}}function i(e,t,n){return{type:a.assignEquipment,adventurerId:e,item:n,equipmentSlot:t}}function s(e,t){return{type:a.removeEquipment,adventurerId:e,equipmentSlot:t}}function u(e,t){return{type:a.renameAdventurer,adventurerId:e,name:t}}n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return u})),function(e){e.moveItemInInventory="moveItemInInventory",e.moveItemToOtherAdventurer="moveItemToOtherAdventurer",e.moveItemFromWarehouseToAdventurer="moveItemFromWarehouseToAdventurer",e.addItemToInventory="addItemToInventory",e.removeItemFromInventory="removeItemFromInventory",e.assignEquipment="assignEquipment",e.removeEquipment="removeEquipment",e.renameAdventurer="renameAdventurer",e.addXP="addXP"}(a||(a={}))},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return h}));var a=n(35),r=n(22),c=n(27),o=n(34),i=n(33),s=n(10),u=n(80),l=n.n(u),d=n(21),m="toast",h=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,null,[{key:"addToast",value:function(e,t,n,r){var c=this;this.stack=[].concat(Object(a.a)(this.stack),[{time:Date.now(),title:e,type:t,icon:n,link:r}]),this.instance.emit(m,this.stack),d.c.playSound("ui/toast"),setTimeout((function(){c.stack=c.stack.filter((function(e){return Date.now()-e.time<c.lifeTime})),c.instance.emit(m,c.stack)}),this.lifeTime)}},{key:"instance",get:function(){return this._instance}}]),n}(l.a);h._instance=new h,h.stack=[],h.lifeTime=s.a},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(1);var a,r=n(7),c=n(37),o=n(25),i=n(0);!function(e){e[e.achievementUnlocked=0]="achievementUnlocked",e[e.cheat=1]="cheat",e[e.game=2]="game",e[e.itemCrafted=3]="itemCrafted",e[e.questCompleted=4]="questCompleted",e[e.questEncounter=5]="questEncounter",e[e.questLaunched=6]="questLaunched",e[e.questUpdate=7]="questUpdate"}(a||(a={}));t.b=function(e){var t=e.title,n=e.type,s=void 0===n?a.achievementUnlocked:n,u=e.icon,l=void 0===u?"/img/items/quest-items/dragon-eye.png":u,d=e.link,m=Object(c.g)(),h=r.a.getToastType(s);return Object(i.jsxs)("div",{className:"toast ".concat(d?"withlink":""),onClick:function(){d&&m.push(d)},children:[Object(i.jsx)("div",{className:"label type",children:h}),Object(i.jsx)("div",{className:"label title",children:t}),Object(i.jsx)(o.b,{size:"big",image:l,className:"toast-icon",border:"gold"}),Object(i.jsx)("div",{className:"banner"})]})}},function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.common=0]="common",e[e.town=1]="town",e[e.quest=2]="quest"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i}));var a,r=function(e){return e?e.reduce((function(e,t){return e[t.name]=t.value,e}),{}):{}};!function(e){e.adventurerStart="adventurerStart",e.exit="exit",e.actor="actor",e.enemySpawn="enemySpawn"}(a||(a={}));var c=function(e,t){for(var n,a=t.length-1;a>=0&&!((n=t[a]).firstgid<=e);a--);return n},o=function(e,t,n){t.data.reduce((function(e,t,a){if(t>0){var r=a%n,c=Math.floor(a/n);e.push([r,c])}return e}),e)},i=function(e,t){return e[0]===t[0]&&e[1]===t[1]}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var a,r,c,o=n(6),i=n(128),s=n(11),u=n(2),l=u.b.deed,d={deedForLumbermill:{item:u.a.deedForLumbermill,structure:s.a.lumberMill,itemType:l,iconImg:"/img/items/deeds/deed.png"},deedForWeaponsmith:{item:u.a.deedForWeaponsmith,structure:s.a.weaponsmith,itemType:l,iconImg:"/img/items/deeds/deed.png"}},m=n(3),h=u.b.material,b="/img/items/materials/",p=(a={},Object(m.a)(a,u.a.arrowheads,{item:u.a.arrowheads,itemType:h,iconImg:"".concat(b,"arrowheads.png")}),Object(m.a)(a,u.a.bolts,{item:u.a.bolts,itemType:h,iconImg:"".concat(b,"bolts.png")}),Object(m.a)(a,u.a.buckle,{item:u.a.buckle,itemType:h,iconImg:"".concat(b,"buckle.png")}),Object(m.a)(a,u.a.chain,{item:u.a.chain,itemType:h,iconImg:"".concat(b,"chain.png")}),Object(m.a)(a,u.a.cogs,{item:u.a.cogs,itemType:h,iconImg:"".concat(b,"cogs.png")}),Object(m.a)(a,u.a.gem,{item:u.a.gem,itemType:h,iconImg:"".concat(b,"gem.png")}),Object(m.a)(a,u.a.ingot,{item:u.a.ingot,itemType:h,iconImg:"".concat(b,"ingot.png")}),Object(m.a)(a,u.a.nails,{item:u.a.nails,itemType:h,iconImg:"".concat(b,"nails.png")}),Object(m.a)(a,u.a.poisonVial,{item:u.a.poisonVial,itemType:h,iconImg:"".concat(b,"poison-vial.png")}),Object(m.a)(a,u.a.ribbon,{item:u.a.ribbon,itemType:h,iconImg:"".concat(b,"ribbon.png")}),Object(m.a)(a,u.a.rope,{item:u.a.rope,itemType:h,iconImg:"".concat(b,"rope.png")}),Object(m.a)(a,u.a.gem,{item:u.a.gem,itemType:h,iconImg:"".concat(b,"gem.png")}),Object(m.a)(a,u.a.gunpowder,{item:u.a.gunpowder,itemType:h,iconImg:"".concat(b,"gunpowder.png")}),Object(m.a)(a,u.a.scales,{item:u.a.scales,itemType:h,iconImg:"".concat(b,"scales.png")}),Object(m.a)(a,u.a.spring,{item:u.a.spring,itemType:h,iconImg:"".concat(b,"spring.png")}),Object(m.a)(a,u.a.thread,{item:u.a.thread,itemType:h,iconImg:"".concat(b,"thread.png")}),a),j=u.b.questItem,f="/img/items/quest-items/",v=(r={},Object(m.a)(r,u.a.blueprints,{item:u.a.blueprints,itemType:j,iconImg:"".concat(f,"blueprints.png")}),Object(m.a)(r,u.a.crate,{item:u.a.crate,itemType:j,iconImg:"".concat(f,"crate.png")}),Object(m.a)(r,u.a.dynamite,{item:u.a.dynamite,itemType:j,iconImg:"".concat(f,"dynamite.png")}),Object(m.a)(r,u.a.dragonEye,{item:u.a.dragonEye,itemType:j,iconImg:"".concat(f,"dragon-eye.png")}),Object(m.a)(r,u.a.eye,{item:u.a.eye,itemType:j,iconImg:"".concat(f,"eye.png")}),Object(m.a)(r,u.a.feather,{item:u.a.feather,itemType:j,iconImg:"".concat(f,"feather.png")}),Object(m.a)(r,u.a.food,{item:u.a.food,itemType:j,iconImg:"".concat(f,"food.png")}),Object(m.a)(r,u.a.heart,{item:u.a.heart,itemType:j,iconImg:"".concat(f,"heart.png")}),Object(m.a)(r,u.a.horn,{item:u.a.horn,itemType:j,iconImg:"".concat(f,"horn.png")}),Object(m.a)(r,u.a.key,{item:u.a.key,itemType:j,iconImg:"".concat(f,"key.png")}),Object(m.a)(r,u.a.letters,{item:u.a.letters,itemType:j,iconImg:"".concat(f,"letters.png")}),Object(m.a)(r,u.a.lockPicks,{item:u.a.lockPicks,itemType:j,iconImg:"".concat(f,"lock-picks.png")}),Object(m.a)(r,u.a.oil,{item:u.a.oil,itemType:j,iconImg:"".concat(f,"oil.png")}),Object(m.a)(r,u.a.orcFinger,{item:u.a.orcFinger,itemType:j,iconImg:"".concat(f,"orc-finger.png")}),Object(m.a)(r,u.a.plans,{item:u.a.plans,itemType:j,iconImg:"".concat(f,"plans.png")}),Object(m.a)(r,u.a.purpleGems,{item:u.a.purpleGems,itemType:j,iconImg:"".concat(f,"purple-gems.png")}),Object(m.a)(r,u.a.runestone,{item:u.a.runestone,itemType:j,iconImg:"".concat(f,"runestone.png")}),Object(m.a)(r,u.a.sandwich,{item:u.a.sandwich,itemType:j,iconImg:"".concat(f,"sandwich.png")}),Object(m.a)(r,u.a.teeth,{item:u.a.teeth,itemType:j,iconImg:"".concat(f,"teeth.png")}),Object(m.a)(r,u.a.tooth,{item:u.a.tooth,itemType:j,iconImg:"".concat(f,"tooth.png")}),Object(m.a)(r,u.a.torch,{item:u.a.torch,itemType:j,iconImg:"".concat(f,"torch.png")}),Object(m.a)(r,u.a.tusk,{item:u.a.tusk,itemType:j,iconImg:"".concat(f,"tusk.png")}),Object(m.a)(r,u.a.vase,{item:u.a.vase,itemType:j,iconImg:"".concat(f,"vase.png")}),Object(m.a)(r,u.a.vial,{item:u.a.vial,itemType:j,iconImg:"".concat(f,"vial.png")}),Object(m.a)(r,u.a.weeds,{item:u.a.weeds,itemType:j,iconImg:"".concat(f,"weeds.png")}),r),g=u.b.trinket,O="/img/items/trinkets/",y=(c={},Object(m.a)(c,u.a.magicAmulet,{item:u.a.magicAmulet,itemType:g,iconImg:"".concat(O,"magic_amulet.png")}),Object(m.a)(c,u.a.ring,{item:u.a.ring,itemType:g,iconImg:"".concat(O,"ring.png")}),c),x=n(39),w=Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)({},d),i.a),p),v),y),x.e);function k(e){return w[e]}},,,,,,,,function(e,t,n){"use strict";var a,r;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c})),function(e){e[e.player=0]="player",e[e.enemy=1]="enemy"}(a||(a={})),function(e){e.move="move",e.slash="slash",e.shoot="shoot"}(r||(r={}));var c={actors:[{allegiance:a.player,health:100,location:[3,5],name:"c4a5d270",remainingAP:5},{allegiance:a.player,health:100,location:[4,6],name:"2e655832",remainingAP:4}],turn:a.player}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(20),r=n(133),c={getQuestVars:function(e){return e.questVars},getInitialQuestVars:function(e){return r.a},nodes:[{x:0,y:1,type:a.a.nothing,log:"quest-kill10-boars-node0"},{x:0,y:3,type:a.a.encounter,startScene:"dungeon.entrance"},{x:1,y:3,type:a.a.nothing,log:"quest-kill10-boars-leave-dungeon"},{x:1,y:3,type:a.a.nothing,log:"quest-kill10-boars-left-dungeon"},{x:2,y:3,type:a.a.nothing},{x:3,y:3,type:a.a.encounter,startScene:"dungeon.hallway"},{x:4,y:4,type:a.a.nothing,log:"The party spots a boss"},{x:5,y:4,type:a.a.nothing}]},o=n(2),i={kill10Boars:c,retrieveMagicAmulet:{getQuestVars:function(e){return e.questVars},getInitialQuestVars:function(e){return{baz:!1,zux:13}},requiredItems:[o.a.torch,o.a.torch,o.a.torch,o.a.sandwich,o.a.sandwich],nodes:[{x:0,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:2,y:1,type:a.a.nothing},{x:3,y:1,type:a.a.nothing},{x:4,y:1,type:a.a.nothing},{x:5,y:1,type:a.a.nothing},{x:7,y:1,type:a.a.nothing},{x:8,y:2,type:a.a.nothing},{x:8,y:3,type:a.a.nothing},{x:9,y:3,type:a.a.nothing},{x:10,y:1,type:a.a.nothing},{x:10,y:2,type:a.a.nothing},{x:10,y:3,type:a.a.nothing},{x:10,y:4,type:a.a.nothing},{x:11,y:5,type:a.a.nothing},{x:12,y:6,type:a.a.nothing},{x:12,y:7,type:a.a.nothing},{x:13,y:8,type:a.a.nothing},{x:12,y:8,type:a.a.nothing},{x:12,y:9,type:a.a.nothing},{x:11,y:8,type:a.a.nothing},{x:10,y:8,type:a.a.nothing},{x:9,y:8,type:a.a.nothing},{x:8,y:9,type:a.a.nothing},{x:7,y:8,type:a.a.encounter,startScene:"dungeon.hallway"},{x:8,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:2,y:1,type:a.a.encounter,startScene:"dungeon.hallway"},{x:3,y:1,type:a.a.nothing}]}};function s(e){return i[e]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o}));var a,r=n(48);function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.a.common,c=arguments.length>3?arguments[3]:void 0,o={key:e,context:t};return{type:a.addLogEntry,entry:o,channel:n,channelContext:c}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.a.common,n=arguments.length>2?arguments[2]:void 0;return{type:a.addLogEntry,entry:e,channel:t,channelContext:n}}!function(e){e.addLogEntry="addLogEntry"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return i}));var a=function(e,t){return t.party.map((function(t){return c(e,t)}))},r=function(e,t){var n=t.party[0];return c(e,n)},c=function(e,t){return e.find((function(e){return e.id===t}))},o=function(e){return e.inventory.filter((function(e){return null===e})).length},i=function(e){return void 0!==(null===e||void 0===e?void 0:e.engine.gameStarted)}},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(42),r=n.n(a),c=n(58),o=function(e,t,n){return e+n*(t-e)},i=function(e,t,n){return{x:o(e.x,t.x,n),y:o(e.y,t.y,n)}};function s(e){return u.apply(this,arguments)}function u(){return(u=Object(c.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=PIXI.Loader.shared,e.abrupt("return",new Promise((function(e,a){n.resources[t]?e(n.resources[t]):n.add(t).load((function(n,r){r[t]?e(r[t]):a()}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var l=function(e,t){var n=PIXI.Loader.shared;n.resources[e]?t(n.resources[e]):n.add(e).load((function(n,a){t(a[e])}))}},,,,,function(e,t,n){"use strict";var a;function r(e){return{type:a.addGold,amount:e}}function c(e){return{type:a.addGold,amount:-e}}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c})),function(e){e.addGold="addGold"}(a||(a={}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var a,r,c;n.d(t,"a",(function(){return a})),function(e){e.tilelayer="tilelayer",e.objectgroup="objectgroup"}(a||(a={})),function(e){e.orthagonal="orthagonal",e.isometric="isometric",e.staggered="staggered",e.hexagonal="hexagonal"}(r||(r={})),function(e){e.rightUp="right-up",e.rightDown="right-down",e.leftUp="left-up",e.leftDown="left-down"}(c||(c={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(22),r=n(27),c=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"registerSceneController",value:function(e,t,n){this.controllerTypes["".concat(e,".").concat(t)]=n}},{key:"getSceneController",value:function(e,t,n){if(!this.store["".concat(e,".").concat(t)]){if(!this.controllerTypes["".concat(e,".").concat(t)])throw new Error("No controller registered for ".concat(e,".").concat(t));this.store["".concat(e,".").concat(t)]=new(this.controllerTypes["".concat(e,".").concat(t)])(n,e)}return this.store["".concat(e,".").concat(t)]}},{key:"destroySceneConroller",value:function(e,t){delete this.store["".concat(e,".").concat(t)]}}]),e}();c.store={},c.controllerTypes={},n(502)},,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return l}));var a,r=n(3),c=n(2),o=n(13),i=c.b.apparel,s="/img/items/apparel/",u=(a={},Object(r.a)(a,c.a.boots1,{item:c.a.boots1,equipmentType:o.a.feet,itemType:i,iconImg:"".concat(s,"boots_1.png")}),Object(r.a)(a,c.a.boots2,{item:c.a.boots2,equipmentType:o.a.feet,itemType:i,damageReduction:1,iconImg:"".concat(s,"boots_2.png")}),Object(r.a)(a,c.a.boots3,{item:c.a.boots3,equipmentType:o.a.feet,itemType:i,damageReduction:2,iconImg:"".concat(s,"boots_3.png")}),Object(r.a)(a,c.a.chainmailHood,{item:c.a.chainmailHood,equipmentType:o.a.head,itemType:i,iconImg:"".concat(s,"chainmail_hood.png"),damageReduction:3}),Object(r.a)(a,c.a.chest,{item:c.a.chest,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(s,"chest_1.png"),damageReduction:2}),Object(r.a)(a,c.a.clothGloves,{item:c.a.clothGloves,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(s,"cloth_gloves.png"),damageReduction:1}),Object(r.a)(a,c.a.cowl,{item:c.a.cowl,equipmentType:o.a.head,itemType:i,iconImg:"".concat(s,"cowl.png"),damageReduction:2}),Object(r.a)(a,c.a.druidChest,{item:c.a.druidHands,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(s,"druid-chest.png")}),Object(r.a)(a,c.a.druidFeet,{item:c.a.druidFeet,equipmentType:o.a.feet,itemType:i,iconImg:"".concat(s,"druid-feet.png")}),Object(r.a)(a,c.a.druidHands,{item:c.a.druidHands,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(s,"druid-hands.png")}),Object(r.a)(a,c.a.druidHead,{item:c.a.druidHead,equipmentType:o.a.head,itemType:i,iconImg:"".concat(s,"druid-head.png")}),Object(r.a)(a,c.a.druidLegs,{item:c.a.druidLegs,equipmentType:o.a.legs,itemType:i,iconImg:"".concat(s,"druid-legs.png")}),Object(r.a)(a,c.a.fedora,{item:c.a.fedora,equipmentType:o.a.head,itemType:i,iconImg:"".concat(s,"fedora.png")}),Object(r.a)(a,c.a.greaves1,{item:c.a.greaves1,equipmentType:o.a.feet,itemType:i,iconImg:"".concat(s,"greaves_1.png"),damageReduction:2}),Object(r.a)(a,c.a.greaves2,{item:c.a.greaves2,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(s,"greaves_2.png")}),Object(r.a)(a,c.a.hornedHelmet,{item:c.a.hornedHelmet,equipmentType:o.a.head,itemType:i,iconImg:"".concat(s,"horned_helmet.png")}),Object(r.a)(a,c.a.leatherGloves,{item:c.a.leatherGloves,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(s,"leather_gloves.png")}),Object(r.a)(a,c.a.nomadHelmet,{item:c.a.nomadHelmet,equipmentType:o.a.head,itemType:i,iconImg:"".concat(s,"nomad_helmet.png")}),Object(r.a)(a,c.a.pants1,{item:c.a.pants1,equipmentType:o.a.legs,itemType:i,iconImg:"".concat(s,"pants_1.png"),damageReduction:3}),Object(r.a)(a,c.a.pants2,{item:c.a.pants2,equipmentType:o.a.legs,itemType:i,iconImg:"".concat(s,"pants_2.png"),damageReduction:3}),Object(r.a)(a,c.a.plateChest1,{item:c.a.plateChest1,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(s,"plate_chest_1.png")}),Object(r.a)(a,c.a.plateChest2,{item:c.a.plateChest2,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(s,"plate_chest_2.png")}),Object(r.a)(a,c.a.plateChest3,{item:c.a.plateChest3,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(s,"plate_chest_3.png")}),Object(r.a)(a,c.a.plateChest4,{item:c.a.plateChest4,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(s,"plate_chest_4.png")}),Object(r.a)(a,c.a.plateGloves1,{item:c.a.plateGloves1,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(s,"plate_gloves_1.png")}),Object(r.a)(a,c.a.plateGloves2,{item:c.a.plateGloves2,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(s,"plate_gloves_2.png")}),Object(r.a)(a,c.a.plateHelmet,{item:c.a.plateHelmet,equipmentType:o.a.head,itemType:i,iconImg:"".concat(s,"plate_helmet_1.png")}),Object(r.a)(a,c.a.platePants,{item:c.a.platePants,equipmentType:o.a.legs,itemType:i,iconImg:"".concat(s,"plate_pants1.png")}),Object(r.a)(a,c.a.plateShoulders1,{item:c.a.plateShoulders1,equipmentType:o.a.shoulders,itemType:i,iconImg:"".concat(s,"plate_shoulders_1.png")}),Object(r.a)(a,c.a.plateShoulders2,{item:c.a.plateShoulders2,equipmentType:o.a.shoulders,itemType:i,iconImg:"".concat(s,"plate_shoulders_2.png")}),Object(r.a)(a,c.a.robe,{item:c.a.robe,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(s,"robe_1.png")}),Object(r.a)(a,c.a.shoulders1,{item:c.a.shoulders1,equipmentType:o.a.shoulders,itemType:i,iconImg:"".concat(s,"shoulders_1.png")}),Object(r.a)(a,c.a.shoulders2,{item:c.a.shoulders2,equipmentType:o.a.shoulders,itemType:i,iconImg:"".concat(s,"shoulders_2.png"),damageReduction:2}),Object(r.a)(a,c.a.shoulders3,{item:c.a.shoulders3,equipmentType:o.a.shoulders,itemType:i,iconImg:"".concat(s,"shoulders_3.png")}),Object(r.a)(a,c.a.vest,{item:c.a.vest,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(s,"vest_1.png")}),a);function l(e){return u[e]}t.a=u},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),r={dungeon:{entered:!1,entrance:{chestOpen:!1,chest:{title:"encounter-dungeon-caches-chest",items:[a.a.nomadHelmet,a.a.teeth,a.a.poisonVial,a.a.fedora],gold:100}},hallway:{chest:{title:"encounter-dungeon-caches-chest",items:[a.a.key]},chestOpen:!1,doorOpen:!1}}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},,,,,,function(e){e.exports=JSON.parse('{"alchemist":[{"shape":[34,18,31,1,37,0]},{"shape":[37,0,53,5,45,17]},{"shape":[45,17,68,27,81,48]},{"shape":[72,67,75,168,11,168]},{"shape":[9,65,1,45,10,30]},{"shape":[31,19,29,5,45,0]},{"shape":[45,0,34,18,37,0]},{"shape":[45,17,81,48,72,67]},{"shape":[72,67,11,168,9,65]},{"shape":[9,65,10,30,31,19]},{"shape":[45,17,72,67,9,65]},{"shape":[9,65,31,19,45,0]},{"shape":[37,0,45,17,9,65]}],"garden":[{"shape":[48,45,48,0,58,0]},{"shape":[57,41,75,56,73,78]},{"shape":[73,78,11,68,2,56]},{"shape":[2,56,13,45,48,45]},{"shape":[48,45,58,0,57,41]},{"shape":[73,78,2,56,48,45]},{"shape":[48,45,57,41,73,78]}],"armoursmith":[{"shape":[53,1,55,0,93,5]},{"shape":[93,5,112,11,120,20]},{"shape":[120,20,124,36,119,49]},{"shape":[119,49,122,156,75,149]},{"shape":[75,149,57,135,33,104]},{"shape":[33,104,10,95,11,52]},{"shape":[11,52,0,35,2,20]},{"shape":[2,20,6,14,27,5]},{"shape":[27,5,53,1,93,5]},{"shape":[93,5,120,20,119,49]},{"shape":[119,49,75,149,33,104]},{"shape":[33,104,11,52,2,20]},{"shape":[2,20,27,5,93,5]},{"shape":[93,5,119,49,33,104]},{"shape":[33,104,2,20,93,5]}],"lumberMill":[{"shape":[32,11,43,1,45,0]},{"shape":[45,0,49,4,37,18]},{"shape":[39,29,50,44,49,48]},{"shape":[38,46,38,230,17,233]},{"shape":[17,233,13,232,13,48]},{"shape":[13,48,3,48,14,28]},{"shape":[14,28,1,7,6,4]},{"shape":[31,18,32,11,45,0]},{"shape":[39,29,49,48,40,43]},{"shape":[38,46,17,233,13,48]},{"shape":[14,28,6,4,19,18]},{"shape":[31,18,45,0,37,18]},{"shape":[37,18,39,29,40,43]},{"shape":[40,43,38,46,13,48]},{"shape":[13,48,14,28,19,18]},{"shape":[31,18,37,18,40,43]},{"shape":[40,43,13,48,19,18]},{"shape":[19,18,31,18,40,43]}],"mine":[{"shape":[15,0,79,1,88,13]},{"shape":[88,13,78,66,27,70]},{"shape":[27,70,2,50,11,27]},{"shape":[11,27,6,13,15,0]},{"shape":[15,0,88,13,27,70]},{"shape":[27,70,11,27,15,0]}],"quarry":[{"shape":[2,24,20,2,22,0]},{"shape":[22,0,103,2,117,15]},{"shape":[117,15,124,24,112,24]},{"shape":[112,24,112,64,104,70]},{"shape":[104,70,104,89,97,88]},{"shape":[97,68,66,67,60,43]},{"shape":[60,43,17,42,17,26]},{"shape":[17,26,2,24,22,0]},{"shape":[22,0,117,15,112,24]},{"shape":[112,24,104,70,97,88]},{"shape":[60,43,17,26,22,0]},{"shape":[112,24,97,88,97,68]},{"shape":[97,68,60,43,22,0]},{"shape":[22,0,112,24,97,68]}],"tannery":[{"shape":[4,2,4,0,61,1]},{"shape":[59,36,89,37,85,79]},{"shape":[85,79,15,77,15,47]},{"shape":[15,47,5,35,0,9]},{"shape":[0,9,4,2,61,1]},{"shape":[59,36,85,79,15,47]},{"shape":[15,47,0,9,61,1]},{"shape":[61,1,59,36,15,47]}],"tavern":[{"shape":[110,27,108,24,112,23]},{"shape":[112,23,151,27,148,60]},{"shape":[148,60,137,71,133,67]},{"shape":[133,67,136,69,132,75]},{"shape":[132,75,137,77,138,124]},{"shape":[131,131,136,136,55,119]},{"shape":[29,64,6,72,0,69]},{"shape":[27,56,76,61,85,67]},{"shape":[101,25,108,13,112,17]},{"shape":[112,17,102,18,104,6]},{"shape":[110,27,112,23,148,60]},{"shape":[132,75,138,124,131,131]},{"shape":[131,131,55,119,59,118]},{"shape":[29,64,0,69,27,56]},{"shape":[112,17,104,6,111,9]},{"shape":[92,27,110,27,148,60]},{"shape":[132,75,131,131,59,118]},{"shape":[50,68,29,64,27,56]},{"shape":[92,27,148,60,133,67]},{"shape":[133,67,132,75,59,118]},{"shape":[50,68,27,56,85,67]},{"shape":[133,67,59,118,56,72]},{"shape":[56,72,50,68,85,67]},{"shape":[133,67,56,72,85,67]},{"shape":[133,67,85,67,89,60]},{"shape":[92,27,133,67,89,60]},{"shape":[92,27,89,60,86,25]},{"shape":[104,0,92,27,86,25]}],"warehouse":[{"shape":[36,414,3,409,2,13]},{"shape":[2,13,31,-7,63,7]},{"shape":[62,197,63,126,65,218]},{"shape":[61,262,83,272,84,459]},{"shape":[84,459,36,414,2,13]},{"shape":[2,13,63,7,62,197]},{"shape":[62,197,65,218,61,262]},{"shape":[61,262,84,459,2,13]},{"shape":[2,13,62,197,61,262]}],"weaponsmith":[{"shape":[52,18,50,2,50,0]},{"shape":[50,0,114,1,109,49]},{"shape":[109,49,115,132,98,129]},{"shape":[98,129,66,95,65,34]},{"shape":[11,33,11,77,0,77]},{"shape":[0,29,18,18,52,18]},{"shape":[52,18,50,0,109,49]},{"shape":[109,49,98,129,65,34]},{"shape":[11,33,0,77,0,29]},{"shape":[52,18,109,49,65,34]},{"shape":[15,27,11,33,0,29]},{"shape":[52,18,65,34,53,26]},{"shape":[15,27,0,29,52,18]},{"shape":[52,18,53,26,15,27]}],"weaver":[{"shape":[51,41,54,0,55,6]},{"shape":[55,41,82,53,87,63]},{"shape":[87,63,86,259,62,254]},{"shape":[62,254,23,212,21,61]},{"shape":[21,61,2,56,51,41]},{"shape":[51,41,55,6,55,41]},{"shape":[55,41,87,63,62,254]},{"shape":[62,254,21,61,51,41]},{"shape":[51,41,55,41,62,254]}],"workshop":[{"shape":[11,2,13,0,68,3]},{"shape":[68,3,77,12,70,14]},{"shape":[70,14,69,38,10,37]},{"shape":[9,13,1,12,11,2]},{"shape":[11,2,68,3,70,14]},{"shape":[70,14,10,37,9,13]},{"shape":[9,13,11,2,70,14]}]}')},function(e){e.exports=JSON.parse('{"alpha":{"start":0.25,"end":0},"scale":{"start":0.04,"end":0.29,"minimumScaleMultiplier":1},"color":{"start":"#85888d","end":"#100f0c"},"speed":{"start":100,"end":200,"minimumSpeedMultiplier":1},"acceleration":{"x":10,"y":-30},"maxSpeed":200,"startRotation":{"min":265,"max":270},"noRotation":false,"rotationSpeed":{"min":8,"max":0},"lifetime":{"min":0.5,"max":3.05},"blendMode":"normal","frequency":0.0005,"emitterLifetime":-1,"maxParticles":300,"pos":{"x":0,"y":0},"addAtBack":true,"spawnType":"point"}')},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,,,,,function(e,t,n){},,,,,,,,,,,function(e,t,n){},,,,function(e,t){},,function(e,t){},,,,,,,,,,function(e,t){},,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},,,,,function(e,t){},,function(e,t){},,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},,,,,,,,function(e,t){},function(e,t,n){},function(e,t,n){"use strict";n.r(t),n.d(t,"runGame",(function(){return lo})),n.d(t,"restartGame",(function(){return uo})),n.d(t,"loadGame",(function(){return so}));var a,r=n(35),c=n(42),o=n.n(c),i=n(58),s=n(1),u=n.n(s),l=n(94),d=n(14),m=n(88),h=n.n(m);!function(e){e.gameTick="gameTick",e.startGame="startGame"}(a||(a={}));var b,p=n(69),j="0.0.6",f=j,v=function(e){var t=e.split(".").map((function(e){return Number(e)}));if(3!==t.length)throw new Error("Received invalid version string: ".concat(e));t.forEach((function(e){if(e>=1024)throw new Error("Version string invalid, ".concat(e," is too large"))}));for(var n=0,a=0;a<3;a++)n|=t[a]<<10*a;return n}(j);!function(e){e.clearCombatAction="clearCombatAction",e.startCombatAction="startCombatAction",e.moveActor="moveActor"}(b||(b={}));var g,O=n(61),y=function(e,t){var n=t.getState().combat;if(n.action&&n.action.endsAt<Date.now())if(n.turn===O.a.enemy);else if(n.turn===O.a.player){switch(n.action.type){case O.b.move:t.dispatch(function(e,t){return{type:b.moveActor,actor:e,location:t}}(n.action.actor,n.action.target)),t.dispatch({type:b.clearCombatAction})}return{action:null}}return null},x=n(18),w=n(507),k=n(263),N=n(63),S=n(37),I=n(506),T=n(57),C=n(21),q=n(7),A=n(251),E=n.n(A),P=n(11),M=n(126),D=n(31);!function(e){e[e.NotBuilt=0]="NotBuilt",e[e.Building=1]="Building",e[e.Built=2]="Built"}(g||(g={}));var R=n(22),H=n(27),L=n(12),W=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";Object(R.a)(this,e),this.shapes=void 0,this.shapes=t[n].map((function(e){var t=e.shape;return new L.Polygon(t)}))}return Object(H.a)(e,[{key:"contains",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(!this.shapes||0===this.shapes.length)&&this.shapes.some((function(n){return n.contains(e,t)}))}}]),e}(),F=n(252),B=n(19),z=n(81),_=n(0),V=function(e){var t=e.hitAreaShapes,n=P.a.lumberMill,a="".concat(".","/img/town/town-alpha/").concat(n,".json"),r=Object(s.useState)(),c=Object(x.a)(r,2),o=c[0],i=c[1],u=e.selected?[je]:[],l=Object(B.useApp)();Object(s.useEffect)((function(){Object(z.b)(a,(function(e){e&&i(e.textures)}))}),[l,l.loader,a]);var d=Object(s.useState)(0),m=Object(x.a)(d,2),h=m[0],b=m[1];return Object(B.useTick)((function(e){return b((function(t){return t+.01*e}))})),o?Object(_.jsx)(B.Sprite,{name:n,position:e.position,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(n)},hitArea:t,filters:u,texture:o["structure.png"],children:Object(_.jsx)(B.Sprite,{name:"blades",texture:o["blades.png"],anchor:new L.Point(.5,.5),x:15,y:10,rotation:h})}):null},G=n(253),Q=n(66),U=n(254),X=Object(B.PixiComponent)("ParticleEmitter",{create:function(){return new L.ParticleContainer},applyProps:function(e,t,n){var a=this,r=n.image,c=n.config,o=Object(Q.a)(n,["image","config"]);Object(B.applyDefaultProps)(e,t,o);var i=this._emitter;if(!i){i=new U.a(e,[L.Texture.from(r)],c);var s=performance.now();i.emit=!0,function e(){a._raf=requestAnimationFrame(e);var t=performance.now();i.update(3e-4*(t-s)),s=t}()}this._emitter=i},willUnmount:function(){this._emitter&&(this._emitter.emit=!1,cancelAnimationFrame(this._raf))}}),Y=function(e){var t=e.hitAreaShapes,n=e.position,a=P.a.tavern,r=e.selected?[je]:[];return Object(_.jsxs)(B.Container,{position:n,children:[Object(_.jsx)(B.Sprite,{name:a,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(a)},filters:r,hitArea:t,image:"".concat(".","/img/town/town-alpha/").concat(a,".png")}),Object(_.jsx)(X,{name:"smoke",x:107,y:-2,image:"".concat(".","/img/town/effects/smokeparticle.png"),config:G})]})},Z=n(6),J=n(34),K=n(33),$=function(e){return function(t){Object(J.a)(a,t);var n=Object(K.a)(a);function a(){return Object(R.a)(this,a),n.apply(this,arguments)}return Object(H.a)(a,[{key:"render",value:function(){var t=this;return Object(_.jsx)(Xr.Consumer,{children:function(n){return Object(_.jsx)(e,Object(Z.a)(Object(Z.a)({},t.props),n))}})}}]),a}(s.Component)},ee=function(e){var t=e.structure,n=e.position,a=e.hitAreaShapes,r=e.selected,c=e.onStructureClick,o=r?[je]:[];return Object(_.jsx)(B.Sprite,{name:t,position:n,interactive:!0,buttonMode:!0,pointertap:function(){c(t)},hitArea:a,filters:o,image:"".concat(".","/img/town/town-alpha/").concat(t,".png")})},te=(n(310),function(e){var t=e.structures,n=[P.a.workshop,P.a.quarry,P.a.tavern,P.a.tannery,P.a.alchemist,P.a.garden,P.a.weaponsmith,P.a.armoursmith,P.a.warehouse,P.a.mine,P.a.lumberMill,P.a.weaver],a=Object(S.i)("".concat(Object(D.c)(),"/:structure")),r=function(e){return(null===a||void 0===a?void 0:a.params.structure)===e.toString()?Object(_.jsx)("span",{className:"highlighted",children:"".concat(q.a.getStructureName(e))}):Object(_.jsx)(N.b,{to:Object(D.b)(e),children:"".concat(q.a.getStructureName(e))})};return Object(_.jsx)("div",{className:"legenda",children:Object(_.jsx)("ul",{children:n.map((function(e){return t[e].state===g.NotBuilt?null:Object(_.jsx)("li",{children:r(e)},e)}))})})}),ne=(n(311),n(134)),ae=n(255),re=Object(s.forwardRef)((function(e,t){var n=Object(B.useApp)();if(n){var a="url('".concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAgCAYAAAABtRhCAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3gMODzc3YHmYGgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAE50lEQVRIx7WXW0wcVRjHfzO7y16YZbfAytACvbjU1hqkLVZMbbSXBEPUNjX6YDYanwYfTXzxrb7qm0lTJ018QhOjaWI0trFYbRoqpYVuwy2UpRS2lAF22YUdtuxt1ofKCIXShaZfMjm37+Q33zn/cxMURWHRVFXNAyiKIvCMTFwKO6Ne4ONPTpngZwoE6Lx6FYCDhwLPDLoMeKPtV8b6ewkEAssiVVU1v/gtLS+dhnUDFUUResZvUhLXuNF+ZVmkBw8F6B+4b5avXR8x82fUC+uCWhoaGsxCV1fXKZelGOvMNPcXspw9+zV60s3MzAweTwXJZBLJXYXPt8XMJ5NJbgX/pqGh4ctCgNalBUVRhId/u5tsQqf9UpDGxkZCoRCtra2mX2trK5qmAZhpoWZdrTIvCOyQihn8/RydsQSVm6uQJAnZ6zV9MjYbkUgEAL/fj6p+my9kOYmPViiKIgQn+8mLIv1jowSONtN0+OgyGEAkEkHXdTRNQ5Kkjal0qY3MJciLIsdOvslYXy9xbXxZu67rAEiSZOafCtgzfpM8Al2/deDEwJZOrYAu2lNFqKpq/rPjLTTtbWY0Psu1jovUVm7Hmk1jS6eYmXooEiH//0pYj3BWFc2RukM4HpxHMAz6x0aRvT1scfsYT0yTTwnEtXEsuQzxhbQ5j08F/O7H0+zz+ThQWsK52yGuBNs5XPcqllwOVzrOjv2HsZaXsuv1OtySnYSeort7kE+Vt56o1FWBo7EollwGQ7Sww13McHyWbE8n9VVVNLzWzMDkXSYGujl/uY1wNIamaciybO4+a0FXXRbd04P8PHydu/EYtmwaSy7NaCzOi0eO09F5kfk7/bhSSZ4T8zQ2NiLLMgCyLPPe+5+vudWtqlJFUYRF8MhsHNHIcXKnn86rfxK8P4Etk8G5kKR4YZ758F1OnDixrP9aUHGt8V6ExlMLbLP7GBoeAkGkxuWhKJfFlUoiJRNE7o0TCARM8UiS9NgjTnySqhRFEUZmR/jm5l9YsynGolG0RJQqpwd7OoU0P0dqZJD0TJyWlhZzU/D7/Txfe2wFVCxUzttLPNyaGEc0svx0+zZVW/cD4Eo/wJuIkevtwZiKLhteWZZXQAsGdk9PscluRzByODxlnL78Aw17mpDdZdizGUr0GNEbndRvKeeD5rcpLy83oRWVjeuLUFEUYTQ+jMfpwutw4CgpJVmzm6/++QVDtFDpLkU0DLxzUabbB6ir9vHGtp3mxi5JkhmluJ6zzONw/pfaMUSR0HyaL6530zYRBmBz7QFqj9YhSQ5efsXPQjxS2MJ/nJUUS8zEZ/G4nPSEQgyHLj08kCehtQuqy66w94/vEfIGNaVliEYGr6No40AAj9OBkDcYHmpb0RaO9hGO9lFdtodubQqAovQCG1IpgGgYlNlsbCqyrekXjvaZ+SlD3Dgwoc9hyWU4WP1SQf6lNbXouo6u6+ZtvmCgoihCcErDks2QCA3w4YF3ngjz+/1omsbkRMfG5nBkdoQ7bjeEe9hVVsZHe5u4FB7nXqTX9Kmvf5eKys3IskwwGGR4qG3ZW0VY+pgpxFRVze/zvcBWbylep5OMzY5hsVLsLiFd5MTqq+DedJRQKLQCtiHg0uv91k21uF1uPE4XhsVC1monlsqSmE8yOdGx6itsQ8BHwavN9+P6/Avf+1eTf20QhwAAAABJRU5ErkJggg==","'), auto");n.renderer.plugins.interaction.cursorStyles.pointer=a}return Object(_.jsx)(ce,Object(Z.a)(Object(Z.a)({app:n},e),{},{ref:t}))}));re.displayName="DisplayName";var ce=Object(B.PixiComponent)("Viewport",{create:function(e){var t=new ae.a({screenWidth:e.screenWidth,screenHeight:e.screenHeight,worldWidth:e.worldWidth,worldHeight:e.worldHeight,ticker:e.app.ticker,interaction:e.app.renderer.plugins.interaction});t.on("clicked",(function(t){e.onClick&&e.onClick(t)}));var n=e.minScale,a=void 0===n?1:n,r=e.maxScale,c=void 0===r?2:r;return t.drag().pinch().wheel().clamp({direction:"all"}).clampZoom({minScale:a,maxScale:c}).decelerate(),t}}),oe=re,ie=Object(s.forwardRef)((function(e,t){var n=e.children,a=e.screenWidth,r=e.screenHeight,c=e.worldWidth,o=e.worldHeight,i=Object(s.useRef)(null);return Object(s.useImperativeHandle)(t,(function(){return i.current})),Object(s.useEffect)((function(){if(me.enabled=!1,i.current){var e=i.current;e.on("moved",(function(){var t=T.b.utils.normalize(e.screenWidth,c,e.right),n=T.b.utils.normalize(o,e.screenHeight,e.bottom),a=Math.max(t*n-.4,0);me.gain=a,me.lacunarity=2.4,me.enabled=me.gain>0}))}var t=function(e){e.preventDefault()};return window.addEventListener("wheel",t,{passive:!1}),function(){window.removeEventListener("wheel",t)}}),[o,c]),Object(_.jsx)(B.Stage,{width:a,height:r,options:de,children:Object(_.jsx)(oe,{screenWidth:a,screenHeight:r,worldWidth:c,worldHeight:o,ref:i,children:Object(_.jsx)(B.Sprite,{name:"background",image:"".concat(".","/img/town/town-alpha/background.png"),filters:[me],children:n})})})}));ie.displayName="TownStage";var se,ue,le=ie,de={autoDensity:!0,sharedLoader:!0},me=new ne.a,he=function(e){var t=e.speed,n=void 0===t?1:t,a=Object(s.useState)(be()),r=Object(x.a)(a,2),c=r[0],o=r[1],i="".concat(".","/img/town/clouds/cloud-0").concat(c,".png"),u=Object(s.useState)(-2e3),l=Object(x.a)(u,2),d=l[0],m=l[1],h=Object(s.useState)(pe()),b=Object(x.a)(h,2),p=b[0],j=b[1];return Object(B.useTick)((function(t){d>e.worldWidth?(m(2e3-1e3*Math.random()),j(pe()),o(be())):m(d+n*(t||1))})),Object(_.jsx)(B.Sprite,{name:"cloud ".concat(c),image:i,alpha:.8,x:d,y:p})},be=function(){return Math.floor(2*Math.random())+1},pe=function(){return-300*Math.random()-200},je=new M.a(8,16763904),fe=$((function(e){var t=Object(S.i)("".concat(Object(D.c)(),"/:structure")),n=null===t||void 0===t?void 0:t.params.structure,a=Object(s.useRef)(null),r=Object(s.useRef)(null),c=Object(s.useRef)(!1);Object(s.useEffect)((function(){C.c.addSound("music/town","sound/music/Soliloquy.mp3",(function(){C.c.playSound("music/town",C.a.music,!0,C.b.fade,!0)}))}),[]),Object(s.useEffect)((function(){var e=T.b.to(je,{duration:.6,thickness:2,yoyo:!0,repeat:-1});return function(){e.pause(0),e.kill()}}),[]),Object(s.useEffect)((function(){if(r.current){var e=r.current;e.on("drag-start",(function(e){c.current=!0,e.event.stopPropagation()})),e.on("drag-end",(function(){c.current=!1}))}}),[]);var o=function(t){c.current||e.onStructureClick(t)},i=Object(d.d)((function(e){return e.structures}));Object(s.useEffect)((function(){if(n&&r.current){var e=r.current;e.zoomPercent(0);var t=ge(n);e.moveCenter(t)}}),[n]);var u=Object(s.useState)(Ur),l=Object(x.a)(u,2),m=l[0],h=l[1],b=Object(s.useState)(1079),p=Object(x.a)(b,2),j=p[0],f=p[1];return Object(s.useEffect)((function(){var e=function(){var e,t,n=(null===(e=a.current)||void 0===e?void 0:e.clientWidth)||Ur,r=(null===(t=a.current)||void 0===t?void 0:t.clientHeight)||1079;h(n),f(r)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),Object(_.jsxs)("div",{className:"town-view",ref:a,children:[Object(_.jsx)(te,{structures:i}),Object(_.jsxs)(le,{screenWidth:m,screenHeight:j,worldWidth:1024,worldHeight:1600,ref:r,children:[Object(_.jsx)(he,{worldWidth:m}),[P.a.workshop,P.a.quarry,P.a.tavern,P.a.tannery,P.a.alchemist,P.a.garden,P.a.weaponsmith,P.a.armoursmith,P.a.warehouse,P.a.mine,P.a.lumberMill,P.a.weaver].reverse().map((function(e){if(i[e].state===g.NotBuilt)return null;var t=ve(e),a=ge(e),r=new W(F,e);return Object(_.jsx)(t,{position:a,structure:e,hitAreaShapes:r,onStructureClick:o,selected:n===e},e)})),Object(_.jsx)(he,{worldWidth:m})]})]})})),ve=function(e){switch(e){case P.a.workshop:case P.a.quarry:case P.a.tannery:case P.a.alchemist:case P.a.garden:case P.a.weaponsmith:case P.a.armoursmith:case P.a.warehouse:case P.a.mine:case P.a.weaver:return ee;case P.a.lumberMill:return V;case P.a.tavern:return Y}},ge=function(e){var t,n;switch(e){case P.a.workshop:t=373,n=610;break;case P.a.quarry:t=632,n=633;break;case P.a.tannery:t=372,n=460;break;case P.a.tavern:t=500,n=469;break;case P.a.alchemist:t=411,n=371;break;case P.a.garden:t=822,n=689;break;case P.a.weaponsmith:t=449,n=460;break;case P.a.armoursmith:t=473,n=442;break;case P.a.warehouse:t=471,n=130;break;case P.a.lumberMill:t=403,n=320;break;case P.a.mine:t=183,n=527;break;case P.a.weaver:t=484,n=333}return new PIXI.Point(t,n)},Oe=n(45),ye=n(47),xe=(n(312),function(){var e=Object(s.useState)([]),t=Object(x.a)(e,2),n=t[0],a=t[1],r=function(e){e&&a(e)};return Object(s.useEffect)((function(){return Oe.b.instance.addListener(Oe.a,r),function(){Oe.b.instance.removeListener(Oe.a,r)}}),[]),Object(_.jsx)("div",{className:"toasts",children:n.map((function(e){return Object(_.jsx)(ye.b,Object(Z.a)({},e),e.time)}))})});n(313);!function(e){e[e.auto=0]="auto",e[e.large=1]="large",e[e.medium=2]="medium",e[e.small=3]="small"}(se||(se={})),function(e){e.blue="blue",e.purple="purple",e.green="green"}(ue||(ue={}));var we,ke,Ne=function(e){var t,n=e.color,a=e.square,r=e.text,c=Object(Q.a)(e,["color","square","text"]),o="button\n        ".concat(e.className||"","\n        button-").concat("string"===typeof n?n:ue[null!==n&&void 0!==n?n:ue.blue],"\n        button-").concat("string"===typeof e.size?e.size:se[null!==(t=e.size)&&void 0!==t?t:se.auto],"\n        ").concat(a?"button-square":"","\n    ").replace(/\n\s*/g," ");return Object(_.jsx)("button",Object(Z.a)(Object(Z.a)({},c),{},{className:o,onClick:function(t){var n;null===(n=e.onClick)||void 0===n||n.call(e,t)},children:Object(_.jsxs)("span",{children:[!!r&&r,!r&&e.children]})}))},Se=function(e){return Object(s.useEffect)((function(){return C.c.musicFiltered=!0,function(){C.c.musicFiltered=!1}})),Object(_.jsxs)("div",{className:"window",children:[Object(_.jsxs)("div",{className:"header",children:[!1!==e.backEnabled&&Object(_.jsx)(Ne,{className:"back-button",onClick:function(t){e.onBack&&(null===e||void 0===e||e.onBack(),C.c.playSound("ui/buttonClick"))},square:!0,size:"medium",color:"purple",text:"<"}),Object(_.jsx)("h3",{children:e.title}),!1!==e.closeEnabled&&Object(_.jsx)(Ne,{className:"close-button",onClick:function(t){e.onClose&&(null===e||void 0===e||e.onClose(),C.c.playSound("ui/buttonClick"))},square:!0,size:"medium",color:"purple",text:"x"})]}),e.children]})},Ie=(n(314),function(e){return function(t){Object(J.a)(a,t);var n=Object(K.a)(a);function a(){return Object(R.a)(this,a),n.apply(this,arguments)}return Object(H.a)(a,[{key:"render",value:function(){return Object(_.jsx)(Se,Object(Z.a)(Object(Z.a)({},this.props),{},{children:Object(_.jsx)(e,Object(Z.a)({},this.props))}))}}]),a}(s.Component)}),Te=n(59),Ce=(n(315),Object(Te.c)(Ie)((function(){var e=function(e){return Object(_.jsxs)("p",{children:[Object(_.jsx)("label",{children:C.a[e]}),Object(_.jsx)("button",{onClick:function(t){var n,a=null===(n=t.currentTarget.parentNode)||void 0===n?void 0:n.lastChild;a&&T.a.to(a,{duration:.5,value:0,onComplete:function(){C.c.setChannelVolume(e,0)}})},children:Object(_.jsx)("span",{role:"img","aria-label":"Mute",children:"\ud83d\udd07"})}),Object(_.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",onChange:function(t){var n=parseFloat(t.target.value),a=Math.pow(n,2);C.c.setChannelVolume(e,a)},defaultValue:"".concat(Math.sqrt(C.c.getChannelVolume(e)))})]})};return Object(_.jsx)("div",{className:"settings-window",children:Object(_.jsxs)("details",{open:!0,className:"sound",children:[Object(_.jsx)("summary",{children:"Sound volume"}),Object(_.jsxs)("section",{children:[e(C.a.ui),e(C.a.scene),e(C.a.music)]})]})})}))),qe=n(53),Ae=n(2),Ee=n(48),Pe=n(32),Me=n(10),De=Me.e,Re=[Pe.a.food,Pe.a.wood,Pe.a.iron,Pe.a.stone,Pe.a.fabric,Pe.a.leather],He=n(3);function Le(e){return{type:we.addResources,resources:e}}function We(e){return{type:ke.finishBuildingStructure,structure:e}}function Fe(e){return{type:ke.upgradeStructure,structure:e}}function Be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:ke.increaseWorkers,structure:e,workers:t}}function ze(e,t){return{type:ke.addItemToToProduces,structure:e,item:t}}!function(e){e.addResources="addResources",e.removeResources="removeResources"}(we||(we={})),function(e){e.upgradeStructure="upgradeStructure",e.increaseWorkers="increaseWorkers",e.decreaseWorkers="decreaseWorkers",e.startBuildingStructure="startBuildingStructure",e.finishBuildingStructure="finishBuildingStructure",e.setStructureState="setStructureState",e.addItemToToProduces="addItemToToProduces"}(ke||(ke={}));var _e,Ve,Ge,Qe=n(86);function Ue(e,t){return{type:_e.addItem,item:e,toSlot:t}}function Xe(e){return{type:_e.removeItem,fromSlot:e}}function Ye(e){return{type:_e.addStockpileSlots,slots:e}}!function(e){e.addItem="addItem",e.moveItemInWarehouse="moveItemInWarehouse",e.removeItem="removeItem",e.addStockpileSlots="addStockpileSlots"}(_e||(_e={})),function(e){e.addWorkers="addWorkers"}(Ve||(Ve={})),function(e){e[e.questProgress=0]="questProgress",e[e.resourceGeneration=1]="resourceGeneration",e[e.cheat=2]="cheat"}(Ge||(Ge={}));var Ze,Je=1,Ke=function(e){switch(e){case Ge.cheat:default:return Je}};!function(e){e[e.item=0]="item",e[e.trait=1]="trait",e[e.resource=2]="resource",e[e.skill=3]="skill",e[e.component=4]="component"}(Ze||(Ze={}));var $e=n(29),et=n(257),tt=n.n(et),nt=n(80),at="tooltipContextUpdated",rt=function(e){Object(J.a)(n,e);var t=Object(K.a)(n);function n(){return Object(R.a)(this,n),t.apply(this,arguments)}return Object(H.a)(n,null,[{key:"showContextTooltip",value:function(e,t,n,a){var r={type:e,info:t,referenceRect:n,className:a};tt()(r,this.lastContext)?this.clear():(this.instance.emit(at,r),this.lastContext=r)}},{key:"clear",value:function(){this.instance.emit(at,void 0),this.lastContext=void 0}},{key:"instance",get:function(){return this._instance}}]),n}(n.n(nt).a);rt._instance=new rt,rt.lastContext=void 0;var ct=n(25),ot=(n(327),function(e){var t=e.item,n=e.size,a=Object(qe.a)(t);a||console.warn("could not find definition for ".concat(t));var r="item-icon ".concat(it(a.rarity)," ").concat(st(n));return Object(_.jsx)("div",{className:r,children:Object(_.jsx)(ct.b,{image:a.iconImg,size:e.size,onClick:function(n){if(!1!==e.showContext){var a=n.currentTarget.getBoundingClientRect();rt.showContextTooltip(Ze.item,Object(qe.a)(t),a),n.stopPropagation()}e.onClick&&e.onClick(n)}})})}),it=function e(t){switch(t){case $e.a.common:return"item-icon-common";case $e.a.uncommon:return"item-icon-uncommon";case $e.a.rare:return"item-icon-rare";case $e.a.epic:return"item-icon-epic";case $e.a.legendary:return"item-icon-legendary"}return e($e.a.common)},st=function e(t){switch(t){case ct.a.smallest:return"item-icon-size-smallest";case ct.a.small:return"item-icon-size-small";case ct.a.medium:return"item-icon-size-medium";case ct.a.big:return"item-icon-size-big";case ct.a.biggest:return"item-icon-size-biggest"}return e(ct.a.medium)},ut=n(262),lt=function(e){return Object(_.jsx)(ut.a,Object(Z.a)({styles:{control:function(e,t){return Object(Z.a)(Object(Z.a)({},e),{},{minHeight:"inherit",height:"32px",boxShadow:"0",border:t.isFocused?"1px solid orange":"1px solid #B1B1B1",":hover":{border:"1px solid orange"}})},container:function(e,t){return Object(Z.a)(Object(Z.a)({},e),{},{flex:1})},option:function(e){return Object(Z.a)(Object(Z.a)({},e),{},{padding:"4px 12px"})},placeholder:function(e){return Object(Z.a)(Object(Z.a)({},e),{},{whiteSpace:"nowrap"})},valueContainer:function(e){return Object(Z.a)(Object(Z.a)({},e),{},{marginTop:"-2px"})},indicatorsContainer:function(e){return Object(Z.a)(Object(Z.a)({},e),{},{marginTop:"-2px",div:{padding:"4px"}})}}},e))};lt.displayName="DefaultSelect";var dt,mt=lt,ht=(n(338),Ie((function(){var e=Object(s.useState)({gold:50,resources:50,workers:10}),t=Object(x.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)(),c=Object(x.a)(r,2),o=c[0],i=c[1],u=Object(d.c)(),l=Object(s.useState)(Ke(Ge.cheat)),m=Object(x.a)(l,2),h=m[0],b=m[1],j=function(e,t){u(function(e,t){return{type:ke.setStructureState,structure:e,state:t}}(e,t))},f=function(e){var t;u((t=e,{type:Ve.addWorkers,value:t})),u(Object(p.c)("common-cheat-workers-added",{amount:e},Ee.a.common))},v=Object(d.d)((function(e){return e.structures})),O=function(e,t){j(e,t?g.Built:g.NotBuilt),t?Oe.b.addToast("The ".concat(q.a.getStructureName(e)," is constructed"),ye.a.cheat):Oe.b.addToast("The ".concat(q.a.getStructureName(e)," is not constructed"),ye.a.cheat)},y=Object(s.useMemo)((function(){return Object.keys(Ae.b).filter((function(e){return!isNaN(parseInt(e))})).map((function(e){return{label:Ae.b[e],value:"",subtext:"",options:Object.keys(Ae.a).filter((function(t){return Object(qe.a)(t).itemType==e})).map((function(e){return{value:e,label:q.a.getItemName(e),subtext:q.a.getItemSubtext(e)}}))}}))}),[]);return Object(_.jsxs)("div",{className:"cheat-window",children:[Object(_.jsxs)("div",{className:"label-numberbox-button",children:[Object(_.jsx)("label",{children:"Gold"}),Object(_.jsx)("input",{type:"number",value:n.gold,style:{width:"50px"},onChange:function(e){var t=Number.parseFloat(e.target.value);a(Object(Z.a)(Object(Z.a)({},n),{},{gold:t}))}}),Object(_.jsx)("button",{onClick:function(e){var t=n.gold;!function(e){u(Object(Qe.b)(e)),u(Object(p.c)("common-cheat-gold-added",{amount:e},Ee.a.common))}(t);var a=q.a.get("common-cheat-gold-added",{amount:t});Oe.b.addToast(a,ye.a.cheat,"/img/resources/gold.png")},children:"Add"})]}),Object(_.jsxs)("div",{className:"label-numberbox-button",children:[Object(_.jsx)("label",{children:"Workers"}),Object(_.jsx)("input",{type:"number",value:n.workers,style:{width:"50px"},onChange:function(e){var t=Number.parseFloat(e.target.value);a(Object(Z.a)(Object(Z.a)({},n),{},{workers:t}))}}),Object(_.jsx)("button",{onClick:function(e){var t=n.workers;f(t);var a=q.a.get("common-cheat-workers-added",{amount:t});Oe.b.addToast(a,ye.a.cheat,"/img/resources/worker.png")},children:"Add"})]}),Object(_.jsxs)("div",{className:"label-numberbox-button",children:[Object(_.jsx)("label",{children:"Resources"}),Object(_.jsx)("input",{type:"number",value:n.resources,style:{width:"50px"},onChange:function(e){var t=Number.parseFloat(e.target.value);a(Object(Z.a)(Object(Z.a)({},n),{},{resources:t}))}}),Object(_.jsx)("button",{onClick:function(e){!function(e){var t=Re.reduce((function(t,n){return t[n]=e,t}),{});u(Le(t)),u(Object(p.c)("common-cheat-resources-added",{amount:e},Ee.a.common))}(n.resources);var t=q.a.get("common-cheat-resources-added",{amount:n.resources});Oe.b.addToast(t,ye.a.cheat)},children:"Add"})]}),Object(_.jsxs)("div",{className:"label-numberbox-button",children:[Object(_.jsx)("label",{children:"Items"}),Object(_.jsx)(mt,{placeholder:"Find item in any category...",onChange:function(e){return i(null===e||void 0===e?void 0:e.value)},formatGroupLabel:function(e){return Object(_.jsxs)("div",{className:"item-group",children:[Object(_.jsx)("div",{className:"item-group-label",children:e.label}),Object(_.jsxs)("div",{className:"item-group-count",children:[e.options.length," items"]})]})},formatOptionLabel:function(e){return Object(_.jsxs)("div",{className:"item-option",children:[Object(_.jsx)(ot,{item:e.value,size:ct.a.smallest}),Object(_.jsxs)("div",{className:"item-label",children:[e.label,Object(_.jsx)("span",{children:e.subtext})]})]})},options:y}),Object(_.jsx)(Ne,{onClick:function(e){var t=o;!function(e){u(Ue(e)),u(Object(p.c)("common-cheat-item-added",{item:e},Ee.a.common))}(t);var n=q.a.get("common-cheat-item-added",{item:t}),a=Object(qe.a)(t).iconImg;Oe.b.addToast(n,ye.a.cheat,a)},children:"Add"})]}),Object(_.jsxs)("div",{className:"label-range-value",children:[Object(_.jsx)("label",{children:"Speed"}),Object(_.jsx)("input",{type:"range",min:"1",max:"10",value:h,step:1,onChange:function(e){var t=Number.parseFloat(e.target.value);b(t),function(e){Je=e}(t)}}),h,"x speed"]}),Object(_.jsx)("div",{children:Object(_.jsx)("h2",{children:"Structures"})}),Object.keys(v).map((function(e){return function(e){var t=Object(P.b)(e),n=v[e],a=t.levels[n.level],r=q.a.get(a.displayName);return Object(_.jsxs)("div",{className:"label-dropdown",children:[Object(_.jsx)("label",{title:e,children:"".concat(r)}),Object(_.jsx)("input",{type:"checkbox",checked:n.state===g.Built,onChange:function(){return O(e,n.state!==g.Built)}},e)]},e)}(e)}))]})}))),bt=n(258),pt=Object(bt.createEncryptor)("P5mw}jD>5c6Y]yqy"),jt=(n(433),Object(Te.c)(Ie,$)((function(e){var t=Object(d.d)((function(e){return e})),n=Object(s.useState)(),a=Object(x.a)(n,2),r=a[0],c=a[1],u=function(){var t=Object(i.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return c(void 0),t.next=5,so(r);case 5:Oe.b.addToast(q.a.get("ui-game-loaded"),ye.a.game,"/img/items/misc/magic-eye.png"),e.onCloseWindow();case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(_.jsxs)("div",{className:"menu",children:[Object(_.jsx)("p",{children:Object(_.jsx)(Ne,{onClick:function(){var t=Object(_.jsx)(ht,{title:"Cheats"});e.onOpenWindow(t)},children:"Cheats!"})}),Object(_.jsx)("p",{children:Object(_.jsx)(Ne,{onClick:function(){var t=Object(_.jsx)(Ce,{title:"Settings"});e.onOpenWindow(t)},children:"Settings"})}),Object(_.jsxs)("fieldset",{children:[Object(_.jsx)("legend",{children:"Save and load"}),Object(_.jsxs)("section",{children:["Save game to disk:\xa0",Object(_.jsx)(Ne,{onClick:function(){!function(e){var t=document.createElement("a"),n=JSON.stringify(e),a=pt.encrypt(n);t.setAttribute("href","data:text/json;charset=utf-8,"+encodeURIComponent(a)),t.setAttribute("download","Gidletown save.json"),t.click()}(t)},children:"Save"})]}),Object(_.jsxs)("section",{children:["Load game from disk:\xa0",Object(_.jsx)("input",{type:"file",onChange:function(e){var t=new FileReader;t.onload=function(){var e=function(e){var t=pt.decrypt(e);return JSON.parse(t)}(t.result);c(e)},t.readAsText(e.target.files[0])}}),Object(_.jsx)(Ne,{onClick:u,disabled:!r,children:"Load"})]})]})]})}))),ft=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=["","k","M","G","T","P","E"],a=Math.log10(e)/3|0;if(0===a)return e.toFixed(t);var r=n[a],c=Math.pow(10,3*a),o=e/c;return o.toFixed(t)+r},vt=function(){return Object(d.d)((function(e){return e.gold}))},gt=n(52),Ot=Object(gt.a)([function(e){return e.structures[P.a.warehouse].level}],(function(e){return Object(P.b)(P.a.warehouse).levels[e].maxResources})),yt=function(){return Object(d.d)((function(e){return e.resources}))},xt=Object(gt.a)([function(e){return e.structures},function(e){return e.workers}],(function(e,t){return t-Object.keys(e).map((function(t){return e[t]})).reduce((function(e,t){return e+t.workers}),0)})),wt=function(){return Object(d.d)(xt)},kt=(n(434),function(){var e=vt(),t=yt(),n=wt(),a=function(e,t,n){return Object(_.jsxs)("li",{onClick:function(e){var t=e.currentTarget.getBoundingClientRect();rt.showContextTooltip(Ze.resource,n,t),e.stopPropagation()},children:[Object(_.jsx)(ct.b,{image:e,size:"smallest"}),Object(_.jsx)("div",{className:"amount",children:ft(t,0)})]},n)},r=Re.map((function(e){var n,r=Pe.b[e];return a(r.iconImg,null!==(n=t[e])&&void 0!==n?n:0,e)}));return r.push(a("/img/resources/worker.png",n,"workers"),a("/img/resources/gold.png",e,"gold")),Object(_.jsx)("ul",{className:"resourcebar",children:r})}),Nt=(n(435),function(e){var t=Object(s.useContext)(Xr);return Object(_.jsxs)("div",{className:"topbar",children:[Object(_.jsx)("div",{className:"topbar-left",children:Object(_.jsx)(kt,{})}),Object(_.jsx)("div",{className:"topbar-right",children:Object(_.jsx)("div",{className:"hamburger",onClick:function(n){var a=Object(_.jsx)(jt,{title:"Menu",persistor:e.persistor});t.onOpenWindow(a)},children:"\u2630"})})]})}),St=n(20),It=function(e){var t=e.quest,n=e.leader,a=e.encounterActive,r=e.position,c=e.onClick,o=e.selected?"/img/world/map-marker-selected.png":"/img/world/map-marker.png",i=Object(s.useRef)(null);return Object(s.useEffect)((function(){var e=i.current,t=new L.Graphics;t.beginFill(12245589),t.drawCircle(0,0,256),t.endFill(),e.mask=t,e.addChild(t)}),[i]),Object(_.jsxs)(B.Sprite,{image:"".concat(".").concat(o),name:t.name,x:r.x,y:r.y,interactive:!0,buttonMode:!0,scale:new L.Point(.1,.1),anchor:new L.Point(.5,1),pointerdown:function(){c&&c(t)},children:[n&&Object(_.jsx)(B.Sprite,{image:"".concat(".","/").concat(n.avatarImg),name:"avatar",anchor:new L.Point(.5,.5),x:0,y:-396,scale:new L.Point(.66,.66),ref:i}),a&&Object(_.jsx)(B.Sprite,{image:"".concat(".","/img/world/quest-alert.png"),name:"quest-alert",anchor:new L.Point(.5,1),x:180,y:-396,scale:new L.Point(2,2)})]})},Tt=function(e){var t=e.positions;return e.positions.length>2?Object(_.jsx)(B.Graphics,{name:"questline",x:0,y:0,draw:function(e){e.lineStyle(3,16724736),e.moveTo(t[0].x,t[0].y);var n=0;for(n=1;n<t.length-2;n++){var a=(t[n].x+t[n+1].x)/2,r=(t[n].y+t[n+1].y)/2;e.quadraticCurveTo(t[n].x,t[n].y,a,r)}e.quadraticCurveTo(t[n].x,t[n].y,t[n+1].x,t[n+1].y),e.endFill()}}):null},Ct=n(68),qt=n(71);!function(e){e[e.unavailable=0]="unavailable",e[e.available=1]="available",e[e.active=2]="active",e[e.completed=3]="completed"}(dt||(dt={}));var At=n(259),Et=Object(gt.b)(gt.c,At.a),Pt=function(e){return e.quests},Mt=function(e){return e.quests.map((function(e){return e.name}))},Dt=function(e){return e.quests.map((function(e){return e.status}))},Rt=function(e){return e.filter((function(e){return e.status===dt.active}))},Ht=function(e){var t=Object(s.useCallback)((function(t){return t.quests.find((function(t){return t.name===e}))}),[e]);return Object(d.d)(t)},Lt=n(28);n(436);window.PIXI=L;var Wt,Ft,Bt=function(e){var t=e.retrieveWorldViewRef,n=e.smallMap,a=Object(s.useCallback)((function(t){return t.quests.find((function(t){return t.name===e.selectedQuestName}))}),[e.selectedQuestName]),r=Object(d.d)(a),c=Object(d.d)((function(e){return e.adventurers})),o=function(){var e=Object(s.useMemo)((function(){return Object(gt.a)([Pt],Rt)}),[]);return Object(d.d)(e)}(),i=Object(S.g)(),u=Object(s.useState)(Ur),l=Object(x.a)(u,2),m=l[0],h=l[1],b=Object(s.useState)(1024),p=Object(x.a)(b,2),j=p[0],f=p[1];Object(s.useEffect)((function(){var e=function(){var e,a,r=t(),c=(null===(e=r.current)||void 0===e?void 0:e.clientWidth)||Ur,o=(null===(a=r.current)||void 0===a?void 0:a.clientHeight)||1024;h(c),f(n?c<576?32:64:o)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[t,n]),Object(s.useEffect)((function(){if(r)g(r);else{var e=v.current,t=_t({x:0,y:0});e.moveCenter(t.x,t.y)}}),[r,j]);var v=Object(s.useRef)(null);Object(s.useEffect)((function(){if(v.current){var e=v.current,t=_t({x:0,y:0});e.moveCenter(t.x/2,t.y/2+10)}}),[m]);var g=function(e){var t=v.current;if(t){var n=zt(e),a=_t(n);t.moveCenter(a.x,a.y)}},O={autoDensity:!0,sharedLoader:!0,width:m,height:j};return Object(_.jsxs)("div",{className:"world-map",children:[Object(_.jsx)(B.Stage,{width:m,height:j,options:O,children:Object(_.jsx)(oe,{screenWidth:m,screenHeight:j,worldWidth:1500,worldHeight:1061,ref:v,children:Object(_.jsxs)(B.Sprite,{image:"".concat(".","/img/world/francesca-baerald-fbaerald-angeloumap-lowres.jpg"),interactive:!0,pointerdown:function(){},children:[o.map((function(e){var t=Vt(e);return Object(_.jsx)(Tt,{positions:t},e.name)})),o.map((function(t){var n=zt(t),a=_t(n),o=Object(qt.c)(c,t),i=Object(Ct.a)(t.name),s=Math.floor(t.progress),u=i.nodes[s];return Object(_.jsx)(It,{quest:t,leader:o,position:a,selected:t===r,encounterActive:u.type===St.a.encounter,onClick:function(t){return n=t.name,void e.onPartyClick(n);var n}},t.name)}))]})})}),e.selectedQuestName&&Object(_.jsxs)("div",{className:"title",children:[Object(_.jsxs)("span",{children:[Object(_.jsx)(Gt,{questName:e.selectedQuestName}),q.a.getQuestTitle(e.selectedQuestName)]}),Object(_.jsx)("span",{onClick:function(){i.push(Object(D.d)())},className:"close",children:"x"})]})]})},zt=function(e){var t=Object(Ct.a)(e.name),n=Math.floor(e.progress),a=t.nodes[n],r=t.nodes[n+1];return r?Object(z.a)(a,r,e.progress-n):a},_t=function(e){var t=10*e.x+750,n=10*e.y+530.5;return new L.Point(t,n)},Vt=function(e){for(var t=[],n=Object(Ct.a)(e.name),a=0;a<e.progress;a++)t.push(_t(n.nodes[a]));var r=_t(zt(e));return t.push(r),t},Gt=function(e){var t,n=e.questName,a=Ht(n),r=Object(d.c)();return(null===(t=a.scene)||void 0===t?void 0:t.combat)?Object(_.jsx)("button",{onClick:function(){return r(Object(Lt.g)(n,!1))},children:"combat: on"}):Object(_.jsx)("button",{onClick:function(){return r(Object(Lt.g)(n,!0))},children:"combat: off"})},Qt=(n(437),function(e){var t=e.activeTab,n=void 0===t?null:t;!n&&e.children&&e.children;var a="".concat(e.className).concat(e.disabled?" disabled":""),r=u.a.Children.map(e.children,(function(e){return u.a.cloneElement(e,{active:e.props.id===n,onClick:function(){c(e.props.id)}})})),c=function(t){e.onTabSelected&&!0!==e.disabled&&e.onTabSelected(t)};return Object(_.jsx)("ul",{className:"tabstrip ".concat(null!==a&&void 0!==a?a:""),onClick:function(t){C.c.playSound("ui/buttonClick"),e.onClick&&e.onClick(t)},children:r})}),Ut=function(e){var t=(e.active?"active":"")+(e.className||"");return Object(_.jsx)("li",{className:"tabstrip-tab ".concat(t),onClick:function(t){e.onClick&&e.onClick(t)},children:e.children})},Xt=(n(438),function(e){var t=e.adventurer,n=e.size,a="".concat(e.className||""," avatar");return Object(_.jsx)(ct.b,{className:a,image:t.avatarImg,size:n,onClick:function(){e.onClick&&e.onClick(e.adventurer.id)}})}),Yt=function(e){var t=e.adventurers,n=e.onAdventurerTabSelected;return Object(_.jsx)(Qt,{className:"adventurers-tabstrip",onTabSelected:function(t){var a=e.adventurers.find((function(e){return e.id===t}));n(a.id)},activeTab:e.selectedAdventurerId,disabled:e.disabled,children:t.map((function(e){return t=e,Object(_.jsx)(Ut,{id:t.id,children:Object(_.jsx)(Xt,{adventurer:t,size:ct.a.medium})},t.id);var t}))})},Zt=function(e){return e.adventurers},Jt=function(e){return e.quests},Kt=(Object(gt.a)([Zt,Jt],(function(e,t){var n=[],a=Object.values(t).reduce((function(t,a){var c=Object(qt.b)(e,a);return a.status===dt.active&&(t[a.name]=c),n.push.apply(n,Object(r.a)(c)),t}),{});return a.solo=e.filter((function(e){return-1===n.indexOf(e)})),a})),function(e){return Object(gt.a)([Zt,Jt],(function(t,n){var a=n.find((function(t){return t.name===e}));return Object(qt.b)(t,a)}))}),$t=(Object(gt.a)([Zt,Jt],(function(e,t){var n=t.reduce((function(e,t){return t.status===dt.active&&e.push.apply(e,Object(r.a)(t.party)),e}),[]);return e.filter((function(e){return-1===n.indexOf(e.id)}))})),n(117)),en=n(114),tn=n(49),nn=Object(B.PixiComponent)("RectTileLayer",{create:function(e){return new en.a},applyProps:function(e,t,n){var a=n.layer,r=n.tilesets,c=n.horizontalTiles,o=n.spritesheets;if(a.data)for(var i=0;i<a.data.length;i++){var s=Object(tn.c)(a.data[i],r);if(s){var u=s.tilewidth,l=s.tileheight,d=i%c*u,m=Math.floor(i/c)*l,h=o[s.name];if(a.data[i]>0){var b="".concat(s.name,"-").concat(a.data[i]);e.addFrame(h.textures[b],d,m)}}}}}),an=Object(B.PixiComponent)("ObjectTileLayer",{create:function(e){return new en.a},applyProps:function(e,t,n){var a=n.objects,r=n.tilesets,c=n.spritesheets;a.length&&(e.clear(),a&&a.forEach((function(t){if(t.gid){var n=Object(tn.c)(t.gid,r);if(n){var a=t.x,o=t.y-n.tileheight,i=c[n.name],s="".concat(n.name,"-").concat(t.gid);e.addFrame(i.textures[s],a,o)}}})))}}),rn=n(24),cn=Object(B.PixiComponent)("SpriteAnimated",{create:function(e){var t=e.textures;return new L.AnimatedSprite(t||[],!0)},applyProps:function(e,t,n){t.textures!==n.textures&&(Object(B.applyDefaultProps)(e,t,n),e.gotoAndPlay(0))}}),on=n(13);!function(e){e[e.blue=0]="blue",e[e.red=1]="red",e[e.teal=2]="teal",e[e.purple=3]="purple",e[e.orange=4]="orange",e[e.black=5]="black",e[e.white=6]="white",e[e.yellow=7]="yellow"}(Wt||(Wt={})),function(e){e.north="n",e.northEast="ne",e.east="e",e.southEast="se",e.south="s",e.southWest="sw",e.west="w",e.northWest="nw"}(Ft||(Ft={}));var sn,un=function(e){var t=e.location,n=void 0===t?[0,0]:t,a=e.controller,r=e.idleAnimation,c=e.color,o=e.children,i=e.spritesheetPath,u=e.lookAt,l=Object(Q.a)(e,["location","controller","idleAnimation","color","children","spritesheetPath","lookAt"]),m=a.getTileDimensions(),h=m.tileWidth,b=m.tileHeight,p=Object(s.useRef)(null),j=Object(s.useRef)(),f=Object(d.c)(),v=Ht(e.controller.questName),g=Object(s.useCallback)((function(){var t;return(null===(t=v.scene)||void 0===t?void 0:t.actionQueue)?v.scene.actionQueue.filter((function(t){return t.actorId===e.name})):[]}),[v.scene,e.name]),O=Object(d.d)(g),y=Object(s.useState)("stand"),w=Object(x.a)(y,2),k=w[0],N=w[1],S=Object(s.useRef)();Object(s.useEffect)((function(){if(p){var t=function(){n[0]===r.target[0]&&n[1]>r.target[1]?W(Ft.north):n[0]<r.target[0]&&n[1]>r.target[1]?W(Ft.northEast):n[0]<r.target[0]&&n[1]===r.target[1]?W(Ft.east):n[0]<r.target[0]&&n[1]<r.target[1]?W(Ft.southEast):n[0]===r.target[0]&&n[1]<r.target[1]?W(Ft.south):n[0]>r.target[0]&&n[1]<r.target[1]?W(Ft.southWest):n[0]>r.target[0]&&n[1]===r.target[1]?W(Ft.west):n[0]>r.target[0]&&n[1]>r.target[1]&&W(Ft.northWest)},r=O[0];if(r&&r!==j.current){switch(r.actionType){case rn.a.move:var c=function(){f(Object(Lt.b)(e.controller.questName)),e.controller.actorMoved(e.name,r.target)},o=(r.endsAt-performance.now())/1e3;o<0&&c(),t(),N("walk"),T.b.killTweensOf(p.current),S.current=T.b.to(p.current,{duration:o,ease:"linear",pixi:{x:r.target[0]*h,y:r.target[1]*b},onComplete:c});break;case rn.a.slash:t(),N("attack"),C.c.playSound("scene/swish",C.a.scene,!1,C.b.singleInstance);setTimeout((function(){N("stand"),f(Object(Lt.b)(e.controller.questName))}),1e3);break;case rn.a.interact:a.actorInteract(e.name,r.target),f(Object(Lt.b)(e.controller.questName))}j.current=r}}}),[f,h,b,O,e.controller,e.name,n,a]),Object(s.useEffect)((function(){return function(){var e;null===(e=S.current)||void 0===e||e.kill()}}),[]);var I=Object(s.useMemo)((function(){return N("stand"),{x:n[0]*h,y:n[1]*b}}),[n,h,b]),q=I.x,A=I.y,E=Object(s.useState)(null),P=Object(x.a)(E,2),M=P[0],D=P[1];Object(s.useEffect)((function(){var e;if(i){if(!(null===(e=PIXI.Loader.shared.resources[i])||void 0===e?void 0:e.textures))throw new Error("No textures for ".concat(i));var t=Object.keys(PIXI.Loader.shared.resources[i].textures).reduce((function(e,t){var n=t.replace(/[0-9]/g,"");return e[n]||(e[n]=[]),e[n].push(PIXI.Loader.shared.resources[i].textures[t]),e}),{});D(t)}}),[i]);var R=Object(s.useState)(Ft.north),H=Object(x.a)(R,2),L=H[0],W=H[1],F=Object(s.useRef)(!1);Object(s.useEffect)((function(){if(void 0!==u){var e=dn(n,u);W(e)}}),[n,u]),Object(s.useEffect)((function(){var e;e=L===Ft.southWest||L===Ft.west||L===Ft.northWest,F.current=e}),[L]),Object(s.useEffect)((function(){if(r&&!u){var e=2e3+4e3*Math.random(),t=setInterval((function(){var e=Math.random()<.5;L===Ft.north&&e?W(Ft.northWest):L===Ft.northWest&&e?W(Ft.west):L===Ft.west&&e?W(Ft.southWest):L===Ft.southWest&&e?W(Ft.south):L===Ft.south&&e?W(Ft.southEast):L===Ft.southEast&&e?W(Ft.east):L===Ft.east&&e?W(Ft.northEast):L===Ft.northEast&&e&&W(Ft.north),L!==Ft.north||e?L!==Ft.northEast||e?L!==Ft.east||e?L!==Ft.southEast||e?L!==Ft.south||e?L!==Ft.southWest||e?L!==Ft.west||e?L!==Ft.northWest||e||W(Ft.north):W(Ft.northWest):W(Ft.west):W(Ft.southWest):W(Ft.south):W(Ft.southEast):W(Ft.east):W(Ft.northEast)}),e);return function(){return clearInterval(t)}}}),[k,r,L,u]);var z=Object(s.useCallback)((function(){switch(L){case Ft.northWest:return"".concat("").concat(k,"-").concat(Ft.northEast);case Ft.west:return"".concat("").concat(k,"-").concat(Ft.east);case Ft.southWest:return"".concat("").concat(k,"-").concat(Ft.southEast);default:return"".concat("").concat(k,"-").concat(L)}}),[k,L]),V=Object(s.useMemo)((function(){switch(c){case Wt.black:return[mn(hn,vn)];case Wt.orange:return[mn(hn,fn)];case Wt.purple:return[mn(hn,jn)];case Wt.red:return[mn(hn,bn)];case Wt.teal:return[mn(hn,pn)];case Wt.white:return[mn(hn,gn)];case Wt.yellow:return[mn(hn,On)];case Wt.blue:default:return[]}}),[c]);return Object(_.jsxs)(B.Container,Object(Z.a)(Object(Z.a)({x:q,y:A,ref:p},l),{},{children:[i&&M&&Object(_.jsx)(cn,{animationSpeed:.1,name:"sprite",isPlaying:!0,textures:M[z()],x:50,y:30,scale:[F.current?-1:1,1],anchor:[.5,.5],pivot:[0,0],filters:V}),o]}))},ln=Object(s.memo)(un),dn=function(e,t){var n=Math.atan2(t[1]-e[1],t[0]-e[0]),a=Math.round((n/(2*Math.PI/8)+8)%8);return[Ft.east,Ft.southEast,Ft.south,Ft.southWest,Ft.west,Ft.northWest,Ft.north,Ft.northEast][a]},mn=function(e,t){var n=e.map((function(n,a){return[e[a],t[a]]}));return new ne.b(n,.15)},hn=[3679,8831,14501,21964],bn=[5703680,7343104,9441280,11867904],pn=[13069,25914,562031,3194533],jn=[3870010,6561118,8930966,11166141],fn=[8400140,11160082,13724945,16094999],vn=[855322,1710891,2434618,3487052],gn=[3159902,6777235,11119298,15132390],On=[12748288,14069264,15323955,16644441],yn=function(e){var t=e.controller,n=e.location,a=e.adventurerId,r=e.selected,c=e.spritesheetPath,o=t.getTileDimensions(),i=o.tileWidth,u=o.tileHeight,l=Object(s.useRef)(null);return Object(_.jsx)(B.Container,{ref:l,children:Object(_.jsx)(ln,{name:a,controller:t,spritesheetPath:c,location:n,idleAnimation:Math.random()<.5,children:r&&Object(_.jsx)(B.Graphics,{name:"selectioncircle",draw:function(e){e.lineStyle(3,16777215),e.drawCircle(i/2,u/2,i/2-3),e.endFill()}})})})},xn=Object(s.memo)(yn),wn=function(e){var t=e.objects,n=e.controller;return Object(_.jsx)(B.Container,{children:t.map((function(t){var a=t.location,r=t.name,c=t.properties.adventurerId;switch(t.type){case tn.a.actor:if(Object(rn.c)(t)){if(t.allegiance===O.a.player)return Object(_.jsx)(xn,{location:a,controller:n,adventurerId:c,spritesheetPath:t.properties.spritesheet,selected:e.selectedActorId===r},c);if(t.allegiance===O.a.enemy)return Object(_.jsx)(ln,{name:t.name||"",controller:n,spritesheetPath:t.properties.spritesheet,location:a,idleAnimation:Math.random()<.5,lookAt:[4,3]},t.name)}break;default:return null}return null}))})},kn=function(e){var t=e.data,n=e.objects,a=e.controller,r=e.spritesheets,c=e.selectedActorId;return Object(_.jsx)(B.Container,{children:t.layers.filter((function(e){return e.visible})).map((function(e){if(e.type===$t.a.objectgroup){var o=Nn(n,e),i=o.tileObjects,s=o.spriteObjects;return Object(_.jsxs)(u.a.Fragment,{children:[!!i.length&&Object(_.jsx)(an,{objects:i,tilesets:t.tilesets||[],spritesheets:r}),!!s.length&&Object(_.jsx)(wn,{objects:s||[],controller:a,selectedActorId:c},e.name)]},e.name)}return e.type===$t.a.tilelayer?Object(_.jsx)(nn,{layer:e,horizontalTiles:t.width,tilesets:t.tilesets,spritesheets:r},e.name):null}))})},Nn=function(e,t){return e.reduce((function(e,n){return n.layerId===t.id&&(void 0!==n.gid?e.tileObjects.push(n):!0===n.properties.isSprite&&e.spriteObjects.push(n)),e}),{tileObjects:[],spriteObjects:[]})},Sn=function(e){var t=e.children,n=Object(Q.a)(e,["children"]);return Object(_.jsx)(d.b.Consumer,{children:function(e){var a=e.store;return Object(_.jsx)(B.Stage,Object(Z.a)(Object(Z.a)({},n),{},{children:Object(_.jsx)(d.a,{store:a,children:t})}))}})},In=function(e){var t=Object(s.useState)({}),n=Object(x.a)(t,2),a=n[0],r=n[1],c=Object(s.useState)(),o=Object(x.a)(c,2),i=o[0],u=o[1];return Object(s.useEffect)((function(){if(i){var t=Tn(i,a);if(t){var n=t.name;Object(z.b)("".concat(e,"/").concat(t.image),(function(c){if(c){if(c.error)throw new Error("Loading ".concat(e,"\n").concat(c.error));var o=Cn(t),i=new PIXI.Spritesheet(c.texture,o);i.parse((function(){var e=Object(Z.a)(Object(Z.a)({},a),{},Object(He.a)({},n,i));r(e)}))}}))}}}),[i,e,a]),{loadComplete:!!i&&void 0===Tn(i,a),loadTilesets:function(e){u(e)},tileSpritesheets:a}},Tn=function(e,t){return e.find((function(e){return!t[e.name]}))},Cn=function(e){for(var t=e.columns,n={},a=0;a<e.tilecount;a++){var r=e.tilewidth,c=e.tileheight,o=a%t*r,i=Math.floor(a/t)*c;n["".concat(e.name,"-").concat(a+e.firstgid)]={frame:{x:o,y:i,w:r,h:c},spriteSourceSize:{x:o,y:i,w:r,h:c},rotated:!1,trimmed:!1,sourceSize:{w:r,h:c}}}return{frames:n,meta:{image:e.image,size:{w:e.imagewidth,h:e.imageheight},scale:1}}},qn=n(118),An=(n(444),function(){return Object(_.jsx)("div",{className:"loading-spinner",children:Object(r.a)(Array(5)).map((function(e,t){return Object(_.jsx)("div",{className:"ring",children:Object(_.jsx)("div",{className:"inner"})},t)}))})}),En=function(e){var t=Object(s.useRef)();return Object(s.useEffect)((function(){t.current=e}),[e]),t.current},Pn=Object(s.createContext)(null),Mn=function(e){var t=e.questName,n=e.children,a=Object(d.e)(),r=Object(s.useState)(!1),c=Object(x.a)(r,2),o=c[0],i=c[1],u=a.getState().quests.find((function(e){return e.name===t})),l=u.scene,m=u.sceneName,h=u.questVars,b=En(h),p=Object(s.useMemo)((function(){return m?qn.a.getSceneController(t,m,a):null}),[t,m,a]);return Object(s.useEffect)((function(){if(i(!1),m&&p&&!p.dataLoading){p.loadData((function(){i(!0),!l&&p&&(p.createScene(),p.sceneEntered())}))}}),[p,t,l,m]),Object(s.useEffect)((function(){h!==b&&p&&p.updateScene()}),[p,b,h]),!p||!p.dataLoading&&o?Object(_.jsx)(Pn.Provider,{value:p,children:n}):Object(_.jsx)(An,{})},Dn=function(e){var t=e.icon,n=e.onActivate,a=e.onDeactivate,r=e.activated,c=Object(s.useMemo)((function(){switch(e.position){case"w":return 180;case"sw":return 135;case"s":return 90;case"se":return 45;default:return 0}}),[e.position]),o=r?"scale(1.2)":"",i=Object(Z.a)({transform:"translate(".concat(32,"px, ").concat(27,"px) ").concat(o," rotate(").concat(c,"deg) translateX(").concat(r?36:44,"px)"),background:"url(".concat(".","/img/scene/ui/combat/ring-segment.svg)"),width:32,height:46},r&&{zIndex:2});return Object(_.jsx)("div",{style:i,className:"segment",onMouseOver:n,onMouseOut:a,children:Object(_.jsx)("img",{src:t,style:{transform:"rotate(-".concat(c,"deg)"),width:28},alt:""})})},Rn=(n(445),function(e){var t=e.location,n=e.actionIntent,a=e.onActionChange,r=Object(s.useContext)(Pn).getTileDimensions(),c=r.tileWidth,o=r.tileHeight,i="translate(".concat(c*t[0],"px, ").concat(o*t[1],"px)"),u=Object(s.useState)(!0),l=Object(x.a)(u,2),d=l[0],m=l[1],h=function(e){a(e)},b=function(e){a(void 0)};return Object(_.jsxs)("div",{className:"combat-ui-widget ".concat(d?"collapsed":"expanded"),style:{transform:i},onMouseMove:function(e){e.preventDefault(),e.stopPropagation()},onMouseOver:function(){m(!1)},onMouseOut:function(){},children:[Object(_.jsx)(Dn,{position:"w",icon:"".concat(".","/img/scene/ui/combat/icons/knife-thrust.svg"),onActivate:function(){return h(rn.a.slash)},onDeactivate:function(){return b(rn.a.slash)},activated:(null===n||void 0===n?void 0:n.action)===rn.a.slash}),Object(_.jsx)(Dn,{position:"sw",icon:"".concat(".","/img/scene/ui/combat/icons/high-shot.svg"),activated:!1}),Object(_.jsx)(Dn,{position:"s",icon:"".concat(".","/img/scene/ui/combat/icons/walking-boot.svg"),onActivate:function(){return h(rn.a.move)},onDeactivate:function(){return b(rn.a.move)},activated:(null===n||void 0===n?void 0:n.action)===rn.a.move}),Object(_.jsx)(Dn,{position:"se",icon:"".concat(".","/img/scene/ui/combat/icons/sunken-eye.svg"),activated:!1}),Object(_.jsx)(Dn,{position:"e",icon:"".concat(".","/img/scene/ui/combat/icons/crosshair.svg"),activated:!1}),Object(_.jsx)("div",{className:"info",style:{width:c},children:Hn(n)})]})}),Hn=function(e){if(!e)return null;if(e.action===rn.a.move){var t;if(!(null===(t=e.path)||void 0===t?void 0:t.length))return null;var n=(e.actorAP||0)<(e.apCost||0);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("span",{children:"Move"}),Object(_.jsxs)("span",{className:"".concat(n?"insufficient":""),children:[" ".concat(e.apCost),"AP"]})]})}if(e.action===rn.a.slash){var a;if(!(null===(a=e.path)||void 0===a?void 0:a.length))return null;var r=(e.actorAP||0)<(e.apCost||0);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("span",{children:"Slash"}),Object(_.jsxs)("span",{className:"".concat(r?"insufficient":""),children:[" ".concat(e.apCost),"AP"]})]})}return"?"},Ln=(n(446),function(e){var t=e.location,n=Object(s.useContext)(Pn),a=n.locationIsBlocked(t),r=rn.a.move;if(a){var c=n.getObjectAtLocation(t);(null===c||void 0===c?void 0:c.properties.interactive)&&(r=rn.a.interact,a=!1)}var o=n.getTileDimensions(),i=o.tileWidth,u=o.tileHeight,l="translate(".concat(i*t[0],"px, ").concat(u*t[1],"px)"),d=Wn[r],m=i,h=u;return Object(_.jsx)("div",{className:"normal-ui-cursor ".concat(a?"invalid":""),style:{transform:l,backgroundImage:d,width:m,height:h}})}),Wn=(sn={},Object(He.a)(sn,rn.a.move,"url(".concat(".","/img/scene/ui/combat/icons/walking-boot.svg)")),Object(He.a)(sn,rn.a.interact,"url(".concat(".","/img/scene/ui/combat/icons/sunken-eye.svg)")),sn),Fn=(n(447),function(e){var t=e.children,n=e.selectedActorId,a=e.actionIntent,r=e.sceneWidth,c=e.sceneHeight,o=e.onMouseDown,i=e.onSetActionIntent,u=Object(s.useRef)(null),l=Object(s.useRef)(!1),d=Object(s.useRef)(1),m=Object(s.useContext)(Pn),h=Ht(m.questName).scene,b=h.combat,p=Object(s.useState)(),j=Object(x.a)(p,2),f=j[0],v=j[1];Object(s.useEffect)((function(){var e=function(){var e;if(u.current){var t=null===(e=u.current.parentNode)||void 0===e?void 0:e.querySelector("canvas");if(!t)throw Error("No canvas found as sibling of SceneUI");var n=null===t||void 0===t?void 0:t.clientWidth;d.current=n/r,u.current.style.transform="scale(".concat(d.current,")"),u.current.style.width="".concat(r,"px"),u.current.style.height="".concat(c,"px")}};return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}),[c,r]);var g=Object(s.useCallback)((function(e){if(e){var t=m.getSceneActor(n),a=t.location,r=void 0===a?[0,0]:a,c=t.ap,o=f;switch(e){case rn.a.move:case rn.a.slash:var s=m.findPath(r,o),u=b?m.calculateWalkApCosts(r,o):void 0;i({action:e,from:r,to:o,apCost:u,actorAP:c,path:s});break;case rn.a.interact:var l=m.findPathNearest(r,o,!0);i({action:e,from:r,to:o,apCost:0,actorAP:c,path:l})}}else i(void 0)}),[b,m,f,i,n]);Object(s.useEffect)((function(){if(!b&&void 0!==f){var e=rn.a.move,t=m.getObjectAtLocation(f);(null===t||void 0===t?void 0:t.properties.interactive)&&(e=rn.a.interact),g(e)}}),[f,g,b,m]);var O=function(e){if(e.target instanceof Element){var t=e.target.getBoundingClientRect(),n=(e.clientX-t.left)/d.current,a=(e.clientY-t.top)/d.current;return m.pointToSceneLocation(new PIXI.Point(n,a))}throw new Error("You didnt give me the correct event")};return Object(_.jsxs)("div",{ref:u,className:"scene-ui",onMouseMove:function(e){if(l.current){var t=O(e);if(m.locationIsOutOfBounds(t))return v(void 0),void i(void 0);f&&Object(tn.d)(t,f)||v(t)}},onMouseDown:function(e){var t=O(e);null===o||void 0===o||o(t),l.current=!0},onMouseUp:function(e){if(l.current=!1,v(void 0),a){var t=m.getSceneActor(n).location;t&&f&&!Object(tn.d)(t,f)&&m.actorAttemptAction(n,a.action,a.to),null===i||void 0===i||i(void 0)}},children:[t,!h.combat&&f&&Object(_.jsx)(Ln,{location:f}),h.combat&&f&&Object(_.jsx)(Rn,{location:f,actionIntent:a,onActionChange:g})]})}),Bn=n(64),zn=Object(B.PixiComponent)("DashedLine",{create:function(){return new L.Graphics},applyProps:function(e,t,n){var a=this,r=n.points,c=void 0===r?[]:r,o=n.dash,i=void 0===o?10:o,s=n.gap,u=void 0===s?5:s,l=n.speed,d=void 0===l?40:l,m=n.style,h=Object(Q.a)(n,["points","dash","gap","speed","style"]);Object(B.applyDefaultProps)(e,t,h),e.clear();!function t(){if(!a._destroy){e.clear(),e.lineStyle(null===m||void 0===m?void 0:m.width,null===m||void 0===m?void 0:m.color,null===m||void 0===m?void 0:m.alpha,null===m||void 0===m?void 0:m.alignment,null===m||void 0===m?void 0:m.native);var n=(Date.now()%(1e4/d)+1)/Math.abs(1e4/d),r=0,o=0;if(n>0){var s=(i+u)*n*(d<-1?1:-1);s<i?r=i-s:o=u-(s-i)}var l,h=[],b=Object(Bn.a)(c);try{for(b.s();!(l=b.n()).done;){var p=l.value.clone(),j=Math.cos(e.rotation),f=Math.sin(e.rotation),v=p.x,g=p.y;p.x=v*j-g*f,p.y=v*f+g*j,h.push(p)}}catch(T){b.e(T)}finally{b.f()}for(var O=0;O<h.length-1;O++){var y=h[O],x=h[O+1],w=x.x-y.x,k=x.y-y.y,N=Math.sqrt(w*w+k*k),S={x:w/N,y:k/N},I=0;for(e.moveTo(y.x+o*S.x,y.y+o*S.y);I<=N;)I+=o,(I+=r>0?r:i)>N?(r=I-N,I=N):r=0,e.lineTo(y.x+I*S.x,y.y+I*S.y),(I+=u)>N&&0===r?o=I-N:(o=0,e.moveTo(y.x+I*S.x,y.y+I*S.y))}0!==d&&(a._raf=requestAnimationFrame(t))}}()},willUnmount:function(){this._destroy=!0,cancelAnimationFrame(this._raf)}}),_n=function(e){var t=e.actionIntent,n=e.tileWidth,a=e.tileHeight;switch(t.action){case rn.a.move:case rn.a.interact:case rn.a.slash:if(!t.path)return null;var c=function(e){return new PIXI.Point(e[0]*n+n/2,e[1]*a+a/2)},o=[c(t.from)].concat(Object(r.a)(t.path.map((function(e){return c(e)})))),i=!t.apCost||t.apCost<=(t.actorAP||0);return Object(_.jsx)(zn,{points:o,dash:10,gap:15,speed:20,rotation:0,style:{width:6,color:i?16777215:9109504,alpha:1}});default:return null}},Vn=function(e){return e.log},Gn=function(e){var t=function(e){var t=Object(s.useMemo)((function(){return Object(gt.a)([Vn],(function(t){return t.filter((function(t){return t.channel===Ee.a.quest&&t.channelContext===e}))}))}),[e]);return Object(d.d)(t)}(e.questId);return Object(s.useEffect)((function(){var e=t.shift();null===e||void 0===e||e.time,Date.now()}),[t]),null},Qn=(n(448),function(e){var t,n=e.selectedActorId,a=e.setSelectedActor,r=Object(s.useContext)(Pn),c=r.mapData,o=r.basePath,i=In(o),u=i.loadComplete,l=i.loadTilesets,m=i.tileSpritesheets,h=Object(s.useRef)(null),b=(t=r.questName,Object(d.d)((function(e){var n;return null===(n=e.quests.find((function(e){return e.name===t})))||void 0===n?void 0:n.scene}))),p=r.getTileDimensions(),j=p.tileWidth,f=p.tileHeight,v=Object(s.useState)(),g=Object(x.a)(v,2),O=g[0],y=g[1];Object(s.useEffect)((function(){c&&l(c.tilesets)}),[l,c]);if(!u||!c||!b)return Object(_.jsx)("div",{children:"loading scene..."});var w=c.width*c.tilewidth,k=c.height*c.tileheight;return Object(_.jsxs)("div",{className:"scene",ref:h,children:[Object(_.jsx)(Sn,{width:w,height:k,children:Object(_.jsxs)(B.Container,{interactive:!0,hitArea:new PIXI.Rectangle(0,0,w,k),children:[Object(_.jsx)(kn,{basePath:o,data:c,spritesheets:m,objects:b.objects,controller:r,selectedActorId:n,setSelectedActor:a}),O&&Object(_.jsx)(_n,{actionIntent:O,tileWidth:j,tileHeight:f}),false]})}),false,Object(_.jsx)(Fn,{sceneWidth:w,sceneHeight:k,selectedActorId:n,actionIntent:O,onMouseDown:function(t){var n=r.getObjectAtLocation(t);n&&Object(rn.d)(n)&&(null===n||void 0===n?void 0:n.name)&&e.setSelectedActor(n.name)},onSetActionIntent:y}),Object(_.jsx)(Gn,{questId:r.questName})]})}),Un=(n(449),function(e){var t=Ht(e.questName),n=Object(Ct.a)(t.name),a=Math.floor(t.progress);do{var r=n.nodes[a].log;if(r)return Object(_.jsx)("div",{children:Object(_.jsx)("p",{children:"".concat(q.a.get(r))})});a--}while(a>=0);return Object(_.jsx)("h1",{className:"on-the-road questname",children:q.a.getQuestTitle(t.name)})}),Xn=function(e){return Ht(e.questName).sceneName?Object(_.jsx)(Qn,Object(Z.a)({},e)):Object(_.jsx)(Un,{questName:e.questName})},Yn=n(40),Zn=n(508);var Jn=Object(Zn.a)(Yn.b.ITEM,{beginDrag:function(e){return{inventorySlot:e.index,item:e.item,sourceId:e.sourceId,sourceType:e.sourceType}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.item,n=e.onClick,a=e.isDragging,r=e.connectDragSource,c=e.size;return a?null:r(Object(_.jsx)("div",{children:Object(_.jsx)(ot,{item:t,onClick:function(e){n&&n(e)},size:c})}))})),Kn=(n(450),function(e){var t=(e.className||"")+" items-list";return Object(_.jsx)("ul",{className:t,children:e.items.map((function(t,n){return Object(_.jsxs)("li",{className:"item",children:[Object(_.jsx)(Jn,{item:t,index:n,sourceId:e.sourceId,sourceType:e.sourceType}),Object(_.jsxs)("div",{className:"text",children:[Object(_.jsx)("p",{className:"name",children:q.a.getItemName(t)}),Object(_.jsx)("p",{className:"subtext",children:q.a.getItemSubtext(t)})]})]},"".concat(t).concat(n))}))})}),$n=n(128),ea=function(){var e=Object(d.d)((function(e){return e.adventurers})),t=Object(d.d)((function(e){return e.quests}));return Object(s.useMemo)((function(){return function(e,t){var n=t.reduce((function(e,t){return t.status===dt.active&&e.push.apply(e,Object(r.a)(t.party)),e}),[]);return e.filter((function(e){return-1===n.indexOf(e.id)}))}(e,t)}),[e,t])},ta=function(e){var t=Object(s.useCallback)((function(t){return t.adventurers.find((function(t){return t.id===e}))}),[e]);return Object(d.d)(t)},na=(n(451),n(246),function(e){var t=Object(s.useContext)(Pn),n=ta(e.adventurerId),a=Object(qt.a)(n),r=Object(s.useRef)(null),c=t.getLootCache(e.cacheName);if(!c)return null;return Object(_.jsxs)("div",{className:"interaction-modal loot-cache",ref:r,children:[Object(_.jsxs)("div",{className:"header",children:[Object(_.jsx)("div",{className:"title",children:q.a.get(c.title,{adventurer:n.name})}),Object(_.jsx)("div",{className:"close",onClick:e.onClose})]}),c.items.length>0&&Object(_.jsxs)("div",{className:"content",children:[Object(_.jsx)("div",{className:"items",children:Object(_.jsx)(Kn,{items:c.items,sourceType:Yn.a.lootCache,sourceId:e.cacheName})}),Object(_.jsxs)("div",{className:"adventurer",children:[Object(_.jsx)(Xt,{adventurer:n}),Object(_.jsx)(Ne,{onClick:function(n){n.stopPropagation(),r.current.querySelectorAll(".items-list .item").forEach((function(e,t){t>=a||e.classList.add("taking")})),T.a.to(".items-list .item.taking",{right:"-100%",stagger:{each:.1,ease:"power2.inOut"},onComplete:function(){for(var n=0;n<a;n++)t.takeItemFromCache(0,e.cacheName,e.adventurerId)}})},disabled:0===a,size:"small",children:q.a.get("quest-common-loot-cache-take-all")})]})]}),!!c.gold&&Object(_.jsxs)("div",{className:"content",children:[Object(_.jsxs)("div",{className:"gold",children:[Object(_.jsx)(ct.b,{image:"img/resources/gold.png",size:"medium"}),q.a.get("quest-common-loot-cache-gold",{gold:c.gold})]}),Object(_.jsx)("div",{className:"take-gold",children:Object(_.jsx)(Ne,{onClick:function(n){n.stopPropagation(),t.takeGoldFromCache(e.cacheName)},size:"small",children:q.a.get("quest-common-loot-cache-take")})})]})]})}),aa=(n(452),function(e){var t=Object(s.useContext)(Pn),n=Object(s.useRef)(null),a=t.getSituation(e.situation,e.adventurerId);if(!a)return null;var r=a.title,c=a.choices,o=a.text,i=function(n){var a=n.currentTarget.getAttribute("data-option");t.handleSituationOptionClick(e.situation,a,e.adventurerId),n.stopPropagation()};return Object(_.jsxs)("div",{className:"interaction-modal situation",ref:n,children:[Object(_.jsxs)("div",{className:"header",children:[Object(_.jsx)("div",{className:"title",children:q.a.get(r)}),Object(_.jsx)("div",{className:"close",onClick:function(t){e.onClose(),t.stopPropagation()}})]}),Object(_.jsxs)("div",{className:"content",children:[o&&Object(_.jsx)("div",{className:"text",children:q.a.get(o)}),null===c||void 0===c?void 0:c.map((function(e){return Object(_.jsx)(Ne,{"data-option":e,onClick:i,children:q.a.get(e)},e)}))]})]})}),ra=(n(453),function(e){var t=e.selectedAdventurerId,n=Object(d.d)(Kt(e.questName)),a=Object(s.useContext)(Pn);return Object(_.jsxs)("div",{className:"combat-bar",children:[Object(_.jsx)("div",{className:"title",children:q.a.get("ui-combat-bar-title")}),Object(_.jsx)("div",{className:"adventurers",children:n.map((function(e){var n;return Object(_.jsxs)("div",{className:"adventurer ".concat(t===e.id?"selected":""),children:[Object(_.jsx)(Xt,{adventurer:e,size:ct.a.smallest}),Object(_.jsxs)("div",{className:"ap",children:[(null===(n=a.getSceneActor(e.id))||void 0===n?void 0:n.ap)||0," AP"]})]},e.id)}))}),Object(_.jsx)(Ne,{size:"small",children:"End turn"})]})}),ca=n(503),oa={drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){var n=t.getItem();return n.sourceType!==Yn.a.adventurerEquipment||(null==e.item||Object(on.c)(e.item,n.inventorySlot))}},ia=Object(ca.a)(Yn.b.ITEM,oa,(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,a=e.connectDropTarget,r=["inventory-item"];return t&&n?r.push("drop-active"):n&&r.push("drop-possible"),a(Object(_.jsx)("div",{className:r.join(" "),children:e.children}))})),sa=(n(454),function(e){for(var t=[],n=function(n){var a=void 0,r=e.items[n];r&&(a=Object(_.jsx)(Jn,{index:n,sourceId:e.sourceId,sourceType:e.sourceType,item:r}));var c=Object(_.jsx)(ia,{item:r,size:e.iconSize,onDrop:function(t){if((t.inventorySlot!==n||t.sourceType!==e.sourceType||t.sourceId!==e.sourceId)&&e.onDropItem){var a=t.inventorySlot;e.onDropItem(t.item,a,n,t.sourceType,t.sourceId)}},children:a},"inventory-slot-".concat(n));t.push(c)},a=0;a<e.items.length;a++)n(a);return Object(_.jsx)("div",{className:"inventory ".concat(e.className?e.className:""),children:t})}),ua=n(41),la=function(){return Object(d.d)((function(e){return e.stockpile}))},da=function(){var e=Object(d.c)(),t=Object(s.useContext)(Pn),n=la();return{dropItemEquipment:function(t,n,a){var r=t.item,c=[];switch(C.c.playSound("ui/equip"),t.sourceType){case Yn.a.adventurerInventory:c.push(Object(ua.f)(a.id,t.inventorySlot),Object(ua.c)(a.id,n,r));var o=a.equipment[n];o&&c.push(Object(ua.b)(a.id,o,t.inventorySlot));break;case Yn.a.warehouse:c.push(Xe(t.inventorySlot),Object(ua.c)(a.id,n,r));var i=a.equipment[n];i&&c.push(Ue(i,t.inventorySlot));break;case Yn.a.adventurerEquipment:c.push(Object(ua.c)(a.id,n,r));var s=a.equipment[n],u=t.inventorySlot;s?c.push(Object(ua.c)(a.id,u,s)):c.push(Object(ua.e)(a.id,u))}c.forEach((function(t){return e(t)}))},dropItemInventory:function(n,a,r,c,o,i){var s=[];switch(c){case Yn.a.adventurerInventory:s.push(Object(ua.d)(o.id,a,r));break;case Yn.a.warehouse:s.push(Xe(a),Object(ua.b)(o.id,n,r));var u=o.inventory[r];u&&s.push(Ue(u,a));break;case Yn.a.adventurerEquipment:s.push(Object(ua.b)(o.id,n,r));var l=o.inventory[r];l?s.push(Object(ua.c)(o.id,a,l)):s.push(Object(ua.e)(o.id,a));break;case Yn.a.lootCache:t&&i&&t.takeItemFromCache(a,i,o.id,r)}s.forEach((function(t){return e(t)}))},dropItemWarehouse:function(t,a,r,c,o){var i=[];switch(c){case Yn.a.warehouse:i.push(function(e,t){return{type:_e.moveItemInWarehouse,fromSlot:e,toSlot:t}}(a,r));var s=n[r];s&&i.push(Object(ua.b)(o,s,a));break;case Yn.a.adventurerInventory:i.push(Object(ua.f)(o,a),Ue(t,r));var u=n[r];u&&i.push(Object(ua.b)(o,u,a))}i.forEach((function(t){return e(t)}))}}},ma=(n(455),function(e){var t,n=ta(e.adventurerId);return(null===n||void 0===n?void 0:n.skills)?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("p",{children:q.a.get("ui-adventurer-info-skills-title")}),Object(_.jsx)("ul",{className:"adventurer-skills",children:null===(t=Object.keys(n.skills))||void 0===t?void 0:t.map((function(e){return function(e){var t=function(t){var n=t.currentTarget.getBoundingClientRect();rt.showContextTooltip(Ze.skill,e,n),t.stopPropagation()};return Object(_.jsx)(s.Fragment,{children:Object(_.jsxs)("li",{onClick:t,children:[Object(_.jsx)("span",{className:"skill",onClick:t,children:q.a.getSkillName(e)}),Object(_.jsx)("span",{children:n.skills[e]})]})},e)}(e)}))})]}):null});function ha(e){return Math.pow(e/.5,2)}var ba;n(456);!function(e){e[e.increasing=0]="increasing",e[e.decreasing=1]="decreasing"}(ba||(ba={}));var pa=function(e){var t,n,a,r=e.className,c=void 0===r?"":r,o=e.animationTime,i=Object(s.useRef)(0),u=(t=e.progress||0,n=0,t>(a=1)?a:t<n?n:t);return i.current=u,Object(_.jsxs)("div",{className:"progressbar ".concat(c),children:[Object(_.jsx)("div",{className:"progressbar-label",children:e.label}),Object(_.jsx)("div",{className:"progressbar-bar",style:Object(Z.a)({width:"".concat(100*u,"%")},o&&{transition:"width ".concat(o,"ms linear")})})]})};var ja,fa,va=function(e){var t=e.adventurerId,n=ta(t).xp,a=function(e){return Math.floor(.5*Math.sqrt(e))}(n),r=ha(a),c=a+1,o=ha(c),i=Object(s.useState)(!1),u=Object(x.a)(i,2),l=u[0],d=u[1],m=En({currentLevel:a,currentLevelXp:r,nextLevel:c,nextLevelXp:o}),h=En(t);Object(s.useEffect)((function(){var e;h!==t?d(!1):c>(null!==(e=null===m||void 0===m?void 0:m.nextLevel)&&void 0!==e?e:0)&&(C.c.playSound("ui/levelUp"),d(!0),setTimeout((function(){d(!1)}),2e3))}),[t,h,null===m||void 0===m?void 0:m.nextLevel,c]);var b=En(l),p=Object(s.useMemo)((function(){return l?1:(n-r)/(o-r)}),[r,l,o,n]);return Object(_.jsxs)("div",{className:"level",children:["Level ",a,Object(_.jsx)(pa,{progress:p,animationTime:h!==t||b?0:300,label:l?q.a.get("ui-adventurer-info-xp-level-up"):q.a.get("ui-adventurer-info-xp-progress",{xp:Math.floor(n-r),next:o-r})})]})},ga=function(e){var t,n=Ht(e.questName),a=Object(s.useContext)(Pn),r=Object(s.useMemo)((function(){var t;return a&&(null===(t=a.getSceneActor(e.adventurer.id))||void 0===t?void 0:t.ap)||null}),[a,e.adventurer.id]);return(null===n||void 0===n||null===(t=n.scene)||void 0===t?void 0:t.combat)?Object(_.jsx)("span",{children:q.a.get("ui-adventurer-info-ap-remaining",{ap:r})}):null};n(457);!function(e){e.arrowFinder="arrowFinder",e.gloomy="gloomy",e.houseHouston="houseHouston",e.houseMaddox="houseMaddox",e.houseMonroe="houseMonroe"}(ja||(ja={}));var Oa=(fa={},Object(He.a)(fa,ja.arrowFinder,{trait:ja.arrowFinder,hasEffect:!0}),Object(He.a)(fa,ja.gloomy,{trait:ja.gloomy,hasEffect:!0}),Object(He.a)(fa,ja.houseHouston,{trait:ja.houseHouston}),Object(He.a)(fa,ja.houseMaddox,{trait:ja.houseMaddox}),Object(He.a)(fa,ja.houseMonroe,{trait:ja.houseMonroe}),fa);var ya,xa=function(e){var t=ta(e.adventurerId),n=function(e,t){var n=function(e){return Oa[e]}(e);return Object(_.jsxs)(s.Fragment,{children:[Object(_.jsx)("li",{onClick:function(e){var t=e.currentTarget.getBoundingClientRect();rt.showContextTooltip(Ze.trait,n,t),e.stopPropagation()},children:q.a.getTraitName(e)}),!t&&", "]},e)};return(null===t||void 0===t?void 0:t.traits)?Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("p",{children:q.a.get("ui-adventurer-info-traits-title")}),Object(_.jsx)("ul",{className:"adventurer-traits",children:t.traits.map((function(e,a){return n(e,a===t.traits.length-1)}))})]}):null},wa=(n(458),function(e){var t=function(e){var t,n=ta(e),a=function(e){var t=n.equipment[e];return t&&Object($n.b)(t).damageReduction||0};return t={},Object(He.a)(t,on.a[on.a.head],a(on.a.head)),Object(He.a)(t,on.a[on.a.chest],a(on.a.chest)),Object(He.a)(t,on.a[on.a.hands],a(on.a.hands)),Object(He.a)(t,on.a[on.a.shoulders],a(on.a.shoulders)),Object(He.a)(t,on.a[on.a.legs],a(on.a.legs)),Object(He.a)(t,on.a[on.a.feet],a(on.a.feet)),t}(e.adventurerId),n=function(e){var n=t[on.a[e]];return n?Object(_.jsx)("div",{className:on.a[e],children:n},e):null};return Object(_.jsxs)("li",{className:"guy",children:[n(on.a.head),n(on.a.chest),n(on.a.hands),n(on.a.shoulders),n(on.a.legs),n(on.a.feet)]})}),ka=(n(459),function(e){var t=e.adventurer,n=e.onDropItemEquipment,a=function(e){var a=t.equipment[e];return Object(_.jsxs)("li",{className:on.a[e],children:[Object(_.jsx)(on.b,{onDrop:function(t){return n(t,e)},type:e,children:a&&Object(_.jsx)(Jn,{index:e,sourceId:t.id,sourceType:Yn.a.adventurerEquipment,item:a,size:ct.a.medium})}),Object(_.jsx)("span",{className:"info",children:q.a.getEquipmentSlot(e)})]})};return Object(_.jsxs)("ul",{className:"adventurer-equipment",children:[a(on.a.head),a(on.a.chest),a(on.a.hands),a(on.a.shoulders),a(on.a.legs),a(on.a.feet),a(on.a.mainHand),a(on.a.offHand),Object(_.jsx)(wa,{adventurerId:t.id})]})}),Na=(n(460),function(e){var t=e.adventurerId,n=e.questName,a=e.horizontalMode,r=e.name,c=void 0===r||r,o=e.levelBar,i=void 0===o||o,s=e.traits,u=void 0===s||s,l=e.skills,d=void 0===l||l,m=ta(t),h=da(),b=h.dropItemEquipment,p=h.dropItemInventory;return Object(_.jsxs)("div",{className:"adventurer-panel".concat(a?" horizontal":""),children:[Object(_.jsxs)("div",{className:"left",children:[Object(_.jsxs)("div",{className:"info",children:[c&&Object(_.jsxs)("div",{className:"name",children:[m.name,n&&Object(_.jsx)(ga,{questName:n,adventurer:m})]}),i&&Object(_.jsx)(va,{adventurerId:m.id}),u&&Object(_.jsx)(xa,{adventurerId:m.id}),d&&Object(_.jsx)(ma,{adventurerId:m.id})]}),Object(_.jsx)("div",{className:"equipment",children:Object(_.jsx)(ka,{adventurer:m,onDropItemEquipment:function(e,t){b(e,t,m)}})})]}),Object(_.jsx)("div",{className:"right",children:Object(_.jsx)(sa,{sourceType:Yn.a.adventurerInventory,sourceId:m.id,items:m.inventory,className:"inventory-small",onDropItem:function(e,t,n,a,r){p(e,t,n,a,m,r)}})})]})});n(461);!function(e){e[e.auto=0]="auto",e[e.vertical=1]="vertical",e[e.horizontal=2]="horizontal"}(ya||(ya={}));var Sa,Ia=function(e){var t,n,a=Object(S.g)(),r=Object(d.c)(),c=e.layout,o=void 0===c?ya.auto:c,i=Object(d.d)(Kt(e.questName)),u=i[0],l=Object(s.useState)(null===u||void 0===u?void 0:u.id),m=Object(x.a)(l,2),h=m[0],b=m[1],p=Ht(e.questName),j=null===p||void 0===p||null===(t=p.scene)||void 0===t?void 0:t.activeInteractionModal,f=function(e){b(e)},v=function(){r(Object(Lt.f)(e.questName))};return Object(s.useEffect)((function(){i.length||a.push(Object(D.d)())}),[i.length,a]),i.length?Object(_.jsxs)(Mn,{questName:e.questName,children:[(null===p||void 0===p||null===(n=p.scene)||void 0===n?void 0:n.combat)&&Object(_.jsx)(ra,{questName:e.questName,selectedAdventurerId:h}),Object(_.jsxs)("div",{className:"quest-panel quest-panel-".concat(ya[o]),children:[Object(_.jsxs)("div",{className:"quest-area",children:[Object(_.jsx)(Xn,{questName:e.questName,selectedActorId:h,setSelectedActor:f}),j&&"lootCache"===j.type&&Object(_.jsx)("div",{className:"modal",onClick:v,children:Object(_.jsx)(na,{cacheName:j.lootCache,adventurerId:h,onClose:v})}),j&&"situation"===j.type&&Object(_.jsx)("div",{className:"modal",onClick:v,children:Object(_.jsx)(aa,{situation:j.situation,adventurerId:h,onClose:v})})]}),Object(_.jsxs)("div",{className:"party-area",children:[Object(_.jsx)(Yt,{adventurers:i,selectedAdventurerId:h,onAdventurerTabSelected:f,disabled:void 0!==j}),Object(_.jsx)("div",{className:"adventurer-details",children:h&&Object(_.jsx)(Na,{adventurerId:h,questName:e.questName})})]})]})]}):null},Ta=(n(462),function(){var e=Object(s.useRef)(null),t=Object(S.i)("".concat(Object(D.d)(),"/:questname")),n=null===t||void 0===t?void 0:t.params.questname,a=Object(S.g)();Object(s.useEffect)((function(){C.c.addSound("music/world","sound/music/TheLoomingBattle.ogg",(function(){C.c.playSound("music/world",C.a.music,!0,C.b.fade,!0)}))}),[]);return Object(_.jsxs)("div",{className:"world-view",ref:e,children:[Object(_.jsx)(Bt,{selectedQuestName:n,smallMap:null!=n,onPartyClick:function(e){a.push(Object(D.a)(e)),C.c.playSound("ui/buttonClick")},retrieveWorldViewRef:function(){return e}}),n&&Object(_.jsx)(Ia,{questName:n})]})});n(463);!function(e){e[e.all=0]="all",e[e.town=1]="town",e[e.quest=2]="quest"}(Sa||(Sa={}));var Ca,qa,Aa=function(){var e=Object(s.useState)(!1),t=Object(x.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)("all"),c=Object(x.a)(r,2),o=c[0],i=c[1],u=Object(d.d)((function(e){return e.log})),l=function(){var e=Object(s.useMemo)((function(){return Et([Mt,Dt],(function(e,t){return e.filter((function(e,n){return t[n]===dt.active}))}))}),[]);return Object(d.d)(e)}(),m=Object(S.h)();Object(s.useEffect)((function(){m.pathname!==Object(D.c)()?l.forEach((function(e){m.pathname===Object(D.a)(e)&&i("quest-".concat(e))})):i("town")}),[l,m]);var h=[{label:q.a.get("ui-log-tab-all"),tabId:"all",tabType:Sa.all},{label:q.a.get("ui-log-tab-town"),tabId:"town",tabType:Sa.town}];l.forEach((function(e){h.push({channelContext:e,label:q.a.getQuestTitle(e),tabId:"quest-".concat(e),tabType:Sa.quest})}));var b=[],p=h.find((function(e){return e.tabId===o}));switch(null===p||void 0===p?void 0:p.tabType){case Sa.all:b=u;break;case Sa.town:b=u.filter((function(e){return e.channel===Ee.a.town}));break;case Sa.quest:b=u.filter((function(e){return e.channel===Ee.a.quest&&e.channelContext===p.channelContext}))}return Object(_.jsxs)("div",{className:"log".concat(n?" expanded":""),children:[Object(_.jsxs)("div",{className:"tab-bar",children:[Object(_.jsx)(Qt,{className:"tabs",onTabSelected:function(e){i(e)},activeTab:o,children:h.map((function(e){return Object(_.jsx)(Ut,{id:e.tabId,children:e.label},e.tabId)}))}),Object(_.jsx)(Ne,{className:"expand-button",onClick:function(){a(!n)},square:!0,size:"medium",text:n?"\u25bc":"\u25b2"})]}),Object(_.jsx)("div",{className:"log-entries",children:b.map((function(e){return function(e){var t=q.a.get(e.key,e.context);return Object(_.jsx)("div",{className:"entry",children:t},e.time)}(e)}))})]})};function Ea(e,t,n,a,r){return{type:Ca.start,taskType:e,name:t,origin:n,time:a,callbacks:r}}function Pa(e){var t=Object(s.useCallback)((function(t){return t.structures[e]}),[e]);return Object(d.d)(t)}!function(e){e.start="startTask",e.update="updateTasks"}(Ca||(Ca={})),function(e){e[e.buildStructure=0]="buildStructure",e[e.upgradeStructure=1]="upgradeStructure",e[e.craftItem=2]="craftItem",e[e.studyItem=3]="studyItem"}(qa||(qa={}));var Ma,Da,Ra=function(e){var t=e.info,n=Object(d.c)(),a=vt(),r=Object(P.b)(t.structure),c=r.cost.gold||0<=a,o=!(Pa(t.structure).state===g.NotBuilt)||!c,i=q.a.getItemSubtext(t.item),s=function(e){n(Object(Qe.c)(r.cost.gold||0)),n(function(e){return{type:ke.startBuildingStructure,structure:e}}(e));var t=[We(e)],a=r.cost.time,c=Ea(qa.buildStructure,"".concat(e,".build"),"town",a,t);n(c)};return Object(_.jsxs)("div",{children:[i&&Object(_.jsx)("p",{className:"subtext",children:'"'.concat(i,'"')}),Object(_.jsxs)(Ne,{disabled:o,size:"small",onClick:function(){return s(t.structure)},children:["Start construction (",r.cost.gold," gold)"]})]})},Ha=n(39),La=(Ma={},Object(He.a)(Ma,Ae.a.aegisOfValor,{item:Ae.a.aegisOfValor,levelRequired:3,cost:{resources:{wood:20,iron:5},time:Me.c}}),Object(He.a)(Ma,Ae.a.arbalest,{item:Ae.a.arbalest,cost:{resources:{wood:20,iron:5},time:Me.c}}),Object(He.a)(Ma,Ae.a.battleAxe,{item:Ae.a.battleAxe,cost:{resources:{wood:20,iron:5},time:Me.c}}),Object(He.a)(Ma,Ae.a.berserkerShield,{item:Ae.a.berserkerShield,levelRequired:2,cost:{resources:{wood:20,iron:5},time:Me.c}}),Object(He.a)(Ma,Ae.a.brassKnuckles,{item:Ae.a.brassKnuckles,cost:{resources:{wood:20,iron:5},time:Me.c}}),Object(He.a)(Ma,Ae.a.simpleCrossbow,{item:Ae.a.simpleCrossbow,cost:{resources:{wood:20,iron:5},time:Me.c}}),Object(He.a)(Ma,Ae.a.cleaver,{item:Ae.a.cleaver,cost:{resources:{wood:10,iron:15},time:Me.c}}),Object(He.a)(Ma,Ae.a.club,{item:Ae.a.club,cost:{resources:{wood:30},time:Me.c}}),Object(He.a)(Ma,Ae.a.dagger,{item:Ae.a.dagger,cost:{resources:{wood:10,iron:10},time:Me.d}}),Object(He.a)(Ma,Ae.a.flail,{item:Ae.a.flail,cost:{resources:{wood:10,iron:10},time:Me.d}}),Object(He.a)(Ma,Ae.a.goldenShield,{item:Ae.a.goldenShield,levelRequired:2,cost:{resources:{wood:20,iron:5},time:Me.c}}),Object(He.a)(Ma,Ae.a.javelin,{item:Ae.a.javelin,cost:{resources:{wood:20,iron:10},time:Me.d+Me.c}}),Object(He.a)(Ma,Ae.a.khopesh,{item:Ae.a.khopesh,cost:{resources:{wood:15,iron:40},time:Me.g}}),Object(He.a)(Ma,Ae.a.longbow,{item:Ae.a.longbow,cost:{resources:{wood:40,iron:5},time:Me.d}}),Object(He.a)(Ma,Ae.a.mace,{item:Ae.a.mace,cost:{resources:{wood:15,iron:10},time:Me.d}}),Object(He.a)(Ma,Ae.a.morningStar,{item:Ae.a.morningStar,cost:{resources:{wood:15,iron:15},time:Me.d}}),Object(He.a)(Ma,Ae.a.paintedBuckler,{item:Ae.a.paintedBuckler,cost:{resources:{wood:20,iron:10},time:Me.d+Me.c}}),Object(He.a)(Ma,Ae.a.poisonedDagger,{item:Ae.a.poisonedDagger,cost:{resources:{wood:50,iron:15},materials:[Ae.a.poisonVial],time:Me.d}}),Object(He.a)(Ma,Ae.a.ravenStaff,{item:Ae.a.ravenStaff,cost:{resources:{wood:15,iron:10,food:5},time:Me.d}}),Object(He.a)(Ma,Ae.a.savageStaff,{item:Ae.a.savageStaff,cost:{resources:{wood:15,iron:10,food:5},time:Me.d}}),Object(He.a)(Ma,Ae.a.spear,{item:Ae.a.spear,cost:{resources:{wood:15,iron:15},time:Me.d}}),Object(He.a)(Ma,Ae.a.steelShield,{item:Ae.a.steelShield,cost:{resources:{wood:15,iron:15},time:Me.d}}),Object(He.a)(Ma,Ae.a.sword,{item:Ae.a.sword,cost:{resources:{wood:10,iron:30},time:Me.d}}),Object(He.a)(Ma,Ae.a.warhammer,{item:Ae.a.warhammer,cost:{resources:{wood:10,iron:30},time:Me.d}}),Object(He.a)(Ma,Ae.a.woodenBulwark,{item:Ae.a.woodenBulwark,cost:{resources:{wood:10,iron:30},time:Me.d}}),Ma),Wa=La;var Fa,Ba,za=(Da={},Object(He.a)(Da,Ae.a.boots1,{item:Ae.a.boots1,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.boots2,{item:Ae.a.boots2,cost:{resources:{wood:10,iron:45},time:Me.d},levelRequired:2}),Object(He.a)(Da,Ae.a.boots3,{item:Ae.a.boots3,cost:{resources:{wood:10,iron:45},time:Me.d},levelRequired:3}),Object(He.a)(Da,Ae.a.chainmailHood,{item:Ae.a.chainmailHood,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.chest,{item:Ae.a.chest,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.clothGloves,{item:Ae.a.clothGloves,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.cowl,{item:Ae.a.cowl,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.druidChest,{item:Ae.a.druidHands,cost:{resources:{wood:10,iron:45},time:Me.d},levelRequired:2}),Object(He.a)(Da,Ae.a.druidFeet,{item:Ae.a.druidFeet,cost:{resources:{wood:10,iron:45},time:Me.d},levelRequired:2}),Object(He.a)(Da,Ae.a.druidHands,{item:Ae.a.druidHands,cost:{resources:{wood:10,iron:45},time:Me.d},levelRequired:2}),Object(He.a)(Da,Ae.a.druidHead,{item:Ae.a.druidHead,cost:{resources:{wood:10,iron:45},time:Me.d},levelRequired:2}),Object(He.a)(Da,Ae.a.druidLegs,{item:Ae.a.druidLegs,cost:{resources:{wood:10,iron:45},time:Me.d},levelRequired:2}),Object(He.a)(Da,Ae.a.fedora,{item:Ae.a.fedora,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.greaves1,{item:Ae.a.greaves1,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.greaves2,{item:Ae.a.greaves2,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.hornedHelmet,{item:Ae.a.hornedHelmet,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.leatherGloves,{item:Ae.a.leatherGloves,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.nomadHelmet,{item:Ae.a.nomadHelmet,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.pants1,{item:Ae.a.pants1,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.pants2,{item:Ae.a.pants2,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.plateChest1,{item:Ae.a.plateChest1,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.plateChest2,{item:Ae.a.plateChest2,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.plateChest3,{item:Ae.a.plateChest3,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.plateChest4,{item:Ae.a.plateChest4,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.plateGloves1,{item:Ae.a.plateGloves1,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.plateGloves2,{item:Ae.a.plateGloves2,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.plateHelmet,{item:Ae.a.plateHelmet,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.platePants,{item:Ae.a.platePants,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.plateShoulders1,{item:Ae.a.plateShoulders1,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.plateShoulders2,{item:Ae.a.plateShoulders2,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.robe,{item:Ae.a.robe,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.shoulders1,{item:Ae.a.shoulders1,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.shoulders2,{item:Ae.a.shoulders2,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.shoulders3,{item:Ae.a.shoulders3,cost:{resources:{wood:10,iron:45},time:Me.d}}),Object(He.a)(Da,Ae.a.vest,{item:Ae.a.vest,cost:{resources:{wood:10,iron:45},time:Me.d}}),Da),_a=(Fa={},Object(He.a)(Fa,Ae.a.torch,{item:Ae.a.torch,cost:{resources:{wood:2,fabric:1},time:Me.e}}),Object(He.a)(Fa,Ae.a.sandwich,{item:Ae.a.sandwich,cost:{resources:{food:1},time:Me.e/2}}),Fa),Va={},Ga=Object(Z.a)(Object(Z.a)(Object(Z.a)(Object(Z.a)({},Va),za),Wa),_a),Qa=function(e){return Ga[e]},Ua=function(e){return e.tasks},Xa=function(e){return Object(d.d)(function(e){return Object(gt.a)([Ua],(function(t){return t.running.filter((function(t){return t.origin==="".concat(e,".craft")}))}))}(e))},Ya=function(e){return Object(d.d)(function(e){return Object(gt.a)([Ua],(function(t){return t.running.filter((function(t){return t.origin==="".concat(e,".study")}))}))}(e))},Za=function(e){return Object(d.d)(function(e){return Object(gt.a)([Ua],(function(t){return t.running.filter((function(t){return t.name==="".concat(e,".upgrade")}))}))}(e))},Ja=Me.g,Ka=function(e){var t=e.structure,n=Pa(t),a=Ya(t),r=Object(d.c)();if(!t)return null;if(n.produces.some((function(t){return t===e.item})))return Object(_.jsxs)("p",{children:["Constructed at:\xa0",Object(_.jsx)(N.b,{to:Object(D.b)(t),children:q.a.getStructureName(t)})]});var c=a.find((function(t){return t.name===e.item}));if(c)return Object(_.jsxs)("p",{children:[Object(_.jsx)(N.b,{to:Object(D.b)(t),children:q.a.get("ui-tooltip-study-currently-studying")}),Object(Me.h)(c.timeRemaining,!0)]});var o=Qa(e.item);if(n.level<(o.levelRequired||0)||n.state!==g.Built)return Object(_.jsx)("p",{className:"invalid",children:q.a.get("ui-tooltip-study-requires-structure-level",{structure:t,level:(o.levelRequired||0)+1})});return Object(_.jsx)("p",{children:Object(_.jsx)(Ne,{onClick:function(){var n=[ze(e.structure,e.item)],a=Ja,c=Ea(qa.studyItem,e.item,"".concat(t,".study"),a,n);r(c)},size:"small",children:q.a.get("ui-tooltip-study-start-study")})})},$a=function(e){var t,n=(t=e.item,Va[t]?P.a.alchemist:za[t]?P.a.armoursmith:Wa[t]?P.a.weaponsmith:_a[t]?P.a.workshop:null);return Object(qe.a)(e.item).unique?Object(_.jsx)("p",{children:"Unique item"}):n?Object(_.jsx)(Ka,{item:e.item,structure:n}):null},er=function(e){var t=e.info,n=q.a.getItemSubtext(t.item),a=q.a.getWeaponType(t.weaponType),r=Ha.d[t.weaponType].classification,c=q.a.getWeaponClassification(r);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("div",{children:[a,t.weaponType!==Ha.c.shield&&" (".concat(c,")")]}),n&&Object(_.jsx)("p",{className:"subtext",children:'"'.concat(n,'"')}),t.damage&&Object(_.jsxs)("p",{children:[" damage: ",t.damage[Ha.a.kinetic]," "]}),Object(_.jsx)($a,{item:t.item})]})},tr=function(e){var t=e.info,n=t.damageReduction,a=q.a.getItemSubtext(t.item),r=q.a.getEquipmentSlot(t.equipmentType);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{children:"".concat(r)}),a&&Object(_.jsx)("p",{className:"subtext",children:'"'.concat(a,'"')}),n&&Object(_.jsxs)("p",{children:[" ",q.a.get("ui-tooltip-damage-reduction",{damageReduction:n})," "]}),Object(_.jsx)($a,{item:t.item})]})},nr=(n(464),function(e){var t=e.info;switch(t.itemType){case Ae.b.deed:return Object(_.jsx)(Ra,{info:t});case Ae.b.weapon:return Object(_.jsx)(er,{info:t});case Ae.b.apparel:return Object(_.jsx)(tr,{info:t});default:var n=q.a.getItemSubtext(t.item);return n&&Object(_.jsx)("p",{className:"subtext",children:'"'.concat(n,'"')})||null}}),ar=(n(465),function(e){var t=e.info,n=yt(),a=vt(),r=Object(d.d)((function(e){return e.workers})),c=wt(),o=Object(d.d)((function(e){return e.structures})),i=Object(d.d)(Ot);switch(t){case Pe.a.fabric:case Pe.a.food:case Pe.a.iron:case Pe.a.leather:case Pe.a.stone:case Pe.a.wood:var s=ft(n[t],0),u=n[t]>=i[t];return Object(_.jsxs)("div",{className:"resource-context",children:[Object(_.jsx)("div",{className:"info",children:q.a.get("resource-".concat(t,"-info"))}),Object(_.jsx)("div",{children:q.a.get("ui-tooltip-resource-quantity",{amount:s})}),Object(_.jsx)("div",{children:function(){var e=Object(P.c)(t),n=o[e];if(n.state!==g.Built)return Object(_.jsx)("span",{children:q.a.get("ui-tooltip-resource-produce-row-notbuilt",{structure:q.a.getStructureName(e)})});var a=Object(P.b)(e).levels[n.level].generates[t],r=q.a.get("ui-tooltip-resource-produce-row",{structure:"%SPLIT%",amount:a}).split("%SPLIT%");return Object(_.jsxs)("span",{className:"produced",children:[r[0],Object(_.jsx)(N.b,{to:Object(D.b)(e),children:q.a.getStructureName(e)}),r[1]]})}()}),u&&Object(_.jsx)("div",{className:"warning-full",children:q.a.get("ui-tooltip-resource-warehouse-full",{resource:t})})]});case"gold":var l=a;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{className:"resource-context",children:Object(_.jsx)("div",{className:"info",children:" ".concat(q.a.get("resource-".concat(t,"-info")))})}),Object(_.jsx)("div",{children:q.a.get("ui-tooltip-resource-quantity",{amount:l})})]});case"workers":var m=c,h=r;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{className:"resource-context",children:Object(_.jsx)("div",{className:"info",children:" ".concat(q.a.get("resource-".concat(t,"-info")))})}),Object(_.jsx)("div",{children:q.a.get("ui-tooltip-workers-quantity",{free:m,total:h})})]});default:throw new Error("Uknow value "+t)}}),rr=(n(466),function(e){var t=e.className,n=e.children,a=Object(Q.a)(e,["className","children"]);return Object(_.jsx)("div",Object(Z.a)(Object(Z.a)({},a),{},{className:"info-window ".concat(t||""),children:n}))});n(467);!function(e){e[e.bottom=0]="bottom",e[e.top=1]="top",e[e.left=2]="left",e[e.right=3]="right"}(Ba||(Ba={}));var cr,or=function(e){var t=e.children,n=e.referenceRect,a=e.className,r=void 0===a?"":a,c=Object(s.useRef)(null),o=Object(s.useState)(e.placement||Ba.bottom),i=Object(x.a)(o,2),u=i[0],l=i[1],d=Object(s.useState)(),m=Object(x.a)(d,2),h=m[0],b=m[1];Object(s.useEffect)((function(){var e=c.current;if(e&&h){var t=e.getBoundingClientRect();switch(u){case Ba.top:if(t.top-t.height-8-8<h.top)return void l(Ba.bottom);break;case Ba.bottom:if(t.top+t.height+8+8>h.height)return void l(Ba.top)}e.style.opacity="1";var n=e.querySelector(".tooltip-content");if(t.left<h.left+8){var a=h.left-t.left+8;n.style.transform="translateX(".concat(a,"px)")}else if(t.right>h.right-8){var r=t.right-h.right+8;n.style.transform="translateX(".concat(-r,"px)")}else n.style.transform=""}}),[l,h,u,n]);var p=function(){rt.clear()};Object(s.useEffect)((function(){var e,t;return b(null===(e=c.current)||void 0===e||null===(t=e.closest(".app"))||void 0===t?void 0:t.getBoundingClientRect()),window.addEventListener("resize",p),function(){window.removeEventListener("resize",p)}}),[]);var j=0,f=0;if(h)switch(u){case Ba.bottom:j=n.left-h.left+n.width/2,f=n.top-h.top+n.height,r+=" tooltip-bottom";break;case Ba.top:j=n.left-h.left+n.width/2,f=n.top-h.top,r+=" tooltip-top"}return Object(_.jsxs)("div",{className:"tooltip ".concat(r),style:{left:j,opacity:0,top:f},ref:c,children:[Object(_.jsx)("div",{className:"tooltip-arrow"}),Object(_.jsx)(rr,{className:"tooltip-content",children:t})]})},ir=(n(468),function(e){var t=e.traitDefinition;return Object(_.jsxs)("div",{className:"trait-context",children:[Object(_.jsx)("div",{className:"description",children:q.a.getTraitDescription(t.trait)}),t.hasEffect&&Object(_.jsx)("div",{className:"effect",children:q.a.getTraitEffect(t.trait)})]})}),sr=(n(469),function(){var e=Object(s.useState)(),t=Object(x.a)(e,2),n=t[0],a=t[1],r=function(e){a(e)};if(Object(s.useEffect)((function(){return rt.instance.addListener(at,r),function(){rt.instance.removeListener(at,r)}}),[]),!n)return null;var c=n.info,o=n.type,i=n.className;return Object(_.jsx)(or,{referenceRect:n.referenceRect,className:i,children:Object(_.jsx)("div",{className:"context-tooltip",children:function(){switch(o){case Ze.resource:var e=q.a.getResourceName(c);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{className:"name resource",children:e}),Object(_.jsx)(ar,{info:c})]});case Ze.item:var t=q.a.getItemName(c.item),a=c;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{className:"name item ".concat(ur(a)),children:t}),Object(_.jsx)(nr,{info:a})]});case Ze.trait:var r=c,i=q.a.getTraitName(r.trait);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("div",{className:"name trait",children:[q.a.get("ui-tooltip-type-trait"),i]}),Object(_.jsx)(ir,{traitDefinition:r})]});case Ze.skill:var s=c,u=q.a.getSkillName(s);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("div",{className:"name skill",children:[q.a.get("ui-tooltip-type-skill"),u]}),q.a.getSkillInfo(s)]});case Ze.component:return c;default:throw new Error("Unknown context type ".concat(n.type))}}()})})}),ur=function(e){switch(e.rarity){case $e.a.common:return"item-name-common";case $e.a.uncommon:return"item-name-uncommon";case $e.a.rare:return"item-name-rare";case $e.a.epic:return"item-name-epic";case $e.a.legendary:return"item-name-legendary"}return"item-name-common"},lr=n(38),dr=function(){return Object(d.d)((function(e){return e.engine}))};!function(e){e[e.increasing=0]="increasing",e[e.decreasing=1]="decreasing"}(cr||(cr={}));var mr=function(e){var t=e.className,n=void 0===t?"":t,a=e.label,r=e.direction,c=e.progress,o=void 0===c?0:c,i=En(o)||0,u=function(){var e=dr();return Date.now()-e.previousTick}(),l=Object(s.useState)(!1),d=Object(x.a)(l,2),m=d[0],h=d[1];return Object(s.useEffect)((function(){h(void 0===r||r===cr.increasing&&o>i||r===cr.decreasing&&o<i)}),[r,o]),Object(_.jsx)(pa,{progress:o,label:a,className:n,animationTime:m?u:0})},hr=(n(470),function(e){return Object(_.jsx)("div",{className:"structureview-header structureview-header-".concat(e.structure)})}),br=(n(471),function(e){var t=e.structure,n=e.onHelpClicked,a=e.addUpgradeCallbacks,c=Object(d.c)(),o=vt(),i=Pa(t).level,s=Object(P.b)(e.structure).levels[i+1],u=null!=s?s.cost.gold||0:-1,l=null!=s&&o>=u,m=null==s?q.a.get("ui-structure-upgrade-max"):q.a.get("ui-structure-upgrade",{cost:u,level:i+2}),h=Za(t);if(h.length){var b=h[0];return Object(_.jsx)(mr,{className:"upgrading",label:"".concat(q.a.get("structure-upgrade-button-upgrading")," (").concat(Object(Me.h)(b.timeRemaining),")"),progress:b.progress},"".concat(b.name).concat(b.startTime))}return Object(_.jsxs)("div",{className:"upgrade-stucture-button",children:[Object(_.jsxs)("label",{children:[q.a.get("ui-structure-level"),i+1]}),Object(_.jsx)(Ne,{className:"upgrade",onClick:function(){!function(e){var n;c(Object(Qe.c)(e));var o=[].concat(Object(r.a)((null===a||void 0===a?void 0:a(i+1))||[]),[Fe(t),Object(p.c)("log-town-upgrade-structure-complete",{level:i+1,structure:t},Ee.a.town)]),u=null!==(n=s.cost.time)&&void 0!==n?n:0,l=Ea(qa.upgradeStructure,"".concat(t,".upgrade"),"town",u,o);c(l)}(u)},disabled:!l,children:m}),null!=s&&Object(_.jsx)(Ne,{className:"help",square:!0,onClick:n,children:"?"})]})}),pr=(n(472),function(e){var t=e.level,n=e.structure,a=Object(P.b)(n).levels[t+1];return Object(_.jsxs)("div",{className:"production-upgrade-help-modal",children:[Object(_.jsxs)("div",{className:"top",children:[Object(_.jsx)("h3",{children:q.a.get("ui-structure-help-upgrade-title",{structure:n})}),Object(_.jsxs)("div",{className:"cost",children:[Object(_.jsx)("section",{children:q.a.get("ui-structure-help-upgrade-cost-gold",{gold:a.cost.gold})}),a.cost.time&&Object(_.jsx)("section",{children:Object(Me.h)(a.cost.time)})]})]}),Object(_.jsx)("div",{className:"unlocks",children:a.unlocks.map((function(e){return function(e){return Object(_.jsx)(ot,{item:e,size:ct.a.small},e)}(Ae.a[e])}))})]})}),jr=(n(473),function(e){var t;return t=null==e.max?e.value:Object(_.jsxs)("span",{children:[e.value," / ",Object(_.jsx)("span",{className:"max",children:e.max})]}),Object(_.jsxs)("div",{className:"updownvalue",children:[Object(_.jsxs)("label",{children:[" ",e.label]}),t,Object(_.jsx)("i",{className:"arrow up"+(e.upDisabled?" disabled":""),onClick:function(t){e.onUp&&!e.upDisabled&&e.onUp(t)}}),Object(_.jsx)("i",{className:"arrow down"+(e.downDisabled?" disabled":""),onClick:function(t){e.onDown&&!e.downDisabled&&e.onDown(t)}})]})}),fr=(n(474),function(e){var t=e.items,n=(e.className||"")+" items-box",a=t.reduce((function(e,t){return e[t]||(e[t]=0),e[t]++,e}),{}),c=la(),o=Object(s.useMemo)((function(){var e=Object(r.a)(c),n=[];return t.forEach((function(t){var a=e.findIndex((function(e){return e===t}));if(a>-1){var r=e.splice(a,1),c=Object(x.a)(r,1)[0];c&&n.push(c)}})),n}),[t,c]),i=Object.keys(a).map((function(e){var t=e,n=a[e],r="item";n>(o?o.filter((function(e){return e===t})).length:0)&&(r+=" missing");var c=Object(qe.a)(t);return Object(_.jsxs)("li",{className:r,children:[Object(_.jsx)(ct.b,{image:c.iconImg,size:"smallest"}),Object(_.jsx)("div",{className:"name",children:"".concat(q.a.getItemName(t)," (").concat(n,")")})]},t)}));return Object(_.jsx)("ul",{className:n,children:i})}),vr=(n(475),function(e){var t=e.resources,n=yt(),a=Object(s.useMemo)((function(){return Object.keys(t).reduce((function(e,a){var r=a;return e[a]=n[r]>=t[r],e}),{})}),[t,n]),r=(e.className||"")+" resources-cost",c=Object.keys(e.resources).map((function(t){var n=t,r="resource";a&&!a[n]&&(r+=" insufficient");var c=Pe.b[n];if(!c)throw new Error("No resource description found for ".concat(n));return Object(_.jsxs)("li",{className:r,children:[Object(_.jsx)(ct.b,{image:c.iconImg,size:"smallest",onClick:function(e){var t=e.currentTarget.getBoundingClientRect();rt.showContextTooltip(Ze.resource,n,t),e.stopPropagation()}}),Object(_.jsx)("div",{className:"name",children:q.a.getResourceName(n)}),Object(_.jsx)("div",{className:"amount",children:e.resources[n]})]},n)}));return Object(_.jsx)("ul",{className:r,children:c})}),gr=function(e,t){if(t>6)throw new Error("Cannot possibly have more than ".concat(6," on one item!"));return e-.1*e*(t-1)},Or=function(e){var t=e.item,n=e.structure,a=Object(d.c)(),r=yt(),c=la(),o=wt(),i=Object(s.useState)(0),u=Object(x.a)(i,2),l=u[0],m=u[1],h=Qa(t),b=h.cost.resources,p=Object.keys(b).some((function(e){var t=e;return b[t]>r[t]})),j=!1,f=h.cost.materials;f&&(j=f.some((function(e){return-1===c.indexOf(e)})));var v=p||j||l<1,g=function(e,t){var r,c=gr(e.cost.time||0,t);a((r=e.cost.resources||{},{type:we.removeResources,resources:r})),a(Be(n,t));var o=[Ue(e.item),Be(n,t)],i=Ea(qa.craftItem,e.item,"".concat(n,".craft"),c,o);a(i)};return Object(_.jsxs)("div",{className:"crafting-details",children:[q.a.get("ui-structure-production-craft-a",{item:t}),Object(_.jsxs)("div",{className:"crafting-costs",children:[Object(_.jsx)("fieldset",{children:Object(_.jsx)(vr,{resources:b})}),Object(_.jsx)("fieldset",{children:f&&Object(_.jsx)(fr,{items:f})})]}),Object(_.jsxs)("div",{className:"buttonrow",children:[Object(_.jsxs)("div",{children:[Object(_.jsx)(jr,{value:l,label:q.a.get("ui-structure-production-workers"),onUp:function(e){e.stopPropagation(),m(l+1)},onDown:function(e){e.stopPropagation(),m(l-1)},upDisabled:l>=o||l>=6,downDisabled:l<1}),function(e){if(0===l)return"";var t=gr(e,l),n=Object(Me.h)(t);return q.a.get("ui-structure-production-crafting-time",{time:n})}(h.cost.time||0)]}),Object(_.jsx)("div",{children:Object(_.jsx)(Ne,{disabled:v,className:"craft",onClick:function(e){e.stopPropagation(),g(h,l),m(0)},children:q.a.get("ui-structure-production-craft")})})]})]})},yr=function(e){var t=e.structure,n=Object(s.useState)(),a=Object(x.a)(n,2),r=a[0],c=a[1],o=Pa(t);return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)("div",{children:"craft:"}),Object(_.jsxs)("div",{className:"crafting-area",children:[Object(_.jsx)("ul",{className:"vertical-tab-bar",children:o.produces.map((function(e){return Object(_.jsxs)("li",{onClick:function(){return function(e){c(e)}(e)},className:r===e?"selected":"",children:[Object(_.jsx)(ot,{item:e,size:ct.a.smallest}),q.a.getItemName(e)]},"craft".concat(e))}))}),r&&Object(_.jsx)(Or,{item:r,structure:t})]})]})},xr=(n(476),function(e){var t=e.structure,n=Pa(t).level,a=Xa(t),r=Ya(t),c=Object(P.b)(e.structure);if(!c)throw new Error("No definition found for structure ".concat(e.structure,"\n            with type ProductionStructureDefinition."));return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(hr,{structure:e.structure}),Object(_.jsx)("div",{className:"production-structure-view",children:Object(_.jsxs)("section",{children:[Object(_.jsx)(br,{structure:t,onHelpClicked:function(e){var a=e.currentTarget.getBoundingClientRect(),r=Object(_.jsx)(pr,{level:n,structure:t});rt.showContextTooltip(Ze.component,r,a,"upgrade-structure-tooltip"),e.stopPropagation()},addUpgradeCallbacks:function(e){return c.levels[e].unlocks.map((function(e){return ze(t,e)}))}}),Object(_.jsx)(yr,{structure:t}),Object(_.jsxs)("fieldset",{children:[Object(_.jsx)("legend",{children:q.a.get("ui-structure-production-crafting")}),a.map((function(e){return Object(_.jsx)(mr,{label:"".concat(q.a.getItemName(e.name)," (").concat(Object(Me.h)(e.timeRemaining),")"),progress:e.progress},"".concat(e.name).concat(e.startTime))}))]}),r.length>0&&Object(_.jsxs)("fieldset",{children:[Object(_.jsx)("legend",{children:q.a.get("ui-structure-production-studying")}),r.map((function(e){return Object(_.jsx)(mr,{label:"".concat(q.a.getItemName(e.name)," (").concat(Object(Me.h)(e.timeRemaining),")"),progress:e.progress},"".concat(e.name).concat(e.startTime))}))]})]})})]})}),wr=(n(477),$((function(e){var t=e.resources,n=e.deltaResources,a=Object(d.d)((function(e){return e.structures})),r="resources-box ".concat(e.className||"");return Object(_.jsx)("div",{className:r,children:Object.keys(t).map((function(t){var r,c=t,o=Pe.b[c],i=e.resources[c];if(!o)throw new Error("No resource description found for ".concat(c));n[c]&&(r=Object(_.jsx)("span",{className:"animate-up",children:"+ ".concat(n[c].toFixed(2))}));var u=Object(P.c)(Pe.a[c]),l=i>=e.maxResources[c];return Object(_.jsxs)(s.Fragment,{children:[Object(_.jsx)(ct.b,{image:o.iconImg,size:"smallest"}),Object(_.jsx)("div",{className:"name",children:q.a.getResourceName(c)}),Object(_.jsx)("div",{className:"amount".concat(l?" full":""),children:ft(i,0)}),Object(_.jsx)("div",{className:"max",children:" / ".concat(e.maxResources[c])}),Object(_.jsx)("div",{className:"delta",children:r}),Object(_.jsx)("div",{className:"structure",children:a[u].state===g.Built?Object(_.jsx)(N.b,{to:Object(D.b)(u),onClick:function(){e.onCloseWindow()},children:q.a.get("ui-structure-warehouse-resources-source",{structure:u})}):q.a.get("ui-structure-warehouse-resources-source",{structure:u})})]},c)}))})}))),kr={fabric:0,food:0,iron:0,leather:0,stone:0,wood:0},Nr=(n(478),function(e){var t=e.level,n=Object(P.b)(P.a.warehouse),a=n.levels[t],r=n.levels[t+1];return Object(_.jsxs)("div",{className:"warehouse-upgrade-help-modal",children:[Object(_.jsxs)("div",{className:"top",children:[Object(_.jsx)("h3",{children:q.a.get("ui-structure-help-upgrade-title",{structure:P.a.warehouse})}),Object(_.jsxs)("div",{className:"cost",children:[Object(_.jsx)("section",{children:q.a.get("ui-structure-help-upgrade-cost-gold",{gold:r.cost.gold})}),r.cost.time&&Object(_.jsx)("section",{children:Object(Me.h)(r.cost.time)})]})]}),Object(_.jsxs)("div",{className:"storage-increase",children:[Object(_.jsx)("div",{className:"header"}),Object(_.jsx)("div",{className:"header",children:q.a.get("ui-structure-warehouse-help-upgrade-header-capacity")}),Object(_.jsx)("div",{className:"header number",children:q.a.get("ui-structure-help-upgrade-header-level",{level:t+1})}),Object(_.jsx)("div",{className:"header"}),Object(_.jsx)("div",{className:"header number",children:q.a.get("ui-structure-help-upgrade-header-level",{level:t+2})}),Object.keys(r.maxResources).map((function(e){return function(e){var t=Pe.b[e];return Object(_.jsxs)(s.Fragment,{children:[Object(_.jsx)("div",{children:Object(_.jsx)(ct.b,{image:t.iconImg,size:"smallest"})}),Object(_.jsx)("div",{children:q.a.getResourceName(e)}),Object(_.jsx)("div",{className:"number",children:a.maxResources[e]}),Object(_.jsx)("div",{className:"arrow",children:"\u27f6"}),Object(_.jsx)("div",{className:"number",children:r.maxResources[e]})]},e)}(e)}))]})]})}),Sr=(n(479),Yn.a.warehouse),Ir=function(){var e,t=ea(),n=Object(s.useState)(null===(e=t[0])||void 0===e?void 0:e.id),a=Object(x.a)(n,2),r=a[0],c=a[1],o=yt(),i=Object(s.useState)(kr),u=Object(x.a)(i,2),l=u[0],m=u[1],h=En(o),b=Object(s.useRef)(null),p=la(),j=Object(d.d)((function(e){return e.structures})),f=da().dropItemWarehouse;Object(s.useEffect)((function(){var e=Object.keys(o).reduce((function(e,t){var n=t;return h&&h[n]&&(e[n]=o[n]-h[n]),e}),{});m(e)}),[o,h]),Object(s.useEffect)((function(){if(b.current){var e=b.current;e.classList.remove("animate"),setTimeout((function(){b&&e.classList.add("animate")}),200)}}),[l]);var v=Object(P.b)(P.a.warehouse);if(!v)throw new Error("No definition found for structure ".concat(P.a.warehouse," with type StructureDefinition."));var g=Pa(P.a.warehouse),O=v.levels[g.level];return Object(_.jsxs)("div",{className:"warehouse-structureview",children:[Object(_.jsx)(br,{structure:P.a.warehouse,onHelpClicked:function(e){var t=e.currentTarget.getBoundingClientRect(),n=Object(_.jsx)(Nr,{level:g.level});rt.showContextTooltip(Ze.component,n,t,"upgrade-structure-tooltip"),e.stopPropagation()},addUpgradeCallbacks:function(e){var t=v.levels[g.level];return[Ye(v.levels[e].maxStockpile-t.maxStockpile)]}}),Object(_.jsxs)("fieldset",{className:"resources",ref:b,children:[Object(_.jsx)("legend",{children:q.a.get("ui-structure-warehouse-resources")}),Object(_.jsx)(wr,{resources:o,structures:j,maxResources:O.maxResources,deltaResources:l})]}),Object(_.jsx)("h3",{children:q.a.get("ui-structure-warehouse-stockpile")}),Object(_.jsx)(sa,{sourceType:Sr,className:"inventory-large",items:p,onDropItem:function(e,t,n,a,r){f(e,t,n,a,r)}}),Object(_.jsx)("h3",{children:q.a.get("ui-structure-warehouse-adventurers")}),Object(_.jsxs)("div",{children:[Object(_.jsx)(Yt,{adventurers:t,selectedAdventurerId:r,onAdventurerTabSelected:function(e){c(e)}}),Object(_.jsx)("div",{className:"adventurer-inventory",children:r&&Object(_.jsx)(Na,{adventurerId:r,horizontalMode:!0,traits:!1,skills:!1})})]})]})},Tr=(n(480),Object(ca.a)(Yn.b.ADVENTURER,{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){return!0}},(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,a="droppable-adventurer-slot";return t?a+=" active-drop":n&&(a+=" can-drop"),(0,e.connectDropTarget)(Object(_.jsx)("div",{className:a}))}))),Cr=(n(481),function(e){return Object(_.jsx)("ul",{className:"assign-adventurers",children:function(){for(var t=[],n=function(n){var a=void 0,r="";if(!!e.assignedAventurers[n]){var c=e.assignedAventurers[n];a=Object(_.jsx)(Xt,{adventurer:c,displayName:!1,size:ct.a.small,onClick:function(){return e.onAdventurerClicked(c)}}),r="has-adventurer"}else a=Object(_.jsx)(Tr,{onDrop:function(t){e.onAdventurerDropped(t,n)}});t.push(Object(_.jsx)("li",{className:r,children:a},"slot".concat(n)))},a=0;a<e.availableSlots;a++)n(a);return t}()})}),qr=(n(482),function(e){var t=Object(d.d)((function(e){return e.stockpile})),n=function(e){return!e.requiredItems||e.requiredItems.every((function(n){var a,r=null===(a=e.requiredItems)||void 0===a?void 0:a.filter((function(e){return e===n})).length;return t.filter((function(e){return e===n})).length>=(null!==r&&void 0!==r?r:0)}))};return Object(_.jsxs)("div",{className:"quest-board",children:[Object(_.jsx)("h2",{children:q.a.get("ui-structure-tavern-title-quest-board")}),Object(_.jsx)("ul",{className:"quest-list",children:e.availableQuests.map((function(t){var n="quest ".concat(t.name===e.selectedQuestName?" selected":"");return Object(_.jsxs)("li",{className:n,onClick:function(){e.onQuestClick(t.name)},children:[Object(_.jsx)("div",{className:"icon",style:{backgroundImage:"url(".concat(".",")")}}),Object(_.jsxs)("div",{className:"title",children:[q.a.getQuestTitle(t.name)," "]})]},t.name)}))}),function(){if(!e.selectedQuestName)return null;var t=e.availableQuests.find((function(t){return t.name===e.selectedQuestName}));if(!t)return Object(_.jsxs)("div",{children:[" ",q.a.get("ui-structure-tavern-quest-launched")," "]});var a=Object(Ct.a)(t.name),r=e.assignedAventurers.filter((function(e){return null!==e})).length>=3,c=n(a),o=r&&c;return Object(_.jsxs)("div",{className:"quest-details",children:[q.a.getQuestDescription(e.selectedQuestName),Object(_.jsx)(Cr,{availableSlots:5,assignedAventurers:e.assignedAventurers,onAdventurerClicked:e.onRemoveAdventurer,onAdventurerDropped:e.onAdventurerDropped}),Object(_.jsx)(fr,{items:a.requiredItems||[]}),Object(_.jsx)(Ne,{disabled:!o,onClick:function(){return e.onLaunchQuest()},children:q.a.get("ui-structure-tavern-button-launch-quest")})]})}()]})}),Ar=(n(483),function(e){var t=e.adventurer,n=e.assignedAventurers,a=e.questName,r=e.onAddAdventurer,c=e.onRemoveAdventurer,o=n.indexOf(t)>-1,i=q.a.getQuestTitle(a);return o?Object(_.jsx)(Ne,{onClick:function(){c(t)},className:"adventurer-button",children:q.a.get("ui-structure-tavern-button-leave-quest")}):5===n.filter(Boolean).length?Object(_.jsx)(Ne,{disabled:!0,className:"adventurer-button",children:q.a.get("ui-structure-tavern-button-join-quest-full-party")}):Object(_.jsx)(Ne,{onClick:function(){var e=Er(n);r(t,e)},className:"adventurer-button",children:q.a.get("ui-structure-tavern-button-join-quest",{quest:i})})}),Er=function(e){for(var t=0;t<5;t++)if(!e[t])return t;return 0},Pr=(n(484),{beginDrag:function(e){return{adventurer:e.adventurer,sourceId:e.sourceId,sourceType:Yn.a.adventurerInventory}}});var Mr,Dr=Object(Zn.a)(Yn.b.ADVENTURER,Pr,(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.isDragging,n=e.connectDragSource,a="draggable-adventurer-avatar";return e.disabled&&(a+=" disabled"),t&&(a+=" dragging"),n(Object(_.jsx)("div",{className:a,children:Object(_.jsx)(Xt,Object(Z.a)({},e))}))})),Rr=function(e){var t=e.adventurer,n=e.onQuest,a=e.assignedAventurers,r=e.expanded,c=e.selectedQuestName,o=e.onClick,i=e.onAddAdventurer,s=e.onRemoveAdventurer,u=Object(d.c)(),l=a.indexOf(t)>-1;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsxs)("div",{className:"room ".concat(r?"expanded":""),onClick:function(){return o(t)},children:[Object(_.jsx)(Dr,{disabled:l||n,adventurer:t,className:"adventurer-icon",sourceId:Fr},"avatar:".concat(t.id)),Object(_.jsxs)("div",{children:[Object(_.jsx)("section",{children:t.name}),Object(_.jsx)("section",{className:"on-a-quest",children:n&&q.a.get("ui-structure-tavern-on-a-quest")})]}),Object(_.jsx)("span",{className:"rename",onClick:function(e){e.stopPropagation();var n=prompt("Enter new name",t.name);n&&n!==t.name&&u(Object(ua.g)(t.id,n))},children:"rename"})]}),r&&Object(_.jsxs)("div",{className:"adventurer-details",children:[Object(_.jsx)(Na,{adventurerId:t.id,name:!1}),!n&&c&&Object(_.jsx)(Ar,{adventurer:t,assignedAventurers:a,questName:c,onAddAdventurer:i,onRemoveAdventurer:s})]})]})},Hr=function(){return Object(_.jsx)("div",{className:"room",children:"(empty room)"})},Lr=(n(485),function(e){for(var t=e.roomCount,n=e.adventurers,a=e.assignedAventurers,r=e.selectedQuestName,c=e.onAddAdventurer,o=e.onRemoveAdventurer,i=Object(s.useState)(),u=Object(x.a)(i,2),l=u[0],d=u[1],m=function(e){l===e.id?d(void 0):d(e.id)},h=[],b=function(t){var i=n.find((function(e){return e.room===t}));if(!i)return h.push(Object(_.jsx)(Hr,{},"room".concat(t))),"continue";var s,u=(s=i.id,!!Object.values(e.quests).find((function(e){return e.party.indexOf(s)>-1})));h.push(Object(_.jsx)(Rr,{adventurer:i,assignedAventurers:a,selectedQuestName:r,expanded:l===i.id,onQuest:u,onClick:m,onAddAdventurer:c,onRemoveAdventurer:o},i.id))},p=0;p<t;p++)b(p);return Object(_.jsxs)("div",{className:"room-list",children:[Object(_.jsx)("h2",{children:q.a.get("ui-structure-tavern-rooms")}),h]})}),Wr=(n(486),function(e){var t=e.level,n=Object(P.b)(P.a.tavern),a=n.levels[t],r=n.levels[t+1];return Object(_.jsxs)("div",{className:"tavern-upgrade-help-modal",children:[Object(_.jsxs)("div",{className:"top",children:[Object(_.jsx)("h3",{children:q.a.get("ui-structure-help-upgrade-title",{structure:P.a.tavern})}),Object(_.jsxs)("div",{className:"cost",children:[Object(_.jsx)("section",{children:q.a.get("ui-structure-help-upgrade-cost-gold",{gold:r.cost.gold})}),r.cost.time&&Object(_.jsx)("section",{children:Object(Me.h)(r.cost.time)})]})]}),Object(_.jsxs)("div",{className:"rooms-increase",children:[Object(_.jsx)("div",{className:"header"}),Object(_.jsx)("div",{className:"header",children:q.a.getStructureName(P.a.tavern)}),Object(_.jsx)("div",{className:"header number",children:q.a.get("ui-structure-help-upgrade-header-level",{level:t+1})}),Object(_.jsx)("div",{className:"header"}),Object(_.jsx)("div",{className:"header number",children:q.a.get("ui-structure-help-upgrade-header-level",{level:t+2})}),Object(_.jsx)("div",{children:Object(_.jsx)(ct.b,{image:"img/ui/structures/tavern.png",size:"smallest"})}),Object(_.jsx)("div",{children:q.a.get("ui-structure-tavern-rooms")}),Object(_.jsx)("div",{className:"number",children:a.rooms}),Object(_.jsx)("div",{className:"arrow",children:"\u27f6"}),Object(_.jsx)("div",{className:"number",children:r.rooms})]})]})}),Fr=(n(487),"tavern"),Br=function(){var e=Pa(P.a.tavern).level,t=Object(d.d)((function(e){return e.adventurers})),n=Object(d.d)((function(e){return e.quests})),a=Object(s.useState)([]),c=Object(x.a)(a,2),o=c[0],i=c[1],u=Object(s.useState)(),l=Object(x.a)(u,2),m=l[0],h=l[1],b=Object(P.b)(P.a.tavern).levels[e],p=Object(d.c)(),j=n.filter((function(e){return e.status===dt.available})),f=function(e,t){var n=Object(r.a)(o);n[t]=e,i(n)},v=function(e){var t=o.indexOf(e),n=Object(r.a)(o);delete n[t],i(n)};return Object(_.jsxs)("div",{className:"tavern-structure-view",children:[Object(_.jsx)(br,{structure:P.a.tavern,onHelpClicked:function(t){var n=t.currentTarget.getBoundingClientRect(),a=Object(_.jsx)(Wr,{level:e});rt.showContextTooltip(Ze.component,a,n,"upgrade-structure-tooltip"),t.stopPropagation()}}),Object(_.jsxs)("section",{children:[Object(_.jsx)(Lr,{roomCount:b.rooms,adventurers:t,assignedAventurers:o,quests:n,selectedQuestName:m,onAddAdventurer:f,onRemoveAdventurer:v}),Object(_.jsx)(qr,{availableQuests:j,selectedQuestName:m,assignedAventurers:o,onQuestClick:function(e){return function(e){h(m===e?void 0:e),i([])}(e)},onAdventurerDropped:function(e,t){e.sourceId===Fr&&f(e.adventurer,t)},onRemoveAdventurer:v,onLaunchQuest:function(){var e,t=q.a.getQuestTitle(m),n=o[0];Oe.b.addToast(t,ye.a.questLaunched,null===n||void 0===n?void 0:n.avatarImg,Object(D.a)(m)),e=m,p(Object(Lt.e)(e,o))}})]})]})},zr=(n(488),function(e){var t=e.level,n=e.structure,a=Object(P.b)(n),r=a.levels[t],c=a.levels[t+1];return Object(_.jsxs)("div",{className:"resource-upgrade-help-modal",children:[Object(_.jsxs)("div",{className:"top",children:[Object(_.jsx)("h3",{children:q.a.get("ui-structure-help-upgrade-title",{structure:n})}),Object(_.jsxs)("div",{className:"cost",children:[Object(_.jsx)("section",{children:q.a.get("ui-structure-help-upgrade-cost-gold",{gold:c.cost.gold})}),c.cost.time&&Object(_.jsx)("section",{children:Object(Me.h)(c.cost.time)})]})]}),Object(_.jsxs)("div",{className:"grid generates-increase",children:[Object(_.jsx)("div",{className:"header"}),Object(_.jsx)("div",{className:"header"}),Object(_.jsx)("div",{className:"header number",children:q.a.get("ui-structure-help-upgrade-header-level",{level:t+1})}),Object(_.jsx)("div",{className:"header"}),Object(_.jsx)("div",{className:"header number",children:q.a.get("ui-structure-help-upgrade-header-level",{level:t+2})}),Object(_.jsx)("div",{children:Object(_.jsx)(ct.b,{image:"/img/resources/worker.png",size:"smallest"})}),Object(_.jsx)("div",{children:q.a.get("ui-structure-help-upgrade-worker-capacity")}),Object(_.jsx)("div",{className:"number",children:r.workerCapacity}),Object(_.jsx)("div",{className:"arrow",children:"\u27f6"}),Object(_.jsx)("div",{className:"number",children:c.workerCapacity}),Object.keys(c.generates).map((function(e){return function(e){var t=Pe.b[e];return Object(_.jsxs)(s.Fragment,{children:[Object(_.jsx)("div",{children:Object(_.jsx)(ct.b,{image:t.iconImg,size:"smallest"})}),Object(_.jsx)("div",{children:q.a.get("ui-structure-resource-help-upgrade-resource-generates",{resource:e})}),Object(_.jsx)("div",{className:"number",children:r.generates[e]}),Object(_.jsx)("div",{className:"arrow",children:"\u27f6"}),Object(_.jsx)("div",{className:"number",children:c.generates[e]})]},e)}(e)}))]})]})}),_r=function(e){var t=e.structure,n=e.resource,a=dr(),r=Pa(t),c=r.level,o=r.workers,i=Object(P.b)(e.structure);if(!i)throw new Error("No definition found for structure ".concat(e.structure," with type ResourceStructureDefinition."));var s=i.levels[c].generates[n]||0,u=De-(Date.now()-a.lastProducedUpdate),l=Pe.b[n];return Object(_.jsxs)("div",{className:"resource-generation-row",children:[Object(_.jsxs)("div",{className:"info",children:[Object(_.jsx)(ct.b,{image:l.iconImg,size:"smallest"}),Object(_.jsx)("div",{children:q.a.get("ui-structure-resource-generates",{amount:s,resource:n})})]}),o>0&&Object(_.jsx)(mr,{className:"generating",direction:ba.decreasing,label:"".concat(q.a.get("ui-structure-resource-next-generates",{amount:s*o,resource:n,time:Object(Me.h)(u)})),progress:u/De}),!o&&q.a.get("ui-structure-resource-no-workers")]})},Vr=(n(489),function(e){var t=e.structure,n=Pa(t),a=n.level,r=n.workers,c=Object(P.b)(e.structure);if(!c)throw new Error("No definition found for structure ".concat(e.structure," with type ResourceStructureDefinition."));var o=c.levels[a],i=Object(d.d)((function(e){return xt(e)})),s=Object(d.c)(),u=r===o.workerCapacity||(i||0)<1,l=0===r;return Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(hr,{structure:e.structure}),Object(_.jsx)("div",{className:"resource-structure-view",children:Object(_.jsxs)("section",{children:[Object(_.jsx)(br,{structure:t,onHelpClicked:function(e){var n=e.currentTarget.getBoundingClientRect(),r=Object(_.jsx)(zr,{level:a,structure:t});rt.showContextTooltip(Ze.component,r,n,"upgrade-structure-tooltip"),e.stopPropagation()}}),Object(_.jsx)(jr,{label:q.a.get("ui-structure-production-workers"),value:r,max:o.workerCapacity,upDisabled:u,downDisabled:l,onDown:function(){s(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:ke.decreaseWorkers,structure:e,workers:t}}(e.structure))},onUp:function(){s(Be(e.structure))}}),Object.keys(o.generates).map((function(e){return Object(_.jsx)(_r,{structure:t,resource:e},e)}))]})})]})}),Gr=(n(490),Ie((function(e){var t=Object(d.d)((function(e){return e.tasks})).running.filter((function(t){return"town"===t.origin&&t.name==="".concat(e.structure,".build")}))[0],n=Pa(e.structure);return Object(_.jsx)("div",{className:"structure-details",children:function(){if(n.state===g.Building)return t?Object(_.jsx)("div",{className:"building",children:Object(_.jsx)(mr,{progress:t.progress,label:"Building... (".concat(Object(Me.h)(t.timeRemaining),")")})}):null;switch(Object(P.b)(e.structure).type){case lr.a.production:return Object(_.jsx)(xr,{structure:e.structure});case lr.a.resource:return Object(_.jsx)(Vr,{structure:e.structure});case lr.a.warehouse:return Object(_.jsx)(Ir,{});case lr.a.tavern:return Object(_.jsx)(Br,{});default:return Object(_.jsxs)("div",{children:[" ",e.structure," "]})}}()})})));n(491);I.a.registerPIXI(PIXI),T.b.registerPlugin(I.a),function(e){e[e.Town=0]="Town",e[e.World=1]="World"}(Mr||(Mr={}));var Qr,Ur=960,Xr=Object(s.createContext)(null),Yr=function(e){var t=Object(s.useRef)(null),n=Object(s.useState)([]),a=Object(x.a)(n,2),c=a[0],o=a[1],i=function(){C.c.playSound("ui/buttonClick")},u=function(e){if(e){var t=q.a.getStructureName(e);l(Object(_.jsx)(Gr,{structure:e,title:t})),C.c.playSound("ui/buttonClick")}},l=function(e){o([].concat(Object(r.a)(c||[]),[e]))},d=function(){o([])},m=function(){c&&c.length&&o(c.slice(0,-1))};Object(s.useEffect)((function(){C.c.addSound("ui/buttonClick","sound/ui/button-click.ogg"),C.c.addSound("ui/equip","sound/ui/equip.mp3"),C.c.addSound("ui/error","sound/ui/error.ogg"),C.c.addSound("ui/levelUp","sound/ui/level-up.ogg"),C.c.addSound("ui/toast","sound/ui/toast.ogg")}),[]);return Object(s.useEffect)((function(){var e=E()((function(){rt.clear()}),100);return window.addEventListener("scroll",e),window.addEventListener("wheel",e),function(){window.removeEventListener("resize",e),window.removeEventListener("wheel",e)}}),[]),Object(_.jsx)(Xr.Provider,{value:{onOpenWindow:l,onCloseWindow:d},children:Object(_.jsx)("div",{className:"app",ref:t,style:{maxWidth:Ur},onClick:function(){rt.clear()},children:Object(_.jsx)(w.a,{backend:k.a,children:Object(_.jsxs)(N.a,{children:[Object(_.jsx)(Nt,{persistor:e.persistor}),Object(_.jsxs)("div",{className:"control-bar",children:[Object(_.jsxs)(S.d,{children:[Object(_.jsx)(S.b,{path:"/",exact:!0,children:Object(_.jsx)(S.a,{from:"/",to:Object(D.d)()})}),Object(_.jsx)(S.b,{path:Object(D.d)(),children:Object(_.jsx)(N.b,{to:Object(D.c)(),children:Object(_.jsxs)(Ne,{onClick:function(){return i()},color:"green",children:[" ",q.a.get("ui-view-button-town")," "]})})}),Object(_.jsx)(S.b,{path:Object(D.c)(),children:Object(_.jsx)(N.b,{to:Object(D.d)(),children:Object(_.jsxs)(Ne,{onClick:function(){return i()},children:[" ",q.a.get("ui-view-button-world")," "]})})})]})," | ",Object(_.jsx)(Ne,{onClick:function(){uo()},color:ue.purple,children:" Restart! "})]}),Object(_.jsxs)(S.d,{children:[Object(_.jsx)(S.b,{path:Object(D.c)(),render:function(){return Object(_.jsx)(fe,{onStructureClick:u})}}),Object(_.jsx)(S.b,{path:Object(D.d)(),render:function(){return Object(_.jsx)(Ta,{})}})]}),Object(_.jsx)(Aa,{}),function(){if(!c.length)return null;var e=c[c.length-1],t={onClose:d,onBack:m,backEnabled:c.length>1,closeEnabled:!0};return s.cloneElement(e,t)}(),Object(_.jsx)(sr,{}),Object(_.jsx)(xe,{})]})})})})},Zr=function(e,t){var n=t.structures,a={},r=Ke(Ge.resourceGeneration),c=(Date.now()-e)/(De/r),o=Ot(t);return c<1?null:(Object.keys(n).forEach((function(e){return function(e){var t=Object(P.b)(e);if(t.type===lr.a.resource){var r=t,o=n[e].level,i=r.levels[o];Object.keys(i.generates).reduce((function(t,a){var r=a,o=i.generates[r]*n[e].workers*c;return t[r]=(t[r]||0)+o,t}),a)}}(e)})),Object.keys(a).forEach((function(e){var n=e;a[n]&&t.resources[n]+a[n]>=o[n]&&(a[n]=o[n]-t.resources[n])})),a)},Jr=function(e,t){var n=Ke(Ge.questProgress),a=[],r=[],c=t.getState();return c.quests.forEach((function(o){if(o.status===dt.active){var i=Object(Ct.a)(o.name),s=o.progress,u=Math.floor(s);if(i.nodes[u].type===St.a.nothing){for(var l=e/(6e4/n)*4,d=Math.min(s+l,i.nodes.length-1),m=Math.floor(d)-u,h=1;h<=m;h++){var b=i.nodes[u+h];if(b.type===St.a.encounter){t.dispatch(Object(Lt.i)(o.name,b.startScene));var p=q.a.getQuestTitle(o.name),j=Object(qt.c)(c.adventurers,o);Oe.b.addToast(p,ye.a.questEncounter,null===j||void 0===j?void 0:j.avatarImg,Object(D.a)(o.name)),b.log&&a.push({channel:Ee.a.quest,channelContext:o.name,key:b.log}),d=s+h;break}b.type===St.a.nothing&&b.log&&a.push({channel:Ee.a.quest,channelContext:o.name,key:b.log})}r.push({name:o.name,progress:d})}}})),{logUpdates:a,questUpdates:r}},Kr=n(260),$r=n.n(Kr);var ec=!1,tc=function(){return ec?(ec=!1,Qr.state()):null},nc=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ac(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");nc?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):rc(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):rc(e)}))}}function rc(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var cc,oc,ic,sc,uc,lc,dc,mc=n(171),hc=function(){return{strength:Math.floor(3*Math.random())+9,dexterity:Math.floor(3*Math.random())+9,intelligence:Math.floor(3*Math.random())+9,health:Math.floor(3*Math.random())+9}},bc="img/avatars",pc="img/scene/actors/",jc=[{id:"c4a5d270",equipment:(cc={},Object(He.a)(cc,on.a.head,Ae.a.cowl),Object(He.a)(cc,on.a.chest,Ae.a.chest),Object(He.a)(cc,on.a.hands,Ae.a.clothGloves),Object(He.a)(cc,on.a.shoulders,Ae.a.shoulders2),Object(He.a)(cc,on.a.legs,Ae.a.pants2),Object(He.a)(cc,on.a.feet,Ae.a.boots3),cc),basicAttributes:hc(),health:100*Math.random(),xp:ha(1),baseAP:6,room:0,name:"Ximena Maddox",traits:[ja.houseMaddox,ja.gloomy],avatarImg:"".concat(bc,"/female/f_14.png"),spritesheetPath:"".concat(pc,"elf-bow.json"),color:Wt.purple,skills:(oc={},Object(He.a)(oc,Ha.c.crossbow,10),Object(He.a)(oc,Ha.c.bow,10),oc),inventory:[Ae.a.deedForLumbermill,null,Ae.a.simpleCrossbow,Ae.a.dagger,Ae.a.khopesh,null,Ae.a.sword,null,null,null,null,Ae.a.steelShield,null,null,null,null]},{id:"2e655832",equipment:Object(He.a)({},on.a.feet,Ae.a.boots2),basicAttributes:hc(),name:"Donte Houston",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:1,avatarImg:"".concat(bc,"/male/m_05.png"),spritesheetPath:"".concat(pc,"elf-bow.json"),color:Wt.teal,traits:[ja.houseHouston],skills:(ic={},Object(He.a)(ic,Ha.c.crossbow,12),Object(He.a)(ic,Ha.c.staff,13),ic),inventory:[Ae.a.simpleCrossbow,null,null,null,null,Ae.a.boots1,Ae.a.chainmailHood,Ae.a.nomadHelmet,Ae.a.plateChest4,null,Ae.a.buckler,null,null,null,null,null,null,null,null,null,null,null,Ae.a.plateHelmet,Ae.a.cowl]},{id:"ec6f1050",equipment:Object(He.a)({},on.a.feet,Ae.a.boots3),basicAttributes:hc(),name:'Zackary "bone bag" Morris',health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:2,traits:[ja.gloomy],skills:(sc={},Object(He.a)(sc,Ha.c.sword,12),Object(He.a)(sc,Ha.c.hammer,6),sc),avatarImg:"".concat(bc,"/male/m_09.png"),spritesheetPath:"".concat(pc,"skeleton.json"),color:Wt.black,inventory:[Ae.a.greatswordOfGwai,null,null,null,Ae.a.berserkerShield]},{id:"d299f98a",basicAttributes:hc(),equipment:{},name:"Mike Keith",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:4,avatarImg:"".concat(bc,"/male/m_19.png"),spritesheetPath:"".concat(pc,"knight-sword.json"),traits:[ja.arrowFinder],skills:Object(He.a)({},Ha.c.sword,13),inventory:[null,null,null,null,Ae.a.khopesh,Ae.a.hornedHelmet,Ae.a.woodenBulwark]},{id:"96c686c3",equipment:{},basicAttributes:hc(),name:"Wayne Monroe",health:100*Math.random(),xp:100*Math.random(),baseAP:4,room:5,avatarImg:"".concat(bc,"/male/m_08.png"),spritesheetPath:"".concat(pc,"orc-axe.json"),traits:[ja.houseMonroe,ja.arrowFinder],skills:Object(He.a)({},Ha.c.axe,12),inventory:[null,null,null,Ae.a.goldenShield]},{id:"250d1a9d",basicAttributes:hc(),equipment:{},name:"Alexis Ortiz ",health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:9,avatarImg:"".concat(bc,"/female/f_10.png"),spritesheetPath:"".concat(pc,"knight-sword.json"),inventory:[null,null,null,null,null],skills:Object(He.a)({},Ha.c.axe,10)},{id:"169384ef",equipment:{},basicAttributes:hc(),name:"Karlee Nolan",health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:3,avatarImg:"".concat(bc,"/female/f_16.png"),spritesheetPath:"".concat(pc,"troll-sword.json"),inventory:[Ae.a.greatswordOfGwai,null,null,null],skills:Object(He.a)({},Ha.c.axe,10)},{id:"f22d66cb",basicAttributes:hc(),equipment:{},name:"Gylbarde the Earnest",health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:8,avatarImg:"".concat(bc,"/male/m_09.png"),spritesheetPath:"".concat(pc,"knight-sword.json"),inventory:[null,null,null,null,null],skills:Object(He.a)({},Ha.c.axe,13)},{id:"36c686c1",equipment:{},basicAttributes:hc(),name:"Lanslet of the Water",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:6,avatarImg:"".concat(bc,"/male/m_26.png"),spritesheetPath:"".concat(pc,"knight-sword.json"),inventory:[Ae.a.greatswordOfGwai,null,null,null,Ae.a.shoulders1,Ae.a.fedora,Ae.a.greaves2],skills:Object(He.a)({},Ha.c.axe,3)},{id:"12c613d4",equipment:{},basicAttributes:hc(),name:"Tedric the Bold",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:7,avatarImg:"".concat(bc,"/male/m_33.png"),spritesheetPath:"".concat(pc,"knight-sword.json"),inventory:[Ae.a.greatswordOfGwai,null,null,null],skills:Object(He.a)({},Ha.c.axe,10)}],fc=function(){return{gameStarted:void 0,previousTick:Date.now(),lastTick:Date.now(),lastProducedUpdate:Date.now()}},vc=40,gc=function(){for(var e=[],t=Object(P.b)(P.a.warehouse).levels[0].maxStockpile,n=0;n<t;n++)if(Math.random()<.5)e.push(null);else{var a=Oc(Ae.a);e.push(a)}return e},Oc=function(e){var t=Object.values(e);return t[Math.floor(Math.random()*t.length)]},yc=[],xc=function(e,t){if(!t.log.length)return e;var n=t.log.map((function(e){return Object(Z.a)(Object(Z.a)({},e),{},{time:Date.now()})}));return[].concat(Object(r.a)(n),Object(r.a)(e))},wc=n(133),kc=n(261),Nc=n.n(kc),Sc=[{name:"kill10Boars",status:dt.active,party:["c4a5d270","2e655832","ec6f1050","d299f98a"],progress:0,questVars:wc.a,encounterResults:[],icon:"sigil1.png"}],Ic=function(e,t){var n=t.assignedAventurers.filter((function(e){return!!e})).map((function(e){return e.id}));return e.map((function(e){if(e.name===t.questName){var a=Object(Ct.a)(t.questName).getInitialQuestVars(e);return Object(Z.a)(Object(Z.a)({},e),{},{status:dt.active,party:n,questVars:a})}return e}))},Tc=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.progress+1;return Object(Z.a)(Object(Z.a)({},e),{},{progress:n,scene:void 0,sceneName:void 0})}return e}))},Cc=function(e,t){return e.map((function(e){return e.name===t.questName?Object(Z.a)(Object(Z.a)({},e),{},{sceneName:t.sceneName,scene:void 0}):e}))},qc=function(e,t){return e.map((function(e){return e.name===t.questName?Object(Z.a)(Object(Z.a)({},e),{},{scene:t.scene}):e}))},Ac=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.actionQueue=[].concat(Object(r.a)(n.actionQueue||[]),[t.sceneAction]),Object(Z.a)(Object(Z.a)({},e),{},{scene:n})}return e}))},Ec=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");var a=n.actionQueue[0];if(!a)return e;switch(a.actionType){case rn.a.move:n.objects=n.objects.map((function(e){return Object(rn.c)(e)&&e.name===a.actorId?Object(Z.a)(Object(Z.a)({},e),{},{location:a.target}):e}))}return n.actionQueue=Object(r.a)(n.actionQueue.slice(1)),Object(Z.a)(Object(Z.a)({},e),{},{scene:n})}return e}))},Pc=function(e,t){var n=t.combat;return e.map((function(e){if(e.name===t.questName){var a=Object(Z.a)(Object(Z.a)({},e.scene),{},{combat:n});return Object(Z.a)(Object(Z.a)({},e),{},{scene:a})}return e}))},Mc=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return Object(Z.a)(Object(Z.a)({},e),{},{scene:n})}return e}))},Dc=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.objects=n.objects.map((function(e){return e.id===t.id?Object(Z.a)(Object(Z.a)({},e),t.object):e})),Object(Z.a)(Object(Z.a)({},e),{},{scene:n})}return e}))},Rc=function(e,t){var n=t.quests;return n.length?e.map((function(e){var t=n.find((function(t){return t.name===e.name}));if(t){var a=t.progress;return Object(Z.a)(Object(Z.a)({},e),{},{progress:a})}return e})):e},Hc=function(e,t){return e.map((function(e){return e.name===t.questName?Object(Z.a)(Object(Z.a)({},e),{},{questVars:Nc()(e.questVars,t.vars,{arrayMerge:Fc})}):e}))},Lc=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.encounterResults.concat();return n[t.nodeIndex]=t.result,Object(Z.a)(Object(Z.a)({},e),{},{encounterResults:n})}return e}))},Wc=function(e,t){return e.map((function(e){return e.name===t.questName&&e.scene&&(e.scene.activeInteractionModal=t.sceneInteractionModal),e}))},Fc=function(e,t){return t},Bc={fabric:0,food:0,iron:10,leather:0,stone:0,wood:10},zc=!1,_c=function(e,t,n){var a=Object(Z.a)(Object(Z.a)({},e[t]),{},{state:n});return Object(Z.a)(Object(Z.a)({},e),{},Object(He.a)({},t,a))},Vc=function(e,t){var n=e[t.structure].level+1,a=Object(Z.a)(Object(Z.a)({},e[t.structure]),{},{level:n});return Object(Z.a)(Object(Z.a)({},e),{},Object(He.a)({},t.structure,a))},Gc=function(e,t){var n=t.workers,a=e[t.structure].workers+n,r=Object(Z.a)(Object(Z.a)({},e[t.structure]),{},{workers:a});return Object(Z.a)(Object(Z.a)({},e),{},Object(He.a)({},t.structure,r))},Qc=function(e,t){var n=t.workers,a=e[t.structure].workers-n,r=Object(Z.a)(Object(Z.a)({},e[t.structure]),{},{workers:a});return Object(Z.a)(Object(Z.a)({},e),{},Object(He.a)({},t.structure,r))},Uc=function(e,t){if((n=t.structure)===P.a.alchemist||n===P.a.armoursmith||n===P.a.weaponsmith||n===P.a.workshop)return e;var n,a=t.item,c=[].concat(Object(r.a)(e[t.structure].produces),[a]),o=Object(Z.a)(Object(Z.a)({},e[t.structure]),{},{produces:c});return Object(Z.a)(Object(Z.a)({},e),{},Object(He.a)({},t.structure,o))},Xc={level:0,state:g.NotBuilt,workers:0},Yc=(uc={},Object(He.a)(uc,P.a.alchemist,Object(Z.a)(Object(Z.a)({},Xc),{},{produces:[]})),Object(He.a)(uc,P.a.armoursmith,Object(Z.a)(Object(Z.a)({},Xc),{},{produces:[Ae.a.boots1]})),Object(He.a)(uc,P.a.garden,{level:0,workers:0,state:g.Built}),Object(He.a)(uc,P.a.lumberMill,Xc),Object(He.a)(uc,P.a.mine,{level:0,workers:0,state:g.NotBuilt}),Object(He.a)(uc,P.a.quarry,Xc),Object(He.a)(uc,P.a.tavern,{level:0,workers:0,state:g.Built}),Object(He.a)(uc,P.a.tannery,Xc),Object(He.a)(uc,P.a.warehouse,{level:0,workers:0,state:g.Built}),Object(He.a)(uc,P.a.weaponsmith,Object(Z.a)(Object(Z.a)({},Xc),{},{produces:[Ae.a.simpleCrossbow,Ae.a.dagger]})),Object(He.a)(uc,P.a.weaver,Xc),Object(He.a)(uc,P.a.workshop,Object(Z.a)(Object(Z.a)({},Xc),{},{produces:[Ae.a.torch,Ae.a.sandwich]})),uc),Zc=function(e){return{name:e.name,origin:e.origin,type:e.taskType,callbacks:e.callbacks,timeRemaining:e.time,startTime:Date.now(),lastTick:Date.now(),progress:0}},Jc={completed:[],running:[]},Kc=13,$c=Object(Te.b)({adventurers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ua.a.moveItemInInventory:var n=t,a=n.adventurerId,r=n.fromSlot,c=n.toSlot,o=e.find((function(e){return e.id===a})),i=o.inventory.map((function(e,t){return t===r?o.inventory[c]:t===c?o.inventory[r]:e}));return e.map((function(e){return e===o?Object(Z.a)(Object(Z.a)({},e),{},{inventory:i}):e}));case ua.a.moveItemToOtherAdventurer:var s=t,u=s.adventurerId,l=s.fromSlot,d=s.toAdventurerId,m=e.find((function(e){return e.id===u})),h=m.inventory[l];return e.map((function(e){if(e.id===u){var t=e.inventory.concat();return t[l]=null,Object(Z.a)(Object(Z.a)({},e),{},{inventory:t})}if(e.id===d){var n=e.inventory.concat(),a=n.findIndex((function(e){return null===e}));return n[a]=h,Object(Z.a)(Object(Z.a)({},e),{},{inventory:n})}return e}));case ua.a.addItemToInventory:var b=t,p=b.item;return e.map((function(e){if(e.id===t.adventurerId){var n=e.inventory.concat(),a=t.toSlot;return null!==a&&void 0!==a||(a=n.findIndex((function(e){return null===e||void 0===e}))),n[a]=p,Object(Z.a)(Object(Z.a)({},e),{},{inventory:n})}return e}));case ua.a.removeItemFromInventory:var j=t,f=j.fromSlot;return e.map((function(e){if(e.id===t.adventurerId){var n=e.inventory.map((function(e,t){return t!==f?e:null}));return Object(Z.a)(Object(Z.a)({},e),{},{inventory:n})}return e}));case ua.a.assignEquipment:var v=t,g=v.equipmentSlot,O=v.item;return e.map((function(e){return e.id===t.adventurerId?Object(Z.a)(Object(Z.a)({},e),{},{equipment:Object(Z.a)(Object(Z.a)({},e.equipment),{},Object(He.a)({},on.a[g],O))}):e}));case ua.a.removeEquipment:var y=t,x=y.equipmentSlot;return e.map((function(e){return e.id===t.adventurerId?Object(Z.a)(Object(Z.a)({},e),{},{equipment:Object(Z.a)(Object(Z.a)({},e.equipment),{},Object(He.a)({},on.a[x],null))}):e}));case ua.a.renameAdventurer:var w=t,k=w.name;return e.map((function(e){return e.id===t.adventurerId?Object(Z.a)(Object(Z.a)({},e),{},{name:k}):e}));case ua.a.addXP:var N=t,S=N.xp;return e.map((function(e){return e.id===t.adventurerId?Object(Z.a)(Object(Z.a)({},e),{},{xp:e.xp+S}):e}))}return e},combat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O.c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b.startCombatAction:var n=t;return Object(Z.a)(Object(Z.a)({},e),{},{action:{actor:n.actor,endsAt:n.endsAt,target:n.target,type:n.combatType}});case b.moveActor:var a=t,r=e.actors.map((function(e){return e.name===a.actor?Object(Z.a)(Object(Z.a)({},e),{},{location:a.location}):e}));return Object(Z.a)(Object(Z.a)({},e),{},{actors:r});case b.clearCombatAction:return Object(Z.a)(Object(Z.a)({},e),{},{action:void 0})}return e},engine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fc(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.startGame:return Object(Z.a)(Object(Z.a)({},e),{},{gameStarted:Date.now()});case a.gameTick:var n=t.resources,r=null===n?e.lastProducedUpdate:Date.now(),c=e.lastTick;return Object(Z.a)(Object(Z.a)({},e),{},{previousTick:c,lastProducedUpdate:r,lastTick:Date.now()})}return e},gold:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Qe.a.addGold:return e+t.amount}return e},stockpile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gc(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _e.addItem:var n=t,a=n.item,c=t,o=c.toSlot;return void 0===o&&-1===(o=e.findIndex((function(e){return null===e})))?[].concat(Object(r.a)(e),[a]):e.map((function(e,t){return t===o?a:e}));case _e.moveItemInWarehouse:var i=t,s=i.fromSlot,u=i.toSlot;return e.map((function(t,n){return n===s?e[u]:n===u?e[s]:t}));case _e.removeItem:var l=t,d=l.fromSlot;return e.map((function(e,t){return t!==d?e:null}));case _e.addStockpileSlots:var m=t,h=m.slots;return[].concat(Object(r.a)(e),Object(r.a)(Array(h).fill(null)))}return e},log:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case p.a.addLogEntry:var n=t,c=n.entry,o=n.channel,i=n.channelContext,s=c.key,u=c.context,l=Date.now();return[{channel:o,channelContext:i,context:u,key:s,time:l}].concat(Object(r.a)(e));case a.gameTick:return xc(e,t)}return e},quests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Lt.a.launchQuest:return Ic(e,t);case Lt.a.exitEncounter:return Tc(e,t);case Lt.a.updateQuestVars:return Hc(e,t);case Lt.a.updateEncounterResult:return Lc(e,t);case Lt.a.setSceneName:return Cc(e,t);case Lt.a.setScene:return qc(e,t);case Lt.a.enqueueSceneAction:return Ac(e,t);case Lt.a.completeSceneAction:return Ec(e,t);case Lt.a.setCombat:return Pc(e,t);case Lt.a.deductActorAp:return Mc(e,t);case Lt.a.updateSceneObjectAction:return Dc(e,t);case Lt.a.setActiveSceneInteractionModal:return Wc(e,t);case a.gameTick:return Rc(e,t)}return e},resources:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bc,t=arguments.length>1?arguments[1]:void 0,n=function(t){return Object.keys(e).reduce((function(n,a){var r=a;return n[r]=e[r]+(t[r]||0),n}),{})};switch(t.type){case we.addResources:var r=t.resources;return n(r);case we.removeResources:var c=t.resources;return Object.keys(e).reduce((function(t,n){var a=n;return t[a]=e[a]-(c[a]||0),t}),{});case a.gameTick:var o=t.resources;return null===o?e:n(o)}return e},rngState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zc,t=arguments.length>1?arguments[1]:void 0;return t.type===a.gameTick&&null!=t.rngState&&(e=Object.assign({},t.rngState)),e},structures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ke.startBuildingStructure:return _c(e,t.structure,g.Building);case ke.finishBuildingStructure:return _c(e,t.structure,g.Built);case ke.upgradeStructure:return Vc(e,t);case ke.increaseWorkers:return Gc(e,t);case ke.decreaseWorkers:return Qc(e,t);case ke.setStructureState:var n=t,a=n.state;return _c(e,t.structure,a);case ke.addItemToToProduces:return Uc(e,t)}return e},tasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ca.start:var n=Zc(t),r=e.running.concat(n);return Object(Z.a)(Object(Z.a)({},e),{},{running:r});case a.gameTick:var c=Date.now(),o=[],i=[];return e.running.forEach((function(e){var t=c+e.timeRemaining,n=(c-e.startTime)/(t-e.startTime),a=e.timeRemaining-(c-e.lastTick),r=Object(Z.a)(Object(Z.a)({},e),{},{progress:n,lastTick:c,timeRemaining:a});a<0?i.push(r):o.push(r)})),{running:o,completed:i}}return e},workers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ve.addWorkers:return e+t.value}return e}}),eo={key:"root",storage:h.a,version:v},to=Object(mc.a)(eo,$c),no=function(){var e=Object(i.a)(o.a.mark((function e(){var t,n=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",new Promise((function(e,n){var a=Object(Te.d)(to,t,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),r=Object(mc.b)(a,void 0,(function(){var t=Object(qt.d)(a.getState());e({store:a,persistor:r,isHydrated:t})}))})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ao=function(e,t){e.completed.forEach((function(e){return function(e){switch(e.callbacks.forEach((function(e){return t(e)})),e.type){case qa.craftItem:var n=e.name,a=q.a.get("common-item-crafted",{item:n}),r=Object(qe.a)(n);Oe.b.addToast(a,ye.a.itemCrafted,r.iconImg)}}(e)}))},ro=(n(500),function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(z.c)("".concat(".","/lang/en.json"));case 2:(t=e.sent)&&q.a.init(t.data),n="GILLESROX2",ec=!0,Qr=$r()(n,{state:!0}),co();case 6:case"end":return e.stop()}var n}),e)})));return function(){return e.apply(this,arguments)}}()),co=function(){var e=Object(i.a)(o.a.mark((function e(){var t,n,a,r,c=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},e.next=3,no(t);case 3:n=e.sent,a=n.store,r=n.isHydrated,lc=n.persistor,r?io():oo(a),lo(a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oo=function(e){e.dispatch({type:a.startGame}),e.dispatch(Object(p.c)("test-game-welcome")),console.log("Starting new GAME (version ".concat(f,")"))},io=function(){console.log("Continuing existing GAME (version ".concat(f,")"))},so=function(){var e=Object(i.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,lc.purge();case 2:return e.next=4,no(t);case 4:n=e.sent,a=n.store,lo(a),location.href="#".concat(Object(D.d)());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),uo=function(){confirm("Are you sure you wish to reset all your progress?")&&(clearTimeout(dc),lc.purge(),h.a.clear(),co({adventurers:jc,combat:O.c,engine:fc(),gold:vc,stockpile:gc(),log:yc,quests:Sc,resources:Bc,rngState:zc,structures:Yc,tasks:Jc,workers:Kc}),location.reload(),console.clear())},lo=function(e){clearTimeout(dc),l.render(Object(_.jsx)(d.a,{store:e,children:Object(_.jsx)(Yr,{persistor:lc})}),document.getElementById("root")),ac();dc=setInterval((function(){var t=e.getState(),n=Date.now()-t.engine.lastTick,c=[],o=Zr(t.engine.lastProducedUpdate,t),i=tc();y(n,e);var s=Jr(n,e),u=s.questUpdates,l=s.logUpdates;c.push.apply(c,Object(r.a)(l)),e.dispatch(function(e,t,n,r,c){return{type:a.gameTick,delta:e,rngState:t,resources:n,quests:r,log:c}}(n,i,o,u,c)),ao(t.tasks,e.dispatch)}),2500)};ro()},function(e,t,n){"use strict";n.r(t),n.d(t,"DungeonEntranceSceneController",(function(){return F})),n.d(t,"DungeonHallwaySceneController",(function(){return B}));var a=n(6),r=n(27),c=n(55),o=n(44),i=n(22),s=n(34),u=n(33),l=n(64),d=n(42),m=n.n(d),h=n(58),b=n(49),p=n(81),j=n(117),f=n(170),v=n(28),g=n(24),O=n(45),y=n(47),x=n(31);function w(e){return"string"===typeof e.key}var k=n(7),N=n(69),S=n(68),I=n(48),T=n(86),C=n(41),q=n(71),A=n(21),E=n(61),P=500,M=function(){function e(t,n){Object(i.a)(this,e),this.questName=void 0,this.mapData=void 0,this.aStar=void 0,this.dataLoading=!1,this.dataLoadComplete=!1,this.jsonPath=void 0,this.store=void 0,this.blockedTiles=[],this.store=t,this.questName=n}return Object(r.a)(e,[{key:"basePath",get:function(){return this.jsonPath?"".concat(".","/").concat(this.jsonPath.substr(0,this.jsonPath.lastIndexOf("/"))):null}},{key:"loadData",value:function(e){var t=this;if(this.dataLoadComplete)return e();if(!this.jsonPath)throw new Error("No jsonPath defined!");this.dataLoading=!0;var n=function(){var e=Object(h.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){A.c.addSound(t,n,(function(t){e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),a=[n("scene/bow",["sound/scene/bow-01.mp3","sound/scene/bow-02.mp3"]),n("scene/meleeHit",["sound/scene/melee-hit-01.mp3","sound/scene/melee-hit-02.mp3","sound/scene/melee-hit-03.mp3"]),n("scene/metalBash",["sound/scene/metal-bash-01.mp3","sound/scene/metal-bash-02.mp3","sound/scene/metal-bash-03.mp3"]),n("scene/shieldBash",["sound/scene/shield-bash-impact.mp3"]),n("scene/swish",["sound/scene/swish-01.mp3","sound/scene/swish-02.mp3","sound/scene/swish-03.mp3","sound/scene/swish-04.mp3"]),n("scene/doorOpen",["sound/scene/door.ogg"]),Object(p.c)("".concat(".","/").concat(this.jsonPath))];Promise.all(a).then(Object(h.a)(m.a.mark((function n(){var a,r,c,o,i;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=PIXI.Loader.shared.resources["".concat(".","/").concat(t.jsonPath)],t.mapData=a.data,t.createBlockedTiles(),t.aStar=t.createAStar(),r=Object(g.b)(t.sceneObjects.length?t.sceneObjects:t.createObjects()),c=Object(l.a)(r),n.prev=6,c.s();case 8:if((o=c.n()).done){n.next=14;break}return i=o.value,n.next=12,Object(p.c)(i);case 12:n.next=8;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(6),c.e(n.t0);case 19:return n.prev=19,c.f(),n.finish(19);case 22:t.dataLoadComplete=!0,t.dataLoading=!1,e();case 25:case"end":return n.stop()}}),n,null,[[6,16,19,22]])}))))}},{key:"createBlockedTiles",value:function(e){var t,n=this;this.blockedTiles=[],null===(t=this.mapData)||void 0===t||t.layers.filter((function(e){return e.visible})).forEach((function(e){e.properties&&e.properties.some((function(e){return"blocksMovement"===e.name&&!0===e.value}))&&Object(b.b)(n.blockedTiles,e,e.width)})),null===e||void 0===e||e.forEach((function(e){!0===e.properties.blocksMovement&&e.location&&n.blockedTiles.push(e.location)}))}},{key:"createScene",value:function(){var e=this.createObjects();this.updateScene(e,!1)}},{key:"updateScene",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sceneObjects,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.combat,n=Object(a.a)(Object(a.a)({},this.quest.scene),{},{objects:e,combat:t});this.dispatch(Object(v.h)(this.questName,n)),this.createBlockedTiles(e),this.mapData&&(this.aStar=this.createAStar())}},{key:"sceneEntered",value:function(){}},{key:"getTileDimensions",value:function(){var e,t;return{tileWidth:(null===(e=this.mapData)||void 0===e?void 0:e.tilewidth)||0,tileHeight:(null===(t=this.mapData)||void 0===t?void 0:t.tileheight)||0}}},{key:"actorMoved",value:function(e,t){var n=this.getObjectAtLocation(t);if(n&&n.type===b.a.exit)if(n.properties.loadScene)this.dispatch(Object(v.i)(this.questName,n.properties.loadScene));else{var a=Math.floor(this.quest.progress)+1,r=Object(S.a)(this.questName).nodes[a];r.log&&this.dispatch(Object(N.c)(r.log,null,I.a.quest,this.questName)),this.dispatch(Object(v.d)(this.questName))}}},{key:"actorInteract",value:function(e,t){var n=this.getSceneActor(e),a=this.getObjectAtLocation(t);a?this.interactWithObject(n,a):console.warn("No object found")}},{key:"actorAttemptAction",value:function(e,t,n){var a=this,r=this.getSceneActor(e),c=r.location;switch(t){case g.a.move:var o=this.findPath(c,n);if(this.combat){r.ap;null===o||void 0===o||o.length}null===o||void 0===o||o.forEach((function(t,n){var r={actionType:g.a.move,actorId:e,target:t,endsAt:P*(n+1)+performance.now()};a.dispatch(Object(v.c)(a.questName,r))}));break;case g.a.interact:var i=this.findPathNearest(c,n);null===i||void 0===i||i.forEach((function(t,n){var r={actionType:g.a.move,actorId:e,target:t,endsAt:P*(n+1)+performance.now()};a.dispatch(Object(v.c)(a.questName,r))}));var s={actionType:g.a.interact,actorId:e,target:n,endsAt:P*i.length+performance.now()};this.dispatch(Object(v.c)(this.questName,s));break;case g.a.slash:var u=this.findPath(c,n),l=null===u||void 0===u?void 0:u.pop();if(!u||!l)return;null===u||void 0===u||u.forEach((function(t,n){var r={actionType:g.a.move,actorId:e,target:t,endsAt:P*(n+1)+performance.now()};a.dispatch(Object(v.c)(a.questName,r))}));var d={actionType:t,actorId:e,target:l,endsAt:P*(u.length+1)+performance.now()};this.dispatch(Object(v.c)(this.questName,d))}}},{key:"interactWithObject",value:function(e,t){}},{key:"pointToSceneLocation",value:function(e){var t,n;return(null===(t=this.mapData)||void 0===t?void 0:t.tilewidth)&&(null===(n=this.mapData)||void 0===n?void 0:n.tileheight)?[Math.floor(e.x/this.mapData.tilewidth),Math.floor(e.y/this.mapData.tilewidth)]:[0,0]}},{key:"locationIsBlocked",value:function(e){return this.blockedTiles.some((function(t){return Object(b.d)(t,e)}))}},{key:"locationIsOutOfBounds",value:function(e){return!this.mapData||(e[0]<0||e[1]<0||e[0]>=this.mapData.width||e[1]>=this.mapData.height)}},{key:"getLootCache",value:function(e){}},{key:"takeGoldFromCache",value:function(e){var t=this.getLootCache(e);t&&this.dispatch(Object(T.b)(t.gold||0))}},{key:"takeItemFromCache",value:function(e,t,n,a){var r=this.getLootCache(t);if(r){var c=r.items[e];this.dispatch(Object(C.b)(n,c,a))}}},{key:"discardItem",value:function(e,t){var n=this.getAdventurerById(t),a=null===n||void 0===n?void 0:n.inventory.indexOf(e);void 0!==a&&this.dispatch(Object(C.f)(t,a))}},{key:"getSituation",value:function(e,t){}},{key:"handleSituationOptionClick",value:function(e,t,n){}},{key:"findPath",value:function(e,t){var n;return null===(n=this.aStar)||void 0===n?void 0:n.findPath(D(e),D(t)).map(R)}},{key:"findPathNearest",value:function(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=null===(n=this.aStar)||void 0===n?void 0:n.getGrid().getGridNodes();if(!r)return[];var c=r.map((function(e){return e.map((function(e){return e.getIsWalkable()?0:1}))}));c[t[1]][t[0]]=0;var o=new f.AStarFinder({grid:{matrix:c},includeStartNode:!1,heuristic:"Manhattan",weight:.2});return o.findPath(D(e),D(t)).map(R).slice(0,a?void 0:-1)}},{key:"calculateWalkApCosts",value:function(e,t){var n;return(null===(n=this.findPath(e,t))||void 0===n?void 0:n.length)||0}},{key:"getSceneActor",value:function(e){return this.sceneActors.find((function(t){return t.name===e}))}},{key:"getObjectAtLocation",value:function(e){var t,n;return null===(t=this.quest.scene)||void 0===t||null===(n=t.objects)||void 0===n?void 0:n.find((function(t){return t.location&&Object(b.d)(t.location,e)}))}},{key:"createAStar",value:function(){var e=[];if(this.mapData)for(var t=0;t<this.mapData.height;t++){for(var n=[],a=0;a<this.mapData.width;a++){var r=[a,t],c=this.locationIsBlocked(r);n.push(c?1:0)}e.push(n)}return new f.AStarFinder({grid:{matrix:e},includeStartNode:!1,heuristic:"Manhattan",weight:.2})}},{key:"createObjects",value:function(){var e=this;if(!this.mapData)throw new Error("No mapData");var t=this.mapData.layers.filter((function(e){return e.type===j.a.objectgroup})),n=[],r=this.getAdventurers();return t.forEach((function(t){t.objects.reduce((function(n,c){var o,i,s=Object(b.e)(c.properties),u=[c.x/((null===(o=e.mapData)||void 0===o?void 0:o.tilewidth)||1),(c.y-(c.gid?c.height:0))/((null===(i=e.mapData)||void 0===i?void 0:i.tileheight)||1)],l=Object(a.a)(Object(a.a)({},c),{},{layerId:t.id,properties:s,location:u});if(l.type===b.a.adventurerStart){var d=r.pop();d?(l.type=b.a.actor,Object(g.c)(l)&&(l.name=d.id,l.allegiance=E.a.player,l.properties.adventurerId=d.id,l.properties.isSprite=!0,l.properties.spritesheet=d.spritesheetPath)):l=null}else l.type===b.a.enemySpawn&&(l.type=b.a.actor,Object(g.c)(l)&&(l.allegiance=E.a.enemy,l.properties.isSprite=!0,l.properties.spritesheet="".concat("img/scene/actors/","troll-sword.json")));return l&&n.push(l),n}),n)})),n}},{key:"combat",get:function(){var e;return!!(null===(e=this.quest.scene)||void 0===e?void 0:e.combat)}},{key:"sceneObjects",get:function(){var e;return(null===(e=this.quest.scene)||void 0===e?void 0:e.objects)||[]}},{key:"sceneActors",get:function(){return this.sceneObjects.filter(g.c)}},{key:"quest",get:function(){var e=this;return this.store.getState().quests.find((function(t){return t.name===e.questName}))}},{key:"questVars",get:function(){return this.quest.questVars}},{key:"updateQuestVars",value:function(e){this.dispatch(Object(v.j)(this.questName,e))}},{key:"getAdventurers",value:function(){var e=this.store.getState();return Object(q.b)(e.adventurers,this.quest)}},{key:"getAdventurerByActor",value:function(e){return this.store.getState().adventurers.find((function(t){return t.id===e.name}))}},{key:"getAdventurerById",value:function(e){return this.store.getState().adventurers.find((function(t){return t.id===e}))}},{key:"questUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=w(e)?e:{key:e},r=k.a.getTextEntry(a);n&&O.b.addToast(r,y.a.questUpdate,t,Object(x.a)(this.questName)),this.dispatch(Object(N.b)(a,I.a.quest,this.questName))}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}]),e}(),D=function(e){return{x:e[0],y:e[1]}},R=function(e){return[e[0],e[1]]},H=n(118),L=n(2),W=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return n}(M),F=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).jsonPath="scenes/ork-dungeon-level1.json",e}return Object(r.a)(n,[{key:"getLootCache",value:function(e){return this.questVars.dungeon.entrance.chest}},{key:"takeGoldFromCache",value:function(e){Object(c.a)(Object(o.a)(n.prototype),"takeGoldFromCache",this).call(this,e),this.updateQuestVars({dungeon:{entrance:{chest:{gold:0}}}})}},{key:"takeItemFromCache",value:function(e,t,a,r){Object(c.a)(Object(o.a)(n.prototype),"takeItemFromCache",this).call(this,e,t,a,r);var i=this.getLootCache(t);if(i){var s=i.items.filter((function(t,n){return n!==e}));this.updateQuestVars({dungeon:{entrance:{chest:{items:s}}}})}}},{key:"updateScene",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sceneObjects,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.combat;t=t.map((function(t){switch(t.name){case"chest":return Object(a.a)(Object(a.a)({},t),{},{gid:e.questVars.dungeon.entrance.chestOpen?34:33})}return t})),Object(c.a)(Object(o.a)(n.prototype),"updateScene",this).call(this,t,r)}},{key:"interactWithObject",value:function(e,t){switch(t.name){case"chest":if(!this.questVars.dungeon.entrance.chestOpen){var a,r={key:"quest-common-adventurer-opened-chest",context:{adventurer:null===(a=this.getAdventurerByActor(e))||void 0===a?void 0:a.name}};this.questUpdate(r,"/img/items/misc/chest-02.png"),this.updateQuestVars({dungeon:{entrance:{chestOpen:!0}}})}this.store.dispatch(Object(v.f)(this.questName,{type:"lootCache",lootCache:t.name}));break;case"altar":this.store.dispatch(Object(v.f)(this.questName,{type:"situation",situation:"altar"}))}Object(c.a)(Object(o.a)(n.prototype),"interactWithObject",this).call(this,e,t)}},{key:"sceneEntered",value:function(){this.questVars.dungeon.entered||this.questUpdate("quest-kill10-boars-enter-dungeon-see-chest")}},{key:"getSituation",value:function(e,t){return Object(c.a)(Object(o.a)(n.prototype),"getSituation",this).call(this,e,t)}},{key:"handleSituationOptionClick",value:function(e,t,n){}}]),n}(W),B=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).jsonPath="scenes/ork-dungeon-level2.json",e}return Object(r.a)(n,[{key:"getLootCache",value:function(e){return this.questVars.dungeon.hallway.chest}},{key:"sceneEntered",value:function(){}},{key:"interactWithObject",value:function(e,t){switch(t.name){case"chest":if(!this.questVars.dungeon.hallway.chestOpen){var a,r={key:"quest-common-adventurer-opened-chest",context:{adventurer:null===(a=this.getAdventurerByActor(e))||void 0===a?void 0:a.name}};this.questUpdate(r,"/img/items/misc/chest-02.png"),this.updateQuestVars({dungeon:{hallway:{chestOpen:!0}}})}this.store.dispatch(Object(v.f)(this.questName,{type:"lootCache",lootCache:t.name}));break;case"door1":this.questVars.dungeon.hallway.doorOpen||this.store.dispatch(Object(v.f)(this.questName,{type:"situation",situation:"door"}));break;case"latrine":this.questUpdate("quest-kill10-boars-dungeonentrance-latrine")}Object(c.a)(Object(o.a)(n.prototype),"interactWithObject",this).call(this,e,t)}},{key:"getSituation",value:function(e,t){switch(e){case"door":var a=this.getAdventurerById(t);return a&&a.inventory.some((function(e){return e===L.a.key}))?{title:"quest-kill10-boars-dungeonentrance-door",choices:["quest-common-scenerio-door-open"]}:{title:"quest-kill10-boars-dungeonentrance-door",text:"quest-kill10-boars-dungeonentrance-door-needs-key"};default:return Object(c.a)(Object(o.a)(n.prototype),"getSituation",this).call(this,e,t)}}},{key:"handleSituationOptionClick",value:function(e,t,n){switch(e){case"door":var a;this.updateQuestVars({dungeon:{hallway:{doorOpen:!0}}}),A.c.playSound("scene/doorOpen",A.a.scene,!1,A.b.singleInstance),this.discardItem(L.a.key,n);var r={key:"quest-common-adventurer-opened-door",context:{adventurer:null===(a=this.getAdventurerById(n))||void 0===a?void 0:a.name}};this.questUpdate(r,"/img/items/misc/chest-02.png"),this.dispatch(Object(v.f)(this.questName))}}},{key:"takeItemFromCache",value:function(e,t,a,r){Object(c.a)(Object(o.a)(n.prototype),"takeItemFromCache",this).call(this,e,t,a,r);var i=this.getLootCache(t);if(i){var s=i.items.filter((function(t,n){return n!==e}));this.updateQuestVars({dungeon:{hallway:{chest:{items:s}}}})}}},{key:"updateScene",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sceneObjects,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.combat;t=t.map((function(t){switch(t.name){case"chest":return Object(a.a)(Object(a.a)({},t),{},{gid:e.questVars.dungeon.hallway.chestOpen?34:33});case"door1":if(e.questVars.dungeon.hallway.doorOpen){var n=Object(a.a)(Object(a.a)({},t.properties),{},{blocksMovement:!1,interactive:!1});return"upper"===t.properties.part?Object(a.a)(Object(a.a)({},t),{},{gid:228,properties:n}):Object(a.a)(Object(a.a)({},t),{},{gid:240,properties:n})}return"upper"===t.properties.part?Object(a.a)(Object(a.a)({},t),{},{gid:252}):Object(a.a)(Object(a.a)({},t),{},{gid:264})}return t})),Object(c.a)(Object(o.a)(n.prototype),"updateScene",this).call(this,t,r)}}]),n}(W);H.a.registerSceneController("kill10Boars","dungeon.entrance",F),H.a.registerSceneController("kill10Boars","dungeon.hallway",B)}],[[501,1,2]]]);
//# sourceMappingURL=main.a31767ec.chunk.js.map