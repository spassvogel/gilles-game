(this["webpackJsonpgilles-game"]=this["webpackJsonpgilles-game"]||[]).push([[0],{101:function(e,t,n){},104:function(e,t,n){},113:function(e){e.exports=JSON.parse('{"alchemist":[{"shape":[34,18,31,1,37,0]},{"shape":[37,0,53,5,45,17]},{"shape":[45,17,68,27,81,48]},{"shape":[72,67,75,168,11,168]},{"shape":[9,65,1,45,10,30]},{"shape":[31,19,29,5,45,0]},{"shape":[45,0,34,18,37,0]},{"shape":[45,17,81,48,72,67]},{"shape":[72,67,11,168,9,65]},{"shape":[9,65,10,30,31,19]},{"shape":[45,17,72,67,9,65]},{"shape":[9,65,31,19,45,0]},{"shape":[37,0,45,17,9,65]}],"garden":[{"shape":[48,45,48,0,58,0]},{"shape":[57,41,75,56,73,78]},{"shape":[73,78,11,68,2,56]},{"shape":[2,56,13,45,48,45]},{"shape":[48,45,58,0,57,41]},{"shape":[73,78,2,56,48,45]},{"shape":[48,45,57,41,73,78]}],"armoursmith":[{"shape":[53,1,55,0,93,5]},{"shape":[93,5,112,11,120,20]},{"shape":[120,20,124,36,119,49]},{"shape":[119,49,122,156,75,149]},{"shape":[75,149,57,135,33,104]},{"shape":[33,104,10,95,11,52]},{"shape":[11,52,0,35,2,20]},{"shape":[2,20,6,14,27,5]},{"shape":[27,5,53,1,93,5]},{"shape":[93,5,120,20,119,49]},{"shape":[119,49,75,149,33,104]},{"shape":[33,104,11,52,2,20]},{"shape":[2,20,27,5,93,5]},{"shape":[93,5,119,49,33,104]},{"shape":[33,104,2,20,93,5]}],"lumberMill":[{"shape":[32,11,43,1,45,0]},{"shape":[45,0,49,4,37,18]},{"shape":[39,29,50,44,49,48]},{"shape":[38,46,38,230,17,233]},{"shape":[17,233,13,232,13,48]},{"shape":[13,48,3,48,14,28]},{"shape":[14,28,1,7,6,4]},{"shape":[31,18,32,11,45,0]},{"shape":[39,29,49,48,40,43]},{"shape":[38,46,17,233,13,48]},{"shape":[14,28,6,4,19,18]},{"shape":[31,18,45,0,37,18]},{"shape":[37,18,39,29,40,43]},{"shape":[40,43,38,46,13,48]},{"shape":[13,48,14,28,19,18]},{"shape":[31,18,37,18,40,43]},{"shape":[40,43,13,48,19,18]},{"shape":[19,18,31,18,40,43]}],"mine":[{"shape":[15,0,79,1,88,13]},{"shape":[88,13,78,66,27,70]},{"shape":[27,70,2,50,11,27]},{"shape":[11,27,6,13,15,0]},{"shape":[15,0,88,13,27,70]},{"shape":[27,70,11,27,15,0]}],"quarry":[{"shape":[2,24,20,2,22,0]},{"shape":[22,0,103,2,117,15]},{"shape":[117,15,124,24,112,24]},{"shape":[112,24,112,64,104,70]},{"shape":[104,70,104,89,97,88]},{"shape":[97,68,66,67,60,43]},{"shape":[60,43,17,42,17,26]},{"shape":[17,26,2,24,22,0]},{"shape":[22,0,117,15,112,24]},{"shape":[112,24,104,70,97,88]},{"shape":[60,43,17,26,22,0]},{"shape":[112,24,97,88,97,68]},{"shape":[97,68,60,43,22,0]},{"shape":[22,0,112,24,97,68]}],"tannery":[{"shape":[4,2,4,0,61,1]},{"shape":[59,36,89,37,85,79]},{"shape":[85,79,15,77,15,47]},{"shape":[15,47,5,35,0,9]},{"shape":[0,9,4,2,61,1]},{"shape":[59,36,85,79,15,47]},{"shape":[15,47,0,9,61,1]},{"shape":[61,1,59,36,15,47]}],"tavern":[{"shape":[110,27,108,24,112,23]},{"shape":[112,23,151,27,148,60]},{"shape":[148,60,137,71,133,67]},{"shape":[133,67,136,69,132,75]},{"shape":[132,75,137,77,138,124]},{"shape":[131,131,136,136,55,119]},{"shape":[29,64,6,72,0,69]},{"shape":[27,56,76,61,85,67]},{"shape":[101,25,108,13,112,17]},{"shape":[112,17,102,18,104,6]},{"shape":[110,27,112,23,148,60]},{"shape":[132,75,138,124,131,131]},{"shape":[131,131,55,119,59,118]},{"shape":[29,64,0,69,27,56]},{"shape":[112,17,104,6,111,9]},{"shape":[92,27,110,27,148,60]},{"shape":[132,75,131,131,59,118]},{"shape":[50,68,29,64,27,56]},{"shape":[92,27,148,60,133,67]},{"shape":[133,67,132,75,59,118]},{"shape":[50,68,27,56,85,67]},{"shape":[133,67,59,118,56,72]},{"shape":[56,72,50,68,85,67]},{"shape":[133,67,56,72,85,67]},{"shape":[133,67,85,67,89,60]},{"shape":[92,27,133,67,89,60]},{"shape":[92,27,89,60,86,25]},{"shape":[104,0,92,27,86,25]}],"warehouse":[{"shape":[36,414,3,409,2,13]},{"shape":[2,13,31,-7,63,7]},{"shape":[62,197,63,126,65,218]},{"shape":[61,262,83,272,84,459]},{"shape":[84,459,36,414,2,13]},{"shape":[2,13,63,7,62,197]},{"shape":[62,197,65,218,61,262]},{"shape":[61,262,84,459,2,13]},{"shape":[2,13,62,197,61,262]}],"weaponsmith":[{"shape":[52,18,50,2,50,0]},{"shape":[50,0,114,1,109,49]},{"shape":[109,49,115,132,98,129]},{"shape":[98,129,66,95,65,34]},{"shape":[11,33,11,77,0,77]},{"shape":[0,29,18,18,52,18]},{"shape":[52,18,50,0,109,49]},{"shape":[109,49,98,129,65,34]},{"shape":[11,33,0,77,0,29]},{"shape":[52,18,109,49,65,34]},{"shape":[15,27,11,33,0,29]},{"shape":[52,18,65,34,53,26]},{"shape":[15,27,0,29,52,18]},{"shape":[52,18,53,26,15,27]}],"weaver":[{"shape":[51,41,54,0,55,6]},{"shape":[55,41,82,53,87,63]},{"shape":[87,63,86,259,62,254]},{"shape":[62,254,23,212,21,61]},{"shape":[21,61,2,56,51,41]},{"shape":[51,41,55,6,55,41]},{"shape":[55,41,87,63,62,254]},{"shape":[62,254,21,61,51,41]},{"shape":[51,41,55,41,62,254]}],"workshop":[{"shape":[11,2,13,0,68,3]},{"shape":[68,3,77,12,70,14]},{"shape":[70,14,69,38,10,37]},{"shape":[9,13,1,12,11,2]},{"shape":[11,2,68,3,70,14]},{"shape":[70,14,10,37,9,13]},{"shape":[9,13,11,2,70,14]}]}')},114:function(e){e.exports=JSON.parse('{"alpha":{"start":0.25,"end":0},"scale":{"start":0.04,"end":0.29,"minimumScaleMultiplier":1},"color":{"start":"#85888d","end":"#100f0c"},"speed":{"start":100,"end":200,"minimumSpeedMultiplier":1},"acceleration":{"x":10,"y":-30},"maxSpeed":200,"startRotation":{"min":265,"max":270},"noRotation":false,"rotationSpeed":{"min":8,"max":0},"lifetime":{"min":0.5,"max":3.05},"blendMode":"normal","frequency":0.0005,"emitterLifetime":-1,"maxParticles":300,"pos":{"x":0,"y":0},"addAtBack":true,"spawnType":"point"}')},123:function(e,t,n){e.exports=n(250)},172:function(e,t,n){},173:function(e,t,n){},195:function(e,t){},201:function(e,t,n){},202:function(e,t,n){},203:function(e,t,n){},204:function(e,t,n){},205:function(e,t,n){},206:function(e,t,n){},208:function(e,t,n){},209:function(e,t,n){},210:function(e,t,n){},211:function(e,t,n){},212:function(e,t,n){},213:function(e,t,n){},214:function(e,t,n){},215:function(e,t,n){},216:function(e,t,n){},217:function(e,t,n){},218:function(e,t,n){},219:function(e,t,n){},229:function(e,t,n){},230:function(e,t,n){},231:function(e,t,n){},232:function(e,t,n){},233:function(e,t,n){},234:function(e,t,n){},242:function(e,t){},243:function(e,t,n){},244:function(e,t,n){},245:function(e,t,n){},247:function(e,t,n){},250:function(e,t,n){"use strict";n.r(t);var r,a,o,c=n(14),i=n(29),s=n.n(i),u=n(41),l=n(105),m=n.n(l);!function(e){e.clearCombatAction="clearCombatAction",e.startCombatAction="startCombatAction",e.moveActor="moveActor"}(r||(r={})),function(e){e[e.player=0]="player",e[e.enemy=1]="enemy"}(a||(a={})),function(e){e.move="move",e.slash="slash",e.shoot="shoot"}(o||(o={}));var d,p,h,g={actors:[{allegiance:a.player,health:100,location:[3,5],name:"c4a5d270",remainingAP:5},{allegiance:a.player,health:100,location:[4,6],name:"2e655832",remainingAP:4}],turn:a.player},f=function(e,t){var n,c,i=t.getState().combat;if(i.action&&i.action.endsAt<Date.now())if(i.turn===a.enemy);else if(i.turn===a.player){switch(i.action.type){case o.move:t.dispatch((n=i.action.actor,c=i.action.target,{type:r.moveActor,actor:n,location:c})),t.dispatch({type:r.clearCombatAction})}return{action:null}}return null},v=n(0),b=n.n(v),y=n(53),w=n(4);function E(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.common,r=arguments.length>3?arguments[3]:void 0;return{type:h.addLogEntry,key:e,channel:n,channelContext:r,context:t}}!function(e){e.gameTick="gameTick"}(d||(d={})),function(e){e[e.common=0]="common",e[e.town=1]="town",e[e.quest=2]="quest"}(p||(p={})),function(e){e.addLogEntry="addLogEntry"}(h||(h={}));var k,O,T,j=function(e){var t=e.split(".").map((function(e){return Number(e)}));if(3!==t.length)throw new Error("Received invalid version string: ".concat(e));t.forEach((function(e){if(e>=1024)throw new Error("Version string invalid, ".concat(e," is too large"))}));for(var n=0,r=0;r<3;r++)n|=t[r]<<10*r;return n}("0.0.4"),I=n(1),x=n(6),N=(n(43),n(5));!function(e){e[e.deed=0]="deed",e[e.apparel=1]="apparel",e[e.material=2]="material",e[e.questItem=3]="questItem",e[e.trinket=4]="trinket",e[e.weapon=5]="weapon"}(k||(k={})),function(e){e.deedForLumbermill="deedForLumbermill",e.deedForWeaponsmith="deedForWeaponsmith",e.boots1="boots1",e.boots2="boots2",e.boots3="boots3",e.chainmailHood="chainmailHood",e.chest="chest",e.clothGloves="clothGloves",e.cowl="cowl",e.fedora="fedora",e.druidChest="druidChest",e.druidFeet="druidFeet",e.druidHands="druidHands",e.druidHead="druidHead",e.druidLegs="druidLegs",e.greaves1="greaves1",e.greaves2="greaves2",e.hornedHelmet="hornedHelmet",e.leatherGloves="leatherGloves",e.nomadHelmet="nomadHelmet",e.pants1="pants1",e.pants2="pants2",e.plateChest1="plateChest1",e.plateChest2="plateChest2",e.plateChest3="plateChest3",e.plateChest4="plateChest4",e.plateGloves1="plateGloves1",e.plateGloves2="plateGloves2",e.plateHelmet="plateHelmet",e.platePants="platePants",e.plateShoulders1="plateShoulders1",e.plateShoulders2="plateShoulders2",e.robe="robe",e.shoulders1="shoulders1",e.shoulders2="shoulders2",e.shoulders3="shoulders3",e.vest="vest",e.arrowheads="arrowheads",e.bolts="bolts",e.buckle="buckle",e.chain="chain",e.cogs="cogs",e.gem="gem",e.gunpowder="gunpowder",e.ingot="ingot",e.nails="nails",e.poisonVial="poisonVial",e.ribbon="ribbon",e.rope="rope",e.scales="scales",e.spring="spring",e.thread="thread",e.blueprints="blueprints",e.crate="crate",e.dragonEye="dragonEye",e.dynamite="dynamite",e.eye="eye",e.feather="feather",e.food="food",e.heart="heart",e.horn="horn",e.key="key",e.letters="letters",e.lockPicks="lockPicks",e.oil="oil",e.orcFinger="orcFinger",e.plans="plans",e.purpleGems="purpleGems",e.runestone="runestone",e.sandwich="sandwich",e.teeth="teeth",e.tooth="tooth",e.torch="torch",e.tusk="tusk",e.vase="vase",e.vial="vial",e.weeds="weeds",e.ring="ring",e.magicAmulet="magicAmulet",e.battleAxe="battleAxe",e.brassKnuckles="brassKnuckles",e.cleaver="cleaver",e.club="club",e.crossbow="crossbow",e.dagger="dagger",e.flail="flail",e.greatswordOfGwai="greatswordOfGwai",e.khopesh="khopesh",e.longbow="longbow",e.mace="mace",e.morningStar="morningStar",e.poisonedDagger="poisonedDagger",e.ravenStaff="ravenStaff",e.savageStaff="savageStaff",e.spear="spear",e.sword="sword",e.warhammer="warhammer"}(O||(O={}));var C,S=k.apparel,q="/img/items/apparel/";!function(e){e[e.feet=0]="feet",e[e.hands=1]="hands",e[e.chest=2]="chest",e[e.legs=3]="legs",e[e.head=4]="head",e[e.shoulders=5]="shoulders"}(C||(C={}));var A,D=(T={},Object(I.a)(T,O.boots1,{item:O.boots1,equipmentType:C.feet,itemType:S,subText:"These boots are made for questin'",iconImg:"".concat(q,"boots_1.png")}),Object(I.a)(T,O.boots2,{item:O.boots2,equipmentType:C.feet,itemType:S,subText:"",iconImg:"".concat(q,"boots_2.png")}),Object(I.a)(T,O.boots3,{item:O.boots3,equipmentType:C.feet,itemType:S,subText:"",iconImg:"".concat(q,"boots_3.png")}),Object(I.a)(T,O.chainmailHood,{item:O.chainmailHood,equipmentType:C.head,itemType:S,subText:"",iconImg:"".concat(q,"chainmail_hood.png"),armourRating:3}),Object(I.a)(T,O.chest,{item:O.chest,equipmentType:C.chest,itemType:S,subText:"",iconImg:"".concat(q,"chest_1.png"),armourRating:2}),Object(I.a)(T,O.clothGloves,{item:O.clothGloves,equipmentType:C.hands,itemType:S,subText:"",iconImg:"".concat(q,"cloth_gloves.png")}),Object(I.a)(T,O.cowl,{item:O.cowl,equipmentType:C.head,itemType:S,subText:"",iconImg:"".concat(q,"cowl.png"),armourRating:20}),Object(I.a)(T,O.druidChest,{item:O.druidHands,equipmentType:C.chest,itemType:S,subText:"",iconImg:"".concat(q,"druid-chest.png")}),Object(I.a)(T,O.druidFeet,{item:O.druidFeet,equipmentType:C.feet,itemType:S,subText:"",iconImg:"".concat(q,"druid-feet.png")}),Object(I.a)(T,O.druidHands,{item:O.druidHands,equipmentType:C.hands,itemType:S,subText:"",iconImg:"".concat(q,"druid-hands.png")}),Object(I.a)(T,O.druidHead,{item:O.druidHead,equipmentType:C.head,itemType:S,subText:"",iconImg:"".concat(q,"druid-head.png")}),Object(I.a)(T,O.druidLegs,{item:O.druidLegs,equipmentType:C.legs,itemType:S,subText:"",iconImg:"".concat(q,"druid-legs.png")}),Object(I.a)(T,O.fedora,{item:O.fedora,equipmentType:C.head,itemType:S,subText:"I study the blade",iconImg:"".concat(q,"fedora.png")}),Object(I.a)(T,O.greaves1,{item:O.greaves1,equipmentType:C.feet,itemType:S,subText:"",iconImg:"".concat(q,"greaves_1.png"),armourRating:10}),Object(I.a)(T,O.greaves2,{item:O.greaves2,equipmentType:C.hands,itemType:S,subText:"",iconImg:"".concat(q,"greaves_2.png")}),Object(I.a)(T,O.hornedHelmet,{item:O.hornedHelmet,equipmentType:C.head,itemType:S,subText:"",iconImg:"".concat(q,"horned_helmet.png")}),Object(I.a)(T,O.leatherGloves,{item:O.leatherGloves,equipmentType:C.hands,itemType:S,subText:"",iconImg:"".concat(q,"leather_gloves.png")}),Object(I.a)(T,O.nomadHelmet,{item:O.nomadHelmet,equipmentType:C.head,itemType:S,subText:"",iconImg:"".concat(q,"nomad_helmet.png")}),Object(I.a)(T,O.pants1,{item:O.pants1,equipmentType:C.legs,itemType:S,subText:"",iconImg:"".concat(q,"pants_1.png"),armourRating:10}),Object(I.a)(T,O.pants2,{item:O.pants2,equipmentType:C.legs,itemType:S,subText:"",iconImg:"".concat(q,"pants_2.png")}),Object(I.a)(T,O.plateChest1,{item:O.plateChest1,equipmentType:C.chest,itemType:S,subText:"",iconImg:"".concat(q,"plate_chest_1.png")}),Object(I.a)(T,O.plateChest2,{item:O.plateChest2,equipmentType:C.chest,itemType:S,subText:"",iconImg:"".concat(q,"plate_chest_2.png")}),Object(I.a)(T,O.plateChest3,{item:O.plateChest3,equipmentType:C.chest,itemType:S,subText:"",iconImg:"".concat(q,"plate_chest_3.png")}),Object(I.a)(T,O.plateChest4,{item:O.plateChest4,equipmentType:C.chest,itemType:S,subText:"",iconImg:"".concat(q,"plate_chest_4.png")}),Object(I.a)(T,O.plateGloves1,{item:O.plateGloves1,equipmentType:C.hands,itemType:S,subText:"",iconImg:"".concat(q,"plate_gloves_1.png")}),Object(I.a)(T,O.plateGloves2,{item:O.plateGloves2,equipmentType:C.hands,itemType:S,subText:"",iconImg:"".concat(q,"plate_gloves_2.png")}),Object(I.a)(T,O.plateHelmet,{item:O.plateHelmet,equipmentType:C.head,itemType:S,subText:"",iconImg:"".concat(q,"plate_helmet_1.png")}),Object(I.a)(T,O.platePants,{item:O.platePants,equipmentType:C.legs,itemType:S,subText:"",iconImg:"".concat(q,"plate_pants1.png")}),Object(I.a)(T,O.plateShoulders1,{item:O.plateShoulders1,equipmentType:C.shoulders,itemType:S,subText:"",iconImg:"".concat(q,"plate_shoulders_1.png")}),Object(I.a)(T,O.plateShoulders2,{item:O.plateShoulders2,equipmentType:C.shoulders,itemType:S,subText:"",iconImg:"".concat(q,"plate_shoulders_2.png")}),Object(I.a)(T,O.robe,{item:O.robe,equipmentType:C.chest,itemType:S,subText:"",iconImg:"".concat(q,"robe_1.png")}),Object(I.a)(T,O.shoulders1,{item:O.shoulders1,equipmentType:C.shoulders,itemType:S,subText:"",iconImg:"".concat(q,"shoulders_1.png")}),Object(I.a)(T,O.shoulders2,{item:O.shoulders2,equipmentType:C.shoulders,itemType:S,subText:"",iconImg:"".concat(q,"shoulders_2.png")}),Object(I.a)(T,O.shoulders3,{item:O.shoulders3,equipmentType:C.shoulders,itemType:S,subText:"",iconImg:"".concat(q,"shoulders_3.png")}),Object(I.a)(T,O.vest,{item:O.vest,equipmentType:C.chest,itemType:S,subText:"",iconImg:"".concat(q,"vest_1.png")}),T),R=D;!function(e){e[e.resource=0]="resource",e[e.production=1]="production",e[e.tavern=2]="tavern",e[e.warehouse=3]="warehouse"}(A||(A={}));var M,_={type:A.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-alchemist-name",workerCapacity:2,cost:{gold:0},produces:[]},{displayName:"structure-alchemist-name",workerCapacity:5,cost:{gold:30},produces:[]},{displayName:"structure-alchemist-name",workerCapacity:10,cost:{gold:50},produces:[]}]},W=n(42),H=(n(150),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"milliseconds";return W.duration(e,t).format("d [days] h [hours] m [min] s [sec]",{trim:"both"})}),F={item:O.boots1,cost:{resources:{wood:2,iron:15},time:18e5}},L={item:O.chest,cost:{resources:{wood:10,iron:45},time:36e5}},P={item:O.cowl,cost:{resources:{iron:15},time:36e5}},B={cost:{gold:40,time:4e3},type:A.production,levels:[{displayName:"structure-armoursmith-name",workerCapacity:2,cost:{gold:0},produces:[F]},{displayName:"structure-armoursmith-name",workerCapacity:5,cost:{gold:30},produces:[F,L]},{displayName:"structure-armoursmith-name",workerCapacity:10,cost:{gold:50},produces:[F,L,P]}]},U={type:A.resource,cost:{gold:40,time:4e3},levels:[{displayName:"structure-garden-name",workerCapacity:2,cost:{gold:0},generates:{food:2}},{displayName:"structure-garden-name",workerCapacity:5,cost:{gold:30},generates:{food:2}},{displayName:"structure-garden-name",workerCapacity:10,cost:{gold:50},generates:{food:2}}]},G={type:A.resource,cost:{gold:31,time:5e3},levels:[{displayName:"structure-lumberMill-name",workerCapacity:2,cost:{gold:0},generates:{wood:2}},{displayName:"structure-lumberMill-name",workerCapacity:5,cost:{gold:30},generates:{wood:2}},{displayName:"structure-lumberMill-name",workerCapacity:10,cost:{gold:50},generates:{wood:2}}]},Q={cost:{gold:40,time:4e3},type:A.resource,levels:[{displayName:"structure-mine-name",workerCapacity:2,cost:{gold:0},generates:{iron:2}},{displayName:"structure-mine-name",workerCapacity:5,cost:{gold:30},generates:{iron:2}},{displayName:"structure-mine-name",workerCapacity:10,cost:{gold:50},generates:{iron:2}}]},V={cost:{gold:40,time:4e3},type:A.resource,levels:[{displayName:"structure-quarry-name",workerCapacity:2,cost:{gold:0},generates:{stone:2}},{displayName:"structure-quarry-name",workerCapacity:5,cost:{gold:30},generates:{stone:4}},{displayName:"structure-quarry-name",workerCapacity:10,cost:{gold:50},generates:{stone:6}}]},z={cost:{gold:40,time:4e3},type:A.resource,levels:[{displayName:"structure-tannery-name",workerCapacity:2,cost:{gold:0},generates:{leather:2}},{displayName:"structure-tannery-name",workerCapacity:5,cost:{gold:30},generates:{leather:5}},{displayName:"structure-tannery-name",workerCapacity:10,cost:{gold:50},generates:{leather:7}}]},X={cost:{gold:40,time:4e3},type:A.tavern,levels:[{displayName:"structure-tavern-name",workerCapacity:2,cost:{gold:0},rooms:10},{displayName:"structure-tavern-name",workerCapacity:5,cost:{gold:30},rooms:12},{displayName:"structure-tavern-name",workerCapacity:10,cost:{gold:50},rooms:15}]},K={cost:{gold:40,time:4e3},type:A.warehouse,levels:[{displayName:"structure-warehouse-name",workerCapacity:2,cost:{gold:0},maxResources:{fabric:200,food:200,iron:200,leather:200,stone:200,wood:200}},{displayName:"structure-warehouse-name",workerCapacity:5,cost:{gold:30},maxResources:{fabric:500,food:500,iron:500,leather:500,stone:500,wood:500}},{displayName:"structure-warehouse-name",workerCapacity:10,cost:{gold:50},maxResources:{fabric:1e3,food:1e3,iron:1e3,leather:1e3,stone:1e3,wood:1e3}}]},J={item:O.crossbow,cost:{resources:{wood:20,iron:5},time:18e5}},Y={item:O.longbow,cost:{resources:{wood:40,iron:5},time:36e5}},Z={item:O.poisonedDagger,cost:{resources:{wood:50,iron:15},materials:[O.poisonVial],time:36e5}},$={item:O.dagger,cost:{resources:{wood:10,iron:10},time:36e5}},ee={item:O.sword,cost:{resources:{wood:10,iron:30},time:36e5}},te={item:O.khopesh,cost:{resources:{wood:15,iron:40},time:12e4}},ne={type:A.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-weaponsmith-name",workerCapacity:2,cost:{gold:0},produces:[J,$]},{displayName:"structure-weaponsmith-name",workerCapacity:5,cost:{gold:30},produces:[J,$,Y]},{displayName:"structure-weaponsmith-name",workerCapacity:10,cost:{gold:50},produces:[J,$,Y,ee,te]},{displayName:"structure-weaponsmith-name",workerCapacity:14,cost:{gold:50},produces:[J,$,Y,ee,te,Z]}]},re={cost:{gold:40,time:4e3},type:A.resource,levels:[{displayName:"structure-weaver-name",workerCapacity:2,cost:{gold:0},generates:{fabric:2}},{displayName:"structure-weaver-name",workerCapacity:5,cost:{gold:30},generates:{fabric:5}},{displayName:"structure-weaver-name",workerCapacity:10,cost:{gold:50},generates:{fabric:7}}]},ae={item:O.torch,cost:{resources:{wood:2,fabric:1},time:6e4}},oe={item:O.sandwich,cost:{resources:{food:1},time:3e4}},ce={type:A.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-workshop-name",workerCapacity:2,cost:{gold:0},produces:[ae,oe]},{displayName:"structure-workshop-name",workerCapacity:5,cost:{gold:30},produces:[]},{displayName:"structure-workshop-name",workerCapacity:10,cost:{gold:50},produces:[]},{displayName:"structure-workshop-name",workerCapacity:14,cost:{gold:50},produces:[]}]};!function(e){e.alchemist="alchemist",e.armoursmith="armoursmith",e.garden="garden",e.lumberMill="lumberMill",e.mine="mine",e.quarry="quarry",e.tavern="tavern",e.tannery="tannery",e.warehouse="warehouse",e.weaponsmith="weaponsmith",e.weaver="weaver",e.workshop="workshop"}(M||(M={}));var ie={alchemist:_,armoursmith:B,garden:U,lumberMill:G,mine:Q,quarry:V,tavern:X,tannery:z,warehouse:K,weaponsmith:ne,weaver:re,workshop:ce};function se(e){return ie[e]}var ue,le,me,de,pe,he,ge=k.deed,fe={deedForLumbermill:{item:O.deedForLumbermill,structure:M.lumberMill,itemType:ge,subText:"It allows for the construction of a lumber mill",iconImg:"/img/items/deeds/deed.png"},deedForWeaponsmith:{item:O.deedForWeaponsmith,structure:M.weaponsmith,itemType:ge,subText:"It allows for the construction of a weaponsmith",iconImg:"/img/items/deeds/deed.png"}},ve=k.material,be="/img/items/materials/",ye=(ue={},Object(I.a)(ue,O.arrowheads,{item:O.arrowheads,itemType:ve,iconImg:"".concat(be,"arrowheads.png")}),Object(I.a)(ue,O.bolts,{item:O.bolts,itemType:ve,iconImg:"".concat(be,"bolts.png")}),Object(I.a)(ue,O.buckle,{item:O.buckle,itemType:ve,iconImg:"".concat(be,"buckle.png")}),Object(I.a)(ue,O.chain,{item:O.chain,itemType:ve,iconImg:"".concat(be,"chain.png")}),Object(I.a)(ue,O.cogs,{item:O.cogs,itemType:ve,iconImg:"".concat(be,"cogs.png")}),Object(I.a)(ue,O.gem,{item:O.gem,itemType:ve,iconImg:"".concat(be,"gem.png")}),Object(I.a)(ue,O.ingot,{item:O.ingot,itemType:ve,iconImg:"".concat(be,"ingot.png")}),Object(I.a)(ue,O.nails,{item:O.nails,itemType:ve,iconImg:"".concat(be,"nails.png")}),Object(I.a)(ue,O.poisonVial,{item:O.poisonVial,itemType:ve,iconImg:"".concat(be,"poison-vial.png")}),Object(I.a)(ue,O.ribbon,{item:O.ribbon,itemType:ve,iconImg:"".concat(be,"ribbon.png")}),Object(I.a)(ue,O.rope,{item:O.rope,itemType:ve,iconImg:"".concat(be,"rope.png")}),Object(I.a)(ue,O.gem,{item:O.gem,itemType:ve,iconImg:"".concat(be,"gem.png")}),Object(I.a)(ue,O.gunpowder,{item:O.gunpowder,itemType:ve,iconImg:"".concat(be,"gunpowder.png")}),Object(I.a)(ue,O.scales,{item:O.scales,itemType:ve,iconImg:"".concat(be,"scales.png")}),Object(I.a)(ue,O.spring,{item:O.spring,itemType:ve,iconImg:"".concat(be,"spring.png")}),Object(I.a)(ue,O.thread,{item:O.thread,itemType:ve,iconImg:"".concat(be,"thread.png")}),ue),we=k.questItem,Ee="/img/items/quest-items/",ke=(le={},Object(I.a)(le,O.blueprints,{item:O.blueprints,itemType:we,iconImg:"".concat(Ee,"blueprints.png")}),Object(I.a)(le,O.crate,{item:O.crate,itemType:we,iconImg:"".concat(Ee,"crate.png")}),Object(I.a)(le,O.dynamite,{item:O.dynamite,itemType:we,iconImg:"".concat(Ee,"dynamite.png")}),Object(I.a)(le,O.dragonEye,{item:O.dragonEye,itemType:we,iconImg:"".concat(Ee,"dragon-eye.png")}),Object(I.a)(le,O.eye,{item:O.eye,itemType:we,iconImg:"".concat(Ee,"eye.png")}),Object(I.a)(le,O.feather,{item:O.feather,itemType:we,iconImg:"".concat(Ee,"feather.png")}),Object(I.a)(le,O.food,{item:O.food,itemType:we,iconImg:"".concat(Ee,"food.png")}),Object(I.a)(le,O.heart,{item:O.heart,itemType:we,iconImg:"".concat(Ee,"heart.png")}),Object(I.a)(le,O.horn,{item:O.horn,itemType:we,iconImg:"".concat(Ee,"horn.png")}),Object(I.a)(le,O.key,{item:O.key,itemType:we,iconImg:"".concat(Ee,"key.png")}),Object(I.a)(le,O.letters,{item:O.letters,itemType:we,iconImg:"".concat(Ee,"letters.png")}),Object(I.a)(le,O.lockPicks,{item:O.lockPicks,itemType:we,iconImg:"".concat(Ee,"lock-picks.png")}),Object(I.a)(le,O.oil,{item:O.oil,itemType:we,iconImg:"".concat(Ee,"oil.png")}),Object(I.a)(le,O.orcFinger,{item:O.orcFinger,itemType:we,iconImg:"".concat(Ee,"orc-finger.png")}),Object(I.a)(le,O.plans,{item:O.plans,itemType:we,iconImg:"".concat(Ee,"plans.png")}),Object(I.a)(le,O.purpleGems,{item:O.purpleGems,itemType:we,iconImg:"".concat(Ee,"purple-gems.png")}),Object(I.a)(le,O.runestone,{item:O.runestone,itemType:we,iconImg:"".concat(Ee,"runestone.png")}),Object(I.a)(le,O.sandwich,{item:O.sandwich,itemType:we,iconImg:"".concat(Ee,"sandwich.png")}),Object(I.a)(le,O.teeth,{item:O.teeth,itemType:we,iconImg:"".concat(Ee,"teeth.png")}),Object(I.a)(le,O.tooth,{item:O.tooth,itemType:we,iconImg:"".concat(Ee,"tooth.png")}),Object(I.a)(le,O.torch,{item:O.torch,itemType:we,iconImg:"".concat(Ee,"torch.png")}),Object(I.a)(le,O.tusk,{item:O.tusk,itemType:we,iconImg:"".concat(Ee,"tusk.png")}),Object(I.a)(le,O.vase,{item:O.vase,itemType:we,iconImg:"".concat(Ee,"vase.png")}),Object(I.a)(le,O.vial,{item:O.vial,itemType:we,iconImg:"".concat(Ee,"vial.png")}),Object(I.a)(le,O.weeds,{item:O.weeds,itemType:we,iconImg:"".concat(Ee,"weeds.png")}),le),Oe=k.trinket,Te=(me={},Object(I.a)(me,O.magicAmulet,{item:O.magicAmulet,itemType:Oe,iconImg:"".concat("/img/items/trinkets/","magic_amulet.png")}),Object(I.a)(me,O.ring,{item:O.ring,itemType:Oe,iconImg:"".concat("/img/items/trinkets/","ring.png")}),me),je=k.weapon,Ie="/img/items/weapons/";!function(e){e[e.axe=0]="axe",e[e.bow=1]="bow",e[e.club=2]="club",e[e.crossbow=3]="crossbow",e[e.fist=4]="fist",e[e.flail=5]="flail",e[e.hammer=6]="hammer",e[e.melee=7]="melee",e[e.knife=8]="knife",e[e.staff=9]="staff",e[e.sword=10]="sword",e[e.poleArm=11]="poleArm"}(pe||(pe={})),function(e){e.kinetic="kinetic"}(he||(he={}));var xe=(de={},Object(I.a)(de,O.battleAxe,{item:O.battleAxe,itemType:je,weaponType:pe.axe,subText:"It's an axe for battle",iconImg:"".concat(Ie,"battle_axe.png"),damage:Object(I.a)({},he.kinetic,20)}),Object(I.a)(de,O.brassKnuckles,{item:O.brassKnuckles,itemType:je,weaponType:pe.melee,subText:" Brass knuckles are pieces of metal shaped to fit around the knuckles.",iconImg:"".concat(Ie,"brass_knuckles.png"),damage:Object(I.a)({},he.kinetic,10)}),Object(I.a)(de,O.crossbow,{item:O.crossbow,itemType:je,weaponType:pe.crossbow,subText:"Shoots and reloads fast",iconImg:"".concat(Ie,"crossbow.png"),damage:Object(I.a)({},he.kinetic,3)}),Object(I.a)(de,O.cleaver,{item:O.cleaver,itemType:je,weaponType:pe.knife,subText:"A cleaver is a large knife that varies in its shape but usually resembles a rectangular-bladed hatchet.",iconImg:"".concat(Ie,"cleaver.png"),damage:Object(I.a)({},he.kinetic,5)}),Object(I.a)(de,O.club,{item:O.club,itemType:je,weaponType:pe.club,subText:"A club is among the simplest of all weapons: a short staff or stick, usually made of wood, wielded as a weapon",iconImg:"".concat(Ie,"club.png"),damage:Object(I.a)({},he.kinetic,8)}),Object(I.a)(de,O.dagger,{item:O.dagger,itemType:je,weaponType:pe.knife,subText:"Excellent for ritual sacrifice and cheese platters",iconImg:"".concat(Ie,"dagger.png"),damage:Object(I.a)({},he.kinetic,8)}),Object(I.a)(de,O.flail,{item:O.flail,itemType:je,weaponType:pe.flail,subText:"A flail is a weapon consisting of a striking head attached to a handle by a flexible rope, strap, or chain. ",iconImg:"".concat(Ie,"flail.png"),damage:Object(I.a)({},he.kinetic,15)}),Object(I.a)(de,O.greatswordOfGwai,{item:O.greatswordOfGwai,itemType:je,weaponType:pe.sword,subText:"Finer steel was seldom forged",iconImg:"".concat(Ie,"greatsword-gwai.png"),unique:!0,damage:Object(I.a)({},he.kinetic,25)}),Object(I.a)(de,O.khopesh,{item:O.khopesh,itemType:je,weaponType:pe.sword,subText:"Dafuq is this. Can I get garlic sauce with that?",iconImg:"".concat(Ie,"khopesh.png"),damage:Object(I.a)({},he.kinetic,15)}),Object(I.a)(de,O.longbow,{item:O.longbow,itemType:je,weaponType:pe.bow,subText:"A deadly killer from long range",iconImg:"".concat(Ie,"longbow.png"),damage:Object(I.a)({},he.kinetic,2)}),Object(I.a)(de,O.mace,{item:O.mace,itemType:je,weaponType:pe.club,subText:"A mace is a blunt weapon, a type of club or virge that uses a heavy head on the end of a handle to deliver powerful blows.",iconImg:"".concat(Ie,"mace.png"),damage:Object(I.a)({},he.kinetic,15)}),Object(I.a)(de,O.morningStar,{item:O.morningStar,itemType:je,weaponType:pe.club,subText:"A morning star is any of several medieval club-like weapons consisting of a shaft with an attached ball adorned with one or more spikes.",iconImg:"".concat(Ie,"morning-star.png"),damage:Object(I.a)({},he.kinetic,13)}),Object(I.a)(de,O.poisonedDagger,{item:O.poisonedDagger,itemType:je,weaponType:pe.knife,subText:"Excellent for ritual sacrifice and cheese platters",iconImg:"".concat(Ie,"poisoned-dagger.png"),damage:Object(I.a)({},he.kinetic,12)}),Object(I.a)(de,O.ravenStaff,{item:O.ravenStaff,itemType:je,weaponType:pe.staff,subText:"Kaa, kaa!",iconImg:"".concat(Ie,"raven-staff.png"),damage:Object(I.a)({},he.kinetic,13)}),Object(I.a)(de,O.savageStaff,{item:O.savageStaff,itemType:je,weaponType:pe.staff,subText:"Savage dude",iconImg:"".concat(Ie,"savage-staff.png"),damage:Object(I.a)({},he.kinetic,8)}),Object(I.a)(de,O.spear,{item:O.spear,itemType:je,weaponType:pe.poleArm,subText:"A spear is a pole weapon consisting of a shaft, usually of wood, with a pointed head. ",iconImg:"".concat(Ie,"sword.png"),damage:Object(I.a)({},he.kinetic,10)}),Object(I.a)(de,O.sword,{item:O.sword,itemType:je,weaponType:pe.sword,subText:"An elegant weapon for a more civilized age",iconImg:"".concat(Ie,"sword.png"),damage:Object(I.a)({},he.kinetic,14)}),Object(I.a)(de,O.warhammer,{item:O.warhammer,itemType:je,weaponType:pe.hammer,subText:"A war hammer is a late medieval weapon of war intended for close combat action, whose design resembles the hammer",iconImg:"".concat(Ie,"warhammer.png"),damage:Object(I.a)({},he.kinetic,16)}),de),Ne=xe;var Ce=Object(N.a)({},fe,{},R,{},ye,{},ke,{},Te,{},Ne),Se=Ce;function qe(e){return Ce[e]}var Ae=n(8),De=n(9),Re=n(31),Me=function(){function e(){Object(Ae.a)(this,e)}return Object(De.a)(e,null,[{key:"init",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.texts=e,this.templates={},t&&this.compileAll(),this.initialized=!0}},{key:"get",value:function(e,t){if(!this.initialized)throw new Error("Error ".concat(this," not initialized!"));var n=this.getTemplate(e);return n?n(t):(console.error("Key '".concat(e,"' not found in TextManager")),"<<'".concat(e,"' missing>>"))}},{key:"getTextEntry",value:function(e){return this.get(e.key,e.context)}},{key:"getTemplate",value:function(e){var t=this.templates[e];return!t&&this.texts[e]&&(this.compile(e,this.texts[e]),t=this.templates[e]),t}},{key:"getQuestTitle",value:function(e){return this.get("quest-".concat(e,"-title"))}},{key:"getQuestDescription",value:function(e){return this.get("quest-".concat(e,"-description"))}},{key:"getResourceName",value:function(e){return this.get("resource-".concat(e,"-name"))}},{key:"getItemName",value:function(e){var t=k[qe(e).itemType];return this.get("item-".concat(t,"-").concat(e,"-name"))}},{key:"getStructureName",value:function(e){return this.get("structure-".concat(e,"-name"))}},{key:"compileAll",value:function(){var e=this;Object.keys(this.texts).forEach((function(t){e.compile(t,e.texts[t])}))}},{key:"compile",value:function(e,t){var n=Re.compile(t);this.templates[e]=n}}]),e}();Me.initialized=!1,Me.texts=void 0,Me.templates=void 0,Re.registerHelper("item:name",(function(e,t){if(!Se[e])return new Re.SafeString("<<ITEM DEFINITION NOT FOUND: ".concat(e,">>"));switch(t){case"aA":return He(e);case"aD":case"aU":return Le(e);default:var n=Se[e].name;return new Re.SafeString(n)}})),Re.registerHelper("structure:name",(function(e){var t=Me.get("structure-".concat(e,"-name"));return new Re.SafeString(t)}));var _e,We,He=function(e){return Fe(e)},Fe=function(e){var t=Me.getItemName(e),n=Me.getTemplate("common-article-undefined");return new Re.SafeString("".concat(n({noun:t})))},Le=function(e){var t=Me.getItemName(e),n=Me.getTemplate("common-article-defined");return new Re.SafeString("".concat(n({noun:t})))},Pe=(n(172),function(e){var t=e.itemsInInventory,n=(e.className||"")+" itemsbox",r=e.items.reduce((function(e,t){return e[t]||(e[t]=0),e[t]++,e}),{}),a=Object.keys(r).map((function(e){var n=e,a=r[e],o="item";a>(t?t.filter((function(e){return e===n})).length:0)&&(o+=" missing");var c=Se[n];return v.createElement("li",{className:o,key:n},v.createElement("div",{className:"icon common-icon-smallest",style:{backgroundImage:"url(".concat("/gilles-game").concat(c.iconImg,")")}}),v.createElement("div",{className:"name"},"".concat(Me.getItemName(n)," (").concat(a,")")))}));return v.createElement("ul",{className:n},a)}),Be=Object(w.b)((function(e,t){var n=[],r=Object(c.a)(e.stockpile);return t.items.forEach((function(e){var t=r.findIndex((function(t){return t===e}));if(t>-1){var a=r.splice(t,1),o=Object(x.a)(a,1)[0];o&&n.push(o)}})),{itemsInInventory:n}}))(Pe);!function(e){e.wood="wood",e.iron="iron",e.stone="stone",e.leather="leather",e.fabric="fabric",e.food="food"}(We||(We={}));var Ue,Ge,Qe=(_e={},Object(I.a)(_e,We.wood,{resource:We.wood,iconImg:"/img/resources/wood.png"}),Object(I.a)(_e,We.iron,{resource:We.iron,iconImg:"/img/resources/iron.png"}),Object(I.a)(_e,We.stone,{resource:We.stone,iconImg:"/img/resources/stone.png"}),Object(I.a)(_e,We.leather,{resource:We.leather,iconImg:"/img/resources/leather.png"}),Object(I.a)(_e,We.fabric,{resource:We.fabric,iconImg:"/img/resources/fabric.png"}),Object(I.a)(_e,We.food,{resource:We.food,iconImg:"/img/resources/food.png"}),_e),Ve=(n(63),function(e){var t=e.sufficientResources,n=(e.className||"")+" resourcesbox",r=Object.keys(e.resources).map((function(n){var r="resource";t&&!t[n]&&(r+=" insufficient");var a=Qe[n];if(!a)throw new Error("No resource description found for ".concat(n));return v.createElement("li",{className:r,key:n},v.createElement("div",{className:"icon",style:{backgroundImage:"url(".concat("/gilles-game").concat(a.iconImg,")")}}),v.createElement("div",{className:"name"},Me.getResourceName(n)),v.createElement("div",{className:"amount"},e.resources[n]))}));return v.createElement("ul",{className:n},r)}),ze=Object(w.b)((function(e,t){var n={};return Object.keys(t.resources).forEach((function(r){n[r]=e.resources[r]>=t.resources[r]})),{sufficientResources:n}}))(Ve),Xe=function(e,t){if(t>6)throw new Error("Cannot possibly have more than ".concat(6," on one item!"));return e-.1*e*(t-1)};!function(e){e[e.item=0]="item"}(Ue||(Ue={})),function(e){e[e.smallest=0]="smallest",e[e.small=1]="small",e[e.medium=2]="medium",e[e.big=3]="big",e[e.biggest=4]="biggest"}(Ge||(Ge={}));var Ke=function e(t){switch(t){case Ge.smallest:return"common-icon-smallest";case Ge.small:return"common-icon-small";case Ge.medium:return"common-icon-medium";case Ge.big:return"common-icon-big";case Ge.biggest:return"common-icon-biggest"}return e(Ge.medium)},Je=(n(173),n(11)),Ye=n(12),Ze=n(108),$e=n.n(Ze);var et=function(){var e=function(){function e(){Object(Ae.a)(this,e)}return Object(De.a)(e,null,[{key:"addEventListener",value:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(this.events[e])for(var n=0;n<this.events[e].length;n++)if(this.events[e][n]===t){this.events[e].splice(n,1);break}}},{key:"emit",value:function(e,t){this.events[e]&&this.events[e].forEach((function(e){return e(t)}))}}]),e}();return e.events={},e},tt=function(e){Object(Ye.a)(n,e);var t=Object(Je.a)(n);function n(){return Object(Ae.a)(this,n),t.apply(this,arguments)}return Object(De.a)(n,null,[{key:"showContextTooltip",value:function(e,t,n){var r={type:e,info:t,referenceRect:n};$e()(r,this.lastContext)?this.clear():(this.emit(this.EVENT_CONTEXT_UPDATED,r),this.lastContext=r)}},{key:"clear",value:function(){this.emit(this.EVENT_CONTEXT_UPDATED,void 0),this.lastContext=void 0}}]),n}(et());tt.EVENT_CONTEXT_UPDATED="tooltipContextUpdated",tt.lastContext=void 0;var nt=function(e){var t=e.item,n=qe(t);n||console.warn("could not find definition for ".concat(t));var r="item-icon ".concat(Ke(e.size));return v.createElement("div",{className:r,onClick:function(n){if(!1!==e.showContext){var r=n.currentTarget.getBoundingClientRect();tt.showContextTooltip(Ue.item,qe(t),r),n.stopPropagation()}e.onClick&&e.onClick(n)},style:{backgroundImage:"url(".concat("/gilles-game").concat(n.iconImg,")")}})},rt=(n(201),function(e){var t,n,r,a=(t=e.progress||0,n=0,t>(r=1)?r:t<n?n:t);return v.createElement("div",{className:"progressbar"},v.createElement("div",{className:"progressbar-label"},e.label),v.createElement("div",{className:"progressbar-info",style:{width:"".concat(100*a,"%")}},"  "))});n(202);var at,ot,ct,it,st,ut=function(e){var t;return t=null==e.max?e.value:v.createElement("span",null,e.value," / ",v.createElement("span",{className:"max"},e.max)),v.createElement("div",{className:"updownvalue"},v.createElement("label",null," ",e.label),t,v.createElement("i",{className:"arrow up"+(e.upDisabled?" disabled":""),onClick:function(t){e.onUp&&!e.upDisabled&&e.onUp(t)}}),v.createElement("i",{className:"arrow down"+(e.downDisabled?" disabled":""),onClick:function(t){e.onDown&&!e.downDisabled&&e.onDown(t)}}))},lt=(n(203),n(204),function(e){return b.a.createElement("div",{className:"structureview-header structureview-header-".concat(e.structure)})}),mt=function(e){var t=Object(v.useState)(),n=Object(x.a)(t,2),r=n[0],a=n[1],o=Object(v.useState)(0),c=Object(x.a)(o,2),i=c[0],s=c[1],u=se(e.type);if(!u)throw new Error("No definition found for structure ".concat(e.type,"\n            with type ProductionStructureDefinition."));var l=e.level||0,m=u.levels[l],d=Me.getStructureName(e.type);return v.createElement(v.Fragment,null,v.createElement(lt,{structure:e.type}),v.createElement("details",{open:!0,className:"productionstructureview"},v.createElement("summary",null,d),v.createElement("section",null,function(){var t=e.gold,n=u.levels[l+1],r=null!=n?n.cost.gold||0:-1,a=null!=n&&t>=r,o="Upgrade! (".concat(r<0?"max":r+" gold",")");return v.createElement("div",null,v.createElement("label",null,"level:"),l+1+" / "+u.levels.length,v.createElement("button",{style:{float:"right"},onClick:function(t){e.onUpgrade&&e.onUpgrade(r,l+1)},disabled:!a},o))}(),v.createElement("div",null,"craft:"),v.createElement("div",{className:"crafting-area"},v.createElement("ul",{className:"vertical-tab-bar"},m.produces.map((function(e){return v.createElement("li",{key:"craft".concat(e.item),onClick:function(t){t.stopPropagation(),a(e.item)},className:r===e.item?"selected":""},v.createElement(nt,{item:e.item}),Me.getItemName(e.item))}))),function(){var t=r;if(!t)return null;var n=m.produces.find((function(e){return e.item===t})),a=e.resources||{},o=n.cost.resources,c=Object.keys(o).some((function(e){return o[e]>a[e]})),u=!1,l=n.cost.materials;l&&(u=l.some((function(t){return-1===e.items.indexOf(t)})));var d=c||u||i<1,p=Se[t],h=null;return l&&(h=v.createElement(Be,{items:l})),v.createElement("div",{className:"crafting-details"},"Craft a ",Me.getItemName(p.item),v.createElement("div",{className:"crafting-costs"},v.createElement("fieldset",null,v.createElement(ze,{resources:o})),v.createElement("fieldset",null,h)),v.createElement("div",{style:{display:"flex "}},v.createElement(ut,{value:i,label:"Workers: ",onUp:function(e){e.stopPropagation(),s(i+1)},onDown:function(e){e.stopPropagation(),s(i-1)},upDisabled:i>=e.workersFree||i>=6,downDisabled:i<1}),"\xa0",function(e){if(0===i)return"";var t=Xe(e,i),n=H(t);return" Crafting time: ".concat(n)}(n.cost.time||0)),v.createElement("div",null,v.createElement("button",{disabled:d,onClick:function(t){t.stopPropagation(),e.onCraft&&(e.onCraft(n,i),s(0))}},"Craft")))}()),v.createElement("fieldset",null,v.createElement("legend",null,"Currently crafting:"),(e.tasks||[]).map((function(e){return v.createElement(rt,{key:"".concat(e.name).concat(e.startTime),label:"".concat(e.name," (").concat(H(e.timeRemaining),")"),progress:e.progress})}))))))};function dt(e){return{type:at.addGold,amount:e}}function pt(e){return{type:at.addGold,amount:-e}}function ht(e,t){return{type:ot.addItem,item:e,toSlot:t}}function gt(e){return{type:ot.removeItem,fromSlot:e}}function ft(e){return{type:ct.addResources,resources:e}}function vt(e){return{type:it.finishBuildingStructure,structure:e}}function bt(e){return{type:it.upgradeStructure,structure:e}}function yt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:it.increaseWorkers,structure:e,workers:t}}function wt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:it.decreaseWorkers,structure:e,workers:t}}function Et(e,t,n,r,a){return{type:st.start,taskType:e,name:t,origin:n,time:r,callbacks:a}}!function(e){e.addGold="addGold"}(at||(at={})),function(e){e.addItem="addItem",e.moveItemInWarehouse="moveItemInWarehouse",e.removeItem="removeItem"}(ot||(ot={})),function(e){e.addResources="addResources",e.removeResources="removeResources"}(ct||(ct={})),function(e){e.upgradeStructure="upgradeStructure",e.increaseWorkers="increaseWorkers",e.decreaseWorkers="decreaseWorkers",e.startBuildingStructure="startBuildingStructure",e.finishBuildingStructure="finishBuildingStructure",e.setStructureState="setStructureState"}(it||(it={})),function(e){e.start="startTask",e.update="updateTasks"}(st||(st={}));var kt,Ot=n(26),Tt=Object(Ot.a)([function(e){return e.structures},function(e){return e.workers}],(function(e,t){return t-Object.keys(e).map((function(t){return e[t]})).reduce((function(e,t){return e+t.workers}),0)}));!function(e){e[e.buildStructure=0]="buildStructure",e[e.craftItem=1]="craftItem"}(kt||(kt={}));var jt,It=Object(w.b)((function(e,t){var n=e.structures[t.type],r=e.tasks.running.filter((function(e){return e.origin==="".concat(t.type,".craft")}));return{gold:e.gold,items:e.stockpile,level:n.level,resources:e.resources,tasks:r,workersFree:Tt(e)}}),(function(e,t){return{onCraft:function(n,r){var a,o=Xe(n.cost.time||0,r);e((a=n.cost.resources||{},{type:ct.removeResources,resources:a})),e(yt(t.type,r));var c=[ht(n.item),wt(t.type,r)],i=Et(kt.craftItem,n.item,"".concat(t.type,".craft"),o,c);e(i)},onUpgrade:function(n,r){e(pt(n)),e(bt(t.type)),r++,e(E("log-town-upgrade-structure-complete",{level:r,structure:t.type},p.town))}}}))(mt);function xt(e){return{type:jt.advanceQuest,questName:e}}function Nt(e,t){return{type:jt.startEncounter,questName:e,encounter:t}}!function(e){e.launchQuest="launchQuest",e.advanceQuest="advanceQuest",e.updateQuestVars="updateQuestVars",e.updateEncounterResult="updateEncounterResult",e.startEncounter="startEncounter",e.updateQuests="updateQuests"}(jt||(jt={}));var Ct,St="adventurer",qt="item";!function(e){e[e.adventurerInventory=0]="adventurerInventory",e[e.warehouse=1]="warehouse",e[e.tavern=2]="tavern",e[e.adventurerEquipment=3]="adventurerEquipment"}(Ct||(Ct={}));var At=n(253),Dt=(n(205),function(e){var t=e.adventurer,n=(e.className||"")+" avatar";return v.createElement("div",{className:n,style:{backgroundImage:"url(".concat("/gilles-game").concat(t.avatarImg,")")},onClick:function(){e.onClick&&e.onClick(e.adventurer.id)}},v.createElement("div",{className:"sizer"}),e.displayName&&v.createElement("div",{className:"name"},t.name))}),Rt=(n(206),{beginDrag:function(e){return{adventurer:e.adventurer,sourceId:e.sourceId,sourceType:Ct.adventurerInventory}}});var Mt,_t,Wt=Object(At.a)(St,Rt,(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.isDragging,n=e.connectDragSource,r="draggable-adventurer-avatar";return e.disabled&&(r+=" disabled"),t&&(r+=" dragging"),n(v.createElement("div",{className:r},v.createElement(Dt,e)))}));!function(e){e.backstabbed="backstabbed",e.goblinHouseHallway="goblinHouseHallway",e.goblinHouseOutside="goblinHouseOutside",e.theBigTree="theBigTree"}(Mt||(Mt={})),function(e){e[e.nothing=0]="nothing",e[e.encounter=1]="encounter",e[e.combat=2]="combat",e[e.boss=3]="boss"}(_t||(_t={}));var Ht={kill10Boars:{nodes:[{x:0,y:1,type:_t.nothing,log:"quest-kill10Boars-node0"},{x:0,y:2,type:_t.nothing,log:"quest-kill10Boars-node1"},{x:0,y:3,type:_t.encounter,encounter:Mt.goblinHouseOutside},{x:1,y:3,type:_t.nothing,log:"quest-kill10Boars-node4"},{x:1,y:3,type:_t.nothing},{x:2,y:3,type:_t.nothing},{x:3,y:3,type:_t.encounter,encounter:Mt.backstabbed},{x:4,y:4,type:_t.nothing,log:"The party spots a boss"},{x:5,y:4,type:_t.boss}]},retrieveMagicAmulet:{requiredItems:[O.torch,O.torch,O.torch,O.sandwich,O.sandwich],nodes:[{x:0,y:1,type:_t.nothing},{x:1,y:1,type:_t.nothing},{x:2,y:1,type:_t.nothing},{x:3,y:1,type:_t.nothing},{x:4,y:1,type:_t.nothing},{x:5,y:1,type:_t.nothing},{x:7,y:1,type:_t.nothing},{x:8,y:2,type:_t.nothing},{x:8,y:3,type:_t.nothing},{x:9,y:3,type:_t.nothing},{x:10,y:1,type:_t.nothing},{x:10,y:2,type:_t.nothing},{x:10,y:3,type:_t.nothing},{x:10,y:4,type:_t.nothing},{x:11,y:5,type:_t.nothing},{x:12,y:6,type:_t.nothing},{x:12,y:7,type:_t.nothing},{x:13,y:8,type:_t.nothing},{x:12,y:8,type:_t.nothing},{x:12,y:9,type:_t.nothing},{x:11,y:8,type:_t.nothing},{x:10,y:8,type:_t.nothing},{x:9,y:8,type:_t.nothing},{x:8,y:9,type:_t.nothing},{x:7,y:8,type:_t.encounter,encounter:Mt.theBigTree},{x:8,y:1,type:_t.nothing},{x:1,y:1,type:_t.nothing},{x:1,y:1,type:_t.nothing},{x:1,y:1,type:_t.nothing},{x:1,y:1,type:_t.nothing},{x:1,y:1,type:_t.nothing},{x:1,y:1,type:_t.nothing},{x:1,y:1,type:_t.nothing},{x:1,y:1,type:_t.nothing},{x:2,y:1,type:_t.encounter,encounter:Mt.backstabbed},{x:3,y:1,type:_t.boss}]}},Ft=Ht;function Lt(e){return Ht[e]}var Pt=n(254),Bt=(n(208),Object(Pt.a)(St,{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){return!0}},(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,r="droppable-adventurer-slot";return t?r+=" active-drop":n&&(r+=" can-drop"),(0,e.connectDropTarget)(v.createElement("div",{className:r}))}))),Ut=(n(209),function(e){return v.createElement("ul",{className:"assign-adventurers"},function(){for(var t=[],n=function(n){var r=void 0,a="";if(!!e.assignedAventurers[n]){var o=e.assignedAventurers[n];r=v.createElement(Dt,{adventurer:o,displayName:!1,onClick:function(){return e.onRemoveAdventurer(n)}}),a="has-adventurer"}else r=v.createElement(Bt,{onDrop:function(t){e.onAddEventurer(t,n)}});t.push(v.createElement("li",{key:"slot".concat(n),className:a}," ",r," "))},r=0;r<e.availableSlots;r++)n(r);return t}())}),Gt=(n(210),function(e){var t=e.availableQuests.map((function(t){var n="".concat("/gilles-game","img/sigils/").concat(t.icon),r="quest"+(t.name===e.selectedQuestName?" selected":"");return v.createElement("li",{key:t.name,className:r,onClick:function(){e.onQuestClick(t.name)}},v.createElement("div",{className:"icon",style:{backgroundImage:"url(".concat("/gilles-game").concat(n,")")}}),v.createElement("div",{className:"title"},Me.getQuestTitle(t.name)," "))})),n=function(t){return!t.requiredItems||t.requiredItems.every((function(n){var r=t.requiredItems.filter((function(e){return e===n})).length;return e.items.filter((function(e){return e===n})).length>=r}))};return v.createElement("div",{className:"quest-board"},v.createElement("h2",null," ",Me.get("structure-tavern-title-quest-board")),v.createElement("ul",{className:"quest-list"},t),function(){if(!e.selectedQuestName)return null;var t=e.availableQuests.find((function(t){return t.name===e.selectedQuestName}));if(!t)return v.createElement("div",null," ",Me.get("structure-tavern-quest-launched")," ");var r=Lt(t.name),a=e.assignedAventurers.filter((function(e){return null!==e})).length>=3,o=n(r),c=a&&o;return v.createElement("div",{className:"quest-details"},Me.getQuestDescription(e.selectedQuestName),v.createElement(Ut,{availableSlots:5,assignedAventurers:e.assignedAventurers,onRemoveAdventurer:e.onRemoveAdventurer,onAddEventurer:e.onAddAdventurer}),v.createElement(Be,{items:r.requiredItems||[]}),v.createElement("button",{disabled:!c,onClick:function(){return e.onLaunchQuest()}},Me.get("structure-tavern-button-launch-quest")))}())});var Qt,Vt=Object(w.b)((function(e,t){return{items:e.stockpile}}))(Gt);!function(e){e[e.unavailable=0]="unavailable",e[e.available=1]="available",e[e.active=2]="active",e[e.completed=3]="completed"}(Qt||(Qt={}));n(211),n(212);var zt,Xt=Object(At.a)(qt,{beginDrag:function(e){return{inventorySlot:e.index,item:e.item,sourceId:e.sourceId,sourceType:e.sourceType}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.item,n=e.onClick,r=e.isDragging,a=e.connectDragSource,o=e.size;return r?null:a(v.createElement("div",null,v.createElement(nt,{item:t,onClick:function(e){n&&n(e)},size:o})))})),Kt=(n(213),{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){var n=t.getItem().item;return Yt(n,e.type)}});!function(e){e[e.feet=0]="feet",e[e.hands=1]="hands",e[e.chest=2]="chest",e[e.legs=3]="legs",e[e.head=4]="head",e[e.shoulders=5]="shoulders",e[e.mainHand=6]="mainHand",e[e.offHand=7]="offHand"}(zt||(zt={}));var Jt,Yt=function(e,t){switch(t){case zt.chest:return $t(e,C.chest);case zt.feet:return $t(e,C.feet);case zt.hands:return $t(e,C.hands);case zt.head:return $t(e,C.head);case zt.legs:return $t(e,C.legs);case zt.mainHand:case zt.offHand:return qe(e).itemType===k.weapon;default:return!1}},Zt=Object(Pt.a)(qt,Kt,(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,r="grey";return t&&n?r="green":n&&(r="orange"),(0,e.connectDropTarget)(v.createElement("div",{className:"equipment-slot",style:{borderColor:r},title:zt[e.type]},e.children))})),$t=function(e,t){var n=qe(e);return n.itemType===k.apparel&&n.equipmentType===t},en=(n(214),{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){var n=t.getItem();return n.sourceType!==Ct.adventurerEquipment||(null==e.item||Yt(e.item,n.inventorySlot))}}),tn=Object(Pt.a)(qt,en,(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,r=e.connectDropTarget,a=t&&n,o=["inventory-item",Ke(e.size)];return a?o.push("drop-active"):n&&o.push("drop-possible"),r(v.createElement("div",{className:o.join(" ")},e.children))})),nn=function(e){for(var t=[],n=function(n){var r=void 0,a=e.items[n];a&&(r=v.createElement(Xt,{index:n,sourceId:e.sourceId,sourceType:e.sourceType,item:a}));var o=v.createElement(tn,{key:"inventory-slot-".concat(n),item:a,size:e.iconSize,onDrop:function(t){if((t.inventorySlot!==n||t.sourceType!==e.sourceType||t.sourceId!==e.sourceId)&&e.onDropItem){var r=t.inventorySlot;e.onDropItem(t.item,r,n,t.sourceType,t.sourceId)}}},r);t.push(o)},r=0;r<e.items.length;r++)n(r);return v.createElement("div",{className:"inventory ".concat(e.className)},t)},rn=function(e){var t=e.adventurer,n=Object.keys(t.stats).map((function(e){var n=t.stats[e];return v.createElement("div",{key:"".concat(t.id,"-").concat(e)}," ",v.createElement("b",null,e),": ",n.toFixed(1)," ")})),r=function(n){var r=t.equipment[zt[n]],a=null;if(r){var o=v.createRef();a=v.createElement(Xt,{index:n,sourceId:t.id,sourceType:Ct.adventurerEquipment,item:r,onClick:function(e){var t=e.currentTarget.getBoundingClientRect();tt.showContextTooltip(Ue.item,qe(r),t),e.stopPropagation()},ref:o,size:Ge.medium})}return v.createElement(v.Fragment,null,v.createElement(Zt,{onDrop:function(r){return function(n,r){var a=n.item;switch(n.sourceType){case Ct.adventurerInventory:e.onRemoveItemFromInventory(t.id,n.inventorySlot),e.onAssignEquipment(t.id,r,a);var o=t.equipment[zt[r]];o&&e.onAddItemToInventory(t.id,o,n.inventorySlot);break;case Ct.warehouse:e.onAssignEquipmentFromWarehouse(t.id,n.inventorySlot,a,r);var c=t.equipment[zt[r]];c&&e.onAddItemToWarehouse(c,n.inventorySlot);break;case Ct.adventurerEquipment:e.onAssignEquipment(t.id,r,a);var i=t.equipment[zt[r]],s=n.inventorySlot;i?e.onAssignEquipment(t.id,s,i):e.onRemoveEquipment(t.id,s)}}(r,n)},type:n},a),v.createElement("span",{className:"info"},Me.get("ui-equipmentslot-".concat(zt[n]))))},a=v.createElement("ul",null,v.createElement("li",null,r(zt.head)),v.createElement("li",null,r(zt.shoulders)),v.createElement("li",null,r(zt.chest)),v.createElement("li",null,r(zt.hands)),v.createElement("li",null,r(zt.legs)),v.createElement("li",null,r(zt.feet)),v.createElement("li",null,r(zt.mainHand)),v.createElement("li",null,r(zt.offHand)));return v.createElement("div",{className:"adventurer-info"},v.createElement("div",{className:"left"},v.createElement("div",{className:"name"},v.createElement("b",null,t.name)),v.createElement("div",{className:"attributes"},n),v.createElement("div",{className:"equipment"},a)),v.createElement("div",{className:"right"},v.createElement(nn,{sourceType:Ct.adventurerInventory,sourceId:t.id,items:t.inventory,onDropItem:function(n,r,a,o,c){switch(o){case Ct.adventurerInventory:e.onMoveItemInInventory&&e.onMoveItemInInventory(t.id,r,a);break;case Ct.warehouse:var i=t.inventory[a];e.onMoveItemFromWarehouseToInventory(t.id,r,a,n,i);break;case Ct.adventurerEquipment:e.onAddItemToInventory&&e.onRemoveEquipment&&e.onAddItemToInventory(t.id,n,a);var s=t.inventory[a];s?e.onAssignEquipment(t.id,r,s):e.onRemoveEquipment(t.id,r)}}})))};function an(e,t,n){return{type:Jt.moveItemInInventory,adventurerId:e,fromSlot:t,toSlot:n}}function on(e,t,n){return{type:Jt.addItemToInventory,adventurerId:e,item:t,toSlot:n}}function cn(e,t){return{type:Jt.removeItemFromInventory,adventurerId:e,fromSlot:t}}function sn(e,t,n){return{type:Jt.assignEquipment,adventurerId:e,item:n,equipmentSlot:t}}function un(e,t){return{type:Jt.removeEquipment,adventurerId:e,equipmentSlot:t}}!function(e){e.moveItemInInventory="moveItemInInventory",e.moveItemToOtherAdventurer="moveItemToOtherAdventurer",e.moveItemFromWarehouseToAdventurer="moveItemFromWarehouseToAdventurer",e.addItemToInventory="addItemToInventory",e.removeItemFromInventory="removeItemFromInventory",e.assignEquipment="assignEquipment",e.removeEquipment="removeEquipment"}(Jt||(Jt={}));var ln=function(e){return{onAddItemToInventory:function(t,n,r){var a=on(t,n,r);e(a)},onAddItemToWarehouse:function(t,n){var r=ht(t,n);e(r)},onAssignEquipment:function(t,n,r){var a=sn(t,n,r);e(a)},onAssignEquipmentFromWarehouse:function(t,n,r,a){var o=gt(n);e(o);var c=sn(t,a,r);e(c)},onMoveItemFromWarehouseToInventory:function(t,n,r,a,o){var c=gt(n);e(c);var i=on(t,a,r);if(e(i),o){var s=ht(o,n);e(s)}},onMoveItemInInventory:function(t,n,r){var a=an(t,n,r);e(a)},onRemoveEquipment:function(t,n){var r=un(t,n);e(r)},onRemoveItemFromInventory:function(t,n){var r=cn(t,n);e(r)}}},mn=Object(w.b)((function(e,t){return{adventurer:e.adventurers.find((function(e){return e.id===t.adventurerId})),warehouse:e.stockpile}}),ln)(rn),dn=(n(215),n(216),function(e){var t=e.className||"";return v.createElement("div",{className:"ui-button widgets-squareiconbutton ".concat(t),onClick:function(t){e.onClick&&e.onClick(t)}},e.text)}),pn=function(e){var t=null;!1!==e.backEnabled&&(t=v.createElement(dn,{className:"back-button",onClick:function(t){e.onBack&&e.onBack()},text:"<"}));var n=null;return!1!==e.closeEnabled&&(n=v.createElement(dn,{className:"close-button",onClick:function(t){e.onClose&&e.onClose()},text:"x"})),v.createElement("div",{className:"window"},v.createElement("div",{className:"header"},t,v.createElement("h3",null,e.title),n),e.children)},hn=function(e){return function(t){Object(Ye.a)(r,t);var n=Object(Je.a)(r);function r(){return Object(Ae.a)(this,r),n.apply(this,arguments)}return Object(De.a)(r,[{key:"render",value:function(){return v.createElement(pn,this.props,v.createElement(e,this.props))}}]),r}(v.Component)},gn=n(13),fn=Object(gn.c)(hn,Object(w.b)((function(e,t){return{adventurer:e.adventurers.find((function(e){return e.id===t.adventurerId})),warehouse:e.stockpile}}),ln))(rn),vn=function(e){var t=v.useState([]),n=Object(x.a)(t,2),r=n[0],a=n[1],o=v.useState(null),i=Object(x.a)(o,2),s=i[0],u=i[1],l=v.useContext(Ea),m=se(M.tavern),d=e.level||0,p=m.levels[d],h=Me.getStructureName(M.tavern),g=p.rooms,f=e.quests.filter((function(e){return e.status===Qt.available})),b=function(t){return Object.values(e.quests).find((function(e){return e.party.indexOf(t)>-1}))},y=function(e){var t=v.createElement(fn,{adventurerId:e.id,title:e.name});l.onOpenWindow(t)};return v.createElement("details",{open:!0,className:"tavernstructureview"},v.createElement("summary",null,h),function(){var t=e.gold,n=m.levels[d+1],r=null!=n?n.cost.gold||0:-1,a=null!=n&&t>=r,o="Upgrade! (".concat(r<0?"max":r+" gold",")");return v.createElement("div",null,v.createElement("label",null,"level:"),d+1+" / "+m.levels.length,v.createElement("button",{style:{float:"right"},onClick:function(t){e.onUpgrade&&e.onUpgrade(r,d+1)},disabled:!a},o))}(),v.createElement("section",null,function(){for(var t=[],n=function(n){var a=e.adventurers.find((function(e){return e.room===n})),o=null;if(a){var c=a.name,i=r.indexOf(a)>-1,s=b(a.id);s&&(c+=" (on a quest)"),o=[v.createElement(Wt,{disabled:i||null!=s,adventurer:a,className:"adventurer-icon",sourceId:"tavern",key:"avatar:".concat(a.id)}),v.createElement("a",{key:a.id,onClick:function(){return y(a)}}," ",c)]}else o="(empty room)";t.push(v.createElement("div",{key:"room".concat(n),className:"room"},o))},a=0;a<g;a++)n(a);return v.createElement("div",{className:"rooms"},v.createElement("h2",null,"Rooms"),t)}(),v.createElement(Vt,{availableQuests:f,selectedQuestName:s,assignedAventurers:r,onQuestClick:function(e){return function(e){u(s===e?null:e),a([])}(e)},onAddAdventurer:function(e,t){return function(e,t){if("tavern"===e.sourceId){var n=Object(c.a)(r);n[t]=e.adventurer,a(n)}}(e,t)},onRemoveAdventurer:function(e){return function(e){var t=Object(c.a)(r);delete t[e],a(t)}(e)},onLaunchQuest:function(){e.onLaunchQuest(s,r)}})))};var bn=Object(w.b)((function(e,t){var n=e.structures[M.tavern];return{adventurers:e.adventurers,gold:e.gold,level:n.level,quests:e.quests}}),(function(e,t){return{onLaunchQuest:function(t,n){e(function(e,t){return{type:jt.launchQuest,questName:e,assignedAventurers:t}}(t,n))},onUpgrade:function(t,n){e(pt(t)),e(bt(M.tavern)),n++,e(E("log-town-upgrade-structure-complete",{level:n,structure:M.tavern},p.town))}}}))(vn),yn=function(e){var t=e.sufficientResources,n=e.resources,r=e.deltaResources,a=(e.className||"")+" resourcesbox",o=Object.keys(n).map((function(n){var a="resource";t&&!t[n]&&(a+=" insufficient");var o,c=Qe[n],i=e.resources[n];if(!c)throw new Error("No resource description found for ".concat(n));r[n]&&(o=v.createElement("span",{className:"animate-up"},"+ ".concat(r[n].toFixed(2))));var s=wn(n);return v.createElement("li",{className:a,key:n},v.createElement("div",{className:"icon common-icon-smallest",style:{backgroundImage:"url(".concat("/gilles-game").concat(c.iconImg,")")}}),v.createElement("div",{className:"name"},Me.getResourceName(n)),v.createElement("div",{className:"amount"},i.toFixed(1)),v.createElement("div",{className:"max"}," / ".concat(e.maxResources[n])),v.createElement("div",{className:"delta"},o),v.createElement("div",{className:"structure"},"source: ",Me.getStructureName(s)))}));return v.createElement("ul",{className:a},o)},wn=function(e){switch(e){case We.fabric:return M.weaver;case We.food:return M.garden;case We.iron:return M.mine;case We.leather:return M.tannery;case We.stone:return M.quarry;case We.wood:return M.lumberMill}throw new Error("Unknown structure for resource ".concat(e))},En=(n(101),function(e){var t=(e.active?"active":"")+(e.className||"");return v.createElement("li",{className:"tabstrip-tab ".concat(t),onClick:function(t){e.onClick&&e.onClick(t)}},e.children)}),kn=function(e){var t=null;e.children&&e.children.length&&(t=e.children[0].props.id);var n=Object(v.useState)(t),r=Object(x.a)(n,2),a=r[0],o=r[1],c=e.className||"",i=b.a.Children.map(e.children,(function(e){return b.a.cloneElement(e,{active:e.props.id===a,onClick:function(){s(e.props.id)}})})),s=function(t){o(t),e.onTabSelected&&e.onTabSelected(t)};return b.a.createElement("ul",{className:"tabstrip ".concat(c),onClick:function(t){e.onClick&&e.onClick(t)}},i)},On=function(e){var t=Object(v.useRef)();return Object(v.useEffect)((function(){t.current=e})),t.current},Tn={fabric:0,food:0,iron:60,leather:0,stone:0,wood:40},jn={fabric:0,food:0,iron:0,leather:0,stone:0,wood:0},In=(n(217),Ct.warehouse),xn=function(e){var t=Object(v.useState)(),n=Object(x.a)(t,2),r=n[0],a=n[1],o=Object(v.useState)(jn),c=Object(x.a)(o,2),i=c[0],s=c[1],u=On(e.resources),l=Object(v.useRef)(null);Object(v.useEffect)((function(){var t=Object.keys(e.resources).reduce((function(t,n){return u&&u[n]&&(t[n]=e.resources[n]-u[n]),t}),{});s(t)}),[e.resources,u]),Object(v.useEffect)((function(){if(l.current){var e=l.current;e.classList.remove("animate"),setTimeout((function(){l&&e.classList.add("animate")}),200)}}),[i]);var m=se(M.warehouse);if(!m)throw new Error("No definition found for structure ".concat(M.warehouse," with type StructureDefinition."));var d=e.level,p=Me.getStructureName(M.warehouse);return v.createElement("details",{open:!0,className:"warehouse-structureview"},v.createElement("summary",null,p),function(){var t=e.gold,n=m.levels[d+1],r=null!=n?n.cost.gold||0:-1,a=null!=n&&t>=r,o="Upgrade! (".concat(r<0?"max":r+" gold",")");return v.createElement("div",null,v.createElement("label",null,"level:"),d+1+" / "+m.levels.length,v.createElement("button",{style:{float:"right"},onClick:function(t){e.onUpgrade&&e.onUpgrade(r,d+1)},disabled:!a},o))}(),v.createElement("fieldset",{className:"resources",ref:l},v.createElement("legend",null,"Resources"),v.createElement(yn,{resources:e.resources,structures:e.structures,maxResources:e.maxResources,deltaResources:i})),v.createElement("h3",null,"Stockpile"),v.createElement(nn,{sourceType:In,items:e.items,onDropItem:function(t,n,r,a,o){switch(a){case In:e.onMoveItemInWarehouse&&e.onMoveItemInWarehouse(n,r);break;case Ct.adventurerInventory:if(e.onMoveItemFromAdventurer){var c=e.items[r];e.onMoveItemFromAdventurer(o,t,n,r,c)}}}}),v.createElement("h3",null,"Adventurers"),v.createElement("div",null,v.createElement(kn,{className:"adventurers-tabstrip",onTabSelected:function(e){a(e)}},e.adventurersInTown.map((function(e){return t=e,v.createElement(En,{id:t.id,key:t.id},v.createElement(Dt,{adventurer:t,className:"common-icon-small"}));var t}))),v.createElement("div",{className:"adventurer-inventory"},r?v.createElement(mn,{adventurerId:r}):null)))},Nn=function(e,t){return t.party.map((function(t){return Sn(e,t)}))},Cn=function(e,t){var n=t.party[0];return Sn(e,n)},Sn=function(e,t){return e.find((function(e){return e.id===t}))},qn=function(e){return!!e.rngState},An=function(e){return e.adventurers},Dn=function(e){return e.quests},Rn=(Object(Ot.a)([An,Dn],(function(e,t){var n=[],r=Object.values(t).reduce((function(t,r){var a=Nn(e,r);return r.status===Qt.active&&(t[r.name]=a),n.push.apply(n,Object(c.a)(a)),t}),{});return r.solo=e.filter((function(e){return-1===n.indexOf(e)})),r})),Object(Ot.a)([An,Dn],(function(e,t){var n=t.reduce((function(e,t){return t.status===Qt.active&&e.push.apply(e,Object(c.a)(t.party)),e}),[]);return e.filter((function(e){return-1===n.indexOf(e.id)}))})));var Mn,_n=Object(w.b)((function(e,t){var n=e.structures[M.warehouse],r=se(M.warehouse),a=n.level,o=r.levels[a],c=Rn(e);if(!n)throw new Error("No structure '".concat(M.warehouse,"' found in the store!"));return{adventurersInTown:c,gold:e.gold,items:e.stockpile,level:a,maxResources:o.maxResources,resources:e.resources,structures:e.structures,workers:n.workers,workersFree:Tt(e)}}),(function(e,t){return{onMoveItemFromAdventurer:function(t,n,r,a,o){var c=cn(t,r);e(c);var i=ht(n,a);if(e(i),o){var s=on(t,o,r);e(s)}},onMoveItemInWarehouse:function(t,n){e(function(e,t){return{type:ot.moveItemInWarehouse,fromSlot:e,toSlot:t}}(t,n))},onMoveItemInInventory:function(t,n,r){var a=an(t,n,r);e(a)},onMoveItemToAdventurer:function(t,n,r,a){var o=gt(r);e(o);var c=on(t,n,a);e(c)},onUpgrade:function(t,n){e(pt(t)),e(bt(M.warehouse)),n++,e(E("log-town-upgrade-structure-complete",{level:n,structure:M.warehouse},p.town))}}}))(xn);!function(e){e[e.NotBuilt=0]="NotBuilt",e[e.Building=1]="Building",e[e.Built=2]="Built"}(Mn||(Mn={}));var Wn={level:0,state:Mn.NotBuilt,workers:0},Hn=(n(218),function(e){var t=Object(w.d)((function(e){return e.gold})),n=Object(w.d)((function(t){var n=t.structures[e.type];if(!n)throw new Error("No structure '".concat(e.type,"' found in the store!"));return n.level})),r=Object(w.d)((function(t){var n=t.structures[e.type];if(!n)throw new Error("No structure '".concat(e.type,"' found in the store!"));return n.workers})),a=Object(w.d)((function(e){return Tt(e)})),o=se(e.type);if(!o)throw new Error("No definition found for structure ".concat(e.type," with type ResourceStructureDefinition."));var c=Object(w.c)(),i=function(){c(wt(e.type))},s=function(){c(yt(e.type))},u=o.levels[n];return v.createElement(v.Fragment,null,v.createElement(lt,{structure:e.type}),v.createElement("details",{open:!0,className:"structureview"},v.createElement("section",null,function(){var e=r===u.workerCapacity||(a||0)<1,t=0===r;return v.createElement(ut,{label:"workers:",value:r,max:u.workerCapacity,upDisabled:e,downDisabled:t,onDown:i,onUp:s})}(),function(){var r=o.levels[n+1],a=null!=r?r.cost.gold||0:-1,i=null!=r&&t>=a,s="Upgrade! (".concat(a<0?"max":a+" gold",")");return v.createElement("div",null,v.createElement("label",null,"level:"),n+1+" / "+o.levels.length,v.createElement("button",{style:{float:"right"},onClick:function(t){!function(t,n){c(pt(t)),c(bt(e.type)),n++,c(E("log-town-upgrade-structure-complete",{level:n,structure:e.type},p.town))}(a,n+1)},disabled:!i},s))}(),function(){var e=u.generates,t=Object.keys(e).reduce((function(t,n){return e[n]&&t.push("".concat(e[n]," x ").concat(r," = ").concat(e[n]*(r||0)," ").concat(n)),t}),[]).join(",");return v.createElement("div",null,"Generates (every minute): ",v.createElement("br",null),t)}())))}),Fn=function(e){return v.createElement("div",{className:"structure-details"},function(){if(e.structures[e.structure].state===Mn.Building){var t=e.buildTask?e.buildTask.progress:1;return v.createElement("div",null,v.createElement(rt,{label:"Building...",progress:t}))}switch(se(e.structure).type){case A.production:return v.createElement(It,{type:e.structure});case A.resource:return v.createElement(Hn,{type:e.structure});case A.warehouse:return v.createElement(_n,null);case A.tavern:return v.createElement(bn,null);default:return v.createElement("div",null," ",e.structure," ")}}())};var Ln,Pn,Bn,Un=Object(gn.c)(Object(w.b)((function(e,t){return{buildTask:e.tasks.running.filter((function(e){return"town"===e.origin&&e.name==="".concat(t.structure,".build")}))[0],structures:e.structures}})),hn)(Fn),Gn=["sound/fx/button-click.ogg","sound/fx/error.ogg","sound/music/Soliloquy.mp3","sound/music/TheLoomingBattle.ogg"],Qn=n(252),Vn=n(120),zn=n(60),Xn=n(34);!function(e){e[e.town=0]="town",e[e.world=1]="world"}(Ln||(Ln={})),function(e){e[e.buttonClick=0]="buttonClick",e[e.error=1]="error"}(Pn||(Pn={}));var Kn,Jn={},Yn=null,Zn={},$n=function(){function e(){Object(Ae.a)(this,e)}return Object(De.a)(e,null,[{key:"loadMedia",value:function(e){Bn=e}},{key:"addSounds",value:function(e){Object.entries(e).forEach((function(e){var t=Object(x.a)(e,2),n=t[0],r=t[1];Zn[n]=Bn.find((function(e){return e.url===r})).content}))}},{key:"playSound",value:function(e){Zn[e].play()}},{key:"addMusicTrack",value:function(e,t){if(Bn){var n=Bn.find((function(e){return e.url===t}));if(!n)throw new Error("No sound found at ".concat(t));Jn.hasOwnProperty(e)||(Jn[e]=n.content)}}},{key:"playMusicTrack",value:function(e){if(Bn){if(null!==Yn)Jn[Yn].fade(1,0,500);var t=Jn[e];t.playing()||(t.loop(!0),t.play()),t.fade(0,1,500),Yn=e}}}]),e}(),er=(n(219),n(110)),tr=function(e){var t=e.itemsLoaded,n=e.itemsTotal;return v.createElement("div",null," ","Loading (".concat(Math.floor((t||0)/(n||0)*100),")%")," ")};!function(e){e[e.image=0]="image",e[e.sound=1]="sound"}(Kn||(Kn={}));var nr,rr=[],ar=function(e){var t=new Image;return t.src=e,new Promise((function(e,n){function r(){t.naturalWidth?e(t):n(null),t.removeEventListener("load",r),t.removeEventListener("error",r)}t.naturalWidth?e(t):t.complete?n(null):(t.addEventListener("load",r),t.addEventListener("error",r))}))},or=function(e){if((e=e.toLowerCase()).endsWith("png")||e.endsWith("jpg")||e.endsWith("gif"))return Kn.image;if(e.endsWith("mp3")||e.endsWith("ogg")||e.endsWith("wav"))return Kn.sound;throw Error("Could not determine type for ".concat(e))},cr=function(e){var t=Object(v.useState)(!1),n=Object(x.a)(t,2),r=n[0],a=n[1],o=Object(v.useState)(0),c=Object(x.a)(o,2),i=c[0],l=c[1];Object(v.useEffect)((function(){h()}),[]);var m=e.children,d=e.manifest,p=v.createElement(tr,{itemsLoaded:i,itemsTotal:d.length}),h=function(){l(0);var t=e.manifest.map((function(e){return g(e).catch((function(e){return console.error(e)}))}));Promise.all(t).then((function(t){e.onLoadComplete&&e.onLoadComplete(rr),a(!0)}))},g=function(){var e=Object(u.a)(s.a.mark((function e(t){var n,r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(rr.some((function(e){return e.url===t}))&&console.warn("Loading media with url ".concat(t," more than once! Will overwrite.")),(n=or(t))!==Kn.image){e.next=7;break}return e.next=5,ar(t);case 5:a=e.sent,r={content:a,mediaType:n,url:t};case 7:if(n===Kn.sound&&(o=new er.Howl({src:[t]}),r={content:o,mediaType:n,url:t}),!r){e.next=14;break}return rr.push(r),l(i+1),e.abrupt("return",r);case 14:throw new Error("Unknown error while trying to load ".concat(t));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r?m:p},ir=n(7),sr=n(112),ur=b.a.forwardRef((function(e,t){var n=Object(ir.useApp)();if(n){var r="url('".concat("/gilles-game","/img/cursors/dwarven_gauntlet_extra_6.png'), auto");n.renderer.plugins.interaction.cursorStyles.pointer=r}return b.a.createElement(lr,Object.assign({app:n},e,{ref:t}))})),lr=Object(ir.PixiComponent)("Viewport",{create:function(e){var t=new sr.a({screenWidth:e.screenWidth,screenHeight:e.screenHeight,worldWidth:e.worldWidth,worldHeight:e.worldHeight,ticker:e.app.ticker,interaction:e.app.renderer.plugins.interaction});return t.on("clicked",(function(t){e.onClick&&e.onClick(t)})),t.drag().pinch().wheel().clamp({direction:"all"}).clampZoom({minScale:1,maxScale:2}).decelerate(),t}}),mr=ur,dr=(n(229),n(2)),pr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";Object(Ae.a)(this,e),this.shapes=void 0,this.shapes=t[n].map((function(e){var t=e.shape;return new dr.Polygon(t)}))}return Object(De.a)(e,[{key:"contains",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(!this.shapes||0===this.shapes.length)&&this.shapes.some((function(n){return n.contains(e,t)}))}}]),e}(),hr=n(113),gr=n(57),fr=function(e){var t=M.lumberMill,n="/img/town/town-alpha/".concat(t,".json"),r=new pr(gr,t),a=Object(v.useState)(),o=Object(x.a)(a,2),c=o[0],i=o[1],s=Object(ir.useApp)();Object(v.useEffect)((function(){var e;s.loader.resources[n]?i(null===(e=s.loader.resources[n])||void 0===e?void 0:e.textures):s.loader.add(n).load((function(e,t){var r;i(null===(r=t[n])||void 0===r?void 0:r.textures)}))}),[s,s.loader,n]);var u=Object(v.useState)(0),l=Object(x.a)(u,2),m=l[0],d=l[1];return Object(ir.useTick)((function(e){return d((function(t){return t+.01*e}))})),c?b.a.createElement(ir.Sprite,{name:t,x:403,y:320,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(t)},hitArea:r,texture:c["structure.png"]},b.a.createElement(ir.Sprite,{name:"blades",texture:c["blades.png"],anchor:new dr.Point(.5,.5),x:15,y:10,rotation:m})):null},vr=n(114),br=n(121),yr=n(115),wr=Object(ir.PixiComponent)("ParticleEmitter",{create:function(){return new dr.ParticleContainer},applyProps:function(e,t,n){var r=n.image,a=n.config,o=Object(br.a)(n,["image","config"]);Object(ir.applyDefaultProps)(e,t,o);var c=this._emitter;if(!c){c=new yr.a(e,[dr.Texture.from(r)],a);var i=performance.now();c.emit=!0,function e(){c.raf=requestAnimationFrame(e);var t=performance.now();c.update(3e-4*(t-i)),i=t}()}this._emitter=c},willUnmount:function(){this._emitter&&(this._emitter.emit=!1,cancelAnimationFrame(this._emitter.raf))}}),Er=function(e){var t=M.tavern,n=new pr(gr,t);return b.a.createElement(ir.Sprite,{name:t,x:500,y:469,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(t)},hitArea:n,image:"/img/town/town-alpha/".concat(t,".png")},b.a.createElement(wr,{name:"smoke",x:107,y:-2,image:"/img/town/effects/smokeparticle.png",config:vr}))},kr=function(e){b.a.useEffect((function(){$n.addMusicTrack(Ln.town,"sound/music/Soliloquy.mp3"),$n.playMusicTrack(Ln.town)}),[]);var t=function(t){!r.current&&e.onStructureClick&&e.onStructureClick(t)},n=Object(w.d)((function(e){return e.structures})),r=Object(v.useRef)(!1),a=Object(v.useRef)(null);Object(v.useEffect)((function(){if(a.current){var e=a.current;e.on("drag-start",(function(){r.current=!0})),e.on("drag-end",(function(){r.current=!1}))}var t=function(e){e.preventDefault()};return window.addEventListener("wheel",t,{passive:!1}),function(){window.removeEventListener("wheel",t)}}),[]);return b.a.createElement("div",{className:"town-view"},b.a.createElement(ir.Stage,{width:wa,height:1079,options:{sharedLoader:!0}},b.a.createElement(mr,{screenWidth:wa,screenHeight:1079,worldWidth:1024,worldHeight:1600,ref:a},b.a.createElement(ir.Sprite,{name:"background",image:"".concat("/gilles-game","/img/town/town-alpha/background.png")},[M.workshop,M.quarry,M.tavern,M.tannery,M.alchemist,M.garden,M.weaponsmith,M.armoursmith,M.warehouse,M.mine,M.lumberMill,M.weaver].reverse().map((function(e){var r,a;if(n[e].state===Mn.NotBuilt)return null;switch(e){case M.workshop:r=373,a=610;break;case M.quarry:r=632,a=633;break;case M.tannery:r=372,a=460;break;case M.alchemist:r=411,a=371;break;case M.garden:r=822,a=689;break;case M.weaponsmith:r=449,a=460;break;case M.armoursmith:r=473,a=442;break;case M.warehouse:r=471,a=130;break;case M.mine:r=183,a=527;break;case M.weaver:r=484,a=333}switch(e){case M.lumberMill:return b.a.createElement(fr,{onStructureClick:t,key:e});case M.tavern:return b.a.createElement(Er,{onStructureClick:t,key:e});default:var o=new pr(hr,e);return b.a.createElement(ir.Sprite,{key:e,name:e,x:r,y:a,interactive:!0,buttonMode:!0,pointertap:function(){t(e)},hitArea:o,image:"".concat("/gilles-game","/img/town/town-alpha/").concat(e,".png")})}}))))))};n(230);!function(e){e[e.questEncounter=0]="questEncounter",e[e.questCompleted=1]="questCompleted",e[e.achievementUnlocked=2]="achievementUnlocked",e[e.cheat=3]="cheat"}(nr||(nr={}));var Or=function(e){var t=e.title,n=e.type,r=void 0===n?nr.achievementUnlocked:n,a=e.icon,o=void 0===a?"/img/items/quest-items/dragon-eye.png":a,c=Me.get("ui-toast-type-".concat(nr[r]));return b.a.createElement("div",{className:"toast"},b.a.createElement("div",{className:"label type"},c),b.a.createElement("div",{className:"label title app-h2-white"},t),b.a.createElement("div",{className:"icon"},b.a.createElement("div",{className:"background"}),b.a.createElement("img",{className:"image",width:"300",alt:"dragon eye",src:"".concat("/gilles-game").concat(o)}),b.a.createElement("div",{className:"foreground"})),b.a.createElement("div",{className:"banner"}))},Tr=function(e){Object(Ye.a)(n,e);var t=Object(Je.a)(n);function n(){return Object(Ae.a)(this,n),t.apply(this,arguments)}return Object(De.a)(n,null,[{key:"addToast",value:function(e,t,n){var r=this;this.stack=[].concat(Object(c.a)(this.stack),[{time:Object(W.now)(),title:e,type:t,icon:n}]),this.emit(this.EVENT_TOASTS_UPDATED,this.stack),setTimeout((function(){r.stack=r.stack.filter((function(e){return Object(W.now)()-e.time<r.lifeTime})),r.emit(r.EVENT_TOASTS_UPDATED,r.stack)}),this.lifeTime)}}]),n}(et());Tr.stack=[],Tr.lifeTime=5e3,Tr.EVENT_TOASTS_UPDATED="toast";var jr,Ir=function(){var e=Object(v.useState)([]),t=Object(x.a)(e,2),n=t[0],r=t[1],a=function(e){r(e)};return Object(v.useEffect)((function(){return Tr.addEventListener(Tr.EVENT_TOASTS_UPDATED,a),function(){Tr.removeEventListener(Tr.EVENT_TOASTS_UPDATED,a)}}),[]),b.a.createElement("div",{className:"toasts"},n.map((function(e){return b.a.createElement(Or,Object.assign({key:e.time},e))})))};!function(e){e.addWorkers="addWorkers"}(jr||(jr={}));n(104);var xr=function(e){var t=Object(v.useRef)(null),n=Object(v.useState)({gold:50,resources:50,workers:10}),r=Object(x.a)(n,2),a=r[0],o=r[1],c=Object.keys(e.structures).map((function(t){return function(t){var n=se(t),r=e.structures[t],a=n.levels[r.level],o=Me.get(a.displayName);return v.createElement("div",{className:"label-dropdown",key:t},v.createElement("label",{title:t},"".concat(o)),v.createElement("input",{key:t,type:"checkbox",checked:e.structures[t].state===Mn.Built,onChange:function(){return u(t,e.structures[t].state!==Mn.Built)}}))}(t)})),i=function(e){return v.createElement("option",{value:e,key:e},Me.getItemName(e))},s=Object.keys(k).filter((function(e){return!isNaN(e)})).map((function(e){return v.createElement("optgroup",{label:k[e],key:e},function(e){return Object.keys(O).filter((function(t){return qe(t).itemType==e})).map((function(e){return i(e)}))}(e))})),u=function(t,n){e.onCheatStructureState&&e.onCheatStructureState(t,n?Mn.Built:Mn.NotBuilt),n?Tr.addToast("The ".concat(Me.getStructureName(t)," is constructed"),nr.cheat):Tr.addToast("The ".concat(Me.getStructureName(t)," is not constructed"),nr.cheat)};return v.createElement("div",{className:"cheat-box"},v.createElement("div",{className:"label-numberbox-button"},v.createElement("label",null,"Gold"),v.createElement("input",{type:"number",value:a.gold,style:{width:"50px"},onChange:function(e){var t=Number(e.target.value);o(Object(N.a)({},a,{gold:t}))}}),v.createElement("button",{onClick:function(t){var n=a.gold;e.onCheatGold&&e.onCheatGold(n);var r=Me.get("common-cheat-gold-added",{amount:n});Tr.addToast(r,nr.cheat,"/img/resources/gold.png")}},"Add")),v.createElement("div",{className:"label-numberbox-button"},v.createElement("label",null,"Workers"),v.createElement("input",{type:"number",value:a.workers,style:{width:"50px"},onChange:function(e){var t=Number(e.target.value);o(Object(N.a)({},a,{workers:t}))}}),v.createElement("button",{onClick:function(t){var n=a.workers;e.onCheatWorkers&&e.onCheatWorkers(n);var r=Me.get("common-cheat-workers-added",{amount:n});Tr.addToast(r,nr.cheat,"/img/resources/worker.png")}},"Add")),v.createElement("div",{className:"label-numberbox-button"},v.createElement("label",null,"Resources"),v.createElement("input",{type:"number",value:a.resources,style:{width:"50px"},onChange:function(e){var t=Number(e.target.value);o(Object(N.a)({},a,{resources:t}))}}),v.createElement("button",{onClick:function(t){e.onCheatResources&&e.onCheatResources(a.resources);var n=Me.get("common-cheat-resources-added",{amount:a.resources});Tr.addToast(n,nr.cheat)}},"Add")),v.createElement("div",{className:"label-numberbox-button"},v.createElement("label",null,"Items"),v.createElement("select",{style:{width:"150px"},ref:t},s),v.createElement("button",{onClick:function(n){var r=t.current.value;e.onCheatItem&&e.onCheatItem(r);var a=Me.get("common-cheat-item-added",{item:r}),o=qe(r).iconImg;Tr.addToast(a,nr.cheat,o)}},"Add")),c)},Nr=[We.food,We.wood,We.stone,We.fabric,We.leather],Cr=Object(gn.c)(Object(w.b)((function(e){return{structures:e.structures}}),(function(e){return{onCheatGold:function(t){e(dt(t)),e(E("common-cheat-gold-added",{amount:t},p.common))},onCheatItem:function(t){e(ht(t)),e(E("common-cheat-item-added",{item:t},p.common))},onCheatResources:function(t){var n=Nr.reduce((function(e,n){return e[n]=t,e}),{});e(ft(n)),e(E("common-cheat-resources-added",{amount:t},p.common))},onCheatStructureState:function(t,n){return e(function(e,t){return{type:it.setStructureState,structure:e,state:t}}(t,n))},onCheatWorkers:function(t){var n;e((n=t,{type:jr.addWorkers,value:n})),e(E("common-cheat-workers-added",{amount:t},p.common))}}})),hn)(xr),Sr=Object(gn.c)(hn,(function(e){return function(t){Object(Ye.a)(r,t);var n=Object(Je.a)(r);function r(){return Object(Ae.a)(this,r),n.apply(this,arguments)}return Object(De.a)(r,[{key:"render",value:function(){var t=this;return v.createElement(Ea.Consumer,null,(function(n){return v.createElement(e,Object.assign({},t.props,n))}))}}]),r}(v.Component)}))((function(e){return v.createElement("div",{className:"menu"},v.createElement("p",null,v.createElement("button",{onClick:function(){var t=v.createElement(Cr,{title:"Cheats"});e.onOpenWindow(t)}},"Cheats!")))})),qr=(n(231),n(232),function(){var e=Object(w.d)((function(e){return{gold:e.gold,resources:e.resources,workers:e.workers,workersFree:Tt(e)}})),t=function(e,t,n){return v.createElement("li",{title:n,key:n},v.createElement("div",{className:"icon common-icon-smallest",style:{backgroundImage:"url(".concat("/gilles-game").concat(e,")")}}),v.createElement("div",{className:"amount"},function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=["","k","M","G","T","P","E"],r=Math.log10(e)/3|0;if(0===r)return"0";var a=n[r],o=Math.pow(10,3*r),c=e/o;return c.toFixed(t)+a}(t)))},n=Nr.map((function(n){return t(Qe[n].iconImg,e.resources[n],Me.getResourceName(n))}));return n.push(t("/img/resources/worker.png",e.workersFree,"workers"),t("/img/resources/gold.png",e.gold,"gold")),v.createElement("ul",{className:"resourcebar"},n)}),Ar=function(){var e=Object(v.useContext)(Ea);return v.createElement("div",{className:"topbar"},v.createElement("div",{className:"topbar-left"},v.createElement(qr,null)),v.createElement("div",{className:"topbar-right"},v.createElement("div",{className:"hamburger",onClick:function(t){var n=v.createElement(Sr,{title:"Menu"});e.onOpenWindow(n)}},"\u2630")))},Dr=function(e,t,n){return e+n*(t-e)},Rr=Object(ir.PixiComponent)("Rectangle",{create:function(e){return new dr.Graphics},applyProps:function(e,t,n){var r=n.width,a=n.height,o=n.gridWidth;e.clear(),e.lineStyle(1,11382189,.5);for(var c=0;c<a;c++)e.moveTo(0,c*o),e.lineTo(r,c*o);for(var i=0;i<r;i++)e.moveTo(i*o,0),e.lineTo(i*o,a);e.endFill(),Object.assign(e,{gridWidth:o,worldWidth:r,worldHeight:a})},didMount:function(e,t){var n=new dr.Graphics;n.beginFill(5374972),n.drawCircle(0,0,3),n.endFill(),n.x=-999,e.addChild(n);var r=e,a=r.gridWidth,o=r.worldWidth,c=r.worldHeight;t.addListener("clicked",(function(e){var t=Math.round(e.world.x/a)*a,r=Math.round(e.world.y/a)*a;n.x=t,n.y=r;var o=i(t,r);console.log("Node [".concat(o.x,", ").concat(o.y,"]"))}));var i=function(e,t){return{x:(e-Math.floor(o/2))/a,y:(t-Math.floor(c/2))/a}}}}),Mr=function(e){var t=e.quest,n=e.leader,r=e.encounterActive,a=e.position,o=e.onClick,c=e.selected?"/img/world/map-marker-selected.png":"/img/world/map-marker.png",i=Object(v.useRef)(null);return Object(v.useEffect)((function(){var e=i.current,t=new dr.Graphics;t.beginFill(12245589),t.drawCircle(0,0,256),t.endFill(),e.mask=t,e.addChild(t)}),[i]),b.a.createElement(ir.Sprite,{image:"".concat("/gilles-game").concat(c),name:t.name,x:a.x,y:a.y,interactive:!0,buttonMode:!0,scale:new dr.Point(.1,.1),anchor:new dr.Point(.5,1),pointerdown:function(){o&&o(t)}},n&&b.a.createElement(ir.Sprite,{image:"".concat("/gilles-game").concat(n.avatarImg),name:"avatar",anchor:new dr.Point(.5,.5),x:0,y:-396,scale:new dr.Point(.66,.66),ref:i}),r&&b.a.createElement(ir.Sprite,{image:"/img/world/quest-alert.png",name:"quest-alert",anchor:new dr.Point(.5,1),x:180,y:-396,scale:new dr.Point(2,2)}))},_r=function(e){var t=e.positions;return e.positions.length>2?b.a.createElement(ir.Graphics,{name:"questline",x:0,y:0,draw:function(e){e.lineStyle(3,16724736),e.moveTo(t[0].x,t[0].y);var n=0;for(n=1;n<t.length-2;n++){var r=(t[n].x+t[n+1].x)/2,a=(t[n].y+t[n+1].y)/2;e.quadraticCurveTo(t[n].x,t[n].y,r,a)}e.quadraticCurveTo(t[n].x,t[n].y,t[n+1].x,t[n+1].y),e.endFill()}}):null},Wr=function(e){return e.log},Hr=Object(Ot.a)([function(e){return e.quests}],(function(e){return e.filter((function(e){return e.status===Qt.active})).map((function(e){return e}))}));var Fr,Lr=function(e){var t=e.retrieveWorldViewRef,n=e.smallMap,r=Object(v.useCallback)((function(t){return t.quests.find((function(t){return t.name===e.selectedQuestName}))}),[e.selectedQuestName]),a=Object(w.d)(r),o=Object(w.d)((function(e){return e.adventurers})),c=Object(w.d)((function(e){return Hr(e)})),i=Object(v.useState)(wa),s=Object(x.a)(i,2),u=s[0],l=s[1],m=Object(v.useState)(1024),d=Object(x.a)(m,2),p=d[0],h=d[1];Object(v.useEffect)((function(){var e=function(){var e,r,a=t(),o=(null===(e=a.current)||void 0===e?void 0:e.clientWidth)||wa,c=(null===(r=a.current)||void 0===r?void 0:r.clientHeight)||1024;l(o),h(n?o<576?64:128:c)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[t,n]),Object(v.useEffect)((function(){a&&f(a)}),[a,p]);var g=Object(v.useRef)(null);Object(v.useEffect)((function(){if(g.current){var e=g.current,t=Br({x:0,y:0});e.moveCenter(t.x,t.y)}}),[u]);var f=function(e){var t=g.current;if(t){var n=Pr(e),r=Br(n);t.moveCenter(r.x,r.y)}};return b.a.createElement(ir.Stage,{width:u,height:p},b.a.createElement(mr,{screenWidth:u,screenHeight:p,worldWidth:1500,worldHeight:1061,ref:g},b.a.createElement(ir.Sprite,{image:"".concat("/gilles-game","/img/world/francesca-baerald-fbaerald-angeloumap-lowres.jpg"),interactive:!0,pointerdown:function(){}},c.map((function(e){var t=Ur(e);return b.a.createElement(_r,{positions:t,key:e.name})})),c.map((function(t){var n=Pr(t),r=Br(n),c=Cn(o,t),i=Lt(t.name),s=Math.floor(t.progress),u=i.nodes[s];return b.a.createElement(Mr,{quest:t,leader:c,position:r,key:t.name,selected:t===a,encounterActive:u.type===_t.encounter,onClick:function(t){return n=t.name,void e.onPartyClick(n);var n}})}))),b.a.createElement(Rr,{width:1500,height:1061,gridWidth:10})))},Pr=function(e){var t,n,r,a=Lt(e.name),o=Math.floor(e.progress),c=a.nodes[o],i=a.nodes[o+1];return i?(t=c,n=i,r=e.progress-o,{x:Dr(t.x,n.x,r),y:Dr(t.y,n.y,r)}):c},Br=function(e){var t=10*e.x+750,n=10*e.y+530.5;return new dr.Point(t,n)},Ur=function(e){for(var t=[],n=Lt(e.name),r=0;r<e.progress;r++)t.push(Br(n.nodes[r]));var a=Br(Pr(e));return t.push(a),t},Gr=(n(233),n(234),function(e){var t=e.adventurers,n=e.onAdventurerTabSelected;return b.a.createElement(kn,{className:"adventurers-tabstrip",onTabSelected:function(t){var r=e.adventurers.find((function(e){return e.id===t}));n(r)}},t.map((function(e){return t=e,b.a.createElement(En,{id:t.id,key:t.id},b.a.createElement(Dt,{adventurer:t,className:"common-icon-small"}));var t})))}),Qr=function(e){var t=e.adventurer,n=e.onDropItemEquipment,r=function(e){var r=t.equipment[zt[e]],a=null;if(r){var o=b.a.createRef();a=b.a.createElement(Xt,{index:e,sourceId:t.id,sourceType:Ct.adventurerEquipment,item:r,ref:o,size:Ge.medium})}return b.a.createElement(b.a.Fragment,null,b.a.createElement(Zt,{onDrop:function(t){return n(t,e)},type:e},a),b.a.createElement("span",{className:"info"},Me.get("ui-equipmentslot-".concat(zt[e]))))};return b.a.createElement("ul",null,b.a.createElement("li",null,r(zt.head)),b.a.createElement("li",null,r(zt.shoulders)),b.a.createElement("li",null,r(zt.chest)),b.a.createElement("li",null,r(zt.hands)),b.a.createElement("li",null,r(zt.legs)),b.a.createElement("li",null,r(zt.feet)),b.a.createElement("li",null,r(zt.mainHand)),b.a.createElement("li",null,r(zt.offHand)))},Vr=function(e){var t=e.adventurer,n=Object(w.c)();return b.a.createElement("div",{className:"adventurer-panel"},b.a.createElement("div",{className:"info"},b.a.createElement("div",{className:"name"},b.a.createElement("b",null,t.name)),b.a.createElement("div",{className:"renderAttributes"},Object.keys(t.stats).map((function(e){var n=t.stats[e];return b.a.createElement("div",{key:"".concat(t.id,"-").concat(e)}," ",b.a.createElement("b",null,e),": ",n.toFixed(1)," ")})))),b.a.createElement("div",{className:"equipment"},b.a.createElement(Qr,{adventurer:t,onDropItemEquipment:function(e,r){var a=e.item,o=[];switch(e.sourceType){case Ct.adventurerInventory:o.push(cn(t.id,e.inventorySlot),sn(t.id,r,a));var c=t.equipment[zt[r]];c&&o.push(on(t.id,c,e.inventorySlot));break;case Ct.warehouse:o.push(gt(e.inventorySlot),sn(t.id,r,a));var i=t.equipment[zt[r]];i&&o.push(ht(i,e.inventorySlot));break;case Ct.adventurerEquipment:o.push(sn(t.id,r,a));var s=t.equipment[zt[r]],u=e.inventorySlot;s?o.push(sn(t.id,u,s)):o.push(un(t.id,u))}o.forEach((function(e){return n(e)}))}})),b.a.createElement("div",{className:"right"},b.a.createElement(nn,{sourceType:Ct.adventurerInventory,sourceId:t.id,items:t.inventory,className:"inventory-medium",onDropItem:function(e,r,a,o,c){var i=[];switch(o){case Ct.adventurerInventory:i.push(an(t.id,r,a));break;case Ct.warehouse:i.push(gt(r),on(t.id,e,a));var s=t.inventory[a];s&&i.push(ht(s,r));break;case Ct.adventurerEquipment:i.push(on(t.id,e,a));var u=t.inventory[a];u?i.push(sn(t.id,r,u)):i.push(un(t.id,r))}i.forEach((function(e){return n(e)}))}})))},zr=n(116),Xr=n.n(zr);function Kr(){if(!Fr)throw new Error("Call init() before random()");return Yr=!0,Fr()}function Jr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return e=Math.ceil(e),t=Math.floor(t),Math.floor(Kr()*(t-e+1))+e}var Yr=!1,Zr=function(){function e(t,n){Object(Ae.a)(this,e),this.questName=void 0,this.store=void 0,this.questName=t,this.store=n}return Object(De.a)(e,[{key:"getAdventurerWithHighest",value:function(e){return Nn(this.store.adventurers,this.quest).concat().sort((function(t,n){return n.stats[e]-t.stats[e]}))[0]}},{key:"getAdventurerWithLowest",value:function(e){return Nn(this.store.adventurers,this.quest).concat().sort((function(t,n){return t.stats[e]-n.stats[e]}))[0]}},{key:"getRandomAdventurer",value:function(){return this.adventurers[Jr(0,this.adventurers.length)]}},{key:"questVars",get:function(){return this.quest.questVars}},{key:"quest",get:function(){var e=this;return this.store.quests.find((function(t){return t.name===e.questName}))}},{key:"adventurers",get:function(){return Nn(this.store.adventurers,this.quest)}}]),e}(),$r={},ea={name:Mt.backstabbed,getOracle:function(e,t){return new Zr(e,t)},getDescription:function(e){return{key:"encounter-backstabbed-description"}},getOptions:function(e){return{fight:"Fight the brigands",flight:"Run away!"}},answer:function(e,t,n){switch(e){case"flight":return"You run away like a pussy";case"fight":var r=t.getRandomAdventurer();return n(on(r.id,O.deedForWeaponsmith)),"The party fights off the rogues. One of them drops a document. ".concat(r.name," picks it up");default:throw new Error("Unhandled option '".concat(e))}}},ta={name:Mt.goblinHouseOutside,getOracle:function(e,t){return new Zr(e,t)},getDescription:function(e){return{key:"encounter-goblinHouseOutside-description"}},getOptions:function(e){return{investigate:"Investigate",leave:"Keep walking"}},answer:function(e,t,n){var r=t.quest;switch(e){case"investigate":return n(Nt(r.name,Mt.goblinHouseHallway)),"The party coutiously opens the door and goes inside";case"leave":return n(Nt(r.name,Mt.goblinHouseHallway)),"The party coutiously opens the door and goes inside";default:throw new Error("Unhandled option ".concat(e))}}},na={backstabbed:ea,goblinHouseHallway:{name:Mt.goblinHouseHallway,getOracle:function(e,t){return new Zr(e,t)},getDescription:function(e){return{key:"encounter-goblinHouseHallway-description"}},getOptions:function(e){return{investigate:"Go inside the house",leave:"Leave the premise"}},answer:function(e,t,n){t.store,t.questVars,t.quest;switch(e){case"walkAround":return"Your party walks around the tree";case"leave":return n(xt(t.questName)),"The party escapes the house unscathed";default:throw new Error("Unhandled option ".concat(e))}}},goblinHouseOutside:ta,theBigTree:{name:Mt.theBigTree,getOracle:function(e,t){return new Zr(e,t)},getDescription:function(e){return{key:"encounter-thebigtree-description"}},getOptions:function(e){var t=e.getAdventurerWithHighest("strength");return{walkAround:"Walk around the tree",lift:"Lift the tree (".concat(t.name,")")}},answer:function(e,t,n){var r=t.questVars,a=t.quest;switch(e){case"walkAround":return"Your party walks around the tree";case"lift":var o=t.getAdventurerWithHighest("strength");r.treeState="lifted",n(function(e,t){return{type:jt.updateQuestVars,questName:e,vars:t}}(a.name,r));var c=Jr(2,5);return n(dt(c)),"".concat(o.name," heaves and lifts the heavy tree, moving it aside. Underneath your party finds ").concat(c," gold coins");default:throw new Error("Unhandled option ".concat(e))}}}},ra=na;var aa,oa,ca=n(117),ia=n.n(ca),sa="".concat("/gilles-game","/scenes/ork-dungeon-level1.json");!function(e){e.orthagonal="orthagonal",e.isometric="isometric",e.staggered="staggered",e.hexagonal="hexagonal"}(aa||(aa={})),function(e){e.rightUp="right-up",e.rightDown="right-down",e.leftUp="left-up",e.leftDown="left-down"}(oa||(oa={}));var ua,la=function(){Object(ir.useApp)();var e=Object(v.useRef)(null),t=function(e,t){if(0===e)return{x:-1,y:-1};var n=(e-1)%t.width;return{x:n,y:Math.floor((e-n)/t.height)}};return Object(v.useEffect)((function(){(new dr.Loader).add([sa]).load((function(n){var r=n.resources[sa].data,a=ia.a.dirname(sa.replace(n.baseUrl,"")),o=r.width,c=r.height,i=function(e){if(!e.tilesets.length)throw new Error("No tilesets found! Can't continue");return e.tilesets.length>1&&console.warn("Found more than one tileset. But we currently only support one."),e.tilesets[0]}(r),s=[i.imagewidth/i.tilewidth,i.imageheight/i.tileheight],u=r.layers[1],l=[o,c],m=dr.BaseTexture.fromBuffer(function(e){var n=e.data.reduce((function(n,r,a){var o=t(r,e),c=o.x,i=o.y;return n[4*a]=c,n[4*a+1]=0,n[4*a+2]=0,n[4*a+3]=i,n}),[]);return new Uint8Array(n)}(u),o,c),d=dr.Texture.from("".concat(a,"/").concat(i.image));d.baseTexture.scaleMode=dr.SCALE_MODES.NEAREST,d.baseTexture.mipmap=dr.MIPMAP_MODES.OFF;var p=dr.Shader.from("\n            precision mediump float;\n            attribute vec2 position;\n            uniform vec4 view;\n            varying vec2 uv;\n            void main() {\n                uv = mix(view.xw, view.zy, 0.5 * (1.0 + position));\n                gl_Position = vec4(position, 1, 1);\n            }","\n            precision mediump float;\n            uniform sampler2D map, image;\n            uniform vec2 mapSize, tileSize;\n            varying vec2 uv;\n            void main() {\n                vec2 tileCoord = floor(255.0 * texture2D(map, floor(uv) / mapSize).ra);\n                gl_FragColor = texture2D(image, (tileCoord + fract(uv)) / tileSize);\n            }",{map:m,image:d,tileSize:s,mapSize:l,view:[0,0,o,c]}),h=(new dr.Geometry).addAttribute("position",[-1,-1,1,-1,-1,1,1,1,-1,1,1,-1]),g=new dr.Mesh(h,p);e.current&&e.current.addChild(g)}))}),[]),Object(ir.useTick)((function(e){})),b.a.createElement(ir.Container,{ref:e})},ma=function(e){var t=Object(v.useCallback)((function(t){return t.quests.find((function(t){return t.name===e.questName}))}),[e.questName]),n=Object(w.d)(t),r=Object(w.c)(),a=Object(w.d)((function(e){return t=e,r=n.name,Object(Ot.a)([Wr],(function(e){return e.filter((function(e){return e.channel===p.quest&&e.channelContext===r}))}))(t);var t,r})),o=Lt(n.name),c=Math.floor(n.progress),i=o.nodes[c],s=b.a.createElement("p",null),u=b.a.createElement("p",null),l=function(e,t,a){var o=e.answer(t,a,r),c=function(e,t,n){return{type:jt.updateEncounterResult,questName:e,nodeIndex:t,result:n}}(n.name,n.progress,o);r(c),r(xt(n.name))},m=Object(w.d)((function(e){return e}));switch(i.type){case _t.nothing:s=b.a.createElement("div",null," ",a&&a.map((function(e){return b.a.createElement("p",{key:e.key},Me.getTextEntry(e))}))," ");break;case _t.encounter:var d=function(e){return na[e]}(n.currentEncounter),h=d.getOracle(n.name,m),g=d.getDescription(h),f=Me.getTextEntry(g);s=b.a.createElement("div",null,b.a.createElement("p",null," ",f," "));var y=d.getOptions(h);u=b.a.createElement("ul",null,Object.keys(y).map((function(e){return b.a.createElement("li",{key:e},b.a.createElement("button",{onClick:function(){return l(d,e,h)},"data-tip":!0,"data-for":"global"},e),b.a.createElement("p",null,y[e]))})));break;case _t.boss:s=b.a.createElement("p",null," ","Boss fight!"," ")}return b.a.createElement("div",null,b.a.createElement("h1",{className:"app-h2"},Me.getQuestTitle(n.name)),b.a.createElement("div",{className:"questlog"},b.a.createElement(ir.Stage,{width:500,height:500},b.a.createElement(ir.Graphics,{name:"hitarea",draw:function(e){e.beginFill(12245589),e.drawRect(0,0,1e3,1e3),e.endFill()}}),b.a.createElement(la,null)),s,b.a.createElement("div",{className:"actions"},u)))},da=function(e){var t,n=e.horizontal,r=Object(w.d)((t=e.questName,Object(Ot.a)([An,Dn],(function(e,n){var r=n.find((function(e){return e.name===t}));return Nn(e,r)})))),a=r[0],o=Object(v.useState)(a.id),c=Object(x.a)(o,2),i=c[0],s=c[1],u=Object(v.useMemo)((function(){return r.find((function(e){return e.id===i}))}),[r,i]);return b.a.createElement("div",{className:"quest-panel ".concat(n?"quest-panel-horizontal":"quest-panel-vertical")},b.a.createElement("div",{className:"quest-area"},b.a.createElement(ma,{questName:e.questName})),b.a.createElement("div",{className:"party-area"},b.a.createElement(Gr,{adventurers:r,onAdventurerTabSelected:function(e){s(e.id)}}),b.a.createElement("div",{className:"adventurer-details"},u&&b.a.createElement(Vr,{adventurer:u}))))},pa=function(){var e=Object(v.useRef)(null),t=Object(v.useState)(),n=Object(x.a)(t,2),r=n[0],a=n[1];Object(v.useEffect)((function(){$n.addMusicTrack(Ln.world,"sound/music/TheLoomingBattle.ogg"),$n.playMusicTrack(Ln.world)}),[]);return b.a.createElement("div",{className:"world-view",ref:e},b.a.createElement(Lr,{selectedQuestName:r,smallMap:null!=r,onPartyClick:function(e){a(e===r?void 0:e)},retrieveWorldViewRef:function(){return e}}),r&&b.a.createElement(da,{questName:r}))};n(243);!function(e){e[e.all=0]="all",e[e.town=1]="town",e[e.quest=2]="quest"}(ua||(ua={}));var ha=function(e){var t=Object(v.useState)(!1),n=Object(x.a)(t,2),r=n[0],a=n[1],o=Object(v.useState)("all"),c=Object(x.a)(o,2),i=c[0],s=c[1],u=Object(w.d)((function(e){return e.log})),l=Object(w.d)((function(e){return Hr(e)})),m=[{label:Me.get("common-log-tab-all"),tabId:"all",tabType:ua.all},{label:Me.get("common-log-tab-town"),tabId:"town",tabType:ua.town}];l.forEach((function(e){var t=e.name;m.push({channelContext:t,label:Me.getQuestTitle(t),tabId:"quest-".concat(t),tabType:ua.quest})}));var d=[],h=m.find((function(e){return e.tabId===i}));switch(h.tabType){case ua.all:d=u;break;case ua.town:d=u.filter((function(e){return e.channel===p.town}));break;case ua.quest:d=u.filter((function(e){return e.channel===p.quest&&e.channelContext===h.channelContext}))}var g=m.map((function(e){return v.createElement(En,{id:e.tabId,key:e.tabId},e.label)}));return v.createElement("div",{className:"log ".concat(r?"expanded":"")},v.createElement("div",{className:"tab-bar"},v.createElement(kn,{className:"tabs",onTabSelected:function(e){return function(e){s(e)}(e)}},g),v.createElement(dn,{className:"expand-button",onClick:function(){a(!r)},text:r?"\u25bc":"\u25b2"})),v.createElement("div",{className:"log-entries"},d.map((function(e){return function(e){var t=Me.get(e.key,e.context);return v.createElement("div",{className:"entry",key:e.time},t)}(e)}))))};var ga,fa=Object(w.b)((function(e,t){return{store:e}}),(function(e,t){return{handleStartConstruction:function(t){var n=se(t);e(pt(n.cost.gold||0)),e(function(e){return{type:it.startBuildingStructure,structure:e}}(t));var r=[vt(t)],a=n.cost.time,o=Et(kt.buildStructure,"".concat(t,".build"),"town",a,r);e(o)}}}))((function(e){var t,n=e.info;switch(n.itemType){case k.deed:var r=e.store.gold,a=n,o=se(a.structure),c=o.cost.gold||0<=r,i=!(e.store.structures[a.structure].state===Mn.NotBuilt)||!c;return v.createElement("div",null,v.createElement("p",null,' " ',n.subText,' " '),v.createElement("button",{disabled:i,onClick:function(){return e.handleStartConstruction(a.structure)}},"Start construction (",o.cost.gold," gold)"));case k.weapon:var s=(t=n.item,xe[t]);return v.createElement(v.Fragment,null,v.createElement("p",null,' " ',n.subText,' " '),v.createElement("p",null," damage: ",s.damage[he.kinetic]," "));case k.apparel:var u=function(e){return D[e]}(n.item);return v.createElement(v.Fragment,null,v.createElement("p",null,' " ',n.subText,' " '),u.armourRating&&v.createElement("p",null," armour: ",u.armourRating," "));default:return v.createElement("p",null,' " ',n.subText,' " ')}}));n(244);!function(e){e[e.bottom=0]="bottom",e[e.top=1]="top",e[e.left=2]="left",e[e.right=3]="right"}(ga||(ga={}));var va,ba=function(e){var t=e.children,n=e.referenceRect,r=Object(v.useRef)(null),a=Object(v.useState)(e.placement||ga.bottom),o=Object(x.a)(a,2),c=o[0],i=o[1],s=Object(v.useState)(),u=Object(x.a)(s,2),l=u[0],m=u[1];Object(v.useEffect)((function(){var e=r.current;if(e&&l){var t=e.getBoundingClientRect();switch(c){case ga.top:if(t.top-t.height-8-8<l.top)return void i(ga.bottom);break;case ga.bottom:if(t.top+t.height+8+8>l.height)return void i(ga.top)}e.style.opacity="1";var n=e.querySelector(".tooltip-content");if(t.left<l.left+8){var a=l.left-t.left+8;n.style.transform="translateX(".concat(a,"px)")}else if(t.right>l.right-8){var o=t.right-l.right+8;n.style.transform="translateX(".concat(-o,"px)")}else n.style.transform=""}}),[i,l,c,n]);var d=function(){tt.clear()};Object(v.useEffect)((function(){var e,t;return m(null===(e=r.current)||void 0===e||null===(t=e.closest(".app"))||void 0===t?void 0:t.getBoundingClientRect()),window.addEventListener("resize",d),function(){window.removeEventListener("resize",d)}}),[]);var p=0,h=0,g="";if(l)switch(c){case ga.bottom:p=n.left-l.left+n.width/2,h=n.top-l.top+n.height,g="tooltip-bottom";break;case ga.top:p=n.left-l.left+n.width/2,h=n.top-l.top,g="tooltip-top"}return b.a.createElement("div",{className:"tooltip ".concat(g),style:{left:p,opacity:0,top:h},ref:r},b.a.createElement("div",{className:"tooltip-arrow"}),b.a.createElement("div",{className:"tooltip-content"},t))},ya=(n(245),function(e){var t=Object(v.useState)(),n=Object(x.a)(t,2),r=n[0],a=n[1],o=function(e){a(e)};if(Object(v.useEffect)((function(){return tt.addEventListener(tt.EVENT_CONTEXT_UPDATED,o),function(){tt.removeEventListener(tt.EVENT_CONTEXT_UPDATED,o)}}),[]),!r)return null;var c,i=r.info;switch(r.type){case Ue.item:default:c=b.a.createElement(fa,{info:i})}var s=Me.getItemName(i.item);return b.a.createElement(ba,{referenceRect:r.referenceRect},b.a.createElement("div",{className:"context-tooltip"},b.a.createElement("div",null,s),c))});!function(e){e[e.Town=0]="Town",e[e.World=1]="World"}(va||(va={}));var wa=960,Ea=Object(v.createContext)(null),ka=function(e){var t=Object(v.useRef)(null),n=Object(v.useState)([]),r=Object(x.a)(n,2),a=r[0],o=r[1],i=Object(v.useState)([]),s=Object(x.a)(i,2),u=s[0],l=s[1],m=function(){$n.playSound(Pn.buttonClick)},d=function(e){if(e){var t=Me.getStructureName(e);p(v.createElement(Un,{structure:e,title:t}))}},p=function(e){l([].concat(Object(c.a)(u||[]),[e]))},h=function(){l([])},g=function(){u&&u.length&&l(u.slice(0,-1))};return v.createElement(Ea.Provider,{value:{media:a,onOpenWindow:p}},v.createElement("div",{className:"app",ref:t,style:{maxWidth:wa},onClick:function(){tt.clear()}},v.createElement(Qn.a,{backend:Vn.a},v.createElement(zn.a,{basename:"/gilles-game"},v.createElement(cr,{manifest:Gn,onLoadComplete:function(e){var t,n=e.filter((function(e){return e.mediaType===Kn.sound}));$n.loadMedia(n),$n.addSounds((t={},Object(I.a)(t,Pn.buttonClick,"sound/fx/button-click.ogg"),Object(I.a)(t,Pn.error,"sound/fx/error.ogg"),t)),o(e)}},v.createElement(Ar,null),v.createElement("div",null,v.createElement(Xn.d,null,v.createElement(Xn.b,{path:"/",exact:!0},v.createElement(Xn.a,{from:"/",to:"/world"})),v.createElement(Xn.b,{path:"/world"},v.createElement(zn.b,{to:"/town"},v.createElement("button",{onClick:function(){return m()}}," ",Me.get("common-view-button-town")," "))),v.createElement(Xn.b,{path:"/town"},v.createElement(zn.b,{to:"/world"},v.createElement("button",{onClick:function(){return m()}}," ",Me.get("common-view-button-world")," "))))," | ",v.createElement("button",{"data-for":"global2","data-tip2":!0,onClick:function(){return e.persistor.purge(),void window.location.reload()},style:{color:"red"}}," Restart! ")),v.createElement(Xn.d,null,v.createElement(Xn.b,{path:"/town",component:function(){return v.createElement(kr,{onStructureClick:d})}}),v.createElement(Xn.b,{path:"/world",component:function(){return v.createElement(pa,null)}})),v.createElement(ha,null),function(){if(!u.length)return null;var e=u[u.length-1],t={onClose:h,onBack:g,backEnabled:u.length>1,closeEnabled:!0};return v.cloneElement(e,t)}(),v.createElement(ya,null),v.createElement(Ir,null))))))};var Oa=Object(w.b)((function(e,t){return{}}),(function(e,t){return{}}))(ka),Ta=(n(247),function(e){var t=se(M.warehouse),n=e.structures[M.warehouse].level;return t.levels[n].maxResources}),ja=function(e,t){var n=t.structures,r={},a=(Date.now()-e)/2e4,o=Ta(t);return a<1?null:(Object.keys(n).forEach((function(e){return function(e){var t=se(e);if(t.type===A.resource){var o=t,c=n[e].level,i=o.levels[c];Object.keys(i.generates).reduce((function(t,r){var o=i.generates[r]*n[e].workers*a;return t[r]=(t[r]||0)+o,t}),r)}}(e)})),Object.keys(r).forEach((function(e){r[e]&&t.resources[e]+r[e]>=o[e]&&(r[e]=o[e]-t.resources[e])})),r)},Ia=function(e,t){var n=[],r=[];return t.quests.forEach((function(a){if(a.status===Qt.active){var o=Ft[a.name],c=a.progress,i=Math.floor(c);if(o.nodes[i].type===_t.nothing){for(var s=e/6e4*4,u=Math.min(c+s,o.nodes.length-1),l=Math.floor(u)-i,m=a.currentEncounter,d=1;d<=l;d++){var h=o.nodes[i+d];if(h.type===_t.encounter){var g=ra[h.encounter],f=$r[a.name];u=i+d,m=h.encounter;var v=Me.getQuestTitle(a.name),b=Cn(t.adventurers,a);Tr.addToast(v,nr.questEncounter,null===b||void 0===b?void 0:b.avatarImg),n.push(Object(N.a)({channel:p.quest,channelContext:a.name},g.getDescription(f)));break}h.type===_t.nothing&&(m=null,h.log&&n.push({channel:p.quest,channelContext:a.name,key:h.log}))}r.push({currentEncounter:m,name:a.name,progress:u})}}})),{logUpdates:n,questUpdates:r}},xa=function(){return Yr?(Yr=!1,Fr.state()):null},Na=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ca(){if("serviceWorker"in navigator){if(new URL("/gilles-game",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("/gilles-game","/service-worker.js");Na?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Sa(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Sa(e)}))}}function Sa(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var qa,Aa=function(){return{strength:100*Math.random(),perception:100*Math.random(),endurance:100*Math.random(),charisma:100*Math.random(),intelligenge:100*Math.random(),agility:100*Math.random(),luck:100*Math.random()}},Da=[{id:"c4a5d270",equipment:{chest:O.chest,head:O.cowl},stats:Aa(),health:100*Math.random(),room:0,name:"Ximena Maddox",avatarImg:"".concat("/img/avatars","/female/f_14.png"),inventory:[O.deedForLumbermill,null,O.crossbow,O.dagger,O.khopesh,null,O.sword,null,null,null,null,null,null,null,null,null]},{id:"2e655832",equipment:{},stats:Aa(),name:"Donte Houston",health:100*Math.random(),room:1,avatarImg:"".concat("/img/avatars","/male/m_05.png"),inventory:[O.crossbow,null,null,null,null,O.boots1,O.chainmailHood,O.nomadHelmet,O.plateChest4,null,null,null,null,null,null,null,null,null,null,null,null,null,O.plateHelmet,O.cowl]},{id:"ec6f1050",equipment:{},stats:Aa(),name:"Zackary Morris",health:100*Math.random(),room:2,avatarImg:"".concat("/img/avatars","/male/m_09.png"),inventory:[O.greatswordOfGwai,null,null,null]},{id:"d299f98a",stats:Aa(),equipment:{},name:"Mike Keith",health:100*Math.random(),room:4,avatarImg:"".concat("/img/avatars","/male/m_19.png"),inventory:[null,null,null,null,O.khopesh,O.hornedHelmet]},{id:"96c686c3",equipment:{},stats:Aa(),name:"Wayne Monroe",health:100*Math.random(),room:5,avatarImg:"".concat("/img/avatars","/male/m_08.png"),inventory:[null,null,null]},{id:"250d1a9d",stats:Aa(),equipment:{},name:"Alexis Ortiz ",health:100*Math.random(),room:9,avatarImg:"".concat("/img/avatars","/female/f_10.png"),inventory:[null,null,null,null,null]},{id:"169384ef",equipment:{},stats:Aa(),name:"Karlee Nolan",health:100*Math.random(),room:3,avatarImg:"".concat("/img/avatars","/female/f_16.png"),inventory:[O.greatswordOfGwai,null,null,null]},{id:"f22d66cb",stats:Aa(),equipment:{},name:"Gylbarde the Earnest",health:100*Math.random(),room:8,avatarImg:"".concat("/img/avatars","/male/m_09.png"),inventory:[null,null,null,null,null]},{id:"36c686c1",equipment:{},stats:Aa(),name:"Lanslet of the Water",health:100*Math.random(),room:6,avatarImg:"".concat("/img/avatars","/male/m_26.png"),inventory:[O.greatswordOfGwai,null,null,null,O.shoulders1,O.fedora,O.greaves2]},{id:"12c613d4",equipment:{},stats:Aa(),name:"Tedric the Bold",health:100*Math.random(),room:7,avatarImg:"".concat("/img/avatars","/male/m_33.png"),inventory:[O.greatswordOfGwai,null,null,null]}],Ra={lastTick:Date.now(),lastProducedUpdate:Date.now()},Ma=[null,null,null,O.dagger,O.deedForWeaponsmith,null,O.sandwich,O.sandwich,null,null,O.torch,O.torch,null,O.torch],_a=function(e,t){if(!t.log.length)return e;var n=t.log.map((function(e){return Object(N.a)({},e,{time:Date.now()})}));return[].concat(Object(c.a)(n),Object(c.a)(e))},Wa=[{name:"kill10Boars",status:Qt.active,party:["c4a5d270","2e655832","ec6f1050","d299f98a"],progress:0,questVars:{},encounterResults:[],icon:"sigil1.png",currentEncounter:null},{name:"retrieveMagicAmulet",party:[],status:Qt.available,progress:0,questVars:{},encounterResults:[],icon:"sigil2.png",currentEncounter:null,reward:{gold:4,items:[O.deedForWeaponsmith]}}],Ha=function(e,t){var n=t.assignedAventurers.filter((function(e){return!!e})).map((function(e){return e.id}));return e.map((function(e){return e.name===t.questName?Object(N.a)({},e,{status:Qt.active,party:n}):e}))},Fa=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.progress+1;return Object(N.a)({},e,{progress:n})}return e}))},La=function(e,t){return e.map((function(e){return e.name===t.questName?Object(N.a)({},e,{currentEncounter:t.encounter}):e}))},Pa=function(e,t){var n=t.quests;return n.length?e.map((function(e){var t=n.find((function(t){return t.name===e.name}));if(t){var r=t.progress,a=t.currentEncounter;return Object(N.a)({},e,{progress:r,currentEncounter:a})}return e})):e},Ba=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=Object.assign({},e.questVars,t.vars);return Object(N.a)({},e,{questVars:n})}return e}))},Ua=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.encounterResults.concat();return n[t.nodeIndex]=t.result,Object(N.a)({},e,{encounterResults:n})}return e}))},Ga=(qa={},Object(I.a)(qa,M.alchemist,{level:0,workers:1,state:Mn.NotBuilt}),Object(I.a)(qa,M.armoursmith,Wn),Object(I.a)(qa,M.garden,{level:0,workers:0,state:Mn.Built}),Object(I.a)(qa,M.lumberMill,Wn),Object(I.a)(qa,M.mine,{level:0,workers:0,state:Mn.NotBuilt}),Object(I.a)(qa,M.quarry,Wn),Object(I.a)(qa,M.tavern,{level:0,workers:0,state:Mn.Built}),Object(I.a)(qa,M.tannery,Wn),Object(I.a)(qa,M.warehouse,{level:0,workers:0,state:Mn.Built}),Object(I.a)(qa,M.weaponsmith,{level:0,workers:0,state:Mn.Built}),Object(I.a)(qa,M.weaver,Wn),Object(I.a)(qa,M.workshop,Wn),qa),Qa=function(e,t,n){var r=Object(N.a)({},e[t],{state:n});return Object(N.a)({},e,Object(I.a)({},t,r))},Va={completed:[],running:[]},za=function(e){return{name:e.name,origin:e.origin,type:e.taskType,callbacks:e.callbacks,timeRemaining:e.time,startTime:Date.now(),lastTick:Date.now(),progress:0}},Xa=Object(gn.b)({adventurers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Da,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Jt.moveItemInInventory:var n=t,r=n.adventurerId,a=n.fromSlot,o=n.toSlot,c=e.find((function(e){return e.id===r})),i=c.inventory.map((function(e,t){return t===a?c.inventory[o]:t===o?c.inventory[a]:e}));return e.map((function(e){return e===c?Object(N.a)({},e,{inventory:i}):e}));case Jt.moveItemToOtherAdventurer:var s=t,u=s.adventurerId,l=s.fromSlot,m=s.toAdventurerId,d=e.find((function(e){return e.id===u})),p=d.inventory[l];return e.map((function(e){if(e.id===u){var t=e.inventory.concat();return t[l]=null,Object(N.a)({},e,{inventory:t})}if(e.id===m){var n=e.inventory.concat(),r=n.findIndex((function(e){return null===e}));return n[r]=p,Object(N.a)({},e,{inventory:n})}return e}));case Jt.addItemToInventory:var h=t,g=h.item;return e.map((function(e){if(e.id===t.adventurerId){var n=e.inventory.concat(),r=t.toSlot;return null===r&&(r=n.findIndex((function(e){return null===e||void 0===e}))),n[r]=g,Object(N.a)({},e,{inventory:n})}return e}));case Jt.removeItemFromInventory:var f=t,v=f.fromSlot;return e.map((function(e){if(e.id===t.adventurerId){var n=e.inventory.map((function(e,t){return t!==v?e:null}));return Object(N.a)({},e,{inventory:n})}return e}));case Jt.assignEquipment:var b=t,y=b.equipmentSlot,w=b.item;return e.map((function(e){return e.id===t.adventurerId?Object(N.a)({},e,{equipment:Object(N.a)({},e.equipment,Object(I.a)({},zt[y],w))}):e}));case Jt.removeEquipment:var E=t,k=E.equipmentSlot;return e.map((function(e){return e.id===t.adventurerId?Object(N.a)({},e,{equipment:Object(N.a)({},e.equipment,Object(I.a)({},zt[k],null))}):e}))}return e},combat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case r.startCombatAction:var n=t;return Object(N.a)({},e,{action:{actor:n.actor,endsAt:n.endsAt,target:n.target,type:n.combatType}});case r.moveActor:var a=t,o=e.actors.map((function(e){return e.name===a.actor?Object(N.a)({},e,{location:a.location}):e}));return Object(N.a)({},e,{actors:o});case r.clearCombatAction:return Object(N.a)({},e,{action:void 0})}return e},engine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ra,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case d.gameTick:var n=t.resources,r=null===n?e.lastProducedUpdate:Date.now();return Object(N.a)({},e,{lastProducedUpdate:r,lastTick:Date.now()})}return e},gold:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case at.addGold:return e+t.amount}return e},stockpile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ma,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ot.addItem:var n=t,r=n.item,a=t,o=a.toSlot;return void 0===o&&-1===(o=e.findIndex((function(e){return null===e})))?[].concat(Object(c.a)(e),[r]):e.map((function(e,t){return t===o?r:e}));case ot.moveItemInWarehouse:var i=t,s=i.fromSlot,u=i.toSlot;return e.map((function(t,n){return n===s?null:n===u?e[s]:t}));case ot.removeItem:var l=t,m=l.fromSlot;return e.map((function(e,t){return t!==m?e:null}))}return e},log:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h.addLogEntry:var n=t,r=n.key,a=n.channel,o=n.channelContext,i=n.context,s=Date.now();return[{channel:a,channelContext:o,context:i,key:r,time:s}].concat(Object(c.a)(e));case d.gameTick:return _a(e,t)}return e},quests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case jt.launchQuest:return Ha(e,t);case jt.advanceQuest:return Fa(e,t);case jt.updateQuestVars:return Ba(e,t);case jt.updateEncounterResult:return Ua(e,t);case jt.startEncounter:return La(e,t);case d.gameTick:return Pa(e,t)}return e},resources:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tn,t=arguments.length>1?arguments[1]:void 0,n=function(t){return Object.keys(e).reduce((function(n,r){return n[r]=e[r]+(t[r]||0),n}),{})};switch(t.type){case ct.addResources:var r=t.resources;return n(r);case ct.removeResources:var a=t.resources;return Object.keys(e).reduce((function(t,n){return t[n]=e[n]-(a[n]||0),t}),{});case d.gameTick:var o=t.resources;return null===o?e:n(o)}return e},rngState:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===d.gameTick&&null!=t.rngState&&(e=Object.assign({},t.rngState)),e},structures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ga,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case it.startBuildingStructure:return Qa(e,t.structure,Mn.Building);case it.finishBuildingStructure:return Qa(e,t.structure,Mn.Built);case it.upgradeStructure:var n=e[t.structure].level+1,r=Object(N.a)({},e[t.structure],{level:n});return Object(N.a)({},e,Object(I.a)({},t.structure,r));case it.increaseWorkers:var a=t,o=a.workers,c=e[t.structure].workers+o,i=Object(N.a)({},e[t.structure],{workers:c});return Object(N.a)({},e,Object(I.a)({},t.structure,i));case it.decreaseWorkers:var s=t,u=s.workers,l=e[t.structure].workers-u,m=Object(N.a)({},e[t.structure],{workers:l});return Object(N.a)({},e,Object(I.a)({},t.structure,m));case it.setStructureState:var d=t,p=d.state;return Qa(e,t.structure,p)}return e},tasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Va,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case st.start:var n=za(t),r=e.running.concat(n);return Object(N.a)({},e,{running:r});case d.gameTick:var a=Date.now(),o=[],c=[];return e.running.forEach((function(e){var t=a+e.timeRemaining,n=(a-e.startTime)/(t-e.startTime),r=e.timeRemaining-(a-e.lastTick),i=Object(N.a)({},e,{progress:n,lastTick:a,timeRemaining:r});r<0?c.push(i):o.push(i)})),{running:o,completed:c}}return e},workers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:13,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case jr.addWorkers:return e+t.value}return e}}),Ka=n(71),Ja=n(119),Ya={key:"root",storage:n.n(Ja).a,version:j},Za=Object(Ka.a)(Ya,Xa),$a=Object(u.a)(s.a.mark((function e(){var t,n=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",new Promise((function(e,n){var r=Object(gn.d)(Za,t,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),a=Object(Ka.b)(r,void 0,(function(){var t=qn(r.getState());e({store:r,persistor:a,isHydrated:t})}))})));case 2:case"end":return e.stop()}}),e)}))),eo=function(){var e=Object(u.a)(s.a.mark((function e(){var t,n,r,a,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.a.get("".concat("/gilles-game","/lang/en-US.json"));case 2:return t=e.sent,n=t.data,Me.init(n),c="GILLESROX2",Yr=!0,Fr=Xr()(c,{state:!0}),e.next=8,$a();case 8:r=e.sent,a=r.store,o=r.persistor,r.isHydrated?no(a):to(a),ro(a,o);case 14:case"end":return e.stop()}var c}),e)})));return function(){return e.apply(this,arguments)}}(),to=function(e){e.dispatch(E("test-game-welcome")),console.log("Starting new GILLES-IDLE-GAME (version ".concat("0.0.4",")"))},no=function(e){console.log("Continuing existing GILLES-IDLE-GAME (version ".concat("0.0.4",")"))},ro=function(e,t){y.render(v.createElement(w.a,{store:e},v.createElement(Oa,{persistor:t})),document.getElementById("root")),Ca();var n=function(t){t.completed.forEach((function(t){return function(t){t.callbacks.forEach((function(t){return e.dispatch(t)}))}(t)}))};setInterval((function(){var t=e.getState(),r=Date.now()-t.engine.lastTick,a=[],o=ja(t.engine.lastProducedUpdate,t),i=xa();f(r,e);var s=Ia(r,t),u=s.questUpdates,l=s.logUpdates;a.push.apply(a,Object(c.a)(l)),e.dispatch(function(e,t,n,r,a){return{type:d.gameTick,delta:e,rngState:t,resources:n,quests:r,log:a}}(r,i,o,u,a)),n(t.tasks)}),2500)};eo()},43:function(e,t,n){},57:function(e){e.exports=JSON.parse('{"alchemist":[{"shape":[34,18,31,1,37,0]},{"shape":[37,0,53,5,45,17]},{"shape":[45,17,68,27,81,48]},{"shape":[72,67,75,168,11,168]},{"shape":[9,65,1,45,10,30]},{"shape":[31,19,29,5,45,0]},{"shape":[45,0,34,18,37,0]},{"shape":[45,17,81,48,72,67]},{"shape":[72,67,11,168,9,65]},{"shape":[9,65,10,30,31,19]},{"shape":[45,17,72,67,9,65]},{"shape":[9,65,31,19,45,0]},{"shape":[37,0,45,17,9,65]}],"garden":[{"shape":[48,45,48,0,58,0]},{"shape":[57,41,75,56,73,78]},{"shape":[73,78,11,68,2,56]},{"shape":[2,56,13,45,48,45]},{"shape":[48,45,58,0,57,41]},{"shape":[73,78,2,56,48,45]},{"shape":[48,45,57,41,73,78]}],"armoursmith":[{"shape":[53,1,55,0,93,5]},{"shape":[93,5,112,11,120,20]},{"shape":[120,20,124,36,119,49]},{"shape":[119,49,122,156,75,149]},{"shape":[75,149,57,135,33,104]},{"shape":[33,104,10,95,11,52]},{"shape":[11,52,0,35,2,20]},{"shape":[2,20,6,14,27,5]},{"shape":[27,5,53,1,93,5]},{"shape":[93,5,120,20,119,49]},{"shape":[119,49,75,149,33,104]},{"shape":[33,104,11,52,2,20]},{"shape":[2,20,27,5,93,5]},{"shape":[93,5,119,49,33,104]},{"shape":[33,104,2,20,93,5]}],"lumberMill":[{"shape":[32,11,43,1,45,0]},{"shape":[45,0,49,4,37,18]},{"shape":[39,29,50,44,49,48]},{"shape":[38,46,38,230,17,233]},{"shape":[17,233,13,232,13,48]},{"shape":[13,48,3,48,14,28]},{"shape":[14,28,1,7,6,4]},{"shape":[31,18,32,11,45,0]},{"shape":[39,29,49,48,40,43]},{"shape":[38,46,17,233,13,48]},{"shape":[14,28,6,4,19,18]},{"shape":[31,18,45,0,37,18]},{"shape":[37,18,39,29,40,43]},{"shape":[40,43,38,46,13,48]},{"shape":[13,48,14,28,19,18]},{"shape":[31,18,37,18,40,43]},{"shape":[40,43,13,48,19,18]},{"shape":[19,18,31,18,40,43]}],"mine":[{"shape":[15,0,79,1,88,13]},{"shape":[88,13,78,66,27,70]},{"shape":[27,70,2,50,11,27]},{"shape":[11,27,6,13,15,0]},{"shape":[15,0,88,13,27,70]},{"shape":[27,70,11,27,15,0]}],"quarry":[{"shape":[2,24,20,2,22,0]},{"shape":[22,0,103,2,117,15]},{"shape":[117,15,124,24,112,24]},{"shape":[112,24,112,64,104,70]},{"shape":[104,70,104,89,97,88]},{"shape":[97,68,66,67,60,43]},{"shape":[60,43,17,42,17,26]},{"shape":[17,26,2,24,22,0]},{"shape":[22,0,117,15,112,24]},{"shape":[112,24,104,70,97,88]},{"shape":[60,43,17,26,22,0]},{"shape":[112,24,97,88,97,68]},{"shape":[97,68,60,43,22,0]},{"shape":[22,0,112,24,97,68]}],"tannery":[{"shape":[4,2,4,0,61,1]},{"shape":[59,36,89,37,85,79]},{"shape":[85,79,15,77,15,47]},{"shape":[15,47,5,35,0,9]},{"shape":[0,9,4,2,61,1]},{"shape":[59,36,85,79,15,47]},{"shape":[15,47,0,9,61,1]},{"shape":[61,1,59,36,15,47]}],"tavern":[{"shape":[110,27,108,24,112,23]},{"shape":[112,23,151,27,148,60]},{"shape":[148,60,137,71,133,67]},{"shape":[133,67,136,69,132,75]},{"shape":[132,75,137,77,138,124]},{"shape":[131,131,136,136,55,119]},{"shape":[29,64,6,72,0,69]},{"shape":[27,56,76,61,85,67]},{"shape":[101,25,108,13,112,17]},{"shape":[112,17,102,18,104,6]},{"shape":[110,27,112,23,148,60]},{"shape":[132,75,138,124,131,131]},{"shape":[131,131,55,119,59,118]},{"shape":[29,64,0,69,27,56]},{"shape":[112,17,104,6,111,9]},{"shape":[92,27,110,27,148,60]},{"shape":[132,75,131,131,59,118]},{"shape":[50,68,29,64,27,56]},{"shape":[92,27,148,60,133,67]},{"shape":[133,67,132,75,59,118]},{"shape":[50,68,27,56,85,67]},{"shape":[133,67,59,118,56,72]},{"shape":[56,72,50,68,85,67]},{"shape":[133,67,56,72,85,67]},{"shape":[133,67,85,67,89,60]},{"shape":[92,27,133,67,89,60]},{"shape":[92,27,89,60,86,25]},{"shape":[104,0,92,27,86,25]}],"warehouse":[{"shape":[36,414,3,409,2,13]},{"shape":[2,13,31,-7,63,7]},{"shape":[62,197,63,126,65,218]},{"shape":[61,262,83,272,84,459]},{"shape":[84,459,36,414,2,13]},{"shape":[2,13,63,7,62,197]},{"shape":[62,197,65,218,61,262]},{"shape":[61,262,84,459,2,13]},{"shape":[2,13,62,197,61,262]}],"weaponsmith":[{"shape":[52,18,50,2,50,0]},{"shape":[50,0,114,1,109,49]},{"shape":[109,49,115,132,98,129]},{"shape":[98,129,66,95,65,34]},{"shape":[11,33,11,77,0,77]},{"shape":[0,29,18,18,52,18]},{"shape":[52,18,50,0,109,49]},{"shape":[109,49,98,129,65,34]},{"shape":[11,33,0,77,0,29]},{"shape":[52,18,109,49,65,34]},{"shape":[15,27,11,33,0,29]},{"shape":[52,18,65,34,53,26]},{"shape":[15,27,0,29,52,18]},{"shape":[52,18,53,26,15,27]}],"weaver":[{"shape":[51,41,54,0,55,6]},{"shape":[55,41,82,53,87,63]},{"shape":[87,63,86,259,62,254]},{"shape":[62,254,23,212,21,61]},{"shape":[21,61,2,56,51,41]},{"shape":[51,41,55,6,55,41]},{"shape":[55,41,87,63,62,254]},{"shape":[62,254,21,61,51,41]},{"shape":[51,41,55,41,62,254]}],"workshop":[{"shape":[11,2,13,0,68,3]},{"shape":[68,3,77,12,70,14]},{"shape":[70,14,69,38,10,37]},{"shape":[9,13,1,12,11,2]},{"shape":[11,2,68,3,70,14]},{"shape":[70,14,10,37,9,13]},{"shape":[9,13,11,2,70,14]}]}')},63:function(e,t,n){}},[[123,1,2]]]);
//# sourceMappingURL=main.b92a12a8.chunk.js.map