(this["webpackJsonpgilles-game"]=this["webpackJsonpgilles-game"]||[]).push([[0],{102:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l}));var a=n(13),r=n(28),c=r.a.deed,o="/img/items/deeds/",i={lumbermill:{structure:"lumberMill",itemType:c,iconImg:"".concat(o,"deed.png")},weaponsmith:{structure:"weaponsmith",itemType:c,iconImg:"".concat(o,"deed.png")}},s=Object.entries(i).reduce((function(e,t){var n=Object(a.a)(t,2),r=n[0],c=n[1];return e["".concat("deed/").concat(r)]=c,e}),{});function u(e){return s[e]}t.a=s;var l=function(e){return!!s[e]}},126:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var a=n(13),r=n(28),c=r.a.questItem,o="/img/items/quest-items/",i={blueprints:{itemType:c,iconImg:"".concat(o,"blueprints.png")},crate:{itemType:c,iconImg:"".concat(o,"crate.png")},dynamite:{itemType:c,iconImg:"".concat(o,"dynamite.png")},dragonEye:{itemType:c,iconImg:"".concat(o,"dragon-eye.png")},eye:{itemType:c,iconImg:"".concat(o,"eye.png")},feather:{itemType:c,iconImg:"".concat(o,"feather.png")},food:{itemType:c,iconImg:"".concat(o,"food.png")},heart:{itemType:c,iconImg:"".concat(o,"heart.png")},horn:{itemType:c,iconImg:"".concat(o,"horn.png")},key:{itemType:c,iconImg:"".concat(o,"key.png")},letters:{itemType:c,iconImg:"".concat(o,"letters.png")},lockPicks:{itemType:c,iconImg:"".concat(o,"lock-picks.png")},oil:{itemType:c,iconImg:"".concat(o,"oil.png")},orcFinger:{itemType:c,iconImg:"".concat(o,"orc-finger.png")},plans:{itemType:c,iconImg:"".concat(o,"plans.png")},purpleGems:{itemType:c,iconImg:"".concat(o,"purple-gems.png")},runestone:{itemType:c,iconImg:"".concat(o,"runestone.png")},sandwich:{itemType:c,iconImg:"".concat(o,"sandwich.png")},teeth:{itemType:c,iconImg:"".concat(o,"teeth.png")},tooth:{itemType:c,iconImg:"".concat(o,"tooth.png")},torch:{itemType:c,iconImg:"".concat(o,"torch.png")},tusk:{itemType:c,iconImg:"".concat(o,"tusk.png")},vase:{itemType:c,iconImg:"".concat(o,"vase.png")},vial:{itemType:c,iconImg:"".concat(o,"vial.png")},weeds:{itemType:c,iconImg:"".concat(o,"weeds.png")}},s=Object.entries(i).reduce((function(e,t){var n=Object(a.a)(t,2),r=n[0],c=n[1];return e["".concat("questItem/").concat(r)]=c,e}),{});t.a=s;var u=function(e){return!!s[e]}},127:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(25),r=n(26),c=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"registerSceneController",value:function(e,t,n){this.controllerTypes["".concat(e,".").concat(t)]=n}},{key:"getSceneController",value:function(e,t,n){if(!this.store["".concat(e,".").concat(t)]){if(!this.controllerTypes["".concat(e,".").concat(t)])throw new Error("No controller registered for ".concat(e,".").concat(t));this.store["".concat(e,".").concat(t)]=new(this.controllerTypes["".concat(e,".").concat(t)])(n,e)}return this.store["".concat(e,".").concat(t)]}},{key:"destroySceneConroller",value:function(e,t){delete this.store["".concat(e,".").concat(t)]}}]),e}();c.store={},c.controllerTypes={},n(498)},128:function(e,t,n){"use strict";var a,r,c;n.d(t,"a",(function(){return a})),function(e){e.tilelayer="tilelayer",e.objectgroup="objectgroup"}(a||(a={})),function(e){e.orthagonal="orthagonal",e.isometric="isometric",e.staggered="staggered",e.hexagonal="hexagonal"}(r||(r={})),function(e){e.rightUp="right-up",e.rightDown="right-down",e.leftUp="left-up",e.leftDown="left-down"}(c||(c={}))},143:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a={dungeon:{entered:!1,entrance:{chestOpen:!1,chest:{title:"encounter-dungeon-caches-chest",items:["apparel/nomadHelmet","questItem/teeth","material/poisonVial","apparel/fedora"],gold:100}},hallway:{chest:{title:"encounter-dungeon-caches-chest",items:["questItem/key"]},chestOpen:!1,doorOpen:!1}}}},146:function(e,t,n){"use strict";n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return A}));var a=n(2),r=n(64),c=n(42),o=n.n(c),i=n(60),s=n(25),u=n(26),l=n(44),d=n(84),m=n(128),p=n(188),h=n(33),b=n(18),v=n(49),f=n(50),g=n(30);function j(e){return"string"!==typeof e}var O=n(3),y=n(70),w=n(69),x=n(46),k=n(96),T=n(48),N=n(71),I=n(22),S=n(41),q=n(11),C=500,A=function(){function e(t,n){Object(s.a)(this,e),this.questName=void 0,this.mapData=void 0,this.aStar=void 0,this.dataLoading=!1,this.dataLoadComplete=!1,this.store=void 0,this.jsonPath=void 0,this.blockedTiles=[],this.store=t,this.questName=n}return Object(u.a)(e,[{key:"basePath",get:function(){return this.jsonPath?"".concat(".","/").concat(this.jsonPath.substr(0,this.jsonPath.lastIndexOf("/"))):null}},{key:"loadData",value:function(e){var t=this;if(this.dataLoadComplete)return e();if(!this.jsonPath)throw new Error("No jsonPath defined!");this.dataLoading=!0;var n=function(){var e=Object(i.a)(o.a.mark((function e(t,n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){I.c.addSound(t,n,(function(t){e(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),a=[n("scene/bow",["sound/scene/bow-01.mp3","sound/scene/bow-02.mp3"]),n("scene/meleeHit",["sound/scene/melee-hit-01.mp3","sound/scene/melee-hit-02.mp3","sound/scene/melee-hit-03.mp3"]),n("scene/metalBash",["sound/scene/metal-bash-01.mp3","sound/scene/metal-bash-02.mp3","sound/scene/metal-bash-03.mp3"]),n("scene/shieldBash",["sound/scene/shield-bash-impact.mp3"]),n("scene/swish",["sound/scene/swish-01.mp3","sound/scene/swish-02.mp3","sound/scene/swish-03.mp3","sound/scene/swish-04.mp3"]),n("scene/doorOpen",["sound/scene/door.ogg"]),Object(d.c)("".concat(".","/").concat(this.jsonPath))];Promise.all(a).then(Object(i.a)(o.a.mark((function n(){var a,c,i,s,u;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:a=q.Loader.shared.resources["".concat(".","/").concat(t.jsonPath)],t.mapData=a.data,t.createBlockedTiles(),t.aStar=t.createAStar(),c=Object(b.b)(t.sceneObjects.length?t.sceneObjects:t.createObjects()),i=Object(r.a)(c),n.prev=6,i.s();case 8:if((s=i.n()).done){n.next=14;break}return u=s.value,n.next=12,Object(d.c)(u);case 12:n.next=8;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(6),i.e(n.t0);case 19:return n.prev=19,i.f(),n.finish(19);case 22:t.dataLoadComplete=!0,t.dataLoading=!1,e();case 25:case"end":return n.stop()}}),n,null,[[6,16,19,22]])}))))}},{key:"createBlockedTiles",value:function(e){var t,n=this;this.blockedTiles=[],null===(t=this.mapData)||void 0===t||t.layers.filter((function(e){return e.visible})).forEach((function(e){e.properties&&e.properties.some((function(e){return"blocksMovement"===e.name&&!0===e.value}))&&Object(l.b)(n.blockedTiles,e,e.width)})),null===e||void 0===e||e.forEach((function(e){!0===e.properties.blocksMovement&&e.location&&n.blockedTiles.push(e.location)}))}},{key:"createScene",value:function(){var e=this.createObjects();this.updateScene(e,!1)}},{key:"updateScene",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sceneObjects,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.combat,n=Object(a.a)(Object(a.a)({},this.quest.scene),{},{objects:e,combat:t});this.dispatch(Object(h.i)(this.questName,n)),this.createBlockedTiles(e),this.mapData&&(this.aStar=this.createAStar())}},{key:"sceneEntered",value:function(){}},{key:"getTileDimensions",value:function(){var e,t;return{tileWidth:(null===(e=this.mapData)||void 0===e?void 0:e.tilewidth)||0,tileHeight:(null===(t=this.mapData)||void 0===t?void 0:t.tileheight)||0}}},{key:"actorMoved",value:function(e,t){var n=this.getObjectAtLocation(t);if(n&&n.type===l.a.exit)if(n.properties.loadScene)this.dispatch(Object(h.j)(this.questName,n.properties.loadScene));else{var a=Math.floor(this.quest.progress)+1,r=Object(w.a)(this.questName).nodes[a];r.log&&this.dispatch(Object(y.b)(r.log,null,x.a.quest,this.questName)),this.dispatch(Object(h.e)(this.questName))}}},{key:"actorInteract",value:function(e,t){var n=this.getSceneActor(e),a=this.getObjectAtLocation(t);a?n&&this.interactWithObject(n,a):console.warn("No object found")}},{key:"actorAttemptAction",value:function(e,t,n){var a=this,r=this.getSceneActor(e);if(r){var c=r.location;if(!c)throw new Error("No location found!");switch(t){case b.a.move:var o=this.findPath(c,n);if(this.combat){if((r.ap||-1)<((null===o||void 0===o?void 0:o.length)||0))return;this.dispatch(Object(h.b)(this.questName,e,(null===o||void 0===o?void 0:o.length)||0))}null===o||void 0===o||o.forEach((function(t,n){var r={actionType:b.a.move,actorId:e,target:t,endsAt:C*(n+1)+performance.now()};a.dispatch(Object(h.d)(a.questName,r))}));break;case b.a.interact:var i=this.findPathNearest(c,n);null===i||void 0===i||i.forEach((function(t,n){var r={actionType:b.a.move,actorId:e,target:t,endsAt:C*(n+1)+performance.now()};a.dispatch(Object(h.d)(a.questName,r))}));var s={actionType:b.a.interact,actorId:e,target:n,endsAt:C*i.length+performance.now()};this.dispatch(Object(h.d)(this.questName,s));break;case b.a.slash:var u=this.findPath(c,n),l=null===u||void 0===u?void 0:u.pop();if(!u||!l)return;null===u||void 0===u||u.forEach((function(t,n){var r={actionType:b.a.move,actorId:e,target:t,endsAt:C*(n+1)+performance.now()};a.dispatch(Object(h.d)(a.questName,r))}));var d={actionType:t,actorId:e,target:l,endsAt:C*(u.length+1)+performance.now()};this.dispatch(Object(h.d)(this.questName,d)),this.dispatch(Object(h.b)(this.questName,e,(null===u||void 0===u?void 0:u.length)||0))}}}},{key:"interactWithObject",value:function(e,t){}},{key:"pointToSceneLocation",value:function(e){var t,n;return(null===(t=this.mapData)||void 0===t?void 0:t.tilewidth)&&(null===(n=this.mapData)||void 0===n?void 0:n.tileheight)?[Math.floor(e.x/this.mapData.tilewidth),Math.floor(e.y/this.mapData.tilewidth)]:[0,0]}},{key:"locationIsBlocked",value:function(e){return this.blockedTiles.some((function(t){return Object(l.d)(t,e)}))}},{key:"locationIsOutOfBounds",value:function(e){return!this.mapData||(e[0]<0||e[1]<0||e[0]>=this.mapData.width||e[1]>=this.mapData.height)}},{key:"getLootCache",value:function(e){}},{key:"takeGoldFromCache",value:function(e){var t=this.getLootCache(e);t&&this.dispatch(Object(k.a)(t.gold||0))}},{key:"takeItemFromCache",value:function(e,t,n,a){var r=this.getLootCache(t);if(r){var c=r.items[e];this.dispatch(Object(T.a)(n,c,a))}}},{key:"discardItem",value:function(e,t){var n=this.getAdventurerById(t),a=null===n||void 0===n?void 0:n.inventory.indexOf(e);void 0!==a&&this.dispatch(Object(T.f)(t,a))}},{key:"getSituation",value:function(e,t){}},{key:"handleSituationOptionClick",value:function(e,t,n){}},{key:"findPath",value:function(e,t){var n;return null===(n=this.aStar)||void 0===n?void 0:n.findPath(E(e),E(t)).map(M)}},{key:"findPathNearest",value:function(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=null===(n=this.aStar)||void 0===n?void 0:n.getGrid().getGridNodes();if(!r)return[];var c=r.map((function(e){return e.map((function(e){return e.getIsWalkable()?0:1}))}));c[t[1]][t[0]]=0;var o=new p.AStarFinder({grid:{matrix:c},includeStartNode:!1,heuristic:"Manhattan",weight:.2});return o.findPath(E(e),E(t)).map(M).slice(0,a?void 0:-1)}},{key:"calculateWalkApCosts",value:function(e,t){var n;return(null===(n=this.findPath(e,t))||void 0===n?void 0:n.length)||0}},{key:"endTurn",value:function(){this.dispatch(Object(h.c)(this.questName))}},{key:"getSceneActor",value:function(e){return this.sceneActors.find((function(t){return t.name===e}))}},{key:"getObjectAtLocation",value:function(e){var t,n;return null===(t=this.quest.scene)||void 0===t||null===(n=t.objects)||void 0===n?void 0:n.find((function(t){return t.location&&Object(l.d)(t.location,e)}))}},{key:"createAStar",value:function(){var e=[];if(this.mapData)for(var t=0;t<this.mapData.height;t++){for(var n=[],a=0;a<this.mapData.width;a++){var r=[a,t],c=this.locationIsBlocked(r);n.push(c?1:0)}e.push(n)}return new p.AStarFinder({grid:{matrix:e},includeStartNode:!1,heuristic:"Manhattan",weight:.2})}},{key:"createObjects",value:function(){var e=this;if(!this.mapData)throw new Error("No mapData");var t=this.mapData.layers.filter((function(e){return e.type===m.a.objectgroup})),n=[],r=this.getAdventurers();return t.forEach((function(t){t.objects.reduce((function(n,c){var o,i,s=Object(l.e)(c.properties),u=[c.x/((null===(o=e.mapData)||void 0===o?void 0:o.tilewidth)||1),(c.y-(c.gid?c.height:0))/((null===(i=e.mapData)||void 0===i?void 0:i.tileheight)||1)],d=Object(a.a)(Object(a.a)({},c),{},{layerId:t.id,properties:s,location:u});if(d.type===l.a.adventurerStart){var m=r.pop();m?(d.type=l.a.actor,Object(b.c)(d)&&(d.name=m.id,d.ap="c4a5d270"===m.id?2:0,d.health=m.health,d.allegiance=S.a.player,d.properties.adventurerId=m.id,d.properties.isSprite=!0,d.properties.spritesheet=m.spritesheetPath)):d=null}else d.type===l.a.enemySpawn&&(d.type=l.a.actor,Object(b.c)(d)&&(d.health=100*Math.random(),d.ap=6,d.name=d.properties.name,d.allegiance=S.a.enemy,d.properties.isSprite=!0,d.properties.spritesheet="".concat("img/scene/actors/","troll-sword.json")));return d&&n.push(d),n}),n)})),n}},{key:"combat",get:function(){var e;return!!(null===(e=this.quest.scene)||void 0===e?void 0:e.combat)}},{key:"sceneObjects",get:function(){var e;return(null===(e=this.quest.scene)||void 0===e?void 0:e.objects)||[]}},{key:"sceneActors",get:function(){return this.sceneObjects.filter(b.c)}},{key:"sceneAdventurers",get:function(){return this.sceneObjects.filter(b.d)}},{key:"sceneEnemies",get:function(){return this.sceneObjects.filter(b.e)}},{key:"quest",get:function(){var e=this,t=this.store.getState().quests.find((function(t){return t.name===e.questName}));if(!t)throw new Error("No quest :(");return t}},{key:"questVars",get:function(){return this.quest.questVars}},{key:"updateQuestVars",value:function(e){this.dispatch(Object(h.l)(this.questName,e))}},{key:"getAdventurers",value:function(){var e=this.store.getState();return Object(N.b)(e.adventurers,this.quest)}},{key:"getAdventurerByActor",value:function(e){return this.store.getState().adventurers.find((function(t){return t.id===e.name}))}},{key:"getAdventurerById",value:function(e){return this.store.getState().adventurers.find((function(t){return t.id===e}))}},{key:"questUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=j(e)?e:{key:e},r=O.a.getTextEntry(a);n&&v.b.addToast(r,f.a.questUpdate,t,Object(g.a)(this.questName)),this.dispatch(Object(y.a)(a,x.a.quest,this.questName))}},{key:"dispatch",value:function(e){this.store.dispatch(e)}}]),e}(),E=function(e){return{x:e[0],y:e[1]}},M=function(e){return[e[0],e[1]]}},18:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return u}));var a,r=n(44),c=n(41),o=function(e){return e.type===r.a.actor},i=function(e){return o(e)&&e.allegiance===c.a.player},s=function(e){return o(e)&&e.allegiance===c.a.enemy};!function(e){e.move="move",e.interact="interact",e.attack="attack",e.slash="slash"}(a||(a={}));var u=function(e){return Array.from(new Set(e.filter((function(e){return e.properties.isSprite})).map((function(e){return e.properties.spritesheet}))))}},19:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.nothing=0]="nothing",e[e.encounter=1]="encounter"}(a||(a={}))},21:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a,r,c=n(2),o=n(61),i=(n(1),n(361),n(0));!function(e){e.smallest="smallest",e.small="small",e.medium="medium",e.big="big",e.biggest="biggest"}(a||(a={})),function(e){e.none="none",e.gold="gold"}(r||(r={}));t.b=function(e){var t=e.image,n=e.size,l=e.children,d=e.className,m=void 0===d?"":d,p=e.border,h=void 0===p?"none":p,b=Object(o.a)(e,["image","size","children","className","border"]);return Object(i.jsxs)("div",Object(c.a)(Object(c.a)({className:"icon ".concat(s("string"===typeof n?a[n]:n)," ").concat(m)},b),{},{style:{backgroundImage:"url(".concat(".").concat(t,")")},children:[l,"none"!==h&&h&&Object(i.jsx)("div",{className:"border ".concat(u("string"===typeof h?r[h]:h)," ")})]}))};var s=function e(t){switch(t){case a.smallest:return"size-smallest";case a.small:return"size-small";case a.medium:return"size-medium";case a.big:return"size-big";case a.biggest:return"size-biggest"}return e(a.medium)},u=function(e){switch(e){case r.gold:return"border-gold";case r.none:default:return""}}},22:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return g}));var a,r,c,o=n(42),i=n.n(o),s=n(10),u=n(60),l=n(25),d=n(26),m=n(89),p=n.n(m),h=n(302),b=n(59),v=n(11);!function(e){e[e.music=0]="music",e[e.ui=1]="ui",e[e.scene=2]="scene"}(a||(a={})),function(e){e[e.singleInstance=0]="singleInstance",e[e.layered=1]="layered",e[e.fade=2]="fade"}(r||(r={})),function(e){e[e.town=0]="town",e[e.world=1]="world"}(c||(c={}));var f="channelVolume",g=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,null,[{key:"init",value:function(){var e=Object(u.a)(i.a.mark((function e(){var t,n,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={},e.t0=s.a,e.t1=c,e.t2=a.music,e.next=6,p.a.getItem("".concat(f,"-").concat(a.music));case 6:if(e.t4=t=e.sent,e.t3=null!==e.t4,!e.t3){e.next=10;break}e.t3=void 0!==t;case 10:if(!e.t3){e.next=14;break}e.t5=t,e.next=15;break;case 14:e.t5=0;case 15:return e.t6=e.t5,(0,e.t0)(e.t1,e.t2,e.t6),e.t7=s.a,e.t8=c,e.t9=a.ui,e.next=22,p.a.getItem("".concat(f,"-").concat(a.ui));case 22:if(e.t11=n=e.sent,e.t10=null!==e.t11,!e.t10){e.next=26;break}e.t10=void 0!==n;case 26:if(!e.t10){e.next=30;break}e.t12=n,e.next=31;break;case 30:e.t12=1;case 31:return e.t13=e.t12,(0,e.t7)(e.t8,e.t9,e.t13),e.t14=s.a,e.t15=c,e.t16=a.scene,e.next=38,p.a.getItem("".concat(f,"-").concat(a.scene));case 38:if(e.t18=r=e.sent,e.t17=null!==e.t18,!e.t17){e.next=42;break}e.t17=void 0!==r;case 42:if(!e.t17){e.next=46;break}e.t19=r,e.next=47;break;case 46:e.t19=1;case 47:e.t20=e.t19,(0,e.t14)(e.t15,e.t16,e.t20),this._channelVolume=c,this._initialized=!0;case 51:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addSound",value:function(){var e=Object(u.a)(i.a.mark((function e(t,n,a){var r,c=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"===typeof n&&(n=[n]),!this._sounds[t]){e.next=4;break}return null===a||void 0===a||a(this._sounds[t]),e.abrupt("return");case 4:r=new v.Loader,n.map((function(e){return r.add(e)})),r.load((function(e,n){n&&(c._sounds[t]=Object.values(n).filter(Boolean).map((function(e){return e.sound})),null===a||void 0===a||a(c._sounds[t]))}));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"playSound",value:function(){var e=Object(u.a)(i.a.mark((function e(t){var n,c,o,s,u,l,d,m,p,h,v,f=this,g=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=g.length>1&&void 0!==g[1]?g[1]:a.ui,s=g.length>2&&void 0!==g[2]&&g[2],u=g.length>3&&void 0!==g[3]?g[3]:r.singleInstance,l=g.length>4&&void 0!==g[4]&&g[4],this._initialized){e.next=7;break}return e.next=7,this.init();case 7:return(d=this.getSound(t)).volume=this._channelVolume[o],d.loop=s,(null===(n=this._currentSound[o])||void 0===n?void 0:n.storePosition)&&(m=this._currentSound[o]).instance.once("progress",(function(e,t){f._storedPositions[m.gameSound]=e*t})),p=null!==(c=this._storedPositions[t])&&void 0!==c?c:0,e.next=14,d.play({start:p});case 14:h=e.sent,this._currentSound[o]&&(u===r.fade?(v=this._currentSound[o],b.b.to(v.instance,{volume:0,duration:.75,onComplete:function(){v.instance.destroy()}}),b.b.from(h,{volume:0,duration:.75})):u===r.singleInstance&&this._currentSound[o].instance.stop()),this._currentSound[o]={instance:h,gameSound:t,pixiSound:d,storePosition:l},h.on("end",(function(){f._currentSound[o].instance.destroy(),delete f._currentSound[o]}));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSound",value:function(e){var t;if(!(null===(t=this._sounds[e])||void 0===t?void 0:t.length))throw new Error("No sound found for ".concat(e));return 1===this._sounds[e].length?this._sounds[e][0]:this._sounds[e][Math.floor(Math.random()*this._sounds[e].length)]}},{key:"musicFiltered",set:function(e){this._currentSound[a.music]&&(this._currentSound[a.music].pixiSound.filters=e?[this._filter]:[])}},{key:"getChannelVolume",value:function(e){return this._channelVolume[e]}},{key:"setChannelVolume",value:function(e,t){var n;this._channelVolume[e]=t,(null===(n=this._currentSound[e])||void 0===n?void 0:n.instance)&&(this._currentSound[e].instance.volume=t),p.a.setItem("".concat(f,"-").concat(e),t)}}]),e}();g._sounds={},g._currentSound={},g._storedPositions={},g._channelVolume={},g._initialized=!1,g._filter=new h.a.filters.TelephoneFilter},23:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.common=0]="common",e[e.uncommon=1]="uncommon",e[e.rare=2]="rare",e[e.epic=3]="epic",e[e.legendary=4]="legendary"}(a||(a={}))},28:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.apparel=0]="apparel",e[e.deed=1]="deed",e[e.herb=2]="herb",e[e.material=3]="material",e[e.mineral=4]="mineral",e[e.potion=5]="potion",e[e.questItem=6]="questItem",e[e.trinket=7]="trinket",e[e.weapon=8]="weapon"}(a||(a={}))},297:function(e,t,n){},3:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(25),r=n(26),c=n(57),o=n(40),i=n(28),s=n(74),u=n(50),l=n(7),d=n(32),m=n(30),p=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"init",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.texts=e,this.templates={},this.notFound=[],t&&this.compileAll(),this.initialized=!0}},{key:"get",value:function(e,t){var n=this.getDefault(e,t);return null===n?(console.error("Key '".concat(e,"' not found in TextManager")),"<<'".concat(e,"' missing>>")):n}},{key:"getDefault",value:function(e,t){if(!this.initialized)throw new Error("Error ".concat(this," not initialized!"));var n=this.getTemplate(e);return n?n(t):null}},{key:"getTextEntry",value:function(e){return this.get(e.key,e.context)}},{key:"getTemplate",value:function(e){var t=this.templates[e];return!t&&this.texts[e]&&(this.compile(e,this.texts[e]),t=this.templates[e]),t}},{key:"getEquipmentSlot",value:function(e){return this.get("ui-equipmentslot-".concat(Object(c.a)(l.a[e])))}},{key:"getQuestTitle",value:function(e){return this.get("quest-".concat(Object(c.a)(e),"-title"))}},{key:"getQuestDescription",value:function(e){return this.get("quest-".concat(Object(c.a)(e),"-description"))}},{key:"getResourceName",value:function(e){return this.get("resource-".concat(e,"-name"))}},{key:"getItemName",value:function(e){return this.get("item-".concat(Object(c.a)(e),"-name"))}},{key:"getItemType",value:function(e){return this.get("item-type-".concat(Object(c.a)(i.a[e])))}},{key:"getItemSubtext",value:function(e){return this.getDefault("item-".concat(Object(c.a)(e),"-subtext"))}},{key:"getStructureName",value:function(e){return this.get("structure-".concat(Object(c.a)(e),"-name"))}},{key:"getTraitName",value:function(e){return this.get("trait-".concat(Object(c.a)(e),"-name"))}},{key:"getTraitDescription",value:function(e){return this.get("trait-".concat(Object(c.a)(e),"-description"))}},{key:"getTraitEffect",value:function(e){return this.get("trait-".concat(Object(c.a)(e),"-effect"))}},{key:"getToastType",value:function(e){return this.get("ui-toast-type-".concat(Object(c.a)(u.a[e])))}},{key:"getWeaponType",value:function(e){return this.get("ui-weapon-type-".concat(Object(c.a)(d.c[e])))}},{key:"getSkillName",value:function(e){return this.get("skill-".concat(Object(c.a)(d.c[e]),"-name"))}},{key:"getSkillInfo",value:function(e){return this.get("skill-".concat(Object(c.a)(d.c[e]),"-info"))}},{key:"getWeaponClassification",value:function(e){return this.get("ui-weapon-class-".concat(Object(c.a)(d.b[e])))}},{key:"printNotFounds",value:function(){this.notFound.length&&(console.log("TextManager strings not found:"),console.log('"'+this.notFound.join('": "",\n"')+'": ""'))}},{key:"compileAll",value:function(){var e=this;Object.keys(this.texts).forEach((function(t){e.compile(t,e.texts[t])}))}},{key:"compile",value:function(e,t){var n=s.compile(t);this.templates[e]=n}}]),e}();p.initialized=!1,p.texts=void 0,p.templates=void 0,p.notFound=void 0,s.registerHelper("item:name",(function(e,t){if(!Object(o.c)(e))return new s.SafeString("<<ITEM DEFINITION NOT FOUND: ".concat(e,">>"));switch(t){case"aA":return h(e);case"aD":case"aU":return v(e);default:return new s.SafeString(e)}})),s.registerHelper("structure:name",(function(e){var t=p.get("structure-".concat(Object(c.a)(e),"-name"));return new s.SafeString(t)})),s.registerHelper("structure:link",(function(e){var t=p.get("structure-".concat(Object(c.a)(e),"-name")),n=Object(m.b)(e);return new s.SafeString("[".concat(t,"](#").concat(n,")"))})),s.registerHelper("resource:name",(function(e){var t=p.get("resource-".concat(e,"-name"));return new s.SafeString(t)}));var h=function(e){return b(e)},b=function(e){var t=p.getItemName(e),n=p.getTemplate("common-article-undefined");return new s.SafeString("".concat(n({noun:t})))},v=function(e){var t=p.getItemName(e),n=p.getTemplate("common-article-defined");return new s.SafeString("".concat(n({noun:t})))}},30:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o}));var a=function(){return"/world"},r=function(e){return"".concat(a(),"/").concat(e)},c=function(){return"/town"},o=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"".concat(c(),"/").concat(e).concat(t?"":"/view")}},305:function(e){e.exports=JSON.parse('{"alchemist":[{"shape":[34,18,31,1,37,0]},{"shape":[37,0,53,5,45,17]},{"shape":[45,17,68,27,81,48]},{"shape":[72,67,75,168,11,168]},{"shape":[9,65,1,45,10,30]},{"shape":[31,19,29,5,45,0]},{"shape":[45,0,34,18,37,0]},{"shape":[45,17,81,48,72,67]},{"shape":[72,67,11,168,9,65]},{"shape":[9,65,10,30,31,19]},{"shape":[45,17,72,67,9,65]},{"shape":[9,65,31,19,45,0]},{"shape":[37,0,45,17,9,65]}],"garden":[{"shape":[48,45,48,0,58,0]},{"shape":[57,41,75,56,73,78]},{"shape":[73,78,11,68,2,56]},{"shape":[2,56,13,45,48,45]},{"shape":[48,45,58,0,57,41]},{"shape":[73,78,2,56,48,45]},{"shape":[48,45,57,41,73,78]}],"armoursmith":[{"shape":[53,1,55,0,93,5]},{"shape":[93,5,112,11,120,20]},{"shape":[120,20,124,36,119,49]},{"shape":[119,49,122,156,75,149]},{"shape":[75,149,57,135,33,104]},{"shape":[33,104,10,95,11,52]},{"shape":[11,52,0,35,2,20]},{"shape":[2,20,6,14,27,5]},{"shape":[27,5,53,1,93,5]},{"shape":[93,5,120,20,119,49]},{"shape":[119,49,75,149,33,104]},{"shape":[33,104,11,52,2,20]},{"shape":[2,20,27,5,93,5]},{"shape":[93,5,119,49,33,104]},{"shape":[33,104,2,20,93,5]}],"lumberMill":[{"shape":[32,11,43,1,45,0]},{"shape":[45,0,49,4,37,18]},{"shape":[39,29,50,44,49,48]},{"shape":[38,46,38,230,17,233]},{"shape":[17,233,13,232,13,48]},{"shape":[13,48,3,48,14,28]},{"shape":[14,28,1,7,6,4]},{"shape":[31,18,32,11,45,0]},{"shape":[39,29,49,48,40,43]},{"shape":[38,46,17,233,13,48]},{"shape":[14,28,6,4,19,18]},{"shape":[31,18,45,0,37,18]},{"shape":[37,18,39,29,40,43]},{"shape":[40,43,38,46,13,48]},{"shape":[13,48,14,28,19,18]},{"shape":[31,18,37,18,40,43]},{"shape":[40,43,13,48,19,18]},{"shape":[19,18,31,18,40,43]}],"mine":[{"shape":[15,0,79,1,88,13]},{"shape":[88,13,78,66,27,70]},{"shape":[27,70,2,50,11,27]},{"shape":[11,27,6,13,15,0]},{"shape":[15,0,88,13,27,70]},{"shape":[27,70,11,27,15,0]}],"quarry":[{"shape":[2,24,20,2,22,0]},{"shape":[22,0,103,2,117,15]},{"shape":[117,15,124,24,112,24]},{"shape":[112,24,112,64,104,70]},{"shape":[104,70,104,89,97,88]},{"shape":[97,68,66,67,60,43]},{"shape":[60,43,17,42,17,26]},{"shape":[17,26,2,24,22,0]},{"shape":[22,0,117,15,112,24]},{"shape":[112,24,104,70,97,88]},{"shape":[60,43,17,26,22,0]},{"shape":[112,24,97,88,97,68]},{"shape":[97,68,60,43,22,0]},{"shape":[22,0,112,24,97,68]}],"tannery":[{"shape":[4,2,4,0,61,1]},{"shape":[59,36,89,37,85,79]},{"shape":[85,79,15,77,15,47]},{"shape":[15,47,5,35,0,9]},{"shape":[0,9,4,2,61,1]},{"shape":[59,36,85,79,15,47]},{"shape":[15,47,0,9,61,1]},{"shape":[61,1,59,36,15,47]}],"tavern":[{"shape":[110,27,108,24,112,23]},{"shape":[112,23,151,27,148,60]},{"shape":[148,60,137,71,133,67]},{"shape":[133,67,136,69,132,75]},{"shape":[132,75,137,77,138,124]},{"shape":[131,131,136,136,55,119]},{"shape":[29,64,6,72,0,69]},{"shape":[27,56,76,61,85,67]},{"shape":[101,25,108,13,112,17]},{"shape":[112,17,102,18,104,6]},{"shape":[110,27,112,23,148,60]},{"shape":[132,75,138,124,131,131]},{"shape":[131,131,55,119,59,118]},{"shape":[29,64,0,69,27,56]},{"shape":[112,17,104,6,111,9]},{"shape":[92,27,110,27,148,60]},{"shape":[132,75,131,131,59,118]},{"shape":[50,68,29,64,27,56]},{"shape":[92,27,148,60,133,67]},{"shape":[133,67,132,75,59,118]},{"shape":[50,68,27,56,85,67]},{"shape":[133,67,59,118,56,72]},{"shape":[56,72,50,68,85,67]},{"shape":[133,67,56,72,85,67]},{"shape":[133,67,85,67,89,60]},{"shape":[92,27,133,67,89,60]},{"shape":[92,27,89,60,86,25]},{"shape":[104,0,92,27,86,25]}],"warehouse":[{"shape":[36,414,3,409,2,13]},{"shape":[2,13,31,-7,63,7]},{"shape":[62,197,63,126,65,218]},{"shape":[61,262,83,272,84,459]},{"shape":[84,459,36,414,2,13]},{"shape":[2,13,63,7,62,197]},{"shape":[62,197,65,218,61,262]},{"shape":[61,262,84,459,2,13]},{"shape":[2,13,62,197,61,262]}],"weaponsmith":[{"shape":[52,18,50,2,50,0]},{"shape":[50,0,114,1,109,49]},{"shape":[109,49,115,132,98,129]},{"shape":[98,129,66,95,65,34]},{"shape":[11,33,11,77,0,77]},{"shape":[0,29,18,18,52,18]},{"shape":[52,18,50,0,109,49]},{"shape":[109,49,98,129,65,34]},{"shape":[11,33,0,77,0,29]},{"shape":[52,18,109,49,65,34]},{"shape":[15,27,11,33,0,29]},{"shape":[52,18,65,34,53,26]},{"shape":[15,27,0,29,52,18]},{"shape":[52,18,53,26,15,27]}],"weaver":[{"shape":[51,41,54,0,55,6]},{"shape":[55,41,82,53,87,63]},{"shape":[87,63,86,259,62,254]},{"shape":[62,254,23,212,21,61]},{"shape":[21,61,2,56,51,41]},{"shape":[51,41,55,6,55,41]},{"shape":[55,41,87,63,62,254]},{"shape":[62,254,21,61,51,41]},{"shape":[51,41,55,41,62,254]}],"workshop":[{"shape":[11,2,13,0,68,3]},{"shape":[68,3,77,12,70,14]},{"shape":[70,14,69,38,10,37]},{"shape":[9,13,1,12,11,2]},{"shape":[11,2,68,3,70,14]},{"shape":[70,14,10,37,9,13]},{"shape":[9,13,11,2,70,14]}]}')},306:function(e){e.exports=JSON.parse('{"alpha":{"start":0.25,"end":0},"scale":{"start":0.04,"end":0.29,"minimumScaleMultiplier":1},"color":{"start":"#85888d","end":"#100f0c"},"speed":{"start":100,"end":200,"minimumSpeedMultiplier":1},"acceleration":{"x":10,"y":-30},"maxSpeed":200,"startRotation":{"min":265,"max":270},"noRotation":false,"rotationSpeed":{"min":8,"max":0},"lifetime":{"min":0.5,"max":3.05},"blendMode":"normal","frequency":0.0005,"emitterLifetime":-1,"maxParticles":300,"pos":{"x":0,"y":0},"addAtBack":true,"spawnType":"point"}')},32:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return g}));var a,r,c,o,i=n(13),s=n(10),u=n(28),l=n(23),d=u.a.weapon,m="/img/items/weapons/";!function(e){e.axe="axe",e.bow="bow",e.club="club",e.crossbow="crossbow",e.fist="fist",e.flail="flail",e.hammer="hammer",e.knife="knife",e.staff="staff",e.shield="shield",e.sword="sword",e.poleArm="poleArm"}(r||(r={})),function(e){e[e.aimedShot=0]="aimedShot",e[e.swing=1]="swing",e[e.block=2]="block",e[e.cut=3]="cut",e[e.cleave=4]="cleave",e[e.shoot=5]="shoot",e[e.slash=6]="slash",e[e.parry=7]="parry"}(c||(c={})),function(e){e[e.oneHanded=0]="oneHanded",e[e.mainHand=1]="mainHand",e[e.offHand=2]="offHand",e[e.twoHanded=3]="twoHanded",e[e.shield=4]="shield"}(o||(o={}));var p,h=(a={},Object(s.a)(a,r.axe,{classification:o.oneHanded,abilities:[c.cut]}),Object(s.a)(a,r.bow,{classification:o.oneHanded,abilities:[c.shoot]}),Object(s.a)(a,r.club,{classification:o.oneHanded,abilities:[c.swing,c.parry]}),Object(s.a)(a,r.crossbow,{classification:o.mainHand,abilities:[c.aimedShot,c.shoot]}),Object(s.a)(a,r.fist,{classification:o.oneHanded,abilities:[c.swing]}),Object(s.a)(a,r.flail,{classification:o.mainHand,abilities:[c.swing,c.parry]}),Object(s.a)(a,r.hammer,{classification:o.oneHanded,abilities:[c.swing,c.parry]}),Object(s.a)(a,r.knife,{classification:o.oneHanded,abilities:[c.cut,c.parry]}),Object(s.a)(a,r.staff,{classification:o.twoHanded,abilities:[c.swing,c.parry]}),Object(s.a)(a,r.sword,{classification:o.oneHanded,abilities:[c.swing,c.parry]}),Object(s.a)(a,r.poleArm,{classification:o.twoHanded,abilities:[c.swing,c.parry]}),Object(s.a)(a,r.shield,{classification:o.shield,abilities:[c.block]}),a);!function(e){e.kinetic="kinetic"}(p||(p={}));var b={aegisOfValor:{itemType:d,weaponType:r.shield,rarity:l.a.legendary,iconImg:"".concat(m,"aegis-of-valor.png")},arbalest:{itemType:d,weaponType:r.crossbow,rarity:l.a.epic,iconImg:"".concat(m,"arbalest.png"),damage:Object(s.a)({},p.kinetic,40)},battleAxe:{itemType:d,weaponType:r.axe,rarity:l.a.common,iconImg:"".concat(m,"battle-axe.png"),damage:Object(s.a)({},p.kinetic,20)},berserkerShield:{itemType:d,weaponType:r.shield,rarity:l.a.epic,iconImg:"".concat(m,"berserker-shield.png")},brassKnuckles:{itemType:d,weaponType:r.fist,iconImg:"".concat(m,"brass-knuckles.png"),rarity:l.a.common,damage:Object(s.a)({},p.kinetic,10)},bronzeDagger:{itemType:d,weaponType:r.knife,iconImg:"".concat(m,"bronze-dagger.png"),rarity:l.a.common,damage:Object(s.a)({},p.kinetic,8)},buckler:{itemType:d,weaponType:r.shield,rarity:l.a.common,iconImg:"".concat(m,"buckler.png")},cleaver:{itemType:d,weaponType:r.knife,iconImg:"".concat(m,"cleaver.png"),rarity:l.a.common,damage:Object(s.a)({},p.kinetic,5)},club:{itemType:d,weaponType:r.club,iconImg:"".concat(m,"club.png"),rarity:l.a.common,damage:Object(s.a)({},p.kinetic,8)},dagger:{itemType:d,weaponType:r.knife,iconImg:"".concat(m,"dagger.png"),rarity:l.a.rare,damage:Object(s.a)({},p.kinetic,10)},dirk:{itemType:d,weaponType:r.knife,iconImg:"".concat(m,"dirk.png"),rarity:l.a.uncommon,damage:Object(s.a)({},p.kinetic,10)},falchion:{itemType:d,weaponType:r.sword,iconImg:"".concat(m,"falchion.png"),rarity:l.a.rare,damage:Object(s.a)({},p.kinetic,12)},flail:{itemType:d,weaponType:r.flail,iconImg:"".concat(m,"flail.png"),rarity:l.a.uncommon,damage:Object(s.a)({},p.kinetic,15)},goldenShield:{itemType:d,weaponType:r.shield,rarity:l.a.rare,iconImg:"".concat(m,"golden-shield.png")},greatswordOfGwai:{itemType:d,weaponType:r.sword,iconImg:"".concat(m,"greatsword-gwai.png"),unique:!0,rarity:l.a.legendary,damage:Object(s.a)({},p.kinetic,25)},halbert:{itemType:d,weaponType:r.poleArm,iconImg:"".concat(m,"halbert.png"),rarity:l.a.rare,damage:Object(s.a)({},p.kinetic,12)},huntingBow:{itemType:d,weaponType:r.bow,iconImg:"".concat(m,"hunting-bow.png"),rarity:l.a.common,damage:Object(s.a)({},p.kinetic,3)},indomitableCarapace:{itemType:d,weaponType:r.shield,rarity:l.a.epic,unique:!0,iconImg:"".concat(m,"indomitable-carapace.png")},jaggedBlade:{itemType:d,weaponType:r.knife,rarity:l.a.epic,iconImg:"".concat(m,"jagged-blade.png")},javelin:{itemType:d,weaponType:r.poleArm,iconImg:"".concat(m,"javelin.png"),rarity:l.a.epic,damage:Object(s.a)({},p.kinetic,25)},khopesh:{itemType:d,weaponType:r.sword,iconImg:"".concat(m,"khopesh.png"),rarity:l.a.epic,damage:Object(s.a)({},p.kinetic,15)},legionnaireSword:{itemType:d,weaponType:r.sword,iconImg:"".concat(m,"legionnaire-sword.png"),rarity:l.a.rare,damage:Object(s.a)({},p.kinetic,8)},longbow:{itemType:d,weaponType:r.bow,iconImg:"".concat(m,"longbow.png"),rarity:l.a.rare,damage:Object(s.a)({},p.kinetic,2)},mace:{itemType:d,weaponType:r.club,iconImg:"".concat(m,"mace.png"),rarity:l.a.rare,damage:Object(s.a)({},p.kinetic,15)},morningStar:{itemType:d,weaponType:r.club,iconImg:"".concat(m,"morning-star.png"),rarity:l.a.uncommon,damage:Object(s.a)({},p.kinetic,13)},paintedBuckler:{itemType:d,weaponType:r.shield,iconImg:"".concat(m,"painted-buckler.png")},poisonedDagger:{itemType:d,weaponType:r.knife,iconImg:"".concat(m,"poisoned-dagger.png"),rarity:l.a.epic,damage:Object(s.a)({},p.kinetic,12)},pikeStaff:{itemType:d,weaponType:r.poleArm,iconImg:"".concat(m,"pike-staff.png"),rarity:l.a.uncommon,damage:Object(s.a)({},p.kinetic,22)},ravenStaff:{itemType:d,weaponType:r.staff,iconImg:"".concat(m,"raven-staff.png"),rarity:l.a.epic,damage:Object(s.a)({},p.kinetic,13)},scythe:{itemType:d,weaponType:r.poleArm,iconImg:"".concat(m,"scythe.png"),rarity:l.a.common,damage:Object(s.a)({},p.kinetic,5)},savageStaff:{itemType:d,weaponType:r.staff,iconImg:"".concat(m,"savage-staff.png"),rarity:l.a.epic,damage:Object(s.a)({},p.kinetic,8)},simpleCrossbow:{itemType:d,weaponType:r.crossbow,iconImg:"".concat(m,"crossbow.png"),rarity:l.a.common,damage:Object(s.a)({},p.kinetic,3)},spear:{itemType:d,weaponType:r.poleArm,iconImg:"".concat(m,"spear.png"),rarity:l.a.rare,damage:Object(s.a)({},p.kinetic,10)},steelShield:{itemType:d,weaponType:r.shield,rarity:l.a.rare,iconImg:"".concat(m,"steel-shield.png")},steelSword:{itemType:d,weaponType:r.sword,iconImg:"".concat(m,"steel-sword.png"),rarity:l.a.uncommon,damage:Object(s.a)({},p.kinetic,14)},warhammer:{itemType:d,weaponType:r.hammer,iconImg:"".concat(m,"warhammer.png"),rarity:l.a.rare,damage:Object(s.a)({},p.kinetic,16)},woodenBulwark:{itemType:d,weaponType:r.shield,rarity:l.a.common,iconImg:"".concat(m,"wooden-bulwark.png")}},v=Object.entries(b).reduce((function(e,t){var n=Object(i.a)(t,2),a=n[0],r=n[1];return e["".concat("weapon/").concat(a)]=r,e}),{});function f(e){return v[e]}t.e=v;var g=function(e){return!!v[e]}},33:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return r})),n.d(t,"l",(function(){return c})),n.d(t,"j",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"k",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return h}));var a=function(e,t){return{type:"launchQuest",questName:e,assignedAventurers:t}},r=function(e){return{type:"exitEncounter",questName:e}},c=function(e,t){return{type:"updateQuestVars",questName:e,vars:t}},o=function(e,t){return{type:"setSceneName",questName:e,sceneName:t}},i=function(e,t){return{type:"setScene",questName:e,scene:t}},s=function(e,t){return{type:"enqueueSceneAction",questName:e,sceneAction:t}},u=function(e){return{type:"completeSceneAction",questName:e}},l=function(e,t){return{type:"setCombat",questName:e,combat:t}},d=function(e){return{type:"endPlayerTurn",questName:e}},m=function(e,t){return{type:"startTurn",questName:e,turn:t}},p=function(e,t,n){return{type:"deductActorAp",questName:e,actor:t,ap:n}},h=function(e,t){return{type:"setActiveSceneInteractionModal",questName:e,sceneInteractionModal:t}}},338:function(e,t,n){},35:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var a,r={ADVENTURER:"adventurer",ITEM:"item"};!function(e){e[e.adventurerInventory=0]="adventurerInventory",e[e.warehouse=1]="warehouse",e[e.tavern=2]="tavern",e[e.adventurerEquipment=3]="adventurerEquipment",e[e.lootCache=4]="lootCache",e[e.resourceStructure=5]="resourceStructure"}(a||(a={}))},361:function(e,t,n){},366:function(e,t,n){},367:function(e,t,n){},368:function(e,t,n){},369:function(e,t,n){},370:function(e,t,n){},371:function(e,t,n){},383:function(e,t,n){},384:function(e,t,n){},385:function(e,t,n){},386:function(e,t,n){},387:function(e,t,n){},388:function(e,t,n){},389:function(e,t,n){},40:function(e,t,n){"use strict";n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return M}));var a=n(2),r=n(83),c=n(102),o=n(13),i=n(28),s=i.a.herb,u="/img/items/herbs/",l={angelicasSorrow:{itemType:s,iconImg:"".concat(u,"angelicas-sorrow.png")},bansheeReeds:{itemType:s,iconImg:"".concat(u,"banshee-reeds.png")},blissflower:{itemType:s,iconImg:"".concat(u,"blissflower.png")},bloodLotus:{itemType:s,iconImg:"".concat(u,"blood-lotus.png")},bogroot:{itemType:s,iconImg:"".concat(u,"bogroot.png")},ceviorise:{itemType:s,iconImg:"".concat(u,"ceviorise.png")},chicory:{itemType:s,iconImg:"".concat(u,"chicory.png")},dragonroot:{itemType:s,iconImg:"".concat(u,"dragonroot.png")},heartsVine:{itemType:s,iconImg:"".concat(u,"hearts-vine.png")},hyacinthus:{itemType:s,iconImg:"".concat(u,"hyacinthus.png")},jaboticaba:{itemType:s,iconImg:"".concat(u,"jaboticaba.png")},kingsrose:{itemType:s,iconImg:"".concat(u,"kingsrose.png")},lastSupper:{itemType:s,iconImg:"".concat(u,"last-supper.png")},mistagold:{itemType:s,iconImg:"".concat(u,"mistagold.png")},monksweed:{itemType:s,iconImg:"".concat(u,"monksweed.png")},moonFlower:{itemType:s,iconImg:"".concat(u,"moon-flower.png")},mountainGrass:{itemType:s,iconImg:"".concat(u,"mountain-grass.png")},oakLeaf:{itemType:s,iconImg:"".concat(u,"oak-leaf.png")},patricksroot:{itemType:s,iconImg:"".concat(u,"patricksroot.png")},sunleaf:{itemType:s,iconImg:"".concat(u,"sunleaf.png")},trollsFeast:{itemType:s,iconImg:"".concat(u,"trolls-feast.png")},uwolic:{itemType:s,iconImg:"".concat(u,"uwolic.png")},wyrmvine:{itemType:s,iconImg:"".concat(u,"wyrmvine.png")},winterWeed:{itemType:s,iconImg:"".concat(u,"winter-weed.png")},wizardsBane:{itemType:s,iconImg:"".concat(u,"wizards-bane.png")}},d=Object.entries(l).reduce((function(e,t){var n=Object(o.a)(t,2),a=n[0],r=n[1];return e["".concat("herb/").concat(a)]=r,e}),{}),m=d;var p=i.a.material,h="/img/items/materials/",b={arrowheads:{itemType:p,iconImg:"".concat(h,"arrowheads.png")},beam:{itemType:p,iconImg:"".concat(h,"beam.png")},bolts:{itemType:p,iconImg:"".concat(h,"bolts.png")},buckle:{itemType:p,iconImg:"".concat(h,"buckle.png")},chain:{itemType:p,iconImg:"".concat(h,"chain.png")},cogs:{itemType:p,iconImg:"".concat(h,"cogs.png")},gunpowder:{itemType:p,iconImg:"".concat(h,"gunpowder.png")},ingot:{itemType:p,iconImg:"".concat(h,"ingot.png")},nails:{itemType:p,iconImg:"".concat(h,"nails.png")},pile:{itemType:p,iconImg:"".concat(h,"pile.png")},planks:{itemType:p,iconImg:"".concat(h,"planks.png")},poisonVial:{itemType:p,iconImg:"".concat(h,"poison-vial.png")},pulley:{itemType:p,iconImg:"".concat(h,"pulley.png")},ribbon:{itemType:p,iconImg:"".concat(h,"ribbon.png")},rope:{itemType:p,iconImg:"".concat(h,"rope.png")},runeCarvedPlank:{itemType:p,iconImg:"".concat(h,"rune-carved-plank.png")},scales:{itemType:p,iconImg:"".concat(h,"scales.png")},spring:{itemType:p,iconImg:"".concat(h,"spring.png")},stake:{itemType:p,iconImg:"".concat(h,"stake.png")},stick:{itemType:p,iconImg:"".concat(h,"stick.png")},thread:{itemType:p,iconImg:"".concat(h,"thread.png")},woodenMask:{itemType:p,iconImg:"".concat(h,"wooden-mask.png")}},v=Object.entries(b).reduce((function(e,t){var n=Object(o.a)(t,2),a=n[0],r=n[1];return e["".concat("material/").concat(a)]=r,e}),{}),f=v;var g=i.a.mineral,j="/img/items/minerals/",O={amethyst:{itemType:g,iconImg:"".concat(j,"amethyst.png")},aquamarine:{itemType:g,iconImg:"".concat(j,"aquamarine.png")},arminsHeart:{itemType:g,iconImg:"".concat(j,"armins-heart.png")},dragonsTooth:{itemType:g,iconImg:"".concat(j,"dragons-tooth.png")},greenOpal:{itemType:g,iconImg:"".concat(j,"green-opal.png")},jasper:{itemType:g,iconImg:"".concat(j,"jasper.png")},malachite:{itemType:g,iconImg:"".concat(j,"malachite.png")},moonstone:{itemType:g,iconImg:"".concat(j,"moonstone.png")},obsidian:{itemType:g,iconImg:"".concat(j,"obsidian.png")},roseQuartz:{itemType:g,iconImg:"".concat(j,"rose-quartz.png")},sapphire:{itemType:g,iconImg:"".concat(j,"sapphire.png")},spellstone:{itemType:g,iconImg:"".concat(j,"spellstone.png")},tigersEye:{itemType:g,iconImg:"".concat(j,"tigers-eye.png")},topaz:{itemType:g,iconImg:"".concat(j,"topaz.png")},wyrdstone:{itemType:g,iconImg:"".concat(j,"wyrdstone.png")}},y=Object.entries(O).reduce((function(e,t){var n=Object(o.a)(t,2),a=n[0],r=n[1];return e["".concat("mineral/").concat(a)]=r,e}),{}),w=y;var x=n(98),k=n(126),T=i.a.trinket,N="/img/items/trinkets/",I={magicAmulet:{itemType:T,iconImg:"".concat(N,"magic_amulet.png")},ring:{itemType:T,iconImg:"".concat(N,"ring.png")}},S=Object.entries(I).reduce((function(e,t){var n=Object(o.a)(t,2),a=n[0],r=n[1];return e["".concat("trinket/").concat(a)]=r,e}),{}),q=S;var C=n(32),A=Object(a.a)(Object(a.a)(Object(a.a)(Object(a.a)(Object(a.a)(Object(a.a)(Object(a.a)(Object(a.a)(Object(a.a)({},r.a),c.a),m),f),w),x.a),k.a),q),C.e),E=(t.a=A,function(e){return A[e]}),M=function(e){switch(e){case i.a.apparel:return Object.keys(r.a);case i.a.deed:return Object.keys(c.a);case i.a.herb:return Object.keys(m);case i.a.material:return Object.keys(f);case i.a.mineral:return Object.keys(w);case i.a.potion:return Object.keys(x.a);case i.a.questItem:return Object.keys(k.a);case i.a.trinket:return Object.keys(q);case i.a.weapon:return Object.keys(C.e)}}},41:function(e,t,n){"use strict";var a,r;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c})),function(e){e[e.player=0]="player",e[e.enemy=1]="enemy"}(a||(a={})),function(e){e.move="move",e.slash="slash",e.shoot="shoot"}(r||(r={}));var c={actors:[{allegiance:a.player,health:100,location:[3,5],name:"c4a5d270",remainingAP:5},{allegiance:a.player,health:100,location:[4,6],name:"2e655832",remainingAP:4}],turn:a.player}},44:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return i}));var a,r=function(e){return e?e.reduce((function(e,t){return e[t.name]=t.value,e}),{}):{}};!function(e){e.adventurerStart="adventurerStart",e.exit="exit",e.actor="actor",e.enemySpawn="enemySpawn"}(a||(a={}));var c=function(e,t){for(var n,a=t.length-1;a>=0&&!((n=t[a]).firstgid<=e);a--);return n},o=function(e,t,n){t.data.reduce((function(e,t,a){if(t>0){var r=a%n,c=Math.floor(a/n);e.push([r,c])}return e}),e)},i=function(e,t){return e[0]===t[0]&&e[1]===t[1]}},46:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.common=0]="common",e[e.town=1]="town",e[e.quest=2]="quest"}(a||(a={}))},48:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return u}));var a=function(e,t){return{type:"drinkPotion",adventurerId:e,fromSlot:t}},r=function(e,t,n){return{type:"moveItemInInventory",adventurerId:e,fromSlot:t,toSlot:n}},c=function(e,t,n){return{type:"addItemToInventory",adventurerId:e,item:t,toSlot:n}},o=function(e,t){return{type:"removeItemFromInventory",adventurerId:e,fromSlot:t}},i=function(e,t,n){return{type:"assignEquipment",adventurerId:e,item:n,equipmentSlot:t}},s=function(e,t){return{type:"removeEquipment",adventurerId:e,equipmentSlot:t}},u=function(e,t){return{type:"renameAdventurer",adventurerId:e,name:t}}},49:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var a=n(29),r=n(25),c=n(26),o=n(39),i=n(37),s=n(8),u=n(82),l=n.n(u),d=n(22),m="toast",p=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,null,[{key:"addToast",value:function(e,t,n,r){var c=this;this.stack=[].concat(Object(a.a)(this.stack),[{time:Date.now(),title:e,type:t,icon:n,link:r}]),this.instance.emit(m,this.stack),d.c.playSound("ui/toast"),setTimeout((function(){c.stack=c.stack.filter((function(e){return Date.now()-e.time<c.lifeTime})),c.instance.emit(m,c.stack)}),this.lifeTime)}},{key:"instance",get:function(){return this._instance}}]),n}(l.a);p._instance=new p,p.stack=[],p.lifeTime=s.a},494:function(e,t,n){},495:function(e,t,n){},496:function(e,t,n){},497:function(e,t,n){},498:function(e,t,n){"use strict";n.r(t),n.d(t,"DungeonEntranceSceneController",(function(){return b})),n.d(t,"DungeonHallwaySceneController",(function(){return v}));var a=n(2),r=n(26),c=n(56),o=n(45),i=n(25),s=n(39),u=n(37),l=n(146),d=n(127),m=n(33),p=n(22),h=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return n}(l.a),b=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).jsonPath="scenes/ork-dungeon-level1.json",e}return Object(r.a)(n,[{key:"getLootCache",value:function(e){return this.questVars.dungeon.entrance.chest}},{key:"takeGoldFromCache",value:function(e){Object(c.a)(Object(o.a)(n.prototype),"takeGoldFromCache",this).call(this,e),this.updateQuestVars({dungeon:{entrance:{chest:{gold:0}}}})}},{key:"takeItemFromCache",value:function(e,t,a,r){Object(c.a)(Object(o.a)(n.prototype),"takeItemFromCache",this).call(this,e,t,a,r);var i=this.getLootCache(t);if(i){var s=i.items.filter((function(t,n){return n!==e}));this.updateQuestVars({dungeon:{entrance:{chest:{items:s}}}})}}},{key:"updateScene",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sceneObjects,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.combat;t=t.map((function(t){switch(t.name){case"chest":return Object(a.a)(Object(a.a)({},t),{},{gid:e.questVars.dungeon.entrance.chestOpen?34:33})}return t})),Object(c.a)(Object(o.a)(n.prototype),"updateScene",this).call(this,t,r)}},{key:"interactWithObject",value:function(e,t){switch(t.name){case"chest":if(!this.questVars.dungeon.entrance.chestOpen){var a,r={key:"quest-common-adventurer-opened-chest",context:{adventurer:null===(a=this.getAdventurerByActor(e))||void 0===a?void 0:a.name}};this.questUpdate(r,"/img/items/misc/chest-02.png"),this.updateQuestVars({dungeon:{entrance:{chestOpen:!0}}})}this.store.dispatch(Object(m.g)(this.questName,{type:"lootCache",lootCache:t.name}));break;case"altar":this.store.dispatch(Object(m.g)(this.questName,{type:"situation",situation:"altar"}))}Object(c.a)(Object(o.a)(n.prototype),"interactWithObject",this).call(this,e,t)}},{key:"sceneEntered",value:function(){this.questVars.dungeon.entered||this.questUpdate("quest-kill10-boars-enter-dungeon-see-chest")}},{key:"getSituation",value:function(e,t){return Object(c.a)(Object(o.a)(n.prototype),"getSituation",this).call(this,e,t)}},{key:"handleSituationOptionClick",value:function(e,t,n){}}]),n}(h),v=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(i.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).jsonPath="scenes/ork-dungeon-level2.json",e}return Object(r.a)(n,[{key:"getLootCache",value:function(e){return this.questVars.dungeon.hallway.chest}},{key:"sceneEntered",value:function(){}},{key:"interactWithObject",value:function(e,t){switch(t.name){case"chest":if(!this.questVars.dungeon.hallway.chestOpen){var a,r={key:"quest-common-adventurer-opened-chest",context:{adventurer:null===(a=this.getAdventurerByActor(e))||void 0===a?void 0:a.name}};this.questUpdate(r,"/img/items/misc/chest-02.png"),this.updateQuestVars({dungeon:{hallway:{chestOpen:!0}}})}this.store.dispatch(Object(m.g)(this.questName,{type:"lootCache",lootCache:t.name}));break;case"door1":this.questVars.dungeon.hallway.doorOpen||this.store.dispatch(Object(m.g)(this.questName,{type:"situation",situation:"door"}));break;case"latrine":this.questUpdate("quest-kill10-boars-dungeonentrance-latrine")}Object(c.a)(Object(o.a)(n.prototype),"interactWithObject",this).call(this,e,t)}},{key:"getSituation",value:function(e,t){switch(e){case"door":var a=this.getAdventurerById(t);return a&&a.inventory.some((function(e){return"questItem/key"===e}))?{title:"quest-kill10-boars-dungeonentrance-door",choices:["quest-common-scenerio-door-open"]}:{title:"quest-kill10-boars-dungeonentrance-door",text:"quest-kill10-boars-dungeonentrance-door-needs-key"};default:return Object(c.a)(Object(o.a)(n.prototype),"getSituation",this).call(this,e,t)}}},{key:"handleSituationOptionClick",value:function(e,t,n){switch(e){case"door":var a;this.updateQuestVars({dungeon:{hallway:{doorOpen:!0}}}),p.c.playSound("scene/doorOpen",p.a.scene,!1,p.b.singleInstance),this.discardItem("questItem/key",n);var r={key:"quest-common-adventurer-opened-door",context:{adventurer:null===(a=this.getAdventurerById(n))||void 0===a?void 0:a.name}};this.questUpdate(r,"/img/items/misc/chest-02.png"),this.dispatch(Object(m.g)(this.questName))}}},{key:"takeItemFromCache",value:function(e,t,a,r){Object(c.a)(Object(o.a)(n.prototype),"takeItemFromCache",this).call(this,e,t,a,r);var i=this.getLootCache(t);if(i){var s=i.items.filter((function(t,n){return n!==e}));this.updateQuestVars({dungeon:{hallway:{chest:{items:s}}}})}}},{key:"updateScene",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.sceneObjects,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.combat;t=t.map((function(t){switch(t.name){case"chest":return Object(a.a)(Object(a.a)({},t),{},{gid:e.questVars.dungeon.hallway.chestOpen?34:33});case"door1":if(e.questVars.dungeon.hallway.doorOpen){var n=Object(a.a)(Object(a.a)({},t.properties),{},{blocksMovement:!1,interactive:!1});return"upper"===t.properties.part?Object(a.a)(Object(a.a)({},t),{},{gid:228,properties:n}):Object(a.a)(Object(a.a)({},t),{},{gid:240,properties:n})}return"upper"===t.properties.part?Object(a.a)(Object(a.a)({},t),{},{gid:252}):Object(a.a)(Object(a.a)({},t),{},{gid:264})}return t})),Object(c.a)(Object(o.a)(n.prototype),"updateScene",this).call(this,t,r)}}]),n}(h);d.a.registerSceneController("kill10Boars","dungeon.entrance",b),d.a.registerSceneController("kill10Boars","dungeon.hallway",v)},50:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(1);var a,r=n(3),c=n(34),o=n(21),i=n(0);!function(e){e[e.achievementUnlocked=0]="achievementUnlocked",e[e.cheat=1]="cheat",e[e.game=2]="game",e[e.itemCrafted=3]="itemCrafted",e[e.questCompleted=4]="questCompleted",e[e.questEncounter=5]="questEncounter",e[e.questLaunched=6]="questLaunched",e[e.questUpdate=7]="questUpdate"}(a||(a={}));t.b=function(e){var t=e.title,n=e.type,s=void 0===n?a.achievementUnlocked:n,u=e.icon,l=void 0===u?"/img/items/quest-items/dragon-eye.png":u,d=e.link,m=Object(c.g)(),p=r.a.getToastType(s);return Object(i.jsxs)("div",{className:"toast ".concat(d?"withlink":""),onClick:function(){d&&m.push(d)},children:[Object(i.jsx)("div",{className:"label type",children:p}),Object(i.jsx)("div",{className:"label title",children:t}),Object(i.jsx)(o.b,{size:"big",image:l,className:"toast-icon",border:"gold"}),Object(i.jsx)("div",{className:"banner"})]})}},504:function(e,t,n){},505:function(e,t,n){},506:function(e,t,n){},507:function(e,t,n){},508:function(e,t,n){},509:function(e,t,n){},510:function(e,t,n){},511:function(e,t,n){},512:function(e,t,n){},513:function(e,t,n){},514:function(e,t,n){},515:function(e,t,n){},516:function(e,t,n){},517:function(e,t,n){},518:function(e,t,n){},519:function(e,t,n){},520:function(e,t,n){},521:function(e,t,n){},522:function(e,t,n){},523:function(e,t,n){},524:function(e,t,n){},525:function(e,t,n){},526:function(e,t,n){},527:function(e,t,n){},528:function(e,t,n){},529:function(e,t,n){},541:function(e,t,n){},545:function(e,t){},547:function(e,t){},557:function(e,t){},559:function(e,t){},584:function(e,t){},585:function(e,t){},590:function(e,t){},592:function(e,t){},599:function(e,t){},618:function(e,t){},636:function(e,t,n){},637:function(e,t,n){},638:function(e,t,n){},639:function(e,t,n){},640:function(e,t,n){},641:function(e,t,n){},642:function(e,t,n){},643:function(e,t,n){},644:function(e,t,n){},645:function(e,t,n){},646:function(e,t,n){},647:function(e,t,n){},648:function(e,t,n){},649:function(e,t,n){},650:function(e,t,n){},651:function(e,t,n){},652:function(e,t,n){},653:function(e,t,n){},654:function(e,t,n){},655:function(e,t,n){},656:function(e,t,n){},657:function(e,t,n){},665:function(e,t){},666:function(e,t,n){},667:function(e,t,n){"use strict";n.r(t),n.d(t,"runGame",(function(){return Io})),n.d(t,"restartGame",(function(){return No})),n.d(t,"loadGame",(function(){return To}));var a,r=n(29),c=n(42),o=n.n(c),i=n(60),s=n(1),u=n.n(s),l=n(101),d=n(12),m=n(89),p=n.n(m),h=n(70),b="0.0.6",v=b,f=function(e){var t=e.split(".").map((function(e){return Number(e)}));if(3!==t.length)throw new Error("Received invalid version string: ".concat(e));t.forEach((function(e){if(e>=1024)throw new Error("Version string invalid, ".concat(e," is too large"))}));for(var n=0,a=0;a<3;a++)n|=t[a]<<10*a;return n}(b);!function(e){e.clearCombatAction="clearCombatAction",e.startCombatAction="startCombatAction",e.moveActor="moveActor"}(a||(a={}));var g,j=n(41),O=function(e,t){var n=t.getState().combat;if(n.action&&n.action.endsAt<Date.now())if(n.turn===j.a.enemy);else if(n.turn===j.a.player){switch(n.action.type){case j.b.move:t.dispatch(function(e,t){return{type:a.moveActor,actor:e,location:t}}(n.action.actor,n.action.target)),t.dispatch({type:a.clearCombatAction})}return{action:null}}return null},y=n(13),w=n(11),x=n(675),k=n(317),T=n(68),N=n(34),I=n(674),S=n(59),q=n(22),C=n(3),A=n(303),E=n.n(A),M=n(304),D=n(30);!function(e){e[e.NotBuilt=0]="NotBuilt",e[e.Building=1]="Building",e[e.Built=2]="Built"}(g||(g={}));var R=n(25),P=n(26),_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";Object(R.a)(this,e),this.shapes=void 0,this.shapes=t[n].map((function(e){var t=e.shape;return new w.Polygon(t)}))}return Object(P.a)(e,[{key:"contains",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(!this.shapes||0===this.shapes.length)&&this.shapes.some((function(n){return n.contains(e,t)}))}}]),e}(),H=n(305),z=n(17),L=n(84),B=n(0),F=function(e){e.hitAreaShapes;var t="lumberMill",n="".concat(".","/img/town/town-alpha/").concat(t,".json"),a=Object(s.useState)(),r=Object(y.a)(a,2),c=r[0],o=r[1],i=e.selected?[Ea]:[],u=Object(z.useApp)();Object(s.useEffect)((function(){Object(L.b)(n,(function(e){e&&o(e.textures)}))}),[u,u.loader,n]);var l=Object(s.useState)(0),d=Object(y.a)(l,2),m=d[0],p=d[1];return Object(z.useTick)((function(e){return p((function(t){return t+.01*(null!==e&&void 0!==e?e:0)}))})),c?Object(B.jsx)(z.Sprite,{name:t,position:e.position,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(t)},filters:i,texture:c["structure.png"],children:Object(B.jsx)(z.Sprite,{name:"blades",texture:c["blades.png"],anchor:new w.Point(.5,.5),x:15,y:10,rotation:m})}):null},W=n(306),V=n(61),Q=n(307),G=Object(z.PixiComponent)("ParticleEmitter",{create:function(){return new w.ParticleContainer(256,{})},applyProps:function(e,t,n){var a=this,r=n.image,c=n.config,o=Object(V.a)(n,["image","config"]);Object(z.applyDefaultProps)(e,t,o);var i=this._emitter;if(!i){i=new Q.a(e,[w.Texture.from(r)],c);var s=performance.now();i.emit=!0,function e(){a._raf=requestAnimationFrame(e);var t=performance.now();i.update(3e-4*(t-s)),s=t}()}this._emitter=i},willUnmount:function(){this._emitter&&(this._emitter.emit=!1,cancelAnimationFrame(this._raf))}}),U=function(e){var t=e.hitAreaShapes,n=e.position,a="tavern",r=e.selected?[Ea]:[];return Object(B.jsxs)(z.Container,{position:n,children:[Object(B.jsx)(z.Sprite,{name:a,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(a)},filters:r,hitArea:t,image:"".concat(".","/img/town/town-alpha/").concat(a,".png")}),Object(B.jsx)(G,{name:"smoke",x:107,y:-2,image:"".concat(".","/img/town/effects/smokeparticle.png"),config:W})]})},X=n(2),Y=n(39),Z=n(37),J=function(e){return function(t){Object(Y.a)(a,t);var n=Object(Z.a)(a);function a(){return Object(R.a)(this,a),n.apply(this,arguments)}return Object(P.a)(a,[{key:"render",value:function(){var t=this;return Object(B.jsx)(qc.Consumer,{children:function(n){return Object(B.jsx)(e,Object(X.a)(Object(X.a)({},t.props),n))}})}}]),a}(s.Component)},K=function(e){var t=e.structure,n=e.position,a=e.hitAreaShapes,r=e.selected,c=e.onStructureClick,o=r?[Ea]:[];return Object(B.jsx)(z.Sprite,{name:t,position:n,interactive:!0,buttonMode:!0,pointertap:function(){c(t)},hitArea:a,filters:o,image:"".concat(".","/img/town/town-alpha/").concat(t,".png")})},$=(n(366),function(e){var t=e.structures,n=Object(N.j)("".concat(Object(D.c)(),"/:structure")),a=function(e){return(null===n||void 0===n?void 0:n.params.structure)===e?Object(B.jsx)("span",{className:"highlighted",children:"".concat(C.a.getStructureName(e))}):Object(B.jsx)(T.b,{to:Object(D.b)(e,!0),children:"".concat(C.a.getStructureName(e))})};return Object(B.jsx)("div",{className:"legenda",children:Object(B.jsx)("ul",{children:["workshop","quarry","tavern","tannery","alchemist","garden","weaponsmith","armoursmith","warehouse","mine","lumberMill","weaver"].map((function(e){return t[e].state===g.NotBuilt?null:Object(B.jsx)("li",{children:a(e)},e)}))})})}),ee=n(318),te=Object(s.forwardRef)((function(e,t){var n=Object(z.useApp)();if(n){var a="url('".concat("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAgCAYAAAABtRhCAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3gMODzc3YHmYGgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAE50lEQVRIx7WXW0wcVRjHfzO7y16YZbfAytACvbjU1hqkLVZMbbSXBEPUNjX6YDYanwYfTXzxrb7qm0lTJ018QhOjaWI0trFYbRoqpYVuwy2UpRS2lAF22YUdtuxt1ofKCIXShaZfMjm37+Q33zn/cxMURWHRVFXNAyiKIvCMTFwKO6Ne4ONPTpngZwoE6Lx6FYCDhwLPDLoMeKPtV8b6ewkEAssiVVU1v/gtLS+dhnUDFUUResZvUhLXuNF+ZVmkBw8F6B+4b5avXR8x82fUC+uCWhoaGsxCV1fXKZelGOvMNPcXspw9+zV60s3MzAweTwXJZBLJXYXPt8XMJ5NJbgX/pqGh4ctCgNalBUVRhId/u5tsQqf9UpDGxkZCoRCtra2mX2trK5qmAZhpoWZdrTIvCOyQihn8/RydsQSVm6uQJAnZ6zV9MjYbkUgEAL/fj6p+my9kOYmPViiKIgQn+8mLIv1jowSONtN0+OgyGEAkEkHXdTRNQ5Kkjal0qY3MJciLIsdOvslYXy9xbXxZu67rAEiSZOafCtgzfpM8Al2/deDEwJZOrYAu2lNFqKpq/rPjLTTtbWY0Psu1jovUVm7Hmk1jS6eYmXooEiH//0pYj3BWFc2RukM4HpxHMAz6x0aRvT1scfsYT0yTTwnEtXEsuQzxhbQ5j08F/O7H0+zz+ThQWsK52yGuBNs5XPcqllwOVzrOjv2HsZaXsuv1OtySnYSeort7kE+Vt56o1FWBo7EollwGQ7Sww13McHyWbE8n9VVVNLzWzMDkXSYGujl/uY1wNIamaciybO4+a0FXXRbd04P8PHydu/EYtmwaSy7NaCzOi0eO09F5kfk7/bhSSZ4T8zQ2NiLLMgCyLPPe+5+vudWtqlJFUYRF8MhsHNHIcXKnn86rfxK8P4Etk8G5kKR4YZ758F1OnDixrP9aUHGt8V6ExlMLbLP7GBoeAkGkxuWhKJfFlUoiJRNE7o0TCARM8UiS9NgjTnySqhRFEUZmR/jm5l9YsynGolG0RJQqpwd7OoU0P0dqZJD0TJyWlhZzU/D7/Txfe2wFVCxUzttLPNyaGEc0svx0+zZVW/cD4Eo/wJuIkevtwZiKLhteWZZXQAsGdk9PscluRzByODxlnL78Aw17mpDdZdizGUr0GNEbndRvKeeD5rcpLy83oRWVjeuLUFEUYTQ+jMfpwutw4CgpJVmzm6/++QVDtFDpLkU0DLxzUabbB6ir9vHGtp3mxi5JkhmluJ6zzONw/pfaMUSR0HyaL6530zYRBmBz7QFqj9YhSQ5efsXPQjxS2MJ/nJUUS8zEZ/G4nPSEQgyHLj08kCehtQuqy66w94/vEfIGNaVliEYGr6No40AAj9OBkDcYHmpb0RaO9hGO9lFdtodubQqAovQCG1IpgGgYlNlsbCqyrekXjvaZ+SlD3Dgwoc9hyWU4WP1SQf6lNbXouo6u6+ZtvmCgoihCcErDks2QCA3w4YF3ngjz+/1omsbkRMfG5nBkdoQ7bjeEe9hVVsZHe5u4FB7nXqTX9Kmvf5eKys3IskwwGGR4qG3ZW0VY+pgpxFRVze/zvcBWbylep5OMzY5hsVLsLiFd5MTqq+DedJRQKLQCtiHg0uv91k21uF1uPE4XhsVC1monlsqSmE8yOdGx6itsQ8BHwavN9+P6/Avf+1eTf20QhwAAAABJRU5ErkJggg==","'), auto");n.renderer.plugins.interaction.cursorStyles.pointer=a}return Object(B.jsx)(ne,Object(X.a)(Object(X.a)({app:n},e),{},{ref:t}))}));te.displayName="DisplayName";var ne=Object(z.PixiComponent)("Viewport",{create:function(e){var t=new ee.a({screenWidth:e.screenWidth,screenHeight:e.screenHeight,worldWidth:e.worldWidth,worldHeight:e.worldHeight,ticker:e.app.ticker,interaction:e.app.renderer.plugins.interaction});t.on("clicked",(function(t){e.onClick&&e.onClick(t)}));var n=e.minScale,a=void 0===n?1:n,r=e.maxScale,c=void 0===r?2:r;return t.drag().pinch().wheel().clamp({direction:"all"}).clampZoom({minScale:a,maxScale:c}).decelerate(),t}}),ae=te,re=n(308),ce=Object(s.forwardRef)((function(e,t){var n=e.children,a=e.screenWidth,r=e.screenHeight,c=e.worldWidth,o=e.worldHeight,i=Object(s.useRef)(null);return Object(s.useImperativeHandle)(t,(function(){return i.current})),Object(s.useEffect)((function(){if(ue.enabled=!1,i.current){var e=i.current;e.on("moved",(function(){var t=S.b.utils.normalize(e.screenWidth,c,e.right),n=S.b.utils.normalize(o,e.screenHeight,e.bottom),a=Math.max(t*n-.4,0);ue.gain=a,ue.lacunarity=2.4,ue.enabled=ue.gain>0}))}var t=function(e){e.preventDefault()};return window.addEventListener("wheel",t,{passive:!1}),function(){window.removeEventListener("wheel",t)}}),[o,c]),Object(B.jsx)(z.Stage,{width:a,height:r,options:se,children:Object(B.jsx)(ae,{screenWidth:a,screenHeight:r,worldWidth:c,worldHeight:o,ref:i,children:Object(B.jsx)(z.Sprite,{name:"background",image:"".concat(".","/img/town/town-alpha/background.png"),filters:[ue],children:n})})})}));ce.displayName="TownStage";var oe,ie=ce,se={autoDensity:!0,sharedLoader:!0},ue=new re.a,le=function(e){var t=e.speed,n=void 0===t?1:t,a=Object(s.useState)(de()),r=Object(y.a)(a,2),c=r[0],o=r[1],i="".concat(".","/img/town/clouds/cloud-0").concat(c,".png"),u=Object(s.useState)(-2e3),l=Object(y.a)(u,2),d=l[0],m=l[1],p=Object(s.useState)(me()),h=Object(y.a)(p,2),b=h[0],v=h[1];return Object(z.useTick)((function(t){d>e.worldWidth?(m(2e3-1e3*Math.random()),v(me()),o(de())):m(d+n*(t||1))})),Object(B.jsx)(z.Sprite,{image:i,alpha:.8,x:d,y:b})},de=function(){return Math.floor(2*Math.random())+1},me=function(){return-300*Math.random()-200},pe=n(8);!function(e){e[e.resource=0]="resource",e[e.production=1]="production",e[e.tavern=2]="tavern",e[e.warehouse=3]="warehouse"}(oe||(oe={}));var he,be,ve={type:oe.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-alchemist-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-alchemist-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},unlocks:[]},{displayName:"structure-alchemist-name",workerCapacity:10,cost:{gold:50,time:pe.g},unlocks:[]}]},fe={cost:{gold:40,time:4e3},type:oe.production,levels:[{displayName:"structure-armoursmith-name",workerCapacity:2,cost:{gold:0},unlocks:["apparel/boots1"]},{displayName:"structure-armoursmith-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},unlocks:["apparel/chest"]},{displayName:"structure-armoursmith-name",workerCapacity:10,cost:{gold:50,time:pe.g},unlocks:["apparel/cowl"]}]},ge={type:oe.resource,cost:{gold:40,time:4e3},levels:[{displayName:"structure-garden-name",workerCapacity:2,cost:{gold:0},generates:{food:2},harvest:{amount:3,lootTable:{"herb/bogroot":2,"herb/winterWeed":1}}},{displayName:"structure-garden-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},generates:{food:4},harvest:{amount:5,lootTable:{"herb/bogroot":2,"herb/winterWeed":1,"herb/hyacinthus":1,"herb/bloodLotus":1}}},{displayName:"structure-garden-name",workerCapacity:10,cost:{gold:50,time:pe.g},generates:{food:8}}]},je={type:oe.resource,cost:{gold:31,time:pe.c},levels:[{displayName:"structure-lumber-mill-name",workerCapacity:2,cost:{gold:0},generates:{wood:2}},{displayName:"structure-lumber-mill-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},generates:{wood:2}},{displayName:"structure-lumber-mill-name",workerCapacity:10,cost:{gold:50,time:pe.g},generates:{wood:2}}]},Oe={cost:{gold:40,time:4e3},type:oe.resource,levels:[{displayName:"structure-mine-name",workerCapacity:2,cost:{gold:0},generates:{iron:2},harvest:{amount:3,lootTable:{"mineral/roseQuartz":2,"mineral/topaz":1}}},{displayName:"structure-mine-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},generates:{iron:2},harvest:{amount:5,lootTable:{"mineral/roseQuartz":2,"mineral/topaz":2,"mineral/jasper":1,"mineral/greenOpal":1}}},{displayName:"structure-mine-name",workerCapacity:10,cost:{gold:50,time:pe.g},generates:{iron:2},harvest:{amount:5,lootTable:{"mineral/roseQuartz":1,"mineral/topaz":1,"mineral/jasper":1,"mineral/greenOpal":1,"mineral/malachite":1,"mineral/tigersEye":1}}}]},ye={cost:{gold:40,time:4e3},type:oe.resource,levels:[{displayName:"structure-quarry-name",workerCapacity:2,cost:{gold:0},generates:{stone:2}},{displayName:"structure-quarry-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},generates:{stone:4}},{displayName:"structure-quarry-name",workerCapacity:10,cost:{gold:50,time:pe.g},generates:{stone:6}}]},we={cost:{gold:40,time:4e3},type:oe.resource,levels:[{displayName:"structure-tannery-name",workerCapacity:2,cost:{gold:0},generates:{leather:2}},{displayName:"structure-tannery-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},generates:{leather:5}},{displayName:"structure-tannery-name",workerCapacity:10,cost:{gold:50,time:pe.g},generates:{leather:7}}]},xe={cost:{gold:40,time:4e3},type:oe.tavern,levels:[{displayName:"structure-tavern-name",workerCapacity:2,cost:{gold:0},rooms:10},{displayName:"structure-tavern-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},rooms:12},{displayName:"structure-tavern-name",workerCapacity:10,cost:{gold:50,time:pe.g},rooms:15}]},ke={cost:{gold:40,time:4e3},type:oe.warehouse,levels:[{displayName:"structure-warehouse-name",workerCapacity:2,cost:{gold:0},maxResources:{fabric:200,food:200,iron:200,leather:200,stone:200,wood:200},maxStockpile:16},{displayName:"structure-warehouse-name",workerCapacity:5,cost:{gold:13,resources:{wood:100,iron:100,stone:100},time:pe.b},maxResources:{fabric:500,food:500,iron:500,leather:500,stone:500,wood:500},maxStockpile:32},{displayName:"structure-warehouse-name",workerCapacity:10,cost:{gold:50,resources:{wood:200,iron:200,stone:200},time:5*pe.g},maxResources:{fabric:1e3,food:1e3,iron:1e3,leather:1e3,stone:1e3,wood:1e3},maxStockpile:48}]},Te={type:oe.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-weaponsmith-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:10,cost:{gold:50,time:pe.g},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:14,cost:{gold:50,time:pe.f},unlocks:["weapon/poisonedDagger"]}]},Ne={cost:{gold:40,time:4e3},type:oe.resource,levels:[{displayName:"structure-weaver-name",workerCapacity:2,cost:{gold:0},generates:{fabric:2}},{displayName:"structure-weaver-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},generates:{fabric:5}},{displayName:"structure-weaver-name",workerCapacity:10,cost:{gold:50,time:pe.f},generates:{fabric:7}}]},Ie={type:oe.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-workshop-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:5,cost:{gold:30,resources:{wood:100,iron:100,stone:100},time:pe.e},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:10,cost:{gold:50,time:pe.g},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:14,cost:{gold:50,time:pe.f},unlocks:[]}]},Se=n(10);!function(e){e.wood="wood",e.iron="iron",e.stone="stone",e.leather="leather",e.fabric="fabric",e.food="food"}(be||(be={}));var qe=(he={},Object(Se.a)(he,be.wood,{resource:be.wood,iconImg:"/img/resources/wood.png"}),Object(Se.a)(he,be.iron,{resource:be.iron,iconImg:"/img/resources/iron.png"}),Object(Se.a)(he,be.stone,{resource:be.stone,iconImg:"/img/resources/stone.png"}),Object(Se.a)(he,be.leather,{resource:be.leather,iconImg:"/img/resources/leather.png"}),Object(Se.a)(he,be.fabric,{resource:be.fabric,iconImg:"/img/resources/fabric.png"}),Object(Se.a)(he,be.food,{resource:be.food,iconImg:"/img/resources/food.png"}),he),Ce=function(e){return"alchemist"===e||"armoursmith"===e||"weaponsmith"===e||"workshop"===e},Ae=function(e){return"garden"===e||"lumberMill"===e||"mine"===e||"quarry"===e||"tannery"===e||"weaver"===e},Ee={alchemist:ve,armoursmith:fe,garden:ge,lumberMill:je,mine:Oe,quarry:ye,tavern:xe,tannery:we,warehouse:ke,weaponsmith:Te,weaver:Ne,workshop:Ie};function Me(e){return Ee[e]}function De(e){switch(e){case be.fabric:return"weaver";case be.food:return"garden";case be.iron:return"mine";case be.leather:return"tannery";case be.stone:return"quarry";case be.wood:return"lumberMill"}}var Re,Pe,_e=function(e){var t=Object(s.useCallback)((function(t){return t.structures[e]}),[e]);return Object(d.d)(t)},He=function(e){var t=Me(e);if(!t)throw new Error("No definition found for structure ".concat(e,"."));return t},ze=function(e){var t=_e(e).level;return He(e).levels[t]};n(367);!function(e){e[e.auto=0]="auto",e[e.large=1]="large",e[e.medium=2]="medium",e[e.small=3]="small"}(Re||(Re={})),function(e){e.blue="blue",e.purple="purple",e.green="green"}(Pe||(Pe={}));var Le,Be=function(e){var t,n,a=e.color,r=e.square,c=e.text,o=Object(V.a)(e,["color","square","text"]),i=["button",null!==(t=e.className)&&void 0!==t?t:"","button-".concat("string"===typeof a?a:Pe[null!==a&&void 0!==a?a:Pe.blue]),"button-".concat("string"===typeof e.size?e.size:Re[null!==(n=e.size)&&void 0!==n?n:Re.auto]),"".concat(r?"button-square":"")];return Object(B.jsx)("button",Object(X.a)(Object(X.a)({},o),{},{className:i.join(" "),onClick:function(t){var n;null===(n=e.onClick)||void 0===n||n.call(e,t)},children:Object(B.jsxs)("span",{children:[!!c&&c,!c&&e.children]})}))},Fe=function(e){return Object(s.useEffect)((function(){return q.c.musicFiltered=!0,function(){q.c.musicFiltered=!1}})),Object(B.jsxs)("div",{className:"window",children:[Object(B.jsxs)("div",{className:"header",children:[!1!==e.backEnabled&&Object(B.jsx)(Be,{className:"back-button",onClick:function(t){e.onBack&&(null===e||void 0===e||e.onBack(),q.c.playSound("ui/buttonClick"))},square:!0,size:"medium",color:"purple",text:"<"}),Object(B.jsx)("h3",{children:e.title}),!1!==e.closeEnabled&&Object(B.jsx)(Be,{className:"close-button",onClick:function(t){e.onClose&&(null===e||void 0===e||e.onClose(),q.c.playSound("ui/buttonClick"))},square:!0,size:"medium",color:"purple",text:"x"})]}),e.children]})},We=(n(368),function(e){return function(t){Object(Y.a)(a,t);var n=Object(Z.a)(a);function a(){return Object(R.a)(this,a),n.apply(this,arguments)}return Object(P.a)(a,[{key:"render",value:function(){return Object(B.jsx)(Fe,Object(X.a)(Object(X.a)({},this.props),{},{children:Object(B.jsx)(e,Object(X.a)({},this.props))}))}}]),a}(s.Component)});n(369);!function(e){e[e.increasing=0]="increasing",e[e.decreasing=1]="decreasing"}(Le||(Le={}));var Ve=function(e){var t,n,a,r=e.className,c=void 0===r?"":r,o=e.animationTime,i=Object(s.useRef)(0),u=(t=e.progress||0,n=0,t>(a=1)?a:t<n?n:t);return i.current=u,Object(B.jsxs)("div",{className:"progressbar ".concat(c),children:[Object(B.jsx)("div",{className:"progressbar-label",children:e.label}),Object(B.jsx)("div",{className:"progressbar-bar",style:Object(X.a)({width:"".concat(100*u,"%")},o&&{transition:"width ".concat(o,"ms linear")})})]})};var Qe,Ge=function(){return Object(d.d)((function(e){return e.engine}))},Ue=function(e){var t=Object(s.useRef)();return Object(s.useEffect)((function(){t.current=e}),[e]),t.current};!function(e){e[e.increasing=0]="increasing",e[e.decreasing=1]="decreasing"}(Qe||(Qe={}));var Xe,Ye=function(e){var t=e.className,n=void 0===t?"":t,a=e.label,r=e.direction,c=e.progress,o=void 0===c?0:c,i=Ue(o)||0,u=function(){var e=Ge();return Date.now()-e.previousTick}(),l=Object(s.useState)(!1),d=Object(y.a)(l,2),m=d[0],p=d[1];return Object(s.useEffect)((function(){p(void 0===r||r===Qe.increasing&&o>i||r===Qe.decreasing&&o<i)}),[r,o]),Object(B.jsx)(Ve,{progress:o,label:a,className:n,animationTime:m?u:0})},Ze=n(54),Je=function(e){return e.tasks},Ke=function(e){return Object(d.d)(function(e){return Object(Ze.a)([Je],(function(t){return t.running.filter((function(t){return t.origin==="".concat(e,".craft")}))}))}(e))},$e=function(e){return Object(d.d)(function(e){return Object(Ze.a)([Je],(function(t){return t.running.filter((function(t){return t.origin==="".concat(e,".study")}))}))}(e))},et=function(e){return Object(d.d)(function(e){return Object(Ze.a)([Je],(function(t){return t.running.filter((function(t){return t.name==="".concat(e,".upgrade")}))}))}(e))},tt=(n(370),function(e){return Object(B.jsx)("div",{className:"structureview-header structureview-header-".concat(e.structure)})}),nt=(n(371),function(e){var t=e.structure,n=e.onHelpClicked,a=(e.addUpgradeCallbacks,_e(t).level),r=He(t).levels[a+1],c=null==r?C.a.get("ui-structure-upgrade-max"):C.a.get("ui-structure-upgrade",{level:a+2}),o=et(t);if(o.length){var i=o[0];return Object(B.jsx)(Ye,{className:"upgrading",label:"".concat(C.a.get("structure-upgrade-button-upgrading")," (").concat(Object(pe.h)(i.timeRemaining),")"),progress:i.progress},"".concat(i.name).concat(i.startTime))}return Object(B.jsxs)("div",{className:"upgrade-stucture-button",children:[Object(B.jsxs)("label",{children:[C.a.get("ui-structure-level"),a+1]}),Object(B.jsx)(Be,{className:"upgrade",onClick:n,disabled:null==r,children:c})]})}),at=n(309),rt=n.n(at),ct=n(82),ot="tooltipContextUpdated",it=function(e){Object(Y.a)(n,e);var t=Object(Z.a)(n);function n(){return Object(R.a)(this,n),t.apply(this,arguments)}return Object(P.a)(n,null,[{key:"showContextTooltip",value:function(e,t,n,a,r){var c={type:e,info:t,referenceRect:n,className:a,source:r};rt()(c,this.lastContext)?this.clear():(this.instance.emit(ot,c),this.lastContext=c)}},{key:"clear",value:function(){this.instance.emit(ot,void 0),this.lastContext=void 0}},{key:"instance",get:function(){return this._instance}}]),n}(n.n(ct).a);it._instance=new it,it.lastContext=void 0,function(e){e[e.item=0]="item",e[e.trait=1]="trait",e[e.resource=2]="resource",e[e.skill=3]="skill",e[e.component=4]="component"}(Xe||(Xe={}));var st=n(21),ut=n(23),lt=n(40),dt=(n(383),function(e){var t=e.item,n=e.size,a=e.source,r=Object(lt.c)(t);if(!r)throw"could not find definition for ".concat(t);var c="item-icon ".concat(mt(r.rarity)," ").concat(pt(n));return Object(B.jsx)("div",{className:c,children:Object(B.jsx)(st.b,{image:r.iconImg,size:e.size,onClick:function(n){if(!1!==e.showContext){var r=n.currentTarget.getBoundingClientRect();it.showContextTooltip(Xe.item,t,r,void 0,a),n.stopPropagation()}e.onClick&&e.onClick(n)}})})}),mt=function e(t){switch(t){case ut.a.common:return"item-icon-common";case ut.a.uncommon:return"item-icon-uncommon";case ut.a.rare:return"item-icon-rare";case ut.a.epic:return"item-icon-epic";case ut.a.legendary:return"item-icon-legendary"}return e(ut.a.common)},pt=function e(t){switch(t){case st.a.smallest:return"item-icon-size-smallest";case st.a.small:return"item-icon-size-small";case st.a.medium:return"item-icon-size-medium";case st.a.big:return"item-icon-size-big";case st.a.biggest:return"item-icon-size-biggest"}return e(st.a.medium)},ht=(n(384),function(e){var t;return t=null==e.max?e.value:Object(B.jsxs)("span",{children:[e.value," / ",Object(B.jsx)("span",{className:"max",children:e.max})]}),Object(B.jsxs)("div",{className:"updownvalue",children:[Object(B.jsxs)("label",{children:[" ",e.label]}),t,Object(B.jsx)("i",{className:"arrow up"+(e.upDisabled?" disabled":""),onClick:function(t){e.onUp&&!e.upDisabled&&e.onUp(t)}}),Object(B.jsx)("i",{className:"arrow down"+(e.downDisabled?" disabled":""),onClick:function(t){e.onDown&&!e.downDisabled&&e.onDown(t)}})]})}),bt=function(){return Object(d.d)((function(e){return e.stockpile}))},vt=function(){var e=bt();return Object(s.useMemo)((function(){return Object.values(e).flat()}),[e])},ft=(n(385),function(e){var t=e.items,n=(e.className||"")+" items-box",a=t.reduce((function(e,t){return e[t]||(e[t]=0),e[t]++,e}),{}),c=vt(),o=Object(s.useMemo)((function(){var e=Object(r.a)(c),n=[];return t.forEach((function(t){var a=e.findIndex((function(e){return e===t}));if(a>-1){var r=e.splice(a,1),c=Object(y.a)(r,1)[0];c&&n.push(c)}})),n}),[t,c]),i=Object.keys(a).map((function(e){var t=e,n=a[e],r="item";n>(o?o.filter((function(e){return e===t})).length:0)&&(r+=" missing");var c=Object(lt.c)(t);return Object(B.jsxs)("li",{className:r,children:[Object(B.jsx)(st.b,{image:c.iconImg,size:"smallest"}),Object(B.jsx)("div",{className:"name",children:"".concat(C.a.getItemName(t)," (").concat(n,")")})]},t)}));return Object(B.jsx)("ul",{className:n,children:i})}),gt=Object(Ze.a)([function(e){return e.structures.warehouse.level}],(function(e){return Me("warehouse").levels[e].maxResources})),jt=function(){return Object(d.d)((function(e){return e.resources}))},Ot=function(){return Object(d.d)(gt)},yt=function(){return Object(d.d)((function(e){return e.gold}))},wt=(n(386),function(e){var t=e.resources,n=e.gold,a=jt(),c=Object(s.useMemo)((function(){return Object.keys(t).reduce((function(e,n){var r=n;return e[n]=a[r]>=t[r],e}),{})}),[t,a]),o=yt(),i=void 0===n||o>=n,u=(e.className||"")+" resources-cost",l=Object.keys(e.resources).map((function(t){var n=t,a="resource";c&&!c[n]&&(a+=" insufficient");var r=qe[n];if(!r)throw new Error("No resource description found for ".concat(n));return Object(B.jsxs)("li",{className:a,children:[Object(B.jsx)(st.b,{image:r.iconImg,size:"smallest",onClick:function(e){var t=e.currentTarget.getBoundingClientRect();it.showContextTooltip(Xe.resource,n,t),e.stopPropagation()}}),Object(B.jsx)("div",{className:"name",children:C.a.getResourceName(n)}),Object(B.jsx)("div",{className:"amount",children:e.resources[n]})]},n)}));return Object(B.jsxs)("ul",{className:u,children:[l,n&&Object(B.jsxs)("li",{className:["gold"].concat(Object(r.a)(i?[]:["insufficient"])).join(" "),children:[Object(B.jsx)(st.b,{image:"img/resources/gold.png",size:"smallest"}),Object(B.jsx)("div",{className:"name",children:C.a.get("resource-gold-name")}),Object(B.jsx)("div",{className:"amount",children:n})]})]})}),xt=Object(Ze.a)([function(e){return e.structures},function(e){return e.workers}],(function(e,t){return t-Object.keys(e).map((function(t){return e[t]})).reduce((function(e,t){return e+t.workers}),0)})),kt=function(){return Object(d.d)(xt)},Tt=function(e,t){if(t>6)throw new Error("Cannot possibly have more than ".concat(6," on one item!"));return e-.1*e*(t-1)},Nt={"weapon/aegisOfValor":{item:"weapon/aegisOfValor",levelRequired:3,cost:{resources:{wood:20,iron:5},time:pe.c}},"weapon/arbalest":{item:"weapon/arbalest",cost:{resources:{wood:20,iron:5},time:pe.c}},"weapon/battleAxe":{item:"weapon/battleAxe",cost:{resources:{wood:20,iron:5},time:pe.c}},"weapon/berserkerShield":{item:"weapon/berserkerShield",levelRequired:2,cost:{resources:{wood:20,iron:5},time:pe.c}},"weapon/brassKnuckles":{item:"weapon/brassKnuckles",cost:{resources:{wood:20,iron:5},time:pe.c}},"weapon/simpleCrossbow":{item:"weapon/simpleCrossbow",cost:{resources:{wood:20,iron:5},time:pe.c}},"weapon/cleaver":{item:"weapon/cleaver",cost:{resources:{wood:10,iron:15},time:pe.c}},"weapon/club":{item:"weapon/club",cost:{resources:{wood:30},time:pe.c}},"weapon/dagger":{item:"weapon/dagger",cost:{resources:{wood:10,iron:10},time:pe.d}},"weapon/flail":{item:"weapon/flail",cost:{resources:{wood:10,iron:10},time:pe.d}},"weapon/goldenShield":{item:"weapon/goldenShield",levelRequired:2,cost:{resources:{wood:20,iron:5},time:pe.c}},"weapon/javelin":{item:"weapon/javelin",cost:{resources:{wood:20,iron:10},time:pe.d+pe.c}},"weapon/khopesh":{item:"weapon/khopesh",cost:{resources:{wood:15,iron:40},time:pe.g}},"weapon/longbow":{item:"weapon/longbow",cost:{resources:{wood:40,iron:5},time:pe.d}},"weapon/mace":{item:"weapon/mace",cost:{resources:{wood:15,iron:10},time:pe.d}},"weapon/morningStar":{item:"weapon/morningStar",cost:{resources:{wood:15,iron:15},time:pe.d}},"weapon/paintedBuckler":{item:"weapon/paintedBuckler",cost:{resources:{wood:20,iron:10},time:pe.d+pe.c}},"weapon/poisonedDagger":{item:"weapon/poisonedDagger",cost:{resources:{wood:50,iron:15},materials:["material/poisonVial"],time:pe.d}},"weapon/ravenStaff":{item:"weapon/ravenStaff",cost:{resources:{wood:15,iron:10,food:5},time:pe.d}},"weapon/savageStaff":{item:"weapon/savageStaff",cost:{resources:{wood:15,iron:10,food:5},time:pe.d}},"weapon/spear":{item:"weapon/spear",cost:{resources:{wood:15,iron:15},time:pe.d}},"weapon/steelShield":{item:"weapon/steelShield",cost:{resources:{wood:15,iron:15},time:pe.d}},"weapon/steelSword":{item:"weapon/steelSword",cost:{resources:{wood:10,iron:30},time:pe.d}},"weapon/warhammer":{item:"weapon/warhammer",cost:{resources:{wood:10,iron:30},time:pe.d}},"weapon/woodenBulwark":{item:"weapon/woodenBulwark",cost:{resources:{wood:10,iron:30},time:pe.d}}},It=Nt;var St,qt={"apparel/boots1":{item:"apparel/boots1",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/boots2":{item:"apparel/boots2",cost:{resources:{wood:10,iron:45},time:pe.d},levelRequired:2},"apparel/boots3":{item:"apparel/boots3",cost:{resources:{wood:10,iron:45},time:pe.d},levelRequired:3},"apparel/chainmailHood":{item:"apparel/chainmailHood",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/chest":{item:"apparel/chest",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/clothGloves":{item:"apparel/clothGloves",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/cowl":{item:"apparel/cowl",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/druidChest":{item:"apparel/druidHands",cost:{resources:{wood:10,iron:45},time:pe.d},levelRequired:2},"apparel/druidFeet":{item:"apparel/druidFeet",cost:{resources:{wood:10,iron:45},time:pe.d},levelRequired:2},"apparel/druidHands":{item:"apparel/druidHands",cost:{resources:{wood:10,iron:45},time:pe.d},levelRequired:2},"apparel/druidHead":{item:"apparel/druidHead",cost:{resources:{wood:10,iron:45},time:pe.d},levelRequired:2},"apparel/druidLegs":{item:"apparel/druidLegs",cost:{resources:{wood:10,iron:45},time:pe.d},levelRequired:2},"apparel/fedora":{item:"apparel/fedora",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/greaves1":{item:"apparel/greaves1",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/greaves2":{item:"apparel/greaves2",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/hornedHelmet":{item:"apparel/hornedHelmet",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/leatherGloves":{item:"apparel/leatherGloves",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/nomadHelmet":{item:"apparel/nomadHelmet",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/pants1":{item:"apparel/pants1",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/pants2":{item:"apparel/pants2",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/plateChest1":{item:"apparel/plateChest1",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/plateChest2":{item:"apparel/plateChest2",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/plateChest3":{item:"apparel/plateChest3",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/plateChest4":{item:"apparel/plateChest4",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/plateGloves1":{item:"apparel/plateGloves1",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/plateGloves2":{item:"apparel/plateGloves2",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/plateHelmet":{item:"apparel/plateHelmet",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/platePants":{item:"apparel/platePants",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/plateShoulders1":{item:"apparel/plateShoulders1",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/plateShoulders2":{item:"apparel/plateShoulders2",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/robe":{item:"apparel/robe",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/shoulders1":{item:"apparel/shoulders1",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/shoulders2":{item:"apparel/shoulders2",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/shoulders3":{item:"apparel/shoulders3",cost:{resources:{wood:10,iron:45},time:pe.d}},"apparel/vest":{item:"apparel/vest",cost:{resources:{wood:10,iron:45},time:pe.d}}},Ct={"questItem/torch":{item:"questItem/torch",cost:{resources:{wood:2,fabric:1},time:pe.e}},"questItem/sandwich":{item:"questItem/sandwich",cost:{resources:{food:1},time:pe.e/2}}},At=n(32),Et=n(83),Mt=n(126),Dt=Object(X.a)(Object(X.a)(Object(X.a)({},qt),It),Ct),Rt=function(e){return Dt[e]},Pt=function(e,t){return console.log("add item to warehouse"),{type:"addItem",item:e,toSlot:t}},_t=function(e,t,n){return{type:"moveItemInWarehouse",itemType:e,fromSlot:t,toSlot:n}},Ht=function(e,t){return{type:"removeItem",itemType:e,fromSlot:t}},zt=function(e){return{type:"addResources",resources:e}},Lt=function(e){return{type:"removeResources",resources:e}},Bt=function(e){return{type:"finishBuildingStructure",structure:e}},Ft=function(e){return{type:"upgradeStructure",structure:e}},Wt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:"increaseWorkers",structure:e,workers:t}},Vt=function(e,t){return{type:"addItemToToProduces",structure:e,item:t}};function Qt(e,t,n,a,r){return{type:"start",taskType:e,name:t,origin:n,time:a,callbacks:r}}!function(e){e[e.buildStructure=0]="buildStructure",e[e.upgradeStructure=1]="upgradeStructure",e[e.craftItem=2]="craftItem",e[e.studyItem=3]="studyItem"}(St||(St={}));var Gt,Ut=function(e){var t=e.item,n=e.structure,a=Object(d.c)(),r=jt(),c=vt(),o=kt(),i=Object(s.useState)(0),u=Object(y.a)(i,2),l=u[0],m=u[1],p=Rt(t),h=p.cost.resources||{},b=Object.keys(h).some((function(e){var t=e;return h[t]>r[t]})),v=!1,f=p.cost.materials;f&&(v=f.some((function(e){return-1===c.indexOf(e)})));var g=b||v||l<1,j=function(e,t){var r=Tt(e.cost.time||0,t);a(Lt(e.cost.resources||{})),a(Wt(n,t));var c=[Pt(e.item),Wt(n,t)],o=Qt(St.craftItem,e.item,"".concat(n,".craft"),r,c);a(o)};return Object(B.jsxs)("div",{className:"crafting-details",children:[C.a.get("ui-structure-production-craft-a",{item:t}),Object(B.jsxs)("div",{className:"crafting-costs",children:[Object(B.jsx)("fieldset",{children:Object(B.jsx)(wt,{resources:h})}),Object(B.jsx)("fieldset",{children:f&&Object(B.jsx)(ft,{items:f})})]}),Object(B.jsxs)("div",{className:"buttonrow",children:[Object(B.jsxs)("div",{children:[Object(B.jsx)(ht,{value:l,label:C.a.get("ui-structure-production-workers"),onUp:function(e){e.stopPropagation(),m(l+1)},onDown:function(e){e.stopPropagation(),m(l-1)},upDisabled:l>=o||l>=6,downDisabled:l<1}),function(e){if(0===l)return"";var t=Tt(e,l),n=Object(pe.h)(t);return C.a.get("ui-structure-production-crafting-time",{time:n})}(p.cost.time||0)]}),Object(B.jsx)("div",{children:Object(B.jsx)(Be,{disabled:g,className:"craft",onClick:function(e){e.stopPropagation(),j(p,l),m(0)},children:C.a.get("ui-structure-production-craft")})})]})]})},Xt=function(e){var t=e.structure,n=Object(s.useState)(),a=Object(y.a)(n,2),r=a[0],c=a[1],o=_e(t);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{children:[" ",C.a.get("ui-structure-production-craft")]}),Object(B.jsxs)("div",{className:"crafting-area",children:[Object(B.jsx)("ul",{className:"vertical-tab-bar",children:o.produces.map((function(e){return Object(B.jsxs)("li",{onClick:function(){return function(e){c(e)}(e)},className:r===e?"selected":"",children:[Object(B.jsx)(dt,{item:e,size:st.a.smallest}),C.a.getItemName(e)]},"craft".concat(e))}))}),r&&Object(B.jsx)(Ut,{item:r,structure:t})]})]})},Yt=n(96),Zt=n(46),Jt=(n(387),function(e){var t=e.structure,n=e.level,a=e.children,r=Object(d.c)(),c=He(t).levels[n+1],o=c.cost.time,i=yt(),s=null!=c?c.cost.gold||0:-1,u=s>i,l=jt(),m=c.cost.resources||{},p=Object.keys(m).some((function(e){var t,n,a=e;return(null!==(t=m[a])&&void 0!==t?t:0)>(null!==(n=null===l||void 0===l?void 0:l[a])&&void 0!==n?n:0)})),b=null!=c&&!u&&!p;return Object(B.jsxs)("div",{className:"structure-upgrade-help-modal",children:[Object(B.jsxs)("div",{className:"top",children:[Object(B.jsx)("h3",{children:C.a.get("ui-structure-help-upgrade-title",{structure:t})}),Object(B.jsx)("div",{className:"level",children:C.a.get("ui-structure-help-upgrade-header-level",{level:n+2})})]}),Object(B.jsxs)("div",{className:"cost",children:[Object(B.jsx)("h3",{children:"Costs"}),c.cost.resources&&Object(B.jsx)(wt,{resources:c.cost.resources,gold:c.cost.gold,className:"wrap"})]}),Object(B.jsx)(Be,{className:"start",onClick:function(){var e;r(Object(Yt.b)(s)),r(Lt(m));var a=[Ft(t),Object(h.b)("log-town-upgrade-structure-complete",{level:n+1,structure:t},Zt.a.town)],o=null!==(e=c.cost.time)&&void 0!==e?e:0,i=Qt(St.upgradeStructure,"".concat(t,".upgrade"),"town",o,a);r(i)},disabled:!b,children:C.a.get("ui-structure-help-upgrade-start",{time:Object(pe.h)(null!==o&&void 0!==o?o:0)})}),a]})}),Kt=(n(388),function(e){var t=e.level,n=e.structure,a=He(n).levels[t+1];return Object(B.jsxs)("div",{className:"upgrade-help-model-content-production",children:[Object(B.jsx)("h3",{children:C.a.get("ui-structure-help-upgrade-unlocks-crafting")}),Object(B.jsx)("div",{className:"unlocks",children:a.unlocks.map((function(e){return function(e){return Object(B.jsx)(dt,{item:e,size:st.a.small},e)}(e)}))})]})}),$t=(n(389),function(e){var t=e.structure,n=_e(t).level,a=Ke(t),r=$e(t),c=He(e.structure);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(tt,{structure:e.structure}),Object(B.jsx)("div",{className:"production-structure-view",children:Object(B.jsxs)("section",{children:[Object(B.jsx)(nt,{structure:t,onHelpClicked:function(e){var a=e.currentTarget.getBoundingClientRect(),r=Object(B.jsx)(Jt,{level:n,structure:t,children:Object(B.jsx)(Kt,{level:n,structure:t})});it.showContextTooltip(Xe.component,r,a,"upgrade-structure-tooltip"),e.stopPropagation()},addUpgradeCallbacks:function(e){return c.levels[e].unlocks.map((function(e){return Vt(t,e)}))}}),Object(B.jsx)(Xt,{structure:t}),Object(B.jsxs)("fieldset",{children:[Object(B.jsx)("legend",{children:C.a.get("ui-structure-production-crafting")}),a.map((function(e){return Object(B.jsx)(Ye,{label:"".concat(C.a.getItemName(e.name)," (").concat(Object(pe.h)(e.timeRemaining),")"),progress:e.progress},"".concat(e.name).concat(e.startTime))}))]}),r.length>0&&Object(B.jsxs)("fieldset",{children:[Object(B.jsx)("legend",{children:C.a.get("ui-structure-production-studying")}),r.map((function(e){return Object(B.jsx)(Ye,{label:"".concat(C.a.getItemName(e.name)," (").concat(Object(pe.h)(e.timeRemaining),")"),progress:e.progress},"".concat(e.name).concat(e.startTime))}))]})]})})]})}),en=n(97),tn=n.n(en),nn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=["","k","M","G","T","P","E"],a=Math.log10(e)/3|0;if(0===a)return e.toFixed(t);var r=n[a],c=Math.pow(10,3*a),o=e/c;return o.toFixed(t)+r},an=(n(494),J((function(e){var t=e.resources,n=e.deltaResources,a=Object(d.d)((function(e){return e.structures})),r="resources-box ".concat(e.className||"");return Object(B.jsx)("div",{className:r,children:Object.keys(t).map((function(t){var r,c,o,i,u=t,l=qe[u],d=e.resources[u]||0;if(!l)throw new Error("No resource description found for ".concat(u));n[u]&&(o=Object(B.jsx)("span",{className:"animate-up",children:"+ ".concat(null===(i=n[u])||void 0===i?void 0:i.toFixed(2))}));var m=De(be[u]),p=d>=(null!==(r=null===(c=e.maxResources)||void 0===c?void 0:c[u])&&void 0!==r?r:0),h=C.a.get(a[m].state===g.Built?"ui-structure-warehouse-resources-source":"ui-structure-warehouse-resources-source-unbuilt",{structure:m});return Object(B.jsxs)(s.Fragment,{children:[Object(B.jsx)(st.b,{image:l.iconImg,size:"smallest"}),Object(B.jsx)("div",{className:"name",children:C.a.getResourceName(u)}),Object(B.jsx)("div",{className:"amount".concat(p?" full":""),children:nn(d,0)}),Object(B.jsx)("div",{className:"max",children:" / ".concat(e.maxResources[u])}),Object(B.jsx)("div",{className:"delta",children:o}),Object(B.jsx)("div",{className:"structure",children:Object(B.jsx)(tn.a,{children:h})})]},u)}))})}))),rn={fabric:0,food:0,iron:0,leather:0,stone:0,wood:0},cn=(n(495),function(e){var t=e.activeTab,n=void 0===t?null:t;!n&&e.children&&e.children;var a="".concat(e.className).concat(e.disabled?" disabled":""),r=u.a.Children.map(e.children,(function(e){return u.a.cloneElement(e,{active:e.props.id===n,onClick:function(){c(e.props.id)}})})),c=function(t){e.onTabSelected&&!0!==e.disabled&&e.onTabSelected(t)};return Object(B.jsx)("ul",{className:"tabstrip ".concat(null!==a&&void 0!==a?a:""),onClick:function(t){q.c.playSound("ui/buttonClick"),e.onClick&&e.onClick(t)},children:r})}),on=function(e){var t=(e.active?"active":"")+(e.className||"");return Object(B.jsx)("li",{className:"tabstrip-tab ".concat(t),onClick:function(t){e.onClick&&e.onClick(t)},children:e.children})},sn=(n(496),function(e){var t=e.adventurer,n=e.size,a="".concat(e.className||""," avatar");return Object(B.jsx)(st.b,{className:a,image:t.avatarImg,size:n,onClick:function(){e.onClick&&e.onClick(e.adventurer.id)}})}),un=function(e){var t=e.adventurers,n=e.onAdventurerTabSelected;return Object(B.jsx)(cn,{className:"adventurers-tabstrip",onTabSelected:function(t){var a=e.adventurers.find((function(e){return e.id===t}));a&&n(a.id)},activeTab:e.selectedAdventurerId,disabled:e.disabled,children:t.map((function(e){return t=e,Object(B.jsx)(on,{id:t.id,children:Object(B.jsx)(sn,{adventurer:t,size:st.a.small})},t.id);var t}))})};!function(e){e[e.unavailable=0]="unavailable",e[e.available=1]="available",e[e.active=2]="active",e[e.completed=3]="completed"}(Gt||(Gt={}));var ln=n(7),dn=function(){var e=Object(d.d)((function(e){return e.adventurers})),t=Object(d.d)((function(e){return e.quests}));return Object(s.useMemo)((function(){return function(e,t){var n=t.reduce((function(e,t){return t.status===Gt.active&&e.push.apply(e,Object(r.a)(t.party)),e}),[]);return e.filter((function(e){return-1===n.indexOf(e.id)}))}(e,t)}),[e,t])},mn=function(e){var t=Object(s.useCallback)((function(t){return t.adventurers.find((function(t){return t.id===e}))}),[e]);return Object(d.d)(t)},pn=n(35),hn=n(669),bn={drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){var n=t.getItem();return n.sourceType===pn.a.adventurerEquipment&&void 0!==n.inventorySlot?null==e.item||Object(ln.c)(e.item,n.inventorySlot):!e.canDropHere||e.canDropHere(n)}},vn=Object(hn.a)(pn.b.ITEM,bn,(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,a=e.connectDropTarget,c=t&&n,o=["inventory-item"].concat(Object(r.a)(c?["drop-active"]:[]),Object(r.a)(!c&&n?["drop-possible"]:[]));return a(Object(B.jsx)("div",{className:o.join(" "),children:e.children}))})),fn=n(676);var gn=Object(fn.a)(pn.b.ITEM,{beginDrag:function(e){var t=e.onStartDrag,n=e.index,a=e.item,r=e.sourceId,c=e.sourceType;return null===t||void 0===t||t(),{inventorySlot:n,item:a,sourceId:r,sourceType:c}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.item,n=e.onClick,a=e.isDragging,r=e.connectDragSource,c=e.size,o=e.index,i=e.sourceType,u=e.sourceId;if(a)return null;var l=Object(s.useMemo)((function(){return{origin:i,id:u,slot:o}}),[]);return r(Object(B.jsx)("div",{children:Object(B.jsx)(dt,{item:t,source:l,onClick:function(e){null===n||void 0===n||n(e)},size:c})}))})),jn=(n(497),function(e){for(var t=e.items,n=e.canDropHere,a=e.onStartDrag,r=[],c=function(c){var o=void 0,i=t[c];i&&(o=Object(B.jsx)(gn,{index:c,sourceId:e.sourceId,sourceType:e.sourceType,item:i,onStartDrag:function(){i&&(null===a||void 0===a||a(i,c))}}));var s=Object(B.jsx)(vn,{item:i,size:e.iconSize,onDrop:function(t){if((t.inventorySlot!==c||t.sourceType!==e.sourceType||t.sourceId!==e.sourceId)&&e.onDropItem&&void 0!==t.inventorySlot){var n=t.inventorySlot;e.onDropItem(t.item,n,c,t.sourceType,t.sourceId)}},canDropHere:function(e){return!n||n(e)},children:o},"inventory-slot-".concat(c));r.push(s)},o=0;o<t.length;o++)c(o);return Object(B.jsx)("div",{className:"inventory ".concat(e.className?e.className:""),children:r})}),On=n(48),yn=n(28),wn=n(127),xn=(n(504),function(){return Object(B.jsx)("div",{className:"loading-spinner",children:Object(r.a)(Array(5)).map((function(e,t){return Object(B.jsx)("div",{className:"ring",children:Object(B.jsx)("div",{className:"inner"})},t)}))})}),kn=Object(s.createContext)(null),Tn=function(e){var t=e.questName,n=e.children,a=Object(d.e)(),r=Object(s.useState)(!1),c=Object(y.a)(r,2),o=c[0],i=c[1],u=a.getState().quests.find((function(e){return e.name===t})),l=u.scene,m=u.sceneName,p=u.questVars,h=Ue(p),b=Object(s.useMemo)((function(){return m?wn.a.getSceneController(t,m,a):null}),[t,m,a]);return Object(s.useEffect)((function(){if(i(!1),m&&b&&!b.dataLoading){b.loadData((function(){i(!0),!l&&b&&(b.createScene(),b.sceneEntered())}))}}),[b,t,l,m]),Object(s.useEffect)((function(){p!==h&&b&&b.updateScene()}),[b,h,p]),!b||!b.dataLoading&&o?Object(B.jsx)(kn.Provider,{value:b,children:n}):Object(B.jsx)(xn,{})},Nn=function(){var e=Object(d.c)(),t=Object(s.useContext)(kn),n=bt();return{dropItemEquipment:function(t,n,a){var r=t.item,c=[];switch(q.c.playSound("ui/equip"),t.sourceType){case pn.a.adventurerInventory:var o;c.push(Object(On.f)(a.id,null!==(o=t.inventorySlot)&&void 0!==o?o:-1),Object(On.b)(a.id,n,r));var i,s=a.equipment[n];if(s)c.push(Object(On.a)(a.id,s,null!==(i=t.inventorySlot)&&void 0!==i?i:-1));break;case pn.a.warehouse:var u,l=Object(lt.c)(r);c.push(Ht(l.itemType,null!==(u=t.inventorySlot)&&void 0!==u?u:-1),Object(On.b)(a.id,n,r));var d,m=a.equipment[n];if(m)c.push(Pt(m,null!==(d=t.inventorySlot)&&void 0!==d?d:-1));break;case pn.a.adventurerEquipment:var p;c.push(Object(On.b)(a.id,n,r));var h=a.equipment[n],b=null!==(p=t.inventorySlot)&&void 0!==p?p:-1;h?c.push(Object(On.b)(a.id,b,h)):c.push(Object(On.e)(a.id,b))}c.forEach((function(t){return e(t)}))},dropItemInventory:function(n,a,r,c,o,i){var s=[];switch(c){case pn.a.adventurerInventory:s.push(Object(On.d)(o.id,a,r));break;case pn.a.warehouse:var u=Object(lt.c)(n);s.push(Ht(u.itemType,a),Object(On.a)(o.id,n,r));var l=o.inventory[r];l&&s.push(Pt(l,a));break;case pn.a.adventurerEquipment:s.push(Object(On.a)(o.id,n,r));var d=o.inventory[r];d?s.push(Object(On.b)(o.id,a,d)):s.push(Object(On.e)(o.id,a));break;case pn.a.lootCache:t&&i&&t.takeItemFromCache(a,i,o.id,r)}s.forEach((function(t){return e(t)}))},dropItemWarehouse:function(t,a,r,c){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",i=[],s=Object(lt.c)(t),u=yn.a[s.itemType];switch(c){case pn.a.warehouse:i.push(_t(s.itemType,a,r));var l=n[u][r];l&&i.push(Object(On.a)(o,l,a));break;case pn.a.adventurerInventory:i.push(Object(On.f)(o,a),Pt(t,r));var d=n[u][r];d&&i.push(Object(On.a)(o,d,a))}i.forEach((function(t){return e(t)}))}}},In=(n(505),function(e){var t,n=mn(e.adventurerId);return(null===n||void 0===n?void 0:n.skills)?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("p",{children:C.a.get("ui-adventurer-info-skills-title")}),Object(B.jsx)("ul",{className:"adventurer-skills",children:null===(t=Object.keys(n.skills))||void 0===t?void 0:t.map((function(e){return function(e){var t=function(t){var n=t.currentTarget.getBoundingClientRect();it.showContextTooltip(Xe.skill,e,n),t.stopPropagation()};return Object(B.jsx)(s.Fragment,{children:Object(B.jsxs)("li",{onClick:t,children:[Object(B.jsx)("span",{className:"skill",onClick:t,children:C.a.getSkillName(e)}),Object(B.jsx)("span",{children:n.skills[e]})]})},e)}(e)}))})]}):null});function Sn(e){return Math.pow(e/.5,2)}var qn,Cn,An=function(e){var t=e.adventurerId,n=mn(t).xp,a=function(e){return Math.floor(.5*Math.sqrt(e))}(n),r=Sn(a),c=a+1,o=Sn(c),i=Object(s.useState)(!1),u=Object(y.a)(i,2),l=u[0],d=u[1],m=Ue({currentLevel:a,currentLevelXp:r,nextLevel:c,nextLevelXp:o}),p=Ue(t);Object(s.useEffect)((function(){var e;p!==t?d(!1):c>(null!==(e=null===m||void 0===m?void 0:m.nextLevel)&&void 0!==e?e:0)&&(q.c.playSound("ui/levelUp"),d(!0),setTimeout((function(){d(!1)}),2e3))}),[t,p,null===m||void 0===m?void 0:m.nextLevel,c]);var h=Ue(l),b=Object(s.useMemo)((function(){return l?1:(n-r)/(o-r)}),[r,l,o,n]);return Object(B.jsxs)("div",{className:"level",children:["Level ",a,Object(B.jsx)(Ve,{progress:b,animationTime:p!==t||h?0:300,label:l?C.a.get("ui-adventurer-info-xp-level-up"):C.a.get("ui-adventurer-info-xp-progress",{xp:Math.floor(n-r),next:o-r})})]})},En=n(310),Mn=Object(Ze.b)(Ze.c,En.a),Dn=function(e){return e.quests},Rn=function(e){return e.quests.map((function(e){return e.name}))},Pn=function(e){return e.quests.map((function(e){return e.status}))},_n=function(e){return e.filter((function(e){return e.status===Gt.active}))},Hn=function(e){var t=Object(s.useCallback)((function(t){return t.quests.find((function(t){return t.name===e}))}),[e]);return Object(d.d)(t)},zn=function(e){var t,n,a=Hn(null!==(t=e.questName)&&void 0!==t?t:""),r=Object(s.useContext)(kn),c=Object(s.useMemo)((function(){var t;return r&&(null===(t=r.getSceneActor(e.adventurer.id))||void 0===t?void 0:t.ap)||null}),[r,e.adventurer.id]);return(null===a||void 0===a||null===(n=a.scene)||void 0===n?void 0:n.combat)?Object(B.jsx)("span",{children:C.a.get("ui-adventurer-info-ap-remaining",{ap:c})}):null};!function(e){e.arrowFinder="arrowFinder",e.gloomy="gloomy",e.houseHouston="houseHouston",e.houseMaddox="houseMaddox",e.houseMonroe="houseMonroe"}(qn||(qn={}));var Ln=(Cn={},Object(Se.a)(Cn,qn.arrowFinder,{trait:qn.arrowFinder,hasEffect:!0}),Object(Se.a)(Cn,qn.gloomy,{trait:qn.gloomy,hasEffect:!0}),Object(Se.a)(Cn,qn.houseHouston,{trait:qn.houseHouston}),Object(Se.a)(Cn,qn.houseMaddox,{trait:qn.houseMaddox}),Object(Se.a)(Cn,qn.houseMonroe,{trait:qn.houseMonroe}),Cn);n(506);var Bn=function(e){var t=mn(e.adventurerId),n=function(e,t){var n=function(e){return Ln[e]}(e);return Object(B.jsxs)(s.Fragment,{children:[Object(B.jsx)("li",{onClick:function(e){var t=e.currentTarget.getBoundingClientRect();it.showContextTooltip(Xe.trait,n,t),e.stopPropagation()},children:C.a.getTraitName(e)}),!t&&", "]},e)};return(null===t||void 0===t?void 0:t.traits)?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("p",{children:C.a.get("ui-adventurer-info-traits-title")}),Object(B.jsx)("ul",{className:"adventurer-traits",children:t.traits&&t.traits.map((function(e,t,a){return n(e,t===a.length-1)}))})]}):null},Fn=(n(507),function(e){var t=function(e){var t,n=mn(e),a=function(e){var t=n.equipment[e];return t&&Object(Et.b)(t).damageReduction||0};return t={},Object(Se.a)(t,ln.a[ln.a.head],a(ln.a.head)),Object(Se.a)(t,ln.a[ln.a.chest],a(ln.a.chest)),Object(Se.a)(t,ln.a[ln.a.hands],a(ln.a.hands)),Object(Se.a)(t,ln.a[ln.a.shoulders],a(ln.a.shoulders)),Object(Se.a)(t,ln.a[ln.a.legs],a(ln.a.legs)),Object(Se.a)(t,ln.a[ln.a.feet],a(ln.a.feet)),t}(e.adventurerId),n=function(e){var n=t[ln.a[e]];return n?Object(B.jsx)("div",{className:ln.a[e],children:n},e):null};return Object(B.jsxs)("li",{className:"guy",children:[n(ln.a.head),n(ln.a.chest),n(ln.a.hands),n(ln.a.shoulders),n(ln.a.legs),n(ln.a.feet)]})}),Wn=(n(508),function(e){var t=e.adventurer,n=e.onDropItemEquipment,a=function(e){var a=t.equipment[e];return Object(B.jsxs)("li",{className:ln.a[e],children:[Object(B.jsx)(ln.b,{onDrop:function(t){return n(t,e)},type:e,children:a&&Object(B.jsx)(gn,{index:e,sourceId:t.id,sourceType:pn.a.adventurerEquipment,item:a,size:st.a.medium})}),Object(B.jsx)("span",{className:"info",children:C.a.getEquipmentSlot(e)})]})};return Object(B.jsxs)("ul",{className:"adventurer-equipment",children:[a(ln.a.head),a(ln.a.chest),a(ln.a.hands),a(ln.a.shoulders),a(ln.a.legs),a(ln.a.feet),a(ln.a.mainHand),a(ln.a.offHand),Object(B.jsx)(Fn,{adventurerId:t.id})]})}),Vn=(n(509),function(e){var t=e.adventurerId,n=e.questName,a=e.horizontalMode,r=e.name,c=void 0===r||r,o=e.levelBar,i=void 0===o||o,s=e.traits,u=void 0===s||s,l=e.skills,d=void 0===l||l,m=e.onStartInventoryItemDrag,p=mn(t),h=Nn(),b=h.dropItemEquipment,v=h.dropItemInventory;return Object(B.jsxs)("div",{className:"adventurer-panel".concat(a?" horizontal":""),children:[Object(B.jsxs)("div",{className:"left",children:[Object(B.jsxs)("div",{className:"info",children:[c&&Object(B.jsxs)("div",{className:"name",children:[p.name,n&&Object(B.jsx)(zn,{questName:n,adventurer:p})]}),i&&Object(B.jsx)(An,{adventurerId:p.id}),u&&Object(B.jsx)(Bn,{adventurerId:p.id}),d&&Object(B.jsx)(In,{adventurerId:p.id})]}),Object(B.jsx)("div",{className:"equipment",children:Object(B.jsx)(Wn,{adventurer:p,onDropItemEquipment:function(e,t){b(e,t,p)}})})]}),Object(B.jsx)("div",{className:"right",children:Object(B.jsx)(jn,{sourceType:pn.a.adventurerInventory,sourceId:p.id,items:p.inventory,className:"inventory-small",onDropItem:function(e,t,n,a,r){v(e,t,n,a,p,r)},onStartDrag:m})})]})}),Qn=(n(510),function(e){var t=e.level,n=He("warehouse"),a=n.levels[t],r=n.levels[t+1];return Object(B.jsxs)("div",{className:"upgrade-help-model-content-warehouse",children:[Object(B.jsx)("h3",{children:C.a.get("ui-structure-help-upgrade-improvements")}),Object(B.jsxs)("div",{className:"storage-increase",children:[Object(B.jsx)("div",{className:"header"}),Object(B.jsx)("div",{className:"header",children:C.a.get("ui-structure-warehouse-help-upgrade-header-capacity")}),Object(B.jsx)("div",{className:"header number",children:C.a.get("ui-structure-help-upgrade-header-level",{level:t+1})}),Object(B.jsx)("div",{className:"header"}),Object(B.jsx)("div",{className:"header number",children:C.a.get("ui-structure-help-upgrade-header-level",{level:t+2})}),Object.keys(r.maxResources).map((function(e){return function(e){var t=qe[e];return Object(B.jsxs)(s.Fragment,{children:[Object(B.jsx)("div",{children:Object(B.jsx)(st.b,{image:t.iconImg,size:"smallest"})}),Object(B.jsx)("div",{children:C.a.getResourceName(e)}),Object(B.jsx)("div",{className:"number",children:a.maxResources[e]}),Object(B.jsx)("div",{className:"arrow",children:"\u27f6"}),Object(B.jsx)("div",{className:"number",children:r.maxResources[e]})]},e)}(e)}))]})]})}),Gn=n(673),Un=(n(511),pn.a.warehouse),Xn=function(){var e=bt(),t=Nn().dropItemWarehouse,n=Object(s.useState)(Object.keys(e)[0]),a=Object(y.a)(n,2),r=a[0],c=a[1],o=Object(Gn.a)(),i=o.getMonitor().isDragging();Object(s.useEffect)((function(){if(i){var e=o.getMonitor().getItem(),t=o.getMonitor().getItemType();if(e&&t===pn.b.ITEM){var n=e.item,a=Object(lt.c)(n);c(yn.a[a.itemType])}}}),[i]);var u=Object(s.useMemo)((function(){return e[r]}),[r,e]);return Object(B.jsxs)("div",{className:"stockpile",children:[Object(B.jsx)(cn,{className:"tabs",onTabSelected:c,activeTab:r,children:Object.keys(e).map((function(e){return Object(B.jsx)(on,{id:e,children:C.a.getItemType(yn.a[e])},e)}))}),Object(B.jsx)(jn,{sourceType:Un,className:"inventory-large",items:u,onDropItem:function(e,n,a,r,c){t(e,n,a,r,c)},canDropHere:function(e){return Object(lt.c)(e.item).itemType===yn.a[r]}})]})},Yn=(n(512),function(){var e,t=dn(),n=Object(s.useState)(null===(e=t[0])||void 0===e?void 0:e.id),a=Object(y.a)(n,2),r=a[0],c=a[1],o=jt(),i=Object(s.useState)(rn),u=Object(y.a)(i,2),l=u[0],m=u[1],p=Ue(o),h=Object(s.useRef)(null),b=Object(d.d)((function(e){return e.structures}));Object(s.useEffect)((function(){var e=Object.keys(o).reduce((function(e,t){var n=t;return p&&p[n]&&(e[n]=o[n]-p[n]),e}),{});m(e)}),[o,p]),Object(s.useEffect)((function(){if(h.current){var e=h.current;e.classList.remove("animate");var t=setTimeout((function(){h&&e.classList.add("animate")}),200);return function(){clearTimeout(t)}}}),[l]);var v=He("warehouse"),f=_e("warehouse"),g=f.level,j=ze("warehouse");return Object(B.jsxs)("div",{className:"warehouse-structureview",children:[Object(B.jsx)(nt,{structure:"warehouse",onHelpClicked:function(e){var t=e.currentTarget.getBoundingClientRect(),n=Object(B.jsx)(Jt,{level:g,structure:"warehouse",children:Object(B.jsx)(Qn,{level:g})});it.showContextTooltip(Xe.component,n,t,"upgrade-structure-tooltip"),e.stopPropagation()},addUpgradeCallbacks:function(e){var t=v.levels[f.level];v.levels[e].maxStockpile,t.maxStockpile;return[]}}),Object(B.jsxs)("fieldset",{className:"resources",ref:h,children:[Object(B.jsx)("legend",{children:C.a.get("ui-structure-warehouse-resources")}),Object(B.jsx)(an,{resources:o,structures:b,maxResources:j.maxResources,deltaResources:l})]}),Object(B.jsx)("h3",{children:C.a.get("ui-structure-warehouse-stockpile")}),Object(B.jsx)(Xn,{}),Object(B.jsx)("h3",{children:C.a.get("ui-structure-warehouse-adventurers")}),Object(B.jsxs)("div",{children:[Object(B.jsx)(un,{adventurers:t,selectedAdventurerId:r,onAdventurerTabSelected:function(e){c(e)}}),Object(B.jsx)("div",{className:"adventurer-inventory",children:r&&Object(B.jsx)(Vn,{adventurerId:r,horizontalMode:!0,traits:!1,skills:!1,onStartInventoryItemDrag:function(e,t){console.log(e)}})})]})]})}),Zn=n(49),Jn=n(50),Kn=n(69),$n=(n(513),Object(hn.a)(pn.b.ADVENTURER,{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){return!0}},(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,a="droppable-adventurer-slot";return t?a+=" active-drop":n&&(a+=" can-drop"),(0,e.connectDropTarget)(Object(B.jsx)("div",{className:a}))}))),ea=(n(514),function(e){return Object(B.jsx)("ul",{className:"assign-adventurers",children:function(){for(var t=[],n=function(n){var a=void 0,r="";if(!!e.assignedAventurers[n]){var c=e.assignedAventurers[n];a=Object(B.jsx)(sn,{adventurer:c,displayName:!1,size:st.a.small,onClick:function(){return e.onAdventurerClicked(c)}}),r="has-adventurer"}else a=Object(B.jsx)($n,{onDrop:function(t){e.onAdventurerDropped(t,n)}});t.push(Object(B.jsx)("li",{className:r,children:a},"slot".concat(n)))},a=0;a<e.availableSlots;a++)n(a);return t}()})}),ta=(n(515),function(e){var t=vt(),n=function(e){return!e.requiredItems||e.requiredItems.every((function(n){var a,r=null===(a=e.requiredItems)||void 0===a?void 0:a.filter((function(e){return e===n})).length;return t.filter((function(e){return e===n})).length>=(null!==r&&void 0!==r?r:0)}))};return Object(B.jsxs)("div",{className:"quest-board",children:[Object(B.jsx)("h2",{children:C.a.get("ui-structure-tavern-title-quest-board")}),Object(B.jsx)("ul",{className:"quest-list",children:e.availableQuests.map((function(t){var n="quest ".concat(t.name===e.selectedQuestName?" selected":"");return Object(B.jsxs)("li",{className:n,onClick:function(){e.onQuestClick(t.name)},children:[Object(B.jsx)("div",{className:"icon",style:{backgroundImage:"url(".concat(".",")")}}),Object(B.jsxs)("div",{className:"title",children:[C.a.getQuestTitle(t.name)," "]})]},t.name)}))}),function(){if(!e.selectedQuestName)return null;var t=e.availableQuests.find((function(t){return t.name===e.selectedQuestName}));if(!t)return Object(B.jsxs)("div",{children:[" ",C.a.get("ui-structure-tavern-quest-launched")," "]});var a=Object(Kn.a)(t.name),r=e.assignedAventurers.filter((function(e){return null!==e})).length>=3,c=n(a),o=r&&c;return Object(B.jsxs)("div",{className:"quest-details",children:[C.a.getQuestDescription(e.selectedQuestName),Object(B.jsx)(ea,{availableSlots:5,assignedAventurers:e.assignedAventurers,onAdventurerClicked:e.onRemoveAdventurer,onAdventurerDropped:e.onAdventurerDropped}),Object(B.jsx)(ft,{items:a.requiredItems||[]}),Object(B.jsx)(Be,{disabled:!o,onClick:function(){return e.onLaunchQuest()},children:C.a.get("ui-structure-tavern-button-launch-quest")})]})}()]})}),na=(n(516),function(e){var t=e.adventurer,n=e.assignedAventurers,a=e.questName,r=e.onAddAdventurer,c=e.onRemoveAdventurer,o=n.indexOf(t)>-1,i=C.a.getQuestTitle(a);return o?Object(B.jsx)(Be,{onClick:function(){c(t)},className:"adventurer-button",children:C.a.get("ui-structure-tavern-button-leave-quest")}):5===n.filter(Boolean).length?Object(B.jsx)(Be,{disabled:!0,className:"adventurer-button",children:C.a.get("ui-structure-tavern-button-join-quest-full-party")}):Object(B.jsx)(Be,{onClick:function(){var e=aa(n);r(t,e)},className:"adventurer-button",children:C.a.get("ui-structure-tavern-button-join-quest",{quest:i})})}),aa=function(e){for(var t=0;t<5;t++)if(!e[t])return t;return 0},ra=(n(517),{beginDrag:function(e){return{adventurer:e.adventurer,sourceId:e.sourceId,sourceType:pn.a.adventurerInventory}}});var ca,oa=Object(fn.a)(pn.b.ADVENTURER,ra,(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.isDragging,n=e.connectDragSource,a="draggable-adventurer-avatar";return e.disabled&&(a+=" disabled"),t&&(a+=" dragging"),n(Object(B.jsx)("div",{className:a,children:Object(B.jsx)(sn,Object(X.a)({},e))}))})),ia=function(e){var t=e.adventurer,n=e.onQuest,a=e.assignedAventurers,r=e.expanded,c=e.selectedQuestName,o=e.onClick,i=e.onAddAdventurer,s=e.onRemoveAdventurer,u=Object(d.c)(),l=a.indexOf(t)>-1;return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{className:"room ".concat(r?"expanded":""),onClick:function(){return o(t)},children:[Object(B.jsx)(oa,{disabled:l||n,adventurer:t,className:"adventurer-icon",sourceId:ma},"avatar:".concat(t.id)),Object(B.jsxs)("div",{children:[Object(B.jsx)("section",{children:t.name}),Object(B.jsx)("section",{className:"on-a-quest",children:n&&C.a.get("ui-structure-tavern-on-a-quest")})]}),Object(B.jsx)("span",{className:"rename",onClick:function(e){e.stopPropagation();var n=prompt("Enter new name",t.name);n&&n!==t.name&&u(Object(On.g)(t.id,n))},children:"rename"})]}),r&&Object(B.jsxs)("div",{className:"adventurer-details",children:[Object(B.jsx)(Vn,{adventurerId:t.id,name:!1}),!n&&c&&Object(B.jsx)(na,{adventurer:t,assignedAventurers:a,questName:c,onAddAdventurer:i,onRemoveAdventurer:s})]})]})},sa=function(){return Object(B.jsx)("div",{className:"room",children:"(empty room)"})},ua=(n(518),function(e){for(var t=e.roomCount,n=e.adventurers,a=e.assignedAventurers,r=e.selectedQuestName,c=e.onAddAdventurer,o=e.onRemoveAdventurer,i=Object(s.useState)(),u=Object(y.a)(i,2),l=u[0],d=u[1],m=function(e){l===e.id?d(void 0):d(e.id)},p=[],h=function(t){var i=n.find((function(e){return e.room===t}));if(!i)return p.push(Object(B.jsx)(sa,{},"room".concat(t))),"continue";var s,u=(s=i.id,!!Object.values(e.quests).find((function(e){return e.party.indexOf(s)>-1})));p.push(Object(B.jsx)(ia,{adventurer:i,assignedAventurers:a,selectedQuestName:r,expanded:l===i.id,onQuest:u,onClick:m,onAddAdventurer:c,onRemoveAdventurer:o},i.id))},b=0;b<t;b++)h(b);return Object(B.jsxs)("div",{className:"room-list",children:[Object(B.jsx)("h2",{children:C.a.get("ui-structure-tavern-rooms")}),p]})}),la=n(33),da=(n(519),function(e){var t=e.level,n=Me("tavern"),a=n.levels[t],r=n.levels[t+1];return Object(B.jsxs)("div",{className:"upgrade-help-model-content-tavern",children:[Object(B.jsx)("h3",{children:C.a.get("ui-structure-help-upgrade-improvements")}),Object(B.jsxs)("div",{className:"rooms-increase",children:[Object(B.jsx)("div",{className:"header"}),Object(B.jsx)("div",{className:"header",children:C.a.getStructureName("tavern")}),Object(B.jsx)("div",{className:"header number",children:C.a.get("ui-structure-help-upgrade-header-level",{level:t+1})}),Object(B.jsx)("div",{className:"header"}),Object(B.jsx)("div",{className:"header number",children:C.a.get("ui-structure-help-upgrade-header-level",{level:t+2})}),Object(B.jsx)("div",{children:Object(B.jsx)(st.b,{image:"img/ui/structures/tavern.png",size:"smallest"})}),Object(B.jsx)("div",{children:C.a.get("ui-structure-tavern-rooms")}),Object(B.jsx)("div",{className:"number",children:a.rooms}),Object(B.jsx)("div",{className:"arrow",children:"\u27f6"}),Object(B.jsx)("div",{className:"number",children:r.rooms})]})]})}),ma=(n(520),"tavern"),pa=function(){var e=_e("tavern").level,t=Object(d.d)((function(e){return e.adventurers})),n=Object(d.d)((function(e){return e.quests})),a=Object(s.useState)([]),c=Object(y.a)(a,2),o=c[0],i=c[1],u=Object(s.useState)(),l=Object(y.a)(u,2),m=l[0],p=l[1],h=He("tavern").levels[e],b=Object(d.c)(),v=n.filter((function(e){return e.status===Gt.available})),f=function(e,t){var n=Object(r.a)(o);n[t]=e,i(n)},g=function(e){var t=o.indexOf(e),n=Object(r.a)(o);delete n[t],i(n)};return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(tt,{structure:"tavern"}),Object(B.jsxs)("div",{className:"tavern-structure-view",children:[Object(B.jsx)(nt,{structure:"tavern",onHelpClicked:function(t){var n=t.currentTarget.getBoundingClientRect(),a=Object(B.jsx)(Jt,{level:e,structure:"tavern",children:Object(B.jsx)(da,{level:e})});it.showContextTooltip(Xe.component,a,n,"upgrade-structure-tooltip"),t.stopPropagation()}}),Object(B.jsxs)("section",{children:[Object(B.jsx)(ua,{roomCount:h.rooms,adventurers:t,assignedAventurers:o,quests:n,selectedQuestName:m,onAddAdventurer:f,onRemoveAdventurer:g}),Object(B.jsx)(ta,{availableQuests:v,selectedQuestName:m,assignedAventurers:o,onQuestClick:function(e){return function(e){p(m===e?void 0:e),i([])}(e)},onAdventurerDropped:function(e,t){e.sourceId===ma&&f(e.adventurer,t)},onRemoveAdventurer:g,onLaunchQuest:function(){if(m){var e,t=C.a.getQuestTitle(m),n=o[0];Zn.b.addToast(t,Jn.a.questLaunched,null===n||void 0===n?void 0:n.avatarImg,Object(D.a)(m)),e=m,b(Object(la.f)(e,o))}}})]})]})]})},ha=pe.e,ba=[be.food,be.wood,be.iron,be.stone,be.fabric,be.leather],va=function(e){var t,n,a=e.structure,r=e.resource,c=Ge(),o=_e(a).workers,i=ze(a).generates[r]||0,s=ha-(Date.now()-c.lastProducedUpdate),u=qe[r],l=jt(),d=Ot(),m=(null!==(t=l[r])&&void 0!==t?t:0)>=(null!==(n=null===d||void 0===d?void 0:d[r])&&void 0!==n?n:0);return m?Object(B.jsx)("div",{className:"resource-generation-row",children:Object(B.jsx)("div",{className:"error-full",children:Object(B.jsx)(tn.a,{children:C.a.get("ui-structure-resource-warehouse-full",{structure:a,resource:r})})})}):Object(B.jsxs)("div",{className:"resource-generation-row",children:[Object(B.jsxs)("div",{className:"info",children:[Object(B.jsx)(st.b,{image:u.iconImg,size:"smallest"}),Object(B.jsx)("div",{children:C.a.get("ui-structure-resource-generates",{amount:i,resource:r})})]}),m,o>0&&Object(B.jsx)(Ye,{className:"generating",direction:Le.decreasing,label:"".concat(C.a.get("ui-structure-resource-next-generates",{amount:i*o,resource:r,time:Object(pe.h)(s)})),progress:s/ha}),!o&&C.a.get("ui-structure-resource-no-workers")]})},fa=function(e){var t=e.item;return Object(B.jsxs)("div",{className:"text",children:[Object(B.jsx)("p",{className:"name",children:C.a.getItemName(t)}),Object(B.jsx)("p",{className:"subtext",children:C.a.getItemSubtext(t)})]})},ga=(n(521),function(e){var t,n,a=e.renderButton,c=e.items,o="items-list ".concat(null!==(t=e.className)&&void 0!==t?t:""),i=null!==(n=e.slots)&&void 0!==n?n:c.length;return Object(B.jsx)("ul",{className:o,children:Object(r.a)(Array(i)).map((function(t,n){var r=c[n];return Object(B.jsxs)("li",{className:"item-row",children:[Object(B.jsx)("div",{className:"item-placeholder"}),r&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(gn,{item:r,index:n,sourceId:e.sourceId,sourceType:e.sourceType}),Object(B.jsx)(fa,{item:r})]}),r&&a&&a(r,n)]},"".concat(r).concat(n))}))})});!function(e){e[e.questProgress=0]="questProgress",e[e.resourceGeneration=1]="resourceGeneration",e[e.cheat=2]="cheat"}(ca||(ca={}));var ja=1,Oa=function(e){switch(e){case ca.cheat:default:return ja}};function ya(e){for(var t,n=null!==(t=Object.values(e).reduce((function(e,t){return(null!==e&&void 0!==e?e:0)+(null!==t&&void 0!==t?t:0)}),0))&&void 0!==t?t:0,a=Math.floor(Math.random()*n+1),r=0,c=Object.entries(e),o=0;o<c.length;o++)if(a<=(r+=c[o][1]))return c[o][0];throw new Error}var wa=3*pe.d,xa=function(e){var t=e.engine.lastHarvest,n=e.structures,a={};Oa(ca.resourceGeneration);return Date.now()-t>wa&&Object.keys(n).forEach((function(e){return function(e){var t=Me(e);if(t.type===oe.resource){var r,c=t,o=n[e].level,i=c.levels[o];if(null===(r=i.harvest)||void 0===r?void 0:r.lootTable){for(var s,u,l=null!==(s=null===(u=n[e].harvest)||void 0===u?void 0:u.length)&&void 0!==s?s:0,d=[];l<i.harvest.amount;)d.push(ya(i.harvest.lootTable)),l++;a[e]=d}}}(e)})),a},ka=(n(522),function(e){var t,n,a=e.iconImg,r=e.children,c=Object(V.a)(e,["iconImg","children"]),o=["icon-button",null!==(t=e.className)&&void 0!==t?t:"","size-".concat("string"===typeof e.size?e.size:st.a[null!==(n=e.size)&&void 0!==n?n:st.a.medium])];return Object(B.jsxs)("button",Object(X.a)(Object(X.a)({},c),{},{className:o.join(" "),children:[Object(B.jsx)(st.b,{image:a,size:e.size}),r&&Object(B.jsx)("div",{className:"text",children:r})]}))}),Ta=(n(523),function(e){var t=Ge(),n=Object(d.c)(),a=wa-(Date.now()-t.lastHarvest);return Object(B.jsxs)("div",{className:"harvest-progress",children:[Object(B.jsx)(Ye,{className:"harvest-progress",direction:Qe.decreasing,label:"".concat(C.a.get("ui-structure-resource-next-harvest",{time:Object(pe.h)(a)})),progress:a/wa}),Object(B.jsx)(ka,{iconImg:"/img/ui/misc/clock.png",size:"smallest",onClick:function(){n({type:"reduceTime",percentage:50,time:"harvest"})},children:" 50%"})]})}),Na=n.p+"static/media/icon.745e2ffb.png",Ia=(n(524),n(525),function(e){var t=e.level,n=Me(e.structure),a=n.levels[t],r=n.levels[t+1];return Object(B.jsx)("div",{className:"upgrade-help-model-content-resource",children:Object(B.jsxs)("div",{className:"grid generates-increase",children:[Object(B.jsx)("div",{className:"header",children:Object(B.jsx)("h3",{children:C.a.get("ui-structure-help-upgrade-improvements")})}),Object(B.jsx)("div",{className:"header"}),Object(B.jsx)("div",{className:"header number",children:C.a.get("ui-structure-help-upgrade-header-level",{level:t+1})}),Object(B.jsx)("div",{className:"header"}),Object(B.jsx)("div",{className:"header number",children:C.a.get("ui-structure-help-upgrade-header-level",{level:t+2})}),Object(B.jsx)("div",{children:Object(B.jsx)(st.b,{image:"/img/resources/worker.png",size:"smallest"})}),Object(B.jsx)("div",{children:C.a.get("ui-structure-help-upgrade-worker-capacity")}),Object(B.jsx)("div",{className:"number",children:a.workerCapacity}),Object(B.jsx)("div",{className:"arrow",children:"\u27f6"}),Object(B.jsx)("div",{className:"number",children:r.workerCapacity}),Object.keys(r.generates).map((function(e){return function(e){var t=qe[e];return Object(B.jsxs)(s.Fragment,{children:[Object(B.jsx)("div",{children:Object(B.jsx)(st.b,{image:t.iconImg,size:"smallest"})}),Object(B.jsx)("div",{children:C.a.get("ui-structure-resource-help-upgrade-resource-generates",{resource:e})}),Object(B.jsx)("div",{className:"number",children:a.generates[e]}),Object(B.jsx)("div",{className:"arrow",children:"\u27f6"}),Object(B.jsx)("div",{className:"number",children:r.generates[e]})]},e)}(e)}))]})})}),Sa=function(e){var t,n=e.structure,a=_e(n),r=a.level,c=a.workers,o=Object(d.d)((function(e){return xt(e)})),i=Object(d.d)((function(e){return qa(e,n)})),s=ze(n),u=Object(d.c)(),l=c===s.workerCapacity||(o||0)<1,m=0===c;return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(tt,{structure:e.structure}),Object(B.jsx)("div",{className:"resource-structure-view",children:Object(B.jsxs)("section",{children:[Object(B.jsx)(nt,{structure:n,onHelpClicked:function(e){var t=e.currentTarget.getBoundingClientRect(),a=Object(B.jsx)(Jt,{level:r,structure:n,children:Object(B.jsx)(Ia,{level:r,structure:n})});it.showContextTooltip(Xe.component,a,t,"upgrade-structure-tooltip"),e.stopPropagation()}}),Object(B.jsx)(ht,{label:C.a.get("ui-structure-production-workers"),value:c,max:s.workerCapacity,upDisabled:l,downDisabled:m,onDown:function(){u(function(e){return{type:"decreaseWorkers",structure:e,workers:arguments.length>1&&void 0!==arguments[1]?arguments[1]:1}}(e.structure))},onUp:function(){u(Wt(e.structure))}}),Object(B.jsx)("h3",{children:"Generates"}),Object.keys(s.generates).map((function(e){return Object(B.jsx)(va,{structure:n,resource:e},e)})),s.harvest&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("h3",{children:"Harvest"}),Object(B.jsx)(tn.a,{children:C.a.get("ui-structure-resource-harvest-".concat(n))}),Object(B.jsx)(Ta,{structure:n}),Object(B.jsx)(ga,{items:i,sourceType:pn.a.resourceStructure,sourceId:n,slots:null===(t=s.harvest)||void 0===t?void 0:t.amount,renderButton:function(e,t){return Object(B.jsx)(ka,{iconImg:Na,onClick:function(){return function(e,t){u(function(e,t){return{type:"removeItemFromHarvest",structure:e,index:t}}(n,t)),u(Pt(e))}(e,t)},children:"Take"})}})]})]})})]})},qa=function(e,t){var n;return null!==(n=e.structures[t].harvest)&&void 0!==n?n:[]},Ca=(n(526),function(e){var t=Object(d.d)((function(e){return e.tasks})).running.filter((function(t){return"town"===t.origin&&t.name==="".concat(e.structure,".build")}))[0],n=_e(e.structure);return Object(B.jsx)("div",{className:"structure-details",children:function(){if(n.state===g.Building)return t?Object(B.jsx)("div",{className:"building",children:Object(B.jsx)(Ye,{progress:t.progress,label:"Building... (".concat(Object(pe.h)(t.timeRemaining),")")})}):null;switch(Me(e.structure).type){case oe.production:return Object(B.jsx)($t,{structure:e.structure});case oe.resource:return Object(B.jsx)(Sa,{structure:e.structure});case oe.warehouse:return Object(B.jsx)(Yn,{});case oe.tavern:return Object(B.jsx)(pa,{});default:return Object(B.jsxs)("div",{children:[" ",e.structure," "]})}}()})}),Aa=(We(Ca),function(){var e=Object(N.i)().structure,t=C.a.getStructureName(e);return Object(B.jsxs)("div",{className:"structure-details-window ",children:[Object(B.jsxs)("div",{className:"header",children:[Object(B.jsx)("h3",{children:t}),Object(B.jsx)(T.b,{to:Object(D.b)(e,!0),children:Object(B.jsx)(Be,{className:"close-button",square:!0,size:"medium",color:"purple",text:"x"})})]}),Object(B.jsx)(Ca,{structure:e,title:t})]})}),Ea=(n(527),new M.a(8,16763904)),Ma=J((function(){var e=Object(N.j)("".concat(Object(D.c)(),"/:structure")),t=null===e||void 0===e?void 0:e.params.structure,n=Object(s.useRef)(null),a=Object(s.useRef)(null),r=Object(s.useRef)(!1),c=Object(N.g)();Object(s.useEffect)((function(){q.c.addSound("music/town","sound/music/Soliloquy.mp3",(function(){q.c.playSound("music/town",q.a.music,!0,q.b.fade,!0)}))}),[]),Object(s.useEffect)((function(){var e=S.b.to(Ea,{duration:.6,thickness:2,yoyo:!0,repeat:-1});return function(){e.pause(0),e.kill()}}),[]),Object(s.useEffect)((function(){if(a.current){var e=a.current;e.on("drag-start",(function(e){r.current=!0,e.event.stopPropagation()})),e.on("drag-end",(function(){r.current=!1}))}}),[]);var o=function(e){!r.current&&e&&(q.c.playSound("ui/buttonClick"),c.push(Object(D.b)(e)))},i=Object(d.d)((function(e){return e.structures}));Object(s.useEffect)((function(){if(t&&a.current){var e=a.current;e.zoomPercent(0);var n=Ra(t);e.moveCenter(n)}}),[t]);var u=Object(s.useState)(Sc),l=Object(y.a)(u,2),m=l[0],p=l[1],h=Object(s.useState)(1079),b=Object(y.a)(h,2),v=b[0],f=b[1];return Object(s.useEffect)((function(){var e=function(){var e,t,a=(null===(e=n.current)||void 0===e?void 0:e.clientWidth)||Sc,r=(null===(t=n.current)||void 0===t?void 0:t.clientHeight)||1079;p(a),f(r)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),Object(B.jsxs)("div",{className:"town-view",ref:n,children:[Object(B.jsx)($,{structures:i}),Object(B.jsxs)(ie,{screenWidth:m,screenHeight:v,worldWidth:1024,worldHeight:1600,ref:a,children:[Object(B.jsx)(le,{worldWidth:m}),["workshop","quarry","tavern","tannery","alchemist","garden","weaponsmith","armoursmith","warehouse","mine","lumberMill","weaver"].reverse().map((function(e){if(i[e].state===g.NotBuilt)return null;var n=Da(e),a=Ra(e),r=new _(H,e);return Object(B.jsx)(n,{position:a,structure:e,hitAreaShapes:r,onStructureClick:o,selected:t===e},e)})),Object(B.jsx)(le,{worldWidth:m})]}),Object(B.jsx)(N.d,{children:Object(B.jsx)(N.b,{path:"/town/:structure/view",children:Object(B.jsx)(Aa,{})})})]})})),Da=function(e){switch(e){case"workshop":case"quarry":case"tannery":case"alchemist":case"garden":case"weaponsmith":case"armoursmith":case"warehouse":case"mine":case"weaver":return K;case"lumberMill":return F;case"tavern":return U}},Ra=function(e){var t,n;switch(e){case"workshop":t=373,n=610;break;case"quarry":t=632,n=633;break;case"tannery":t=372,n=460;break;case"tavern":t=500,n=469;break;case"alchemist":t=411,n=371;break;case"garden":t=822,n=689;break;case"weaponsmith":t=449,n=460;break;case"armoursmith":t=473,n=442;break;case"warehouse":t=471,n=130;break;case"lumberMill":t=403,n=320;break;case"mine":t=183,n=527;break;case"weaver":t=484,n=333}return new w.Point(t,n)},Pa=(n(528),function(){var e=Object(s.useState)([]),t=Object(y.a)(e,2),n=t[0],a=t[1],r=function(e){e&&a(e)};return Object(s.useEffect)((function(){return Zn.b.instance.addListener(Zn.a,r),function(){Zn.b.instance.removeListener(Zn.a,r)}}),[]),Object(B.jsx)("div",{className:"toasts",children:n.map((function(e){return Object(B.jsx)(Jn.b,Object(X.a)({},e),e.time)}))})}),_a=n(67),Ha=(n(529),Object(_a.b)(We)((function(){var e=function(e){return Object(B.jsxs)("p",{children:[Object(B.jsx)("label",{children:q.a[e]}),Object(B.jsx)("button",{onClick:function(t){var n,a=null===(n=t.currentTarget.parentNode)||void 0===n?void 0:n.lastChild;a&&S.a.to(a,{duration:.5,value:0,onComplete:function(){q.c.setChannelVolume(e,0)}})},children:Object(B.jsx)("span",{role:"img","aria-label":"Mute",children:"\ud83d\udd07"})}),Object(B.jsx)("input",{type:"range",min:"0",max:"1",step:"0.05",onChange:function(t){var n=parseFloat(t.target.value),a=Math.pow(n,2);q.c.setChannelVolume(e,a)},defaultValue:"".concat(Math.sqrt(q.c.getChannelVolume(e)))})]})};return Object(B.jsx)("div",{className:"settings-window",children:Object(B.jsxs)("details",{open:!0,className:"sound",children:[Object(B.jsx)("summary",{children:"Sound volume"}),Object(B.jsxs)("section",{children:[e(q.a.ui),e(q.a.scene),e(q.a.music)]})]})})}))),za=n(316),La=function(e){return Object(B.jsx)(za.a,Object(X.a)({styles:{control:function(e,t){return Object(X.a)(Object(X.a)({},e),{},{minHeight:"inherit",height:"32px",boxShadow:"0",border:t.isFocused?"1px solid orange":"1px solid #B1B1B1",":hover":{border:"1px solid orange"}})},container:function(e,t){return Object(X.a)(Object(X.a)({},e),{},{flex:1})},option:function(e){return Object(X.a)(Object(X.a)({},e),{},{padding:"4px 12px"})},placeholder:function(e){return Object(X.a)(Object(X.a)({},e),{},{whiteSpace:"nowrap"})},valueContainer:function(e){return Object(X.a)(Object(X.a)({},e),{},{marginTop:"-2px"})},indicatorsContainer:function(e){return Object(X.a)(Object(X.a)({},e),{},{marginTop:"-2px",div:{padding:"4px"}})}}},e))};La.displayName="DefaultSelect";var Ba,Fa=La,Wa=(n(541),We((function(){var e=Object(s.useState)({gold:50,resources:50,workers:10}),t=Object(y.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)(),c=Object(y.a)(r,2),o=c[0],i=c[1],u=Object(d.c)(),l=Object(s.useState)(Oa(ca.cheat)),m=Object(y.a)(l,2),p=m[0],b=m[1],v=Object(d.d)((function(e){return e.structures})),f=function(e,t){!function(e,t){u(function(e,t){return{type:"setStructureState",structure:e,state:t}}(e,t))}(e,t?g.Built:g.NotBuilt),t?Zn.b.addToast("The ".concat(C.a.getStructureName(e)," is constructed"),Jn.a.cheat):Zn.b.addToast("The ".concat(C.a.getStructureName(e)," is not constructed"),Jn.a.cheat)},j=Object(s.useMemo)((function(){return Object.keys(yn.a).filter((function(e){return!isNaN(parseInt(e))})).map((function(e){return{label:yn.a[e],value:"",subtext:"",options:Object.keys(lt.a).filter((function(t){return Object(lt.c)(t).itemType==e})).map((function(e){return{value:e,label:C.a.getItemName(e),subtext:C.a.getItemSubtext(e)}}))}}))}),[]);return Object(s.useEffect)((function(){0}),[]),Object(B.jsxs)("div",{className:"cheat-window",children:[Object(B.jsxs)("div",{className:"label-numberbox-button",children:[Object(B.jsx)("label",{children:"Gold"}),Object(B.jsx)("input",{type:"number",value:n.gold,style:{width:"50px"},onChange:function(e){var t=Number.parseFloat(e.target.value);a(Object(X.a)(Object(X.a)({},n),{},{gold:t}))}}),Object(B.jsx)("button",{onClick:function(e){var t=n.gold;!function(e){u(Object(Yt.a)(e)),u(Object(h.b)("common-cheat-gold-added",{amount:e},Zt.a.common))}(t);var a=C.a.get("common-cheat-gold-added",{amount:t});Zn.b.addToast(a,Jn.a.cheat,"/img/resources/gold.png")},children:"Add"})]}),Object(B.jsxs)("div",{className:"label-numberbox-button",children:[Object(B.jsx)("label",{children:"Workers"}),Object(B.jsx)("input",{type:"number",value:n.workers,style:{width:"50px"},onChange:function(e){var t=Number.parseFloat(e.target.value);a(Object(X.a)(Object(X.a)({},n),{},{workers:t}))}}),Object(B.jsx)("button",{onClick:function(e){var t=n.workers;!function(e){u({type:"addWorkers",value:e}),u(Object(h.b)("common-cheat-workers-added",{amount:e},Zt.a.common))}(t);var a=C.a.get("common-cheat-workers-added",{amount:t});Zn.b.addToast(a,Jn.a.cheat,"/img/resources/worker.png")},children:"Add"})]}),Object(B.jsxs)("div",{className:"label-numberbox-button",children:[Object(B.jsx)("label",{children:"Resources"}),Object(B.jsx)("input",{type:"number",value:n.resources,style:{width:"50px"},onChange:function(e){var t=Number.parseFloat(e.target.value);a(Object(X.a)(Object(X.a)({},n),{},{resources:t}))}}),Object(B.jsx)("button",{onClick:function(e){!function(e){var t=ba.reduce((function(t,n){return t[n]=e,t}),{});u(zt(t)),u(Object(h.b)("common-cheat-resources-added",{amount:e},Zt.a.common))}(n.resources);var t=C.a.get("common-cheat-resources-added",{amount:n.resources});Zn.b.addToast(t,Jn.a.cheat)},children:"Add"})]}),Object(B.jsxs)("div",{className:"label-numberbox-button",children:[Object(B.jsx)("label",{children:"Items"}),Object(B.jsx)(Fa,{placeholder:"Find item in any category...",onChange:function(e){return i(null===e||void 0===e?void 0:e.value)},formatGroupLabel:function(e){return Object(B.jsxs)("div",{className:"item-group",children:[Object(B.jsx)("div",{className:"item-group-label",children:e.label}),Object(B.jsxs)("div",{className:"item-group-count",children:[e.options.length," items"]})]})},formatOptionLabel:function(e){return Object(B.jsxs)("div",{className:"item-option",children:[Object(B.jsx)(dt,{item:e.value,size:st.a.smallest}),Object(B.jsxs)("div",{className:"item-label",children:[e.label,Object(B.jsx)("span",{children:e.subtext})]})]})},options:j}),Object(B.jsx)(Be,{onClick:function(e){var t=o;!function(e){u(Pt(e)),u(Object(h.b)("common-cheat-item-added",{item:e},Zt.a.common))}(t);var n=C.a.get("common-cheat-item-added",{item:t}),a=Object(lt.c)(t).iconImg;Zn.b.addToast(n,Jn.a.cheat,a)},children:"Add"})]}),Object(B.jsxs)("div",{className:"label-range-value",children:[Object(B.jsx)("label",{children:"Speed"}),Object(B.jsx)("input",{type:"range",min:"1",max:"10",value:p,step:1,onChange:function(e){var t=Number.parseFloat(e.target.value);b(t),function(e){ja=e}(t)}}),p,"x speed"]}),Object(B.jsx)("div",{children:Object(B.jsx)("h2",{children:"Structures"})}),Object.keys(v).map((function(e){return function(e){var t=Me(e),n=v[e],a=t.levels[n.level],r=C.a.get(a.displayName);return Object(B.jsxs)("div",{className:"label-dropdown",children:[Object(B.jsx)("label",{title:e,children:"".concat(r)}),Object(B.jsx)("input",{type:"checkbox",checked:n.state===g.Built,onChange:function(){return f(e,n.state!==g.Built)}},e)]},e)}(e)}))]})}))),Va=n(312),Qa=Object(Va.createEncryptor)("P5mw}jD>5c6Y]yqy"),Ga=(n(636),Object(_a.b)(We,J)((function(e){var t=Object(d.d)((function(e){return e})),n=Object(s.useState)(),a=Object(y.a)(n,2),r=a[0],c=a[1],u=function(){var t=Object(i.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return c(void 0),t.next=5,To(r);case 5:Zn.b.addToast(C.a.get("ui-game-loaded"),Jn.a.game,"/img/items/misc/magic-eye.png"),e.onCloseWindow();case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(B.jsxs)("div",{className:"menu",children:[Object(B.jsx)("p",{children:Object(B.jsx)(Be,{onClick:function(){var t=Object(B.jsx)(Wa,{title:"Cheats"});e.onOpenWindow(t)},children:"Cheats!"})}),Object(B.jsx)("p",{children:Object(B.jsx)(Be,{onClick:function(){var t=Object(B.jsx)(Ha,{title:"Settings"});e.onOpenWindow(t)},children:"Settings"})}),Object(B.jsxs)("fieldset",{children:[Object(B.jsx)("legend",{children:"Save and load"}),Object(B.jsxs)("section",{children:["Save game to disk:\xa0",Object(B.jsx)(Be,{onClick:function(){!function(e){var t=document.createElement("a"),n=JSON.stringify(e),a=Qa.encrypt(n);t.setAttribute("href","data:text/json;charset=utf-8,"+encodeURIComponent(a)),t.setAttribute("download","Gidletown save.json"),t.click()}(t)},children:"Save"})]}),Object(B.jsxs)("section",{children:["Load game from disk:\xa0",Object(B.jsx)("input",{type:"file",onChange:function(e){var t=new FileReader;t.onload=function(){var e=function(e){var t=Qa.decrypt(e);return JSON.parse(t)}(t.result);c(e)},e.target.files&&t.readAsText(e.target.files[0])}}),Object(B.jsx)(Be,{onClick:u,disabled:!r,children:"Load"})]})]})]})}))),Ua=(n(637),function(){var e=yt(),t=jt(),n=kt(),a=Ot(),r=function(e,t,n){var r,c="workers"!==n&&"gold"!==n&&(null!==t&&void 0!==t?t:0)>=(null!==(r=null===a||void 0===a?void 0:a[n])&&void 0!==r?r:0);return Object(B.jsxs)("li",{onClick:function(e){var t=e.currentTarget.getBoundingClientRect();it.showContextTooltip(Xe.resource,n,t),e.stopPropagation()},children:[Object(B.jsx)(st.b,{image:e,size:"smallest"}),Object(B.jsx)("div",{className:"amount ".concat(c?"full":""),children:nn(t,0)})]},n)},c=ba.map((function(e){var n;return r(qe[e].iconImg,null!==(n=t[e])&&void 0!==n?n:0,e)}));return c.push(r("/img/resources/worker.png",n,"workers"),r("/img/resources/gold.png",e,"gold")),Object(B.jsx)("ul",{className:"resourcebar",children:c})}),Xa=(n(638),function(e){var t=Object(s.useContext)(qc);return Object(B.jsxs)("div",{className:"topbar",children:[Object(B.jsx)("div",{className:"topbar-left",children:Object(B.jsx)(Ua,{})}),Object(B.jsx)("div",{className:"topbar-right",children:Object(B.jsx)("div",{className:"hamburger",onClick:function(n){var a=Object(B.jsx)(Ga,{title:"Menu",persistor:e.persistor});null===t||void 0===t||t.onOpenWindow(a)},children:"\u2630"})})]})}),Ya=n(19),Za=function(e){var t=e.quest,n=e.leader,a=e.encounterActive,r=e.position,c=e.onClick,o=e.selected?"/img/world/map-marker-selected.png":"/img/world/map-marker.png",i=Object(s.useRef)(null);return Object(s.useEffect)((function(){var e=i.current,t=new w.Graphics;t.beginFill(12245589),t.drawCircle(0,0,256),t.endFill(),e.mask=t,e.addChild(t)}),[i]),Object(B.jsxs)(z.Sprite,{image:"".concat(".").concat(o),name:t.name,x:r.x,y:r.y,interactive:!0,buttonMode:!0,scale:new w.Point(.1,.1),anchor:new w.Point(.5,1),pointerdown:function(){c&&c(t)},children:[n&&Object(B.jsx)(z.Sprite,{image:"".concat(".").concat(n.avatarImg),name:"avatar",anchor:new w.Point(.5,.5),x:0,y:-396,scale:new w.Point(.66,.66),ref:i}),a&&Object(B.jsx)(z.Sprite,{image:"".concat(".","/img/world/quest-alert.png"),name:"quest-alert",anchor:new w.Point(.5,1),x:180,y:-396,scale:new w.Point(2,2)})]})},Ja=function(e){var t=e.positions;return e.positions.length>2?Object(B.jsx)(z.Graphics,{name:"questline",x:0,y:0,draw:function(e){e.lineStyle(3,16724736),e.moveTo(t[0].x,t[0].y);var n=0;for(n=1;n<t.length-2;n++){var a=(t[n].x+t[n+1].x)/2,r=(t[n].y+t[n+1].y)/2;e.quadraticCurveTo(t[n].x,t[n].y,a,r)}e.quadraticCurveTo(t[n].x,t[n].y,t[n+1].x,t[n+1].y),e.endFill()}}):null},Ka=n(71),$a=(n(639),function(e){var t=e.retrieveWorldViewRef,n=e.smallMap,a=Object(s.useCallback)((function(t){return t.quests.find((function(t){return t.name===e.selectedQuestName}))}),[e.selectedQuestName]),r=Object(d.d)(a),c=Object(d.d)((function(e){return e.adventurers})),o=function(){var e=Object(s.useMemo)((function(){return Object(Ze.a)([Dn],_n)}),[]);return Object(d.d)(e)}(),i=Object(N.g)(),u=Object(s.useState)(Sc),l=Object(y.a)(u,2),m=l[0],p=l[1],h=Object(s.useState)(1024),b=Object(y.a)(h,2),v=b[0],f=b[1];Object(s.useEffect)((function(){var e=function(){var e,a,r=t(),c=(null===(e=r.current)||void 0===e?void 0:e.clientWidth)||Sc,o=(null===(a=r.current)||void 0===a?void 0:a.clientHeight)||1024;p(c),f(n?c<576?32:64:o)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[t,n]),Object(s.useEffect)((function(){if(r)j(r);else{var e=g.current,t=tr({x:0,y:0});null===e||void 0===e||e.moveCenter(t.x,t.y)}}),[r,v]);var g=Object(s.useRef)(null);Object(s.useEffect)((function(){if(g.current){var e=g.current,t=tr({x:0,y:0});e.moveCenter(t.x/2,t.y/2+10)}}),[m]);var j=function(e){var t=g.current;if(t){var n=er(e),a=tr(n);t.moveCenter(a.x,a.y)}},O={autoDensity:!0,sharedLoader:!0,width:m,height:v};return Object(B.jsxs)("div",{className:"world-map",children:[Object(B.jsx)(z.Stage,{width:m,height:v,options:O,children:Object(B.jsx)(ae,{screenWidth:m,screenHeight:v,worldWidth:1500,worldHeight:1061,ref:g,children:Object(B.jsxs)(z.Sprite,{image:"".concat(".","/img/world/francesca-baerald-fbaerald-angeloumap-lowres.jpg"),interactive:!0,pointerdown:function(){},children:[o.map((function(e){var t=nr(e);return Object(B.jsx)(Ja,{positions:t},e.name)})),o.map((function(t){var n,a=er(t),o=tr(a),i=null!==(n=Object(Ka.c)(c,t))&&void 0!==n?n:c[0],s=Object(Kn.a)(t.name),u=Math.floor(t.progress),l=s.nodes[u];return Object(B.jsx)(Za,{quest:t,leader:i,position:o,selected:t===r,encounterActive:l.type===Ya.a.encounter,onClick:function(t){return n=t.name,void e.onPartyClick(n);var n}},t.name)}))]})})}),e.selectedQuestName&&Object(B.jsxs)("div",{className:"title",children:[Object(B.jsxs)("span",{children:[Object(B.jsx)(ar,{questName:e.selectedQuestName}),C.a.getQuestTitle(e.selectedQuestName)]}),Object(B.jsx)("span",{onClick:function(){i.push(Object(D.d)())},className:"close",children:"x"})]})]})}),er=function(e){var t=Object(Kn.a)(e.name),n=Math.floor(e.progress),a=t.nodes[n],r=t.nodes[n+1];return r?Object(L.a)(a,r,e.progress-n):a},tr=function(e){var t=10*e.x+750,n=10*e.y+530.5;return new w.Point(t,n)},nr=function(e){for(var t=[],n=Object(Kn.a)(e.name),a=0;a<e.progress;a++)t.push(tr(n.nodes[a]));var r=tr(er(e));return t.push(r),t},ar=function(e){var t,n=e.questName,a=Hn(n),r=Object(d.c)();return(null===(t=a.scene)||void 0===t?void 0:t.combat)&&void 0!==a.scene.turn?Object(B.jsxs)("button",{onClick:function(){return r(Object(la.h)(n,!1))},children:["combat: on (",j.a[a.scene.turn],")"]}):Object(B.jsx)("button",{onClick:function(){return r(Object(la.h)(n,!0))},children:"combat: off"})},rr=function(e){return e.adventurers},cr=function(e){return e.quests},or=(Object(Ze.a)([rr,cr],(function(e,t){var n=[],a=Object.values(t).reduce((function(t,a){var c=Object(Ka.b)(e,a);return a.status===Gt.active&&(t[a.name]=c),n.push.apply(n,Object(r.a)(c)),t}),{});return a.solo=e.filter((function(e){return-1===n.indexOf(e)})),a})),function(e){return Object(Ze.a)([rr,cr],(function(t,n){var a=n.find((function(t){return t.name===e}));if(!a)throw new Error("No quest named ".concat(e));return Object(Ka.b)(t,a)}))}),ir=(Object(Ze.a)([rr,cr],(function(e,t){var n=t.reduce((function(e,t){return t.status===Gt.active&&e.push.apply(e,Object(r.a)(t.party)),e}),[]);return e.filter((function(e){return-1===n.indexOf(e.id)}))})),n(128)),sr=n(44),ur=n(144),lr=Object(z.PixiComponent)("RectTileLayer",{create:function(e){return new ur.a},applyProps:function(e,t,n){var a=n.layer,r=n.tilesets,c=n.horizontalTiles,o=n.spritesheets;if(a.data)for(var i=0;i<a.data.length;i++){var s=Object(sr.c)(a.data[i],r);if(s){var u=s.tilewidth,l=s.tileheight,d=i%c*u,m=Math.floor(i/c)*l,p=o[s.name];if(a.data[i]>0){var h="".concat(s.name,"-").concat(a.data[i]);e.addFrame(p.textures[h],d,m)}}}}}),dr=Object(z.PixiComponent)("ObjectTileLayer",{create:function(e){return new ur.a},applyProps:function(e,t,n){var a=n.objects,r=n.tilesets,c=n.spritesheets;a.length&&(e.clear(),a&&a.forEach((function(t){if(t.gid){var n=Object(sr.c)(t.gid,r);if(n){var a=t.x,o=t.y-n.tileheight,i=c[n.name],s="".concat(n.name,"-").concat(t.gid);e.addFrame(i.textures[s],a,o)}}})))}}),mr=n(18),pr=Object(z.PixiComponent)("SpriteAnimated",{create:function(e){var t=e.textures;return new w.AnimatedSprite(t||[],!0)},applyProps:function(e,t,n){t.textures!==n.textures&&(Object(z.applyDefaultProps)(e,t,n),e.gotoAndPlay(0))}});!function(e){e[e.blue=0]="blue",e[e.red=1]="red",e[e.teal=2]="teal",e[e.purple=3]="purple",e[e.orange=4]="orange",e[e.black=5]="black",e[e.white=6]="white",e[e.yellow=7]="yellow"}(Ba||(Ba={}));var hr,br=function(e){var t=e.tileWidth,n=e.actor,a=function(e){var t=mn(e.name);return e.allegiance===j.a.player?t.name:e.name}(n);return Object(B.jsxs)(z.Container,{y:-40,children:[Object(B.jsx)(z.Text,{y:-10,x:4,anchor:[0,1],text:"".concat(a," (").concat(n.ap,")"),style:{fontFamily:"Gabriela",fontSize:18,fill:16777215,align:"center",wordWrap:!0,wordWrapWidth:t,dropShadow:!0,dropShadowAngle:.9,dropShadowBlur:10,dropShadowDistance:0}}),Object(B.jsx)(z.Graphics,{name:"background",draw:function(e){e.beginFill(15387),e.drawRect(0,0,t,6),e.endFill()}}),Object(B.jsx)(z.Graphics,{name:"foreground",draw:function(e){e.beginFill(27426),e.drawRect(0,0,n.health,6),e.endFill()}})]})},vr=n(313);!function(e){e.north="n",e.northEast="ne",e.east="e",e.southEast="se",e.south="s",e.southWest="sw",e.west="w",e.northWest="nw"}(hr||(hr={}));var fr,gr=function(e){var t,n=e.location,a=void 0===n?[0,0]:n,r=e.controller,c=e.idleAnimation,o=e.color,i=e.children,u=e.spritesheetPath,l=e.lookAt,m=e.actor,p=Object(V.a)(e,["location","controller","idleAnimation","color","children","spritesheetPath","lookAt","actor"]),h=r.getTileDimensions(),b=h.tileWidth,v=h.tileHeight,f=Object(s.useRef)(null),g=Object(s.useRef)(),j=Object(d.c)(),O=Hn(e.controller.questName),x=Object(s.useCallback)((function(){var e;return(null===(e=O.scene)||void 0===e?void 0:e.actionQueue)?O.scene.actionQueue.filter((function(e){return e.actorId===m.name})):[]}),[O.scene,m.name]),k=Object(d.d)(x),T=Object(s.useState)("stand"),N=Object(y.a)(T,2),I=N[0],C=N[1],A=Object(s.useRef)();Object(s.useEffect)((function(){if(f){var t=function(){a[0]===n.target[0]&&a[1]>n.target[1]?Q(hr.north):a[0]<n.target[0]&&a[1]>n.target[1]?Q(hr.northEast):a[0]<n.target[0]&&a[1]===n.target[1]?Q(hr.east):a[0]<n.target[0]&&a[1]<n.target[1]?Q(hr.southEast):a[0]===n.target[0]&&a[1]<n.target[1]?Q(hr.south):a[0]>n.target[0]&&a[1]<n.target[1]?Q(hr.southWest):a[0]>n.target[0]&&a[1]===n.target[1]?Q(hr.west):a[0]>n.target[0]&&a[1]>n.target[1]&&Q(hr.northWest)},n=k[0];if(n&&n!==g.current){switch(n.actionType){case mr.a.move:var c=function(){j(Object(la.a)(e.controller.questName)),e.controller.actorMoved(m.name,n.target)},o=(n.endsAt-performance.now())/1e3;o<0&&c(),t(),C("walk"),S.b.killTweensOf(f.current),A.current=S.b.to(f.current,{duration:o,ease:"linear",pixi:{x:n.target[0]*b,y:n.target[1]*v},onComplete:c});break;case mr.a.slash:t(),C("attack"),q.c.playSound("scene/swish",q.a.scene,!1,q.b.singleInstance);setTimeout((function(){C("stand"),j(Object(la.a)(e.controller.questName))}),1e3);break;case mr.a.interact:r.actorInteract(m.name,n.target),j(Object(la.a)(e.controller.questName))}g.current=n}}}),[j,b,v,k,e.controller,e.name,a,r]),Object(s.useEffect)((function(){return function(){var e;null===(e=A.current)||void 0===e||e.kill()}}),[]);var E=Object(s.useMemo)((function(){return C("stand"),{x:a[0]*b,y:a[1]*v}}),[a,b,v]),M=E.x,D=E.y,R=Object(s.useState)(null),P=Object(y.a)(R,2),_=P[0],H=P[1];Object(s.useEffect)((function(){var e,t;if(u){if(!(null===(e=w.Loader.shared.resources[u])||void 0===e?void 0:e.textures))throw new Error("No textures for ".concat(u));var n=Object.keys(null!==(t=w.Loader.shared.resources[u].textures)&&void 0!==t?t:{}).reduce((function(e,t){var n,a=t.replace(/[0-9]/g,"");e[a]||(e[a]=[]);var r=null===(n=w.Loader.shared.resources[u].textures)||void 0===n?void 0:n[t];return r&&e[a].push(r),e}),{});H(n)}}),[u]);var L=Object(s.useState)(hr.north),F=Object(y.a)(L,2),W=F[0],Q=F[1],G=Object(s.useRef)(!1);Object(s.useEffect)((function(){if(void 0!==l){var e=Or(a,l);Q(e)}}),[a,l]),Object(s.useEffect)((function(){var e;e=W===hr.southWest||W===hr.west||W===hr.northWest,G.current=e}),[W]),Object(s.useEffect)((function(){if(c&&!l){var e=2e3+4e3*Math.random(),t=setInterval((function(){var e=Math.random()<.5;W===hr.north&&e?Q(hr.northWest):W===hr.northWest&&e?Q(hr.west):W===hr.west&&e?Q(hr.southWest):W===hr.southWest&&e?Q(hr.south):W===hr.south&&e?Q(hr.southEast):W===hr.southEast&&e?Q(hr.east):W===hr.east&&e?Q(hr.northEast):W===hr.northEast&&e&&Q(hr.north),W!==hr.north||e?W!==hr.northEast||e?W!==hr.east||e?W!==hr.southEast||e?W!==hr.south||e?W!==hr.southWest||e?W!==hr.west||e?W!==hr.northWest||e||Q(hr.north):Q(hr.northWest):Q(hr.west):Q(hr.southWest):Q(hr.south):Q(hr.southEast):Q(hr.east):Q(hr.northEast)}),e);return function(){return clearInterval(t)}}}),[I,c,W,l]);var U=Object(s.useCallback)((function(){switch(W){case hr.northWest:return"".concat("").concat(I,"-").concat(hr.northEast);case hr.west:return"".concat("").concat(I,"-").concat(hr.east);case hr.southWest:return"".concat("").concat(I,"-").concat(hr.southEast);default:return"".concat("").concat(I,"-").concat(W)}}),[I,W]),Y=Object(s.useMemo)((function(){switch(o){case Ba.black:return[yr(wr,Ir)];case Ba.orange:return[yr(wr,Nr)];case Ba.purple:return[yr(wr,Tr)];case Ba.red:return[yr(wr,xr)];case Ba.teal:return[yr(wr,kr)];case Ba.white:return[yr(wr,Sr)];case Ba.yellow:return[yr(wr,qr)];default:return[]}}),[o]),Z=!!(null===(t=O.scene)||void 0===t?void 0:t.combat);return Object(B.jsxs)(z.Container,Object(X.a)(Object(X.a)({x:M,y:D,ref:f},p),{},{children:[u&&_&&Object(B.jsx)(pr,{animationSpeed:.1,name:"sprite",isPlaying:!0,textures:_[U()],x:35.5,y:20,scale:[G.current?-1:1,1],anchor:[.5,.5],pivot:[0,0],filters:Y}),i,Z&&Object(B.jsx)(br,{tileWidth:b,actor:m})]}))},jr=Object(s.memo)(gr),Or=function(e,t){var n=Math.atan2(t[1]-e[1],t[0]-e[0]),a=Math.round((n/(2*Math.PI/8)+8)%8);return[hr.east,hr.southEast,hr.south,hr.southWest,hr.west,hr.northWest,hr.north,hr.northEast][a]},yr=function(e,t){var n=e.map((function(n,a){return[e[a],t[a]]}));return new vr.a(n,.15)},wr=[3679,8831,14501,21964],xr=[5703680,7343104,9441280,11867904],kr=[13069,25914,562031,3194533],Tr=[3870010,6561118,8930966,11166141],Nr=[8400140,11160082,13724945,16094999],Ir=[855322,1710891,2434618,3487052],Sr=[3159902,6777235,11119298,15132390],qr=[12748288,14069264,15323955,16644441],Cr=function(e){var t=e.controller,n=e.location,a=e.actor,r=e.selected,c=e.spritesheetPath,o=t.getTileDimensions(),i=o.tileWidth,u=o.tileHeight,l=Object(s.useRef)(null);return Object(B.jsx)(z.Container,{ref:l,children:Object(B.jsx)(jr,{actor:a,controller:t,spritesheetPath:c,location:n,idleAnimation:Math.random()<.5,children:r&&Object(B.jsx)(z.Graphics,{name:"selectioncircle",draw:function(e){e.lineStyle(3,16777215),e.drawCircle(i/2,u/2,i/2-3),e.endFill()}})})})},Ar=Object(s.memo)(Cr),Er=function(e){var t=e.objects,n=e.controller;return Object(B.jsx)(z.Container,{children:t.map((function(t){var a=t.location,r=t.name,c=t.properties,o=c.adventurerId,i=c.spritesheet;switch(t.type){case sr.a.actor:if(Object(mr.c)(t)){if(t.allegiance===j.a.player)return Object(B.jsx)(Ar,{location:a,controller:n,actor:t,spritesheetPath:i,selected:e.selectedActorId===r},o);if(t.allegiance===j.a.enemy)return Object(B.jsx)(jr,{actor:t,controller:n,spritesheetPath:i,location:a,idleAnimation:Math.random()<.5,lookAt:[4,3]},t.name)}break;default:return null}return null}))})},Mr=function(e){var t=e.data,n=e.objects,a=e.controller,r=e.spritesheets,c=e.selectedActorId;return Object(B.jsx)(z.Container,{children:t.layers.filter((function(e){return e.visible})).map((function(e){if(e.type===ir.a.objectgroup){var o=Dr(n,e),i=o.tileObjects,s=o.spriteObjects;return Object(B.jsxs)(u.a.Fragment,{children:[!!i.length&&Object(B.jsx)(dr,{objects:i,tilesets:t.tilesets||[],spritesheets:r}),!!s.length&&Object(B.jsx)(Er,{objects:s||[],controller:a,selectedActorId:c},e.name)]},e.name)}return e.type===ir.a.tilelayer?Object(B.jsx)(lr,{layer:e,horizontalTiles:t.width,tilesets:t.tilesets,spritesheets:r},e.name):null}))})},Dr=function(e,t){return e.reduce((function(e,n){return n.layerId===t.id&&(void 0!==n.gid?e.tileObjects.push(n):!0===n.properties.isSprite&&e.spriteObjects.push(n)),e}),{tileObjects:[],spriteObjects:[]})},Rr=function(e){var t=e.children,n=Object(V.a)(e,["children"]);return Object(B.jsx)(d.b.Consumer,{children:function(e){var a=e.store;return Object(B.jsx)(z.Stage,Object(X.a)(Object(X.a)({},n),{},{children:Object(B.jsx)(d.a,{store:a,children:t})}))}})},Pr=function(e){var t=Object(s.useState)({}),n=Object(y.a)(t,2),a=n[0],r=n[1],c=Object(s.useState)(),o=Object(y.a)(c,2),i=o[0],u=o[1];return Object(s.useEffect)((function(){if(i){var t=_r(i,a);if(t){var n=t.name;Object(L.b)("".concat(e,"/").concat(t.image),(function(c){if(c){if(c.error)throw new Error("Loading ".concat(e,"\n").concat(c.error));var o=Hr(t),i=new w.Spritesheet(c.texture,o);i.parse((function(){var e=Object(X.a)(Object(X.a)({},a),{},Object(Se.a)({},n,i));r(e)}))}}))}}}),[i,e,a]),{loadComplete:!!i&&void 0===_r(i,a),loadTilesets:function(e){u(e)},tileSpritesheets:a}},_r=function(e,t){return e.find((function(e){return!t[e.name]}))},Hr=function(e){for(var t=e.columns,n={},a=0;a<e.tilecount;a++){var r=e.tilewidth,c=e.tileheight,o=a%t*r,i=Math.floor(a/t)*c;n["".concat(e.name,"-").concat(a+e.firstgid)]={frame:{x:o,y:i,w:r,h:c},spriteSourceSize:{x:o,y:i,w:r,h:c},rotated:!1,trimmed:!1,sourceSize:{w:r,h:c}}}return{frames:n,meta:{image:e.image,size:{w:e.imagewidth,h:e.imageheight},scale:"1"}}},zr=function(e){var t=e.icon,n=e.onActivate,a=e.onDeactivate,r=e.tileHeight,c=e.activated,o=Object(s.useMemo)((function(){switch(e.position){case"w":return 180;case"sw":return 135;case"s":return 90;case"se":return 45;default:return 0}}),[e.position]),i=c?"scale(2)":"scale(1.5)",u=Object(X.a)({transform:"translate(".concat(16,"px, ").concat(r/2-23,"px) ").concat(i," rotate(").concat(o,"deg) translateX(").concat(c?27:35,"px)"),background:"url(".concat(".","/img/scene/ui/combat/ring-segment.svg)"),width:32,height:46},c&&{zIndex:2});return Object(B.jsx)("div",{style:u,className:"segment",onMouseOver:n,onMouseOut:a,children:Object(B.jsx)("img",{src:t,style:{transform:"rotate(-".concat(o,"deg)"),width:24},alt:""})})},Lr=(n(640),function(e){var t=e.location,n=e.actionIntent,a=e.onActionChange,r=e.selectedActorId,c=Object(s.useContext)(kn),o=c.getTileDimensions(),i=o.tileWidth,u=o.tileHeight,l="translate(".concat(i*t[0],"px, ").concat(u*t[1],"px)"),d=Object(s.useState)(!0),m=Object(y.a)(d,2),p=m[0],h=m[1],b=Object(s.useMemo)((function(){var e;return null===(e=c.getSceneActor(r))||void 0===e?void 0:e.location}),[]),v=function(e){a(e)},f=function(e){a(void 0)};return Object(B.jsxs)("div",{className:"combat-ui-widget ".concat(p?"collapsed":"expanded"),style:{transform:l},onMouseMove:function(e){e.preventDefault(),e.stopPropagation()},onMouseOver:function(){Object(sr.d)(t,null!==b&&void 0!==b?b:[0,0])||h(!1)},onMouseOut:function(){h(!0)},children:[Object(B.jsx)(zr,{position:"w",tileHeight:u,icon:"".concat(".","/img/scene/ui/combat/icons/knife-thrust.svg"),onActivate:function(){return v(mr.a.slash)},onDeactivate:function(){return f(mr.a.slash)},activated:(null===n||void 0===n?void 0:n.action)===mr.a.slash}),Object(B.jsx)(zr,{position:"sw",tileHeight:u,icon:"".concat(".","/img/scene/ui/combat/icons/high-shot.svg"),activated:!1}),Object(B.jsx)(zr,{position:"s",tileHeight:u,icon:"".concat(".","/img/scene/ui/combat/icons/walking-boot.svg"),onActivate:function(){return v(mr.a.move)},onDeactivate:function(){return f(mr.a.move)},activated:(null===n||void 0===n?void 0:n.action)===mr.a.move}),Object(B.jsx)(zr,{position:"se",icon:"".concat(".","/img/scene/ui/combat/icons/sunken-eye.svg"),tileHeight:u,activated:!1}),Object(B.jsx)(zr,{position:"e",icon:"".concat(".","/img/scene/ui/combat/icons/crosshair.svg"),tileHeight:u,activated:!1}),Object(B.jsx)("div",{className:"info",style:{width:i},children:Br(n)})]})}),Br=function(e){if(!e)return null;if(e.action===mr.a.move){var t;if(!(null===(t=e.path)||void 0===t?void 0:t.length))return null;var n=(e.actorAP||0)<(e.apCost||0);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("span",{children:"Move"}),Object(B.jsxs)("span",{className:"".concat(n?"insufficient":""),children:[" ".concat(e.apCost),"AP"]})]})}if(e.action===mr.a.slash){var a;if(!(null===(a=e.path)||void 0===a?void 0:a.length))return null;var r=(e.actorAP||0)<(e.apCost||0);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("span",{children:"Slash"}),Object(B.jsxs)("span",{className:"".concat(r?"insufficient":""),children:[" ".concat(e.apCost),"AP"]})]})}return"?"},Fr=(n(641),function(e){var t,n,a=e.location,r=Object(s.useContext)(kn),c=null!==(t=null===r||void 0===r?void 0:r.locationIsBlocked(a))&&void 0!==t&&t,o=mr.a.move;if(c){var i=null===r||void 0===r?void 0:r.getObjectAtLocation(a);(null===i||void 0===i?void 0:i.properties.interactive)&&(o=mr.a.interact,c=!1)}var u=null!==(n=null===r||void 0===r?void 0:r.getTileDimensions())&&void 0!==n?n:{tileWidth:64,tileHeight:64},l=u.tileWidth,d=u.tileHeight,m="translate(".concat(l*a[0],"px, ").concat(d*a[1],"px)"),p=Wr[o],h=l,b=d;return Object(B.jsx)("div",{className:"normal-ui-cursor ".concat(c?"invalid":""),style:{transform:m,backgroundImage:p,width:h,height:b}})}),Wr=(fr={},Object(Se.a)(fr,mr.a.move,"url(".concat(".","/img/scene/ui/combat/icons/walking-boot.svg)")),Object(Se.a)(fr,mr.a.interact,"url(".concat(".","/img/scene/ui/combat/icons/sunken-eye.svg)")),fr),Vr=(n(642),function(e){var t,n=e.children,a=e.selectedActorId,r=e.actionIntent,c=e.sceneWidth,o=e.sceneHeight,i=e.onMouseDown,u=e.onSetActionIntent,l=Object(s.useRef)(null),d=Object(s.useRef)(!1),m=Object(s.useRef)(1),p=Object(s.useContext)(kn),h=Hn(null!==(t=null===p||void 0===p?void 0:p.questName)&&void 0!==t?t:"").scene,b=(null!==h&&void 0!==h?h:{}).combat,v=Object(s.useState)(),f=Object(y.a)(v,2),g=f[0],j=f[1];Object(s.useEffect)((function(){var e=function(){var e;if(l.current){var t=null===(e=l.current.parentNode)||void 0===e?void 0:e.querySelector("canvas");if(!t)throw Error("No canvas found as sibling of SceneUI");var n=null===t||void 0===t?void 0:t.clientWidth;m.current=n/c,l.current.style.transform="scale(".concat(m.current,")"),l.current.style.width="".concat(c,"px"),l.current.style.height="".concat(o,"px")}};return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}}),[o,c]);var O=Object(s.useCallback)((function(e){var t;if(e){var n=null!==(t=null===p||void 0===p?void 0:p.getSceneActor(a))&&void 0!==t?t:{},r=n.location,c=void 0===r?[0,0]:r,o=n.ap,i=null!==g&&void 0!==g?g:[0,0];switch(e){case mr.a.move:case mr.a.slash:var s=null===p||void 0===p?void 0:p.findPath(c,i),l=b?null===p||void 0===p?void 0:p.calculateWalkApCosts(c,i):void 0;u({action:e,from:c,to:i,apCost:l,actor:a,actorAP:o,path:s});break;case mr.a.interact:var d=null===p||void 0===p?void 0:p.findPathNearest(c,i,!0);u({action:e,from:c,to:i,apCost:0,actor:a,actorAP:o,path:d})}}else u(void 0)}),[b,p,g,u,a]);Object(s.useEffect)((function(){if(!b&&void 0!==g){var e=mr.a.move,t=null===p||void 0===p?void 0:p.getObjectAtLocation(g);(null===t||void 0===t?void 0:t.properties.interactive)&&(e=mr.a.interact),O(e)}}),[g,O,b,p]);var x=function(e){if(e.target instanceof Element){var t=e.target.getBoundingClientRect(),n=(e.clientX-t.left)/m.current,a=(e.clientY-t.top)/m.current;return null===p||void 0===p?void 0:p.pointToSceneLocation(new w.Point(n,a))}throw new Error("You didnt give me the correct event")};return Object(B.jsxs)("div",{ref:l,className:"scene-ui",onMouseMove:function(e){if(d.current){var t,n=null!==(t=x(e))&&void 0!==t?t:[0,0];if(null===p||void 0===p?void 0:p.locationIsOutOfBounds(n))return j(void 0),void u(void 0);g&&Object(sr.d)(n,g)||j(n)}},onMouseDown:function(e){var t=x(e);t&&(null===i||void 0===i||i(t)),d.current=!0,e.preventDefault()},onMouseUp:function(e){var t;if(d.current=!1,j(void 0),r){var n=null===p||void 0===p||null===(t=p.getSceneActor(a))||void 0===t?void 0:t.location;n&&g&&!Object(sr.d)(n,g)&&(null===p||void 0===p||p.actorAttemptAction(a,r.action,r.to)),null===u||void 0===u||u(void 0)}},children:[n,!(null===h||void 0===h?void 0:h.combat)&&g&&Object(B.jsx)(Fr,{location:g}),(null===h||void 0===h?void 0:h.combat)&&g&&Object(B.jsx)(Lr,{location:g,selectedActorId:a,actionIntent:r,onActionChange:O})]})}),Qr=n(64),Gr=Object(z.PixiComponent)("DashedLine",{create:function(){return new w.Graphics},applyProps:function(e,t,n){var a=this,r=n.points,c=void 0===r?[]:r,o=n.dash,i=void 0===o?10:o,s=n.gap,u=void 0===s?5:s,l=n.speed,d=void 0===l?40:l,m=n.style,p=Object(V.a)(n,["points","dash","gap","speed","style"]);Object(z.applyDefaultProps)(e,t,p),e.clear();!function t(){var n;if(!a._destroy){e.clear(),e.lineStyle(null!==(n=null===m||void 0===m?void 0:m.width)&&void 0!==n?n:10,null===m||void 0===m?void 0:m.color,null===m||void 0===m?void 0:m.alpha,null===m||void 0===m?void 0:m.alignment,null===m||void 0===m?void 0:m.native);var r=(Date.now()%(1e4/d)+1)/Math.abs(1e4/d),o=0,s=0;if(r>0){var l=(i+u)*r*(d<-1?1:-1);l<i?o=i-l:s=u-(l-i)}var p,h=[],b=Object(Qr.a)(c);try{for(b.s();!(p=b.n()).done;){var v=p.value.clone(),f=Math.cos(e.rotation),g=Math.sin(e.rotation),j=v.x,O=v.y;v.x=j*f-O*g,v.y=j*g+O*f,h.push(v)}}catch(q){b.e(q)}finally{b.f()}for(var y=0;y<h.length-1;y++){var w=h[y],x=h[y+1],k=x.x-w.x,T=x.y-w.y,N=Math.sqrt(k*k+T*T),I={x:k/N,y:T/N},S=0;for(e.moveTo(w.x+s*I.x,w.y+s*I.y);S<=N;)S+=s,(S+=o>0?o:i)>N?(o=S-N,S=N):o=0,e.lineTo(w.x+S*I.x,w.y+S*I.y),(S+=u)>N&&0===o?s=S-N:(s=0,e.moveTo(w.x+S*I.x,w.y+S*I.y))}0!==d&&(a._raf=requestAnimationFrame(t))}}()},willUnmount:function(){this._destroy=!0,cancelAnimationFrame(this._raf)}}),Ur=function(e){var t=e.actionIntent,n=e.tileWidth,a=e.tileHeight;switch(t.action){case mr.a.move:case mr.a.interact:case mr.a.slash:if(!t.path)return null;var c=function(e){return new w.Point(e[0]*n+n/2,e[1]*a+a/2)},o=[c(t.from)].concat(Object(r.a)(t.path.map((function(e){return c(e)})))),i=!t.apCost||t.apCost<=(t.actorAP||0);return Object(B.jsx)(Gr,{points:o,dash:10,gap:15,speed:20,rotation:0,style:{width:6,color:i?16777215:9109504,alpha:1}});default:return null}},Xr=function(e){return e.log},Yr=function(e){var t=function(e){var t=Object(s.useMemo)((function(){return Object(Ze.a)([Xr],(function(t){return t.filter((function(t){return t.channel===Zt.a.quest&&t.channelContext===e}))}))}),[e]);return Object(d.d)(t)}(e.questId);return Object(s.useEffect)((function(){var e=t.shift();null===e||void 0===e||e.time,Date.now()}),[t]),null},Zr=(n(643),n(146)),Jr=function(){function e(){Object(R.a)(this,e)}return Object(P.a)(e,null,[{key:"initialize",value:function(e){this.sceneController=e;var t=this.handleStoreChange.bind(this);this.unsubscriber=e.store.subscribe(t)}},{key:"destroy",value:function(){var e;null===(e=this.unsubscriber)||void 0===e||e.call(this)}},{key:"handleStoreChange",value:function(){var e=this;if(this.sceneController){var t=this.sceneController.sceneAdventurers,n=this.sceneController.sceneEnemies,a=this.sceneController.quest;if(t&&n&&a&&a.scene){var r,c=t.reduce((function(e,t){return e+t.ap}),0),o=a.scene,i=o.turn;if(0===c&&i===j.a.player)return void this.dispatch(Object(la.k)(a.name,j.a.enemy));if(i===j.a.enemy&&!(null===(r=o.actionQueue)||void 0===r?void 0:r.length)){var s=n.reduce((function(e,t){return e+t.ap}),0);if(0===s)return void this.dispatch(Object(la.k)(a.name,j.a.player));console.log("total enemy ap: ",s);var u=this.findEnemyWithAp();if(console.log((new Date).getTime(),"do smt with: ",u,o,o.actionQueue),u&&u.location){var l=this.findNearestActor(u.location,j.a.player);if(!l||!l.location)return;console.log("attack ",l);var d=this.sceneController.findPath(u.location,l.location);null===d||void 0===d||d.forEach((function(t,n){var r={actionType:mr.a.move,actorId:u.name,target:t,endsAt:10*Zr.b*(n+1)+performance.now()};e.dispatch(Object(la.d)(a.name,r))}))}}}}}},{key:"getQuestStoreState",value:function(){var e,t=this;return null===(e=this.sceneController)||void 0===e?void 0:e.store.getState().quests.find((function(e){var n;return e.name===(null===(n=t.sceneController)||void 0===n?void 0:n.questName)}))}},{key:"findNearestActor",value:function(e,t){var n=this;if(this.sceneController){var a,r=this.sceneController.sceneActors,c=Number.MAX_VALUE;return null===r||void 0===r||r.forEach((function(r){var o;if(r.location&&n.sceneController&&!Object(sr.d)(r.location,e)){var i=null===(o=n.sceneController.findPath(e,r.location))||void 0===o?void 0:o.length;void 0!==i&&i<c&&(void 0!==t&&r.allegiance!==t||(c=i,a=r))}})),a}}},{key:"findEnemyWithAp",value:function(){if(this.sceneController){var e=this.sceneController.sceneActors;return null===e||void 0===e?void 0:e.find((function(e){return e.allegiance===j.a.enemy&&e.ap>0}))}}},{key:"dispatch",value:function(e){var t;null===(t=this.sceneController)||void 0===t||t.store.dispatch(e)}}]),e}();Jr.sceneController=void 0,Jr.unsubscriber=void 0;var Kr,$r=function(e){var t,n=e.selectedActorId,a=e.setSelectedActor,r=Object(s.useContext)(kn),c=r.mapData,o=r.basePath,i=Pr(o),u=i.loadComplete,l=i.loadTilesets,m=i.tileSpritesheets,p=Object(s.useRef)(null),h=(t=r.questName,Object(d.d)((function(e){var n;return null===(n=e.quests.find((function(e){return e.name===t})))||void 0===n?void 0:n.scene}))),b=!0===(null===h||void 0===h?void 0:h.combat),v=r.getTileDimensions(),f=v.tileWidth,g=v.tileHeight,j=Object(s.useState)(),O=Object(y.a)(j,2),x=O[0],k=O[1];Object(s.useEffect)((function(){return b&&(console.log("combat on!"),Jr.initialize(r)),function(){console.log("combat off"),Jr.destroy()}}),[b]),Object(s.useEffect)((function(){c&&l(c.tilesets)}),[l,c]);if(!u||!c||!h)return Object(B.jsx)("div",{children:"loading scene..."});var T=c.width*c.tilewidth,N=c.height*c.tileheight;return Object(B.jsxs)("div",{className:"scene",ref:p,children:[Object(B.jsx)(Rr,{width:T,height:N,children:Object(B.jsxs)(z.Container,{interactive:!0,hitArea:new w.Rectangle(0,0,T,N),children:[Object(B.jsx)(Mr,{basePath:o,data:c,spritesheets:m,objects:h.objects,controller:r,selectedActorId:n,setSelectedActor:a}),x&&Object(B.jsx)(Ur,{actionIntent:x,tileWidth:f,tileHeight:g}),false]})}),false,Object(B.jsx)(Vr,{sceneWidth:T,sceneHeight:N,selectedActorId:n,actionIntent:x,onMouseDown:function(t){var n=r.getObjectAtLocation(t);n&&Object(mr.d)(n)&&(null===n||void 0===n?void 0:n.name)&&e.setSelectedActor(n.name)},onSetActionIntent:k}),Object(B.jsx)(Yr,{questId:r.questName})]})},ec=(n(644),function(e){var t=Hn(e.questName),n=Object(Kn.a)(t.name),a=Math.floor(t.progress);do{var r=n.nodes[a].log;if(r)return Object(B.jsx)("div",{children:Object(B.jsx)("p",{children:"".concat(C.a.get(r))})});a--}while(a>=0);return Object(B.jsx)("h1",{className:"on-the-road questname",children:C.a.getQuestTitle(t.name)})}),tc=function(e){return Hn(e.questName).sceneName?Object(B.jsx)($r,Object(X.a)({},e)):Object(B.jsx)(ec,{questName:e.questName})},nc=(n(645),n(297),function(e){var t=Object(s.useContext)(kn),n=mn(e.adventurerId),a=Object(Ka.a)(n),r=Object(s.useRef)(null),c=t.getLootCache(e.cacheName);if(!c)return null;return Object(B.jsxs)("div",{className:"interaction-modal loot-cache",ref:r,children:[Object(B.jsxs)("div",{className:"header",children:[Object(B.jsx)("div",{className:"title",children:C.a.get(c.title,{adventurer:n.name})}),Object(B.jsx)("div",{className:"close",onClick:e.onClose})]}),c.items.length>0&&Object(B.jsxs)("div",{className:"content",children:[Object(B.jsx)("div",{className:"items",children:Object(B.jsx)(ga,{items:c.items,sourceType:pn.a.lootCache,sourceId:e.cacheName})}),Object(B.jsxs)("div",{className:"adventurer",children:[Object(B.jsx)(sn,{adventurer:n}),Object(B.jsx)(Be,{onClick:function(n){n.stopPropagation(),r.current.querySelectorAll(".items-list .item").forEach((function(e,t){t>=a||e.classList.add("taking")})),S.a.to(".items-list .item.taking",{right:"-100%",stagger:{each:.1,ease:"power2.inOut"},onComplete:function(){for(var n=0;n<a;n++)t.takeItemFromCache(0,e.cacheName,e.adventurerId)}})},disabled:0===a,size:"small",children:C.a.get("quest-common-loot-cache-take-all")})]})]}),!!c.gold&&Object(B.jsxs)("div",{className:"content",children:[Object(B.jsxs)("div",{className:"gold",children:[Object(B.jsx)(st.b,{image:"img/resources/gold.png",size:"medium"}),C.a.get("quest-common-loot-cache-gold",{gold:c.gold})]}),Object(B.jsx)("div",{className:"take-gold",children:Object(B.jsx)(Be,{onClick:function(n){n.stopPropagation(),t.takeGoldFromCache(e.cacheName)},size:"small",children:C.a.get("quest-common-loot-cache-take")})})]})]})}),ac=(n(646),function(e){var t=Object(s.useContext)(kn),n=Object(s.useRef)(null),a=null===t||void 0===t?void 0:t.getSituation(e.situation,e.adventurerId);if(!a)return null;var r=a.title,c=a.choices,o=a.text,i=function(n){var a=n.currentTarget.getAttribute("data-option");a&&t&&(t.handleSituationOptionClick(e.situation,a,e.adventurerId),n.stopPropagation())};return Object(B.jsxs)("div",{className:"interaction-modal situation",ref:n,children:[Object(B.jsxs)("div",{className:"header",children:[Object(B.jsx)("div",{className:"title",children:C.a.get(r)}),Object(B.jsx)("div",{className:"close",onClick:function(t){e.onClose(),t.stopPropagation()}})]}),Object(B.jsxs)("div",{className:"content",children:[o&&Object(B.jsx)("div",{className:"text",children:C.a.get(o)}),null===c||void 0===c?void 0:c.map((function(e){return Object(B.jsx)(Be,{"data-option":e,onClick:i,children:C.a.get(e)},e)}))]})]})}),rc=(n(647),function(e){var t=e.selectedAdventurerId,n=Object(d.d)(or(e.questName)),a=Object(s.useContext)(kn);return Object(B.jsxs)("div",{className:"combat-bar",children:[Object(B.jsx)("div",{className:"title",children:C.a.get("ui-combat-bar-title")}),Object(B.jsx)("div",{className:"adventurers",children:n.map((function(e){var n;return Object(B.jsxs)("div",{className:"adventurer ".concat(t===e.id?"selected":""),children:[Object(B.jsx)(sn,{adventurer:e,size:st.a.smallest}),Object(B.jsxs)("div",{className:"ap",children:[(null===a||void 0===a||null===(n=a.getSceneActor(e.id))||void 0===n?void 0:n.ap)||0," AP"]})]},e.id)}))}),Object(B.jsx)(Be,{size:"small",onClick:function(){return null===a||void 0===a?void 0:a.endTurn()},children:"End turn"})]})});n(648);!function(e){e[e.auto=0]="auto",e[e.vertical=1]="vertical",e[e.horizontal=2]="horizontal"}(Kr||(Kr={}));var cc,oc=function(e){var t,n,a=Object(N.g)(),r=Object(d.c)(),c=e.layout,o=void 0===c?Kr.auto:c,i=Object(d.d)(or(e.questName)),u=i[0],l=Object(s.useState)(null===u||void 0===u?void 0:u.id),m=Object(y.a)(l,2),p=m[0],h=m[1],b=Hn(e.questName),v=null===b||void 0===b||null===(t=b.scene)||void 0===t?void 0:t.activeInteractionModal,f=function(e){h(e)},g=function(){r(Object(la.g)(e.questName))};return Object(s.useEffect)((function(){i.length||a.push(Object(D.d)())}),[i.length,a]),i.length?Object(B.jsxs)(Tn,{questName:e.questName,children:[(null===b||void 0===b||null===(n=b.scene)||void 0===n?void 0:n.combat)&&Object(B.jsx)(rc,{questName:e.questName,selectedAdventurerId:p}),Object(B.jsxs)("div",{className:"quest-panel quest-panel-".concat(Kr[o]),children:[Object(B.jsxs)("div",{className:"quest-area",children:[Object(B.jsx)(tc,{questName:e.questName,selectedActorId:p,setSelectedActor:f}),v&&"lootCache"===v.type&&Object(B.jsx)("div",{className:"modal",onClick:g,children:Object(B.jsx)(nc,{cacheName:v.lootCache,adventurerId:p,onClose:g})}),v&&"situation"===v.type&&Object(B.jsx)("div",{className:"modal",onClick:g,children:Object(B.jsx)(ac,{situation:v.situation,adventurerId:p,onClose:g})})]}),Object(B.jsxs)("div",{className:"party-area",children:[Object(B.jsx)(un,{adventurers:i,selectedAdventurerId:p,onAdventurerTabSelected:f,disabled:void 0!==v}),Object(B.jsx)("div",{className:"adventurer-details",children:p&&Object(B.jsx)(Vn,{adventurerId:p,questName:e.questName})})]})]})]}):null},ic=(n(649),function(){var e=Object(s.useRef)(null),t=Object(N.j)("".concat(Object(D.d)(),"/:questname")),n=null===t||void 0===t?void 0:t.params.questname,a=Object(N.g)();Object(s.useEffect)((function(){q.c.addSound("music/world","sound/music/TheLoomingBattle.ogg",(function(){q.c.playSound("music/world",q.a.music,!0,q.b.fade,!0)}))}),[]);return Object(B.jsxs)("div",{className:"world-view",ref:e,children:[Object(B.jsx)($a,{selectedQuestName:n,smallMap:null!=n,onPartyClick:function(e){a.push(Object(D.a)(e)),q.c.playSound("ui/buttonClick")},retrieveWorldViewRef:function(){return e}}),n&&Object(B.jsx)(oc,{questName:n})]})});n(650);!function(e){e[e.all=0]="all",e[e.town=1]="town",e[e.quest=2]="quest"}(cc||(cc={}));var sc,uc=function(){var e=Object(s.useState)(!1),t=Object(y.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)("all"),c=Object(y.a)(r,2),o=c[0],i=c[1],u=Object(d.d)((function(e){return e.log})),l=function(){var e=Object(s.useMemo)((function(){return Mn([Rn,Pn],(function(e,t){return e.filter((function(e,n){return t[n]===Gt.active}))}))}),[]);return Object(d.d)(e)}(),m=Object(N.h)();Object(s.useEffect)((function(){m.pathname!==Object(D.c)()?l.forEach((function(e){m.pathname===Object(D.a)(e)&&i("quest-".concat(e))})):i("town")}),[l,m]);var p=[{label:C.a.get("ui-log-tab-all"),tabId:"all",tabType:cc.all},{label:C.a.get("ui-log-tab-town"),tabId:"town",tabType:cc.town}];l.forEach((function(e){p.push({channelContext:e,label:C.a.getQuestTitle(e),tabId:"quest-".concat(e),tabType:cc.quest})}));var h=[],b=p.find((function(e){return e.tabId===o}));switch(null===b||void 0===b?void 0:b.tabType){case cc.all:h=u;break;case cc.town:h=u.filter((function(e){return e.channel===Zt.a.town}));break;case cc.quest:h=u.filter((function(e){return e.channel===Zt.a.quest&&e.channelContext===b.channelContext}))}return Object(B.jsxs)("div",{className:"log".concat(n?" expanded":""),children:[Object(B.jsxs)("div",{className:"tab-bar",children:[Object(B.jsx)(cn,{className:"tabs",onTabSelected:function(e){i(e)},activeTab:o,children:p.map((function(e){return Object(B.jsx)(on,{id:e.tabId,children:e.label},e.tabId)}))}),Object(B.jsx)(Be,{className:"expand-button",onClick:function(){a(!n)},square:!0,size:"medium",text:n?"\u25bc":"\u25b2"})]}),Object(B.jsx)("div",{className:"log-entries",children:h.map((function(e){return function(e){var t=C.a.get(e.key,e.context);return Object(B.jsx)("div",{className:"entry",children:t},e.time)}(e)}))})]})},lc=n(102),dc=function(e){var t=e.item,n=Object(lc.b)(t),a=Object(d.c)(),r=yt(),c=He(n.structure),o=c.cost.gold||0<=r,i=!(_e(n.structure).state===g.NotBuilt)||!o,s=C.a.getItemSubtext(t);return Object(B.jsxs)("div",{children:[s&&Object(B.jsx)("p",{className:"subtext",children:'"'.concat(s,'"')}),Object(B.jsxs)(Be,{disabled:i,size:"small",onClick:function(){return function(e){a(Object(Yt.b)(c.cost.gold||0)),a(function(e){return{type:"startBuildingStructure",structure:e}}(e));var t=[Bt(e)],n=c.cost.time,r=Qt(St.buildStructure,"".concat(e,".build"),"town",null!==n&&void 0!==n?n:0,t);a(r)}(n.structure)},children:["Start construction (",c.cost.gold," gold)"]})]})},mc=pe.g,pc=function(e){var t=e.structure,n=_e(t),a=$e(t),r=Object(d.c)();if(!t)return null;if(n.produces.some((function(t){return t===e.item})))return Object(B.jsxs)("p",{children:["Constructed at:\xa0",Object(B.jsx)(T.b,{to:Object(D.b)(t),children:C.a.getStructureName(t)})]});var c=a.find((function(t){return t.name===e.item}));if(c)return Object(B.jsxs)("p",{children:[Object(B.jsx)(T.b,{to:Object(D.b)(t),children:C.a.get("ui-tooltip-study-currently-studying")}),Object(pe.h)(c.timeRemaining,!0)]});var o=Rt(e.item);if(n.level<(o.levelRequired||0)||n.state!==g.Built)return Object(B.jsx)("p",{className:"invalid",children:C.a.get("ui-tooltip-study-requires-structure-level",{structure:t,level:(o.levelRequired||0)+1})});return Object(B.jsxs)("p",{children:[Object(B.jsx)(Be,{onClick:function(){var n=[Vt(e.structure,e.item)],a=mc,c=Qt(St.studyItem,e.item,"".concat(t,".study"),a,n);r(c)},size:"small",children:C.a.get("ui-tooltip-study-start-study")}),"Start studying this item at "," ",Object(B.jsx)(T.b,{to:Object(D.b)(t),children:C.a.getStructureName(t)})]})},hc=function(e){var t,n=(t=e.item,Object(Et.c)(t)&&qt[t]?"armoursmith":Object(At.g)(t)&&It[t]?"weaponsmith":Object(Mt.b)(t)&&Ct[t]?"workshop":null);return Object(lt.c)(e.item).unique?Object(B.jsx)("p",{children:"Unique item"}):n?Object(B.jsx)(pc,{item:e.item,structure:n}):null},bc=function(e){var t=e.item,n=Object(At.f)(t),a=C.a.getItemSubtext(t),r=C.a.getWeaponType(n.weaponType),c=At.d[n.weaponType].classification,o=C.a.getWeaponClassification(c);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{children:[r,n.weaponType!==At.c.shield&&" (".concat(o,")")]}),a&&Object(B.jsx)("p",{className:"subtext",children:'"'.concat(a,'"')}),n.damage&&Object(B.jsxs)("p",{children:[" damage: ",n.damage[At.a.kinetic]," "]}),Object(B.jsx)(hc,{item:t})]})},vc=function(e){var t=e.item,n=Object(Et.b)(t),a=n.damageReduction,r=C.a.getItemSubtext(t),c=C.a.getEquipmentSlot(n.equipmentType);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("div",{children:"".concat(c)}),r&&Object(B.jsx)("p",{className:"subtext",children:'"'.concat(r,'"')}),a&&Object(B.jsxs)("p",{children:[" ",C.a.get("ui-tooltip-damage-reduction",{damageReduction:a})," "]}),Object(B.jsx)(hc,{item:t})]})},fc=n(98),gc=function(e){var t=e.item,n=e.source,a=Object(d.c)(),r=C.a.getItemSubtext(t),c=Object(d.d)((function(e){return e.adventurers})),o=n&&n.origin===pn.a.adventurerInventory;return Object(B.jsxs)("div",{children:[r&&Object(B.jsx)("p",{className:"subtext",children:'"'.concat(r,'"')}),o&&Object(B.jsx)(Be,{disabled:!1,size:"small",onClick:function(){return function(){var e;if((null===n||void 0===n?void 0:n.id)&&(null===n||void 0===n?void 0:n.slot)){a(Object(On.c)(n.id,n.slot));var r=null===(e=c.find((function(e){return e.id===n.id})))||void 0===e?void 0:e.name;r&&a(Object(h.b)("adventurer-drink-potion",{item:t,adventurer:r},Zt.a.common))}}()},children:"Drink potion"})]})},jc=(n(651),function(e){var t=e.item,n=e.source;if(Object(lc.c)(t))return Object(B.jsx)(dc,{item:t});if(Object(At.g)(t))return Object(B.jsx)(bc,{item:t});if(Object(At.g)(t))return Object(B.jsx)(bc,{item:t});if(Object(Et.c)(t))return Object(B.jsx)(vc,{item:t});if(Object(fc.c)(t))return Object(B.jsx)(gc,{item:t,source:n});var a=C.a.getItemSubtext(t);return a&&Object(B.jsx)("p",{className:"subtext",children:'"'.concat(a,'"')})||null}),Oc=(n(652),function(e){var t=e.info,n=jt(),a=yt(),r=Object(d.d)((function(e){return e.workers})),c=kt(),o=Object(d.d)((function(e){return e.structures})),i=Ot();switch(t){case be.fabric:case be.food:case be.iron:case be.leather:case be.stone:case be.wood:var s,u,l,m=nn(null!==(s=n[t])&&void 0!==s?s:0,0),p=(null!==(u=n[t])&&void 0!==u?u:0)>=(null!==(l=null===i||void 0===i?void 0:i[t])&&void 0!==l?l:0);return Object(B.jsxs)("div",{className:"resource-context",children:[Object(B.jsx)("div",{className:"info",children:C.a.get("resource-".concat(t,"-info"))}),Object(B.jsx)("div",{children:C.a.get("ui-tooltip-resource-quantity",{amount:m})}),Object(B.jsx)("div",{children:function(){var e=De(t),n=o[e];if(n.state!==g.Built)return Object(B.jsx)("span",{children:C.a.get("ui-tooltip-resource-produce-row-notbuilt",{structure:C.a.getStructureName(e)})});var a=Me(e).levels[n.level].generates[t];return Object(B.jsx)("span",{className:"produced",children:Object(B.jsx)(tn.a,{children:C.a.get("ui-tooltip-resource-produce-row",{structure:e,amount:a})})})}()}),p&&Object(B.jsx)("div",{className:"warning-full",children:C.a.get("ui-tooltip-resource-warehouse-full",{resource:t})})]});case"gold":var h=a;return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("div",{className:"resource-context",children:Object(B.jsx)("div",{className:"info",children:" ".concat(C.a.get("resource-".concat(t,"-info")))})}),Object(B.jsx)("div",{children:C.a.get("ui-tooltip-resource-quantity",{amount:h})})]});case"workers":var b=c,v=r;return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("div",{className:"resource-context",children:Object(B.jsx)("div",{className:"info",children:" ".concat(C.a.get("resource-".concat(t,"-info")))})}),Object(B.jsx)("div",{children:C.a.get("ui-tooltip-workers-quantity",{free:b,total:v})})]});default:throw new Error("Uknow value "+t)}}),yc=(n(653),function(e){var t=e.className,n=e.children,a=Object(V.a)(e,["className","children"]);return Object(B.jsx)("div",Object(X.a)(Object(X.a)({},a),{},{className:"info-window ".concat(t||""),children:n}))});n(654);!function(e){e[e.bottom=0]="bottom",e[e.top=1]="top",e[e.left=2]="left",e[e.right=3]="right"}(sc||(sc={}));var wc,xc=function(e){var t=e.children,n=e.referenceRect,a=e.className,r=void 0===a?"":a,c=Object(s.useRef)(null),o=Object(s.useState)(e.placement||sc.bottom),i=Object(y.a)(o,2),u=i[0],l=i[1],d=Object(s.useState)(),m=Object(y.a)(d,2),p=m[0],h=m[1];Object(s.useEffect)((function(){var e=c.current;if(e&&p){var t=e.getBoundingClientRect();switch(u){case sc.top:if(t.top-t.height-8-8<p.top)return void l(sc.bottom);break;case sc.bottom:if(t.top+t.height+8+8>p.height)return void l(sc.top)}e.style.opacity="1";var n=e.querySelector(".tooltip-content");if(t.left<p.left+8){var a=p.left-t.left+8;n.style.transform="translateX(".concat(a,"px)")}else if(t.right>p.right-8){var r=t.right-p.right+8;n.style.transform="translateX(".concat(-r,"px)")}else n.style.transform=""}}),[l,p,u,n]);var b=function(){it.clear()};Object(s.useEffect)((function(){var e,t;return h(null===(e=c.current)||void 0===e||null===(t=e.closest(".app"))||void 0===t?void 0:t.getBoundingClientRect()),window.addEventListener("resize",b),function(){window.removeEventListener("resize",b)}}),[]);var v=0,f=0;if(p)switch(u){case sc.bottom:v=n.left-p.left+n.width/2,f=n.top-p.top+n.height,r+=" tooltip-bottom";break;case sc.top:v=n.left-p.left+n.width/2,f=n.top-p.top,r+=" tooltip-top"}return Object(B.jsxs)("div",{className:"tooltip ".concat(r),style:{left:v,opacity:0,top:f},ref:c,children:[Object(B.jsx)("div",{className:"tooltip-arrow"}),Object(B.jsx)(yc,{className:"tooltip-content",children:t})]})},kc=(n(655),function(e){var t=e.traitDefinition;return Object(B.jsxs)("div",{className:"trait-context",children:[Object(B.jsx)("div",{className:"description",children:C.a.getTraitDescription(t.trait)}),t.hasEffect&&Object(B.jsx)("div",{className:"effect",children:C.a.getTraitEffect(t.trait)})]})}),Tc=(n(656),function(){var e=Object(s.useState)(),t=Object(y.a)(e,2),n=t[0],a=t[1],r=function(e){a(e)};if(Object(s.useEffect)((function(){return it.instance.addListener(ot,r),function(){it.instance.removeListener(ot,r)}}),[]),!n)return null;var c=n.info,o=n.type,i=n.className,u=n.source;return Object(B.jsx)(xc,{referenceRect:n.referenceRect,className:i,children:Object(B.jsx)("div",{className:"context-tooltip",children:function(){switch(o){case Xe.resource:var e=C.a.getResourceName(c);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)("div",{className:"name resource",children:e}),Object(B.jsx)(Oc,{info:c})]});case Xe.item:var t=c,a=C.a.getItemName(t),r=Object(lt.c)(t);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{className:"header",children:[Object(B.jsx)("div",{className:"name item ".concat(Nc(r)),children:a}),Object(B.jsx)("div",{className:"secondary",children:C.a.getItemType(r.itemType)})]}),Object(B.jsx)(jc,{item:t,source:u})]});case Xe.trait:var i=c,s=C.a.getTraitName(i.trait);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{className:"name trait",children:[C.a.get("ui-tooltip-type-trait"),s]}),Object(B.jsx)(kc,{traitDefinition:i})]});case Xe.skill:var l=c,d=C.a.getSkillName(l);return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)("div",{className:"name skill",children:[C.a.get("ui-tooltip-type-skill"),d]}),C.a.getSkillInfo(l)]});case Xe.component:return c;default:throw new Error("Unknown context type ".concat(n.type))}}()})})}),Nc=function(e){switch(e.rarity){case ut.a.common:return"item-name-common";case ut.a.uncommon:return"item-name-uncommon";case ut.a.rare:return"item-name-rare";case ut.a.epic:return"item-name-epic";case ut.a.legendary:return"item-name-legendary"}return"item-name-common"};n(657);I.a.registerPIXI(w),S.b.registerPlugin(I.a),function(e){e[e.Town=0]="Town",e[e.World=1]="World"}(wc||(wc={}));var Ic,Sc=960,qc=Object(s.createContext)(null),Cc=function(e){var t=Object(s.useRef)(null),n=Object(s.useState)([]),a=Object(y.a)(n,2),c=a[0],o=a[1],i=function(){q.c.playSound("ui/buttonClick")},u=function(){o([])},l=function(){c&&c.length&&o(c.slice(0,-1))};Object(s.useEffect)((function(){q.c.addSound("ui/buttonClick","sound/ui/button-click.ogg"),q.c.addSound("ui/equip","sound/ui/equip.mp3"),q.c.addSound("ui/error","sound/ui/error.ogg"),q.c.addSound("ui/levelUp","sound/ui/level-up.ogg"),q.c.addSound("ui/toast","sound/ui/toast.ogg")}),[]);return Object(s.useEffect)((function(){var e=E()((function(){it.clear()}),100);return window.addEventListener("scroll",e),window.addEventListener("wheel",e),function(){window.removeEventListener("resize",e),window.removeEventListener("wheel",e)}}),[]),Object(B.jsx)(qc.Provider,{value:{onOpenWindow:function(e){o([].concat(Object(r.a)(c||[]),[e]))},onCloseWindow:u},children:Object(B.jsx)("div",{className:"app",ref:t,style:{maxWidth:Sc},onClick:function(){it.clear()},children:Object(B.jsx)(x.a,{backend:k.a,children:Object(B.jsxs)(T.a,{children:[Object(B.jsx)(Xa,{persistor:e.persistor}),Object(B.jsxs)("div",{className:"control-bar",children:[Object(B.jsxs)(N.d,{children:[Object(B.jsx)(N.b,{path:"/",exact:!0,children:Object(B.jsx)(N.a,{from:"/",to:Object(D.d)()})}),Object(B.jsx)(N.b,{path:Object(D.d)(),children:Object(B.jsx)(T.b,{to:Object(D.c)(),children:Object(B.jsxs)(Be,{onClick:function(){return i()},color:"green",children:[" ",C.a.get("ui-view-button-town")," "]})})}),Object(B.jsx)(N.b,{path:Object(D.c)(),children:Object(B.jsx)(T.b,{to:Object(D.d)(),children:Object(B.jsxs)(Be,{onClick:function(){return i()},children:[" ",C.a.get("ui-view-button-world")," "]})})})]})," | ",Object(B.jsx)(Be,{onClick:function(){No()},color:Pe.purple,children:" Restart! "})]}),Object(B.jsxs)(N.d,{children:[Object(B.jsx)(N.b,{path:Object(D.c)(),render:function(){return Object(B.jsx)(Ma,{})}}),Object(B.jsx)(N.b,{path:Object(D.d)(),render:function(){return Object(B.jsx)(ic,{})}})]}),Object(B.jsx)(uc,{}),function(){if(!c.length)return null;var e=c[c.length-1],t={onClose:u,onBack:l,backEnabled:c.length>1,closeEnabled:!0};return s.cloneElement(e,t)}(),Object(B.jsx)(Tc,{}),Object(B.jsx)(Pa,{})]})})})})},Ac=function(e,t){var n=t.structures,a={},r=Oa(ca.resourceGeneration),c=(Date.now()-e)/(ha/r),o=gt(t);return c<1?null:(Object.keys(n).forEach((function(e){return function(e){var t=Me(e);if(t.type===oe.resource){var r=t,o=n[e].level,i=r.levels[o];Object.keys(i.generates).reduce((function(t,a){var r=a,o=i.generates[r]*n[e].workers*c;return t[r]=(t[r]||0)+o,t}),a)}}(e)})),Object.keys(a).forEach((function(e){var n=e;a[n]&&t.resources[n]+a[n]>=o[n]&&(a[n]=o[n]-t.resources[n])})),a)},Ec=function(e,t){var n=Oa(ca.questProgress),a=[],r=[],c=t.getState();return c.quests.forEach((function(o){if(o.status===Gt.active){var i=Object(Kn.a)(o.name),s=o.progress,u=Math.floor(s);if(i.nodes[u].type===Ya.a.nothing){for(var l=e/(6e4/n)*4,d=Math.min(s+l,i.nodes.length-1),m=Math.floor(d)-u,p=1;p<=m;p++){var h=i.nodes[u+p];if(h.type===Ya.a.encounter){t.dispatch(Object(la.j)(o.name,h.startScene));var b=C.a.getQuestTitle(o.name),v=Object(Ka.c)(c.adventurers,o);Zn.b.addToast(b,Jn.a.questEncounter,null===v||void 0===v?void 0:v.avatarImg,Object(D.a)(o.name)),h.log&&a.push({channel:Zt.a.quest,channelContext:o.name,key:h.log}),d=s+p;break}h.type===Ya.a.nothing&&h.log&&a.push({channel:Zt.a.quest,channelContext:o.name,key:h.log})}r.push({name:o.name,progress:d})}}})),{logUpdates:a,questUpdates:r}},Mc=n(314),Dc=n.n(Mc);var Rc=!1,Pc=function(){return Rc?(Rc=!1,Ic.state()):null},_c=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Hc(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");_c?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):zc(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):zc(e)}))}}function zc(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Lc,Bc,Fc,Wc,Vc,Qc,Gc=n(191),Uc=function(){return{strength:Math.floor(3*Math.random())+9,dexterity:Math.floor(3*Math.random())+9,intelligence:Math.floor(3*Math.random())+9,health:Math.floor(3*Math.random())+9}},Xc="/img/avatars",Yc="img/scene/actors/",Zc=[{id:"c4a5d270",equipment:(Lc={},Object(Se.a)(Lc,ln.a.head,"apparel/cowl"),Object(Se.a)(Lc,ln.a.chest,"apparel/chest"),Object(Se.a)(Lc,ln.a.hands,"apparel/clothGloves"),Object(Se.a)(Lc,ln.a.shoulders,"apparel/shoulders2"),Object(Se.a)(Lc,ln.a.legs,"apparel/pants2"),Object(Se.a)(Lc,ln.a.feet,"apparel/boots3"),Lc),basicAttributes:Uc(),health:100*Math.random(),xp:Sn(1),baseAP:6,room:0,name:"Ximena Maddox",traits:[qn.houseMaddox,qn.gloomy],avatarImg:"".concat(Xc,"/female/f_14.png"),spritesheetPath:"".concat(Yc,"elf-bow.json"),color:Ba.purple,skills:(Bc={},Object(Se.a)(Bc,At.c.crossbow,10),Object(Se.a)(Bc,At.c.bow,10),Bc),inventory:["deed/lumbermill",null,"weapon/simpleCrossbow","weapon/dagger","weapon/khopesh",null,"weapon/steelSword",null,"potion/greaterMana","potion/majorHealth",null,"weapon/steelShield",null,null,null,null]},{id:"2e655832",equipment:Object(Se.a)({},ln.a.feet,"apparel/boots2"),basicAttributes:Uc(),name:"Donte Houston",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:1,avatarImg:"".concat(Xc,"/male/m_05.png"),spritesheetPath:"".concat(Yc,"elf-bow.json"),color:Ba.teal,traits:[qn.houseHouston],skills:(Fc={},Object(Se.a)(Fc,At.c.crossbow,12),Object(Se.a)(Fc,At.c.staff,13),Fc),inventory:["weapon/simpleCrossbow",null,null,null,null,"apparel/boots1","apparel/chainmailHood","apparel/nomadHelmet","apparel/plateChest4",null,"weapon/buckler",null,null,null,null,null,null,null,null,null,null,null,"apparel/plateHelmet","apparel/cowl"]},{id:"ec6f1050",equipment:Object(Se.a)({},ln.a.feet,"apparel/boots3"),basicAttributes:Uc(),name:'Zackary "bone bag" Morris',health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:2,traits:[qn.gloomy],skills:(Wc={},Object(Se.a)(Wc,At.c.sword,12),Object(Se.a)(Wc,At.c.hammer,6),Wc),avatarImg:"".concat(Xc,"/male/m_09.png"),spritesheetPath:"".concat(Yc,"skeleton.json"),color:Ba.black,inventory:["weapon/greatswordOfGwai",null,null,null,"weapon/berserkerShield"]},{id:"d299f98a",basicAttributes:Uc(),equipment:{},name:"Mike Keith",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:4,avatarImg:"".concat(Xc,"/male/m_19.png"),spritesheetPath:"".concat(Yc,"knight-sword.json"),traits:[qn.arrowFinder],skills:Object(Se.a)({},At.c.sword,13),inventory:[null,null,null,null,"weapon/khopesh","apparel/hornedHelmet","weapon/woodenBulwark"]},{id:"96c686c3",equipment:{},basicAttributes:Uc(),name:"Wayne Monroe",health:100*Math.random(),xp:100*Math.random(),baseAP:4,room:5,avatarImg:"".concat(Xc,"/male/m_08.png"),spritesheetPath:"".concat(Yc,"orc-axe.json"),traits:[qn.houseMonroe,qn.arrowFinder],skills:Object(Se.a)({},At.c.axe,12),inventory:[null,null,null,"weapon/goldenShield"]},{id:"250d1a9d",basicAttributes:Uc(),equipment:{},name:"Alexis Ortiz ",health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:9,avatarImg:"".concat(Xc,"/female/f_10.png"),spritesheetPath:"".concat(Yc,"knight-sword.json"),inventory:[null,null,null,null,null],skills:Object(Se.a)({},At.c.axe,10)},{id:"169384ef",equipment:{},basicAttributes:Uc(),name:"Karlee Nolan",health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:3,avatarImg:"".concat(Xc,"/female/f_16.png"),spritesheetPath:"".concat(Yc,"troll-sword.json"),inventory:["weapon/greatswordOfGwai",null,null,null],skills:Object(Se.a)({},At.c.axe,10)},{id:"f22d66cb",basicAttributes:Uc(),equipment:{},name:"Gylbarde the Earnest",health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:8,avatarImg:"".concat(Xc,"/male/m_09.png"),spritesheetPath:"".concat(Yc,"knight-sword.json"),inventory:[null,null,null,null,null],skills:Object(Se.a)({},At.c.axe,13)},{id:"36c686c1",equipment:{},basicAttributes:Uc(),name:"Lanslet of the Water",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:6,avatarImg:"".concat(Xc,"/male/m_26.png"),spritesheetPath:"".concat(Yc,"knight-sword.json"),inventory:["weapon/greatswordOfGwai",null,null,null,"apparel/shoulders1","apparel/fedora","apparel/greaves2"],skills:Object(Se.a)({},At.c.axe,3)},{id:"12c613d4",equipment:{},basicAttributes:Uc(),name:"Tedric the Bold",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:7,avatarImg:"".concat(Xc,"/male/m_33.png"),spritesheetPath:"".concat(Yc,"knight-sword.json"),inventory:["weapon/greatswordOfGwai",null,null,null],skills:Object(Se.a)({},At.c.axe,10)}],Jc=function(){return{gameStarted:void 0,previousTick:Date.now(),lastTick:Date.now(),lastProducedUpdate:Date.now(),lastHarvest:Date.now()}},Kc=40,$c=function(){var e={apparel:[],deed:[],herb:[],material:[],mineral:[],potion:[],questItem:[],trinket:[],weapon:[]},t=Me("warehouse").levels[0].maxStockpile;return Object.keys(e).forEach((function(n){for(var a=yn.a[n],r=0;r<t;r++)if(Math.random()<.5)e[n].push(null);else{var c=eo(a);e[n].push(c)}})),e},eo=function(e){var t=Object(lt.b)(e);return t[Math.floor(Math.random()*t.length)]},to=[],no=n(143),ao=n(315),ro=n.n(ao),co=[{name:"kill10Boars",status:Gt.active,party:["c4a5d270","2e655832","ec6f1050","d299f98a"],progress:0,questVars:no.a,encounterResults:[],icon:"sigil1.png"}],oo=function(e,t){return t},io={fabric:0,food:0,iron:10,leather:0,stone:0,wood:10},so=!1,uo=function(e,t,n){var a=Object(X.a)(Object(X.a)({},e[t]),{},{state:n});return Object(X.a)(Object(X.a)({},e),{},Object(Se.a)({},t,a))},lo={level:0,state:g.NotBuilt,workers:0},mo={alchemist:Object(X.a)(Object(X.a)({},lo),{},{produces:[]}),armoursmith:Object(X.a)(Object(X.a)({},lo),{},{produces:["apparel/boots1"]}),garden:{level:0,workers:0,state:g.Built},lumberMill:lo,mine:{level:0,workers:0,state:g.NotBuilt},quarry:lo,tavern:{level:0,workers:0,state:g.Built},tannery:lo,warehouse:{level:0,workers:0,state:g.Built},weaponsmith:Object(X.a)(Object(X.a)({},lo),{},{produces:["weapon/simpleCrossbow","weapon/dagger"]}),weaver:lo,workshop:Object(X.a)(Object(X.a)({},lo),{},{produces:["questItem/torch","questItem/sandwich"]})},po=function(e){return{name:e.name,origin:e.origin,type:e.taskType,callbacks:e.callbacks,timeRemaining:e.time,startTime:Date.now(),lastTick:Date.now(),progress:0}},ho={completed:[],running:[]},bo=13,vo=Object(_a.a)({adventurers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"drinkPotion":var n=t.adventurerId,a=t.fromSlot,r=e.find((function(e){return e.id===n}));if(!r)throw new Error("No adventurer ".concat(n," found"));var c=r.inventory[a];if(!c||!Object(fc.c)(c))throw new Error("No potion found at index ".concat(a," "));var o=Object(fc.b)(c);switch(o.category){case"health":console.log("".concat(r.name," drinks a health potion"));break;case"soma":console.log("".concat(r.name," drinks a soma potion"));break;case"mana":console.log("".concat(r.name," drinks a mana potion"))}var i=r.inventory.map((function(e,t){return t!==a?e:null}));return e.map((function(e){return e===r?Object(X.a)(Object(X.a)({},e),{},{inventory:i}):e}));case"moveItemInInventory":var s=t.adventurerId,u=t.fromSlot,l=t.toSlot,d=e.find((function(e){return e.id===s}));if(!d)throw new Error("No adventurer ".concat(s," found"));var m=d.inventory.map((function(e,t){return t===u?d.inventory[l]:t===l?d.inventory[u]:e}));return e.map((function(e){return e===d?Object(X.a)(Object(X.a)({},e),{},{inventory:m}):e}));case"moveItemToOtherAdventurer":var p=t.adventurerId,h=t.fromSlot,b=t.toAdventurerId,v=e.find((function(e){return e.id===p}));if(!v)return e;var f=v.inventory[h];return e.map((function(e){if(e.id===p){var t=e.inventory.concat();return t[h]=null,Object(X.a)(Object(X.a)({},e),{},{inventory:t})}if(e.id===b){var n=e.inventory.concat(),a=n.findIndex((function(e){return null===e}));return n[a]=f,Object(X.a)(Object(X.a)({},e),{},{inventory:n})}return e}));case"addItemToInventory":var g=t.item,j=t.toSlot;return e.map((function(e){if(e.id===t.adventurerId){var n=e.inventory.concat();return null!==j&&void 0!==j||(j=n.findIndex((function(e){return null===e||void 0===e}))),n[j]=g,Object(X.a)(Object(X.a)({},e),{},{inventory:n})}return e}));case"removeItemFromInventory":var O=t.fromSlot;return e.map((function(e){if(e.id===t.adventurerId){var n=e.inventory.map((function(e,t){return t!==O?e:null}));return Object(X.a)(Object(X.a)({},e),{},{inventory:n})}return e}));case"assignEquipment":var y=t.equipmentSlot,w=t.item;return e.map((function(e){return e.id===t.adventurerId?Object(X.a)(Object(X.a)({},e),{},{equipment:Object(X.a)(Object(X.a)({},e.equipment),{},Object(Se.a)({},y,w))}):e}));case"removeEquipment":var x=t.equipmentSlot;return e.map((function(e){return e.id===t.adventurerId?Object(X.a)(Object(X.a)({},e),{},{equipment:Object(X.a)(Object(X.a)({},e.equipment),{},Object(Se.a)({},x,null))}):e}));case"renameAdventurer":var k=t.name;return e.map((function(e){return e.id===t.adventurerId?Object(X.a)(Object(X.a)({},e),{},{name:k}):e}));case"addXP":var T=t.xp;return e.map((function(e){return e.id===t.adventurerId?Object(X.a)(Object(X.a)({},e),{},{xp:e.xp+T}):e}))}return e},combat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j.c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.startCombatAction:var n=t;return Object(X.a)(Object(X.a)({},e),{},{action:{actor:n.actor,endsAt:n.endsAt,target:n.target,type:n.combatType}});case a.moveActor:var r=t,c=e.actors.map((function(e){return e.name===r.actor?Object(X.a)(Object(X.a)({},e),{},{location:r.location}):e}));return Object(X.a)(Object(X.a)({},e),{},{actors:c});case a.clearCombatAction:return Object(X.a)(Object(X.a)({},e),{},{action:void 0})}return e},engine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jc(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"startGame":return Object(X.a)(Object(X.a)({},e),{},{gameStarted:Date.now()});case"gameTick":var n=t.resources,a=null===n?e.lastProducedUpdate:Date.now(),r=null!==t.harvest&&Object.keys(t.harvest).length?Date.now():e.lastHarvest,c=e.lastTick;return Object(X.a)(Object(X.a)({},e),{},{previousTick:c,lastProducedUpdate:a,lastTick:Date.now(),lastHarvest:r});case"reduceTime":if(console.log(t.percentage),t.percentage<0||t.percentage>100)return e;switch(t.time){case"harvest":var o=wa-(Date.now()-e.lastHarvest);console.log("time left",Object(pe.h)(o));var i=o*(t.percentage/100);return console.log("delta",Object(pe.h)(i)),Object(X.a)(Object(X.a)({},e),{},{lastHarvest:e.lastHarvest-i})}return e}return e},gold:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Kc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"addGold":return e+t.amount}return e},stockpile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$c(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"addItem":var n=Object(lt.c)(t.item),a=t.item,c=t.toSlot,o=yn.a[n.itemType];return void 0===c&&-1===(c=e[o].findIndex((function(e){return null===e})))?Object(X.a)(Object(X.a)({},e),{},Object(Se.a)({},o,[].concat(Object(r.a)(e[o]),[a]))):Object(X.a)(Object(X.a)({},e),{},Object(Se.a)({},o,e[o].map((function(e,t){return t===c?a:e}))));case"moveItemInWarehouse":var i=t.itemType,s=t.fromSlot,u=t.toSlot,l=yn.a[i];return Object(X.a)(Object(X.a)({},e),{},Object(Se.a)({},l,e[l].map((function(t,n){return n===s?e[l][u]:n===u?e[l][s]:t}))));case"removeItem":var d=t.itemType,m=t.fromSlot,p=yn.a[d];return Object(X.a)(Object(X.a)({},e),{},Object(Se.a)({},p,e[p].map((function(e,t){return t!==m?e:null}))))}return e},log:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:to,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"addLogEntry":var n=t.entry,a=t.channel,c=t.channelContext,o=n.key,i=n.context,s=Date.now();return[{channel:a,channelContext:c,context:i,key:o,time:s}].concat(Object(r.a)(e));case"gameTick":if(!t.log.length)return e;var u=t.log.map((function(e){return Object(X.a)(Object(X.a)({},e),{},{time:Date.now()})}));return[].concat(Object(r.a)(u),Object(r.a)(e))}return e},quests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:co,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"launchQuest":var n=t.assignedAventurers.filter((function(e){return!!e})).map((function(e){return e.id}));return e.map((function(e){if(e.name===t.questName){var a=Object(Kn.a)(t.questName).getInitialQuestVars(e);return Object(X.a)(Object(X.a)({},e),{},{status:Gt.active,party:n,questVars:a})}return e}));case"exitEncounter":return e.map((function(e){if(e.name===t.questName){var n=e.progress+1;return Object(X.a)(Object(X.a)({},e),{},{progress:n,scene:void 0,sceneName:void 0})}return e}));case"updateQuestVars":return e.map((function(e){return e.name===t.questName?Object(X.a)(Object(X.a)({},e),{},{questVars:ro()(e.questVars,t.vars,{arrayMerge:oo})}):e}));case"setSceneName":return e.map((function(e){return e.name===t.questName?Object(X.a)(Object(X.a)({},e),{},{sceneName:t.sceneName,scene:void 0}):e}));case"setScene":return e.map((function(e){return e.name===t.questName?Object(X.a)(Object(X.a)({},e),{},{scene:t.scene}):e}));case"enqueueSceneAction":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.actionQueue=[].concat(Object(r.a)(n.actionQueue||[]),[t.sceneAction]),Object(X.a)(Object(X.a)({},e),{},{scene:n})}return e}));case"completeSceneAction":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n||!n.actionQueue)throw new Error("Something broke. No scene");var a=n.actionQueue[0];if(!a)return e;switch(a.actionType){case mr.a.move:n.objects=n.objects.map((function(e){return Object(mr.c)(e)&&e.name===a.actorId?Object(X.a)(Object(X.a)({},e),{},{location:a.target}):e}))}return n.actionQueue=Object(r.a)(n.actionQueue.slice(1)),Object(X.a)(Object(X.a)({},e),{},{scene:n})}return e}));case"setCombat":var a=t.combat;return e.map((function(e){if(e.name===t.questName&&e.scene){var n=Object(X.a)(Object(X.a)({},e.scene),{},{combat:a,turn:a?j.a.player:void 0});return Object(X.a)(Object(X.a)({},e),{},{scene:n})}return e}));case"endPlayerTurn":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.objects=n.objects.map((function(e){if(Object(mr.c)(e)){return Object(X.a)(Object(X.a)({},e),{},{ap:0})}return e})),Object(X.a)(Object(X.a)({},e),{},{scene:n})}return e}));case"startTurn":return e.map((function(e){if(e.name===t.questName){if(!e.scene)throw new Error("Something broke. No scene");var n=t.turn;return Object(X.a)(Object(X.a)({},e),{},{scene:Object(X.a)(Object(X.a)({},e.scene),{},{turn:n})})}return e}));case"setActorAp":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.objects=n.objects.map((function(e){if(Object(mr.c)(e)&&e.name===t.actor){var n=t.ap;return Object(X.a)(Object(X.a)({},e),{},{ap:n})}return e})),Object(X.a)(Object(X.a)({},e),{},{scene:n})}return e}));case"deductActorAp":return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.objects=n.objects.map((function(e){if(Object(mr.c)(e)&&e.name===t.actor){var n=e.ap-t.ap;return Object(X.a)(Object(X.a)({},e),{},{ap:n})}return e})),Object(X.a)(Object(X.a)({},e),{},{scene:n})}return e}));case"setActiveSceneInteractionModal":return e.map((function(e){return e.name===t.questName&&e.scene&&(e.scene.activeInteractionModal=t.sceneInteractionModal),e}));case"gameTick":var c=t.quests;return c.length?e.map((function(e){var t=c.find((function(t){return t.name===e.name}));if(t){var n=t.progress;return Object(X.a)(Object(X.a)({},e),{},{progress:n})}return e})):e}return e},resources:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:io,t=arguments.length>1?arguments[1]:void 0,n=function(t){return Object.keys(e).reduce((function(n,a){var r,c=a;return n[c]=(null!==(r=e[c])&&void 0!==r?r:0)+(t[c]||0),n}),{})};switch(t.type){case"addResources":var a=t.resources;return n(a);case"removeResources":var r=t.resources;return Object.keys(e).reduce((function(t,n){var a,c=n;return t[c]=(null!==(a=e[c])&&void 0!==a?a:0)-(r[c]||0),t}),{});case"gameTick":var c=t.resources;return null===c?e:n(c)}return e},rngState:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:so,t=arguments.length>1?arguments[1]:void 0;return"gameTick"===t.type&&null!=t.rngState&&(e=Object.assign({},t.rngState)),e},structures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:mo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"startBuildingStructure":return uo(e,t.structure,g.Building);case"finishBuildingStructure":return uo(e,t.structure,g.Built);case"upgradeStructure":var n=e[t.structure].level+1,a=Object(X.a)(Object(X.a)({},e[t.structure]),{},{level:n});return Object(X.a)(Object(X.a)({},e),{},Object(Se.a)({},t.structure,a));case"increaseWorkers":var c=t.workers,o=e[t.structure].workers+c,i=Object(X.a)(Object(X.a)({},e[t.structure]),{},{workers:o});return Object(X.a)(Object(X.a)({},e),{},Object(Se.a)({},t.structure,i));case"decreaseWorkers":var s=t.workers,u=e[t.structure].workers-s,l=Object(X.a)(Object(X.a)({},e[t.structure]),{},{workers:u});return Object(X.a)(Object(X.a)({},e),{},Object(Se.a)({},t.structure,l));case"setStructureState":var d=t.state;return uo(e,t.structure,d);case"addItemToToProduces":if(Ce(t.structure))return e;var m=t.item,p=[].concat(Object(r.a)(e[t.structure].produces),[m]),h=Object(X.a)(Object(X.a)({},e[t.structure]),{},{produces:p});return Object(X.a)(Object(X.a)({},e),{},Object(Se.a)({},t.structure,h));case"removeItemFromHarvest":var b;if(!Ae(t.structure))return e;var v=null===(b=e[t.structure].harvest)||void 0===b?void 0:b.filter((function(e,n){return n!==t.index}));return Object(X.a)(Object(X.a)({},e),{},Object(Se.a)({},t.structure,Object(X.a)(Object(X.a)({},e[t.structure]),{},{harvest:v})));case"gameTick":var f;return t.harvest&&(null===(f=Object.keys(t.harvest))||void 0===f?void 0:f.length)?Object.keys(e).reduce((function(e,n){var a,c,o=n;if(Ae(o)&&(null===(a=t.harvest)||void 0===a||null===(c=a[o])||void 0===c?void 0:c.length)){var i,s=t.harvest[o];e[o].harvest=[].concat(Object(r.a)(null!==(i=e[o].harvest)&&void 0!==i?i:[]),Object(r.a)(null!==s&&void 0!==s?s:[]))}return e}),e):e}return e},tasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ho,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"start":var n=po(t),a=e.running.concat(n);return Object(X.a)(Object(X.a)({},e),{},{running:a});case"gameTick":var r=Date.now(),c=[],o=[];return e.running.forEach((function(e){var t=r+e.timeRemaining,n=(r-e.startTime)/(t-e.startTime),a=e.timeRemaining-(r-e.lastTick),i=Object(X.a)(Object(X.a)({},e),{},{progress:n,lastTick:r,timeRemaining:a});a<0?o.push(i):c.push(i)})),{running:c,completed:o}}return e},workers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bo,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"addWorkers":return e+t.value}return e}}),fo={key:"root",storage:p.a,version:f},go=Object(Gc.a)(fo,vo),jo=function(){var e=Object(i.a)(o.a.mark((function e(){var t,n=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",new Promise((function(e,n){var a=Object(_a.c)(go,t,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),r=Object(Gc.b)(a,void 0,(function(){var t=Object(Ka.d)(a.getState());e({store:a,persistor:r,isHydrated:t})}))})));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Oo=function(e,t){e.completed.forEach((function(e){return function(e){switch(e.callbacks.forEach((function(e){return t(e)})),e.type){case St.craftItem:var n=e.name,a=C.a.get("common-item-crafted",{item:n}),r=Object(lt.c)(n);Zn.b.addToast(a,Jn.a.itemCrafted,r.iconImg)}}(e)}))},yo=(n(666),function(){var e=Object(i.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(L.c)("".concat(".","/lang/en.json"));case 2:(t=e.sent)&&C.a.init(t.data),n="GILLESROX2",Rc=!0,Ic=Dc()(n,{state:!0}),wo();case 6:case"end":return e.stop()}var n}),e)})));return function(){return e.apply(this,arguments)}}()),wo=function(){var e=Object(i.a)(o.a.mark((function e(){var t,n,a,r,c=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},e.next=3,jo(t);case 3:n=e.sent,a=n.store,r=n.isHydrated,Vc=n.persistor,r?ko():xo(a),Io(a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xo=function(e){e.dispatch({type:"startGame"}),e.dispatch(Object(h.b)("test-game-welcome")),console.log("Starting new GAME (version ".concat(v,")"))},ko=function(){console.log("Continuing existing GAME (version ".concat(v,")"))},To=function(){var e=Object(i.a)(o.a.mark((function e(t){var n,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vc.purge();case 2:return e.next=4,jo(t);case 4:n=e.sent,a=n.store,Io(a),location.href="#".concat(Object(D.d)());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),No=function(){confirm("Are you sure you wish to reset all your progress?")&&(clearTimeout(Qc),Vc.purge(),p.a.clear(),wo({adventurers:Zc,combat:j.c,engine:Jc(),gold:Kc,stockpile:$c(),log:to,quests:co,resources:io,rngState:so,structures:mo,tasks:ho,workers:bo}),location.reload(),console.clear())},Io=function(e){clearTimeout(Qc),l.render(Object(B.jsx)(d.a,{store:e,children:Object(B.jsx)(Cc,{persistor:Vc})}),document.getElementById("root")),Hc();Qc=setInterval((function(){var t=e.getState(),n=Date.now()-t.engine.lastTick,a=[],c=Ac(t.engine.lastProducedUpdate,t),o=xa(t),i=Pc();O(n,e);var s=Ec(n,e),u=s.questUpdates,l=s.logUpdates;a.push.apply(a,Object(r.a)(l)),e.dispatch(function(e,t,n,a,r,c){return{type:"gameTick",delta:e,rngState:t,resources:n,quests:a,harvest:r,log:c}}(n,i,c,u,o,a)),Oo(t.tasks,e.dispatch)}),2500)};yo()},69:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(19),r=n(143),c={kill10Boars:{getQuestVars:function(e){return e.questVars},getInitialQuestVars:function(e){return r.a},nodes:[{x:0,y:1,type:a.a.nothing,log:"quest-kill10-boars-node0"},{x:0,y:3,type:a.a.encounter,startScene:"dungeon.entrance"},{x:1,y:3,type:a.a.nothing,log:"quest-kill10-boars-leave-dungeon"},{x:1,y:3,type:a.a.nothing,log:"quest-kill10-boars-left-dungeon"},{x:2,y:3,type:a.a.nothing},{x:3,y:3,type:a.a.encounter,startScene:"dungeon.hallway"},{x:4,y:4,type:a.a.nothing,log:"The party spots a boss"},{x:5,y:4,type:a.a.nothing}]},retrieveMagicAmulet:{getQuestVars:function(e){return e.questVars},getInitialQuestVars:function(e){return{baz:!1,zux:13}},requiredItems:["questItem/torch","questItem/torch","questItem/torch","questItem/sandwich","questItem/sandwich"],nodes:[{x:0,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:2,y:1,type:a.a.nothing},{x:3,y:1,type:a.a.nothing},{x:4,y:1,type:a.a.nothing},{x:5,y:1,type:a.a.nothing},{x:7,y:1,type:a.a.nothing},{x:8,y:2,type:a.a.nothing},{x:8,y:3,type:a.a.nothing},{x:9,y:3,type:a.a.nothing},{x:10,y:1,type:a.a.nothing},{x:10,y:2,type:a.a.nothing},{x:10,y:3,type:a.a.nothing},{x:10,y:4,type:a.a.nothing},{x:11,y:5,type:a.a.nothing},{x:12,y:6,type:a.a.nothing},{x:12,y:7,type:a.a.nothing},{x:13,y:8,type:a.a.nothing},{x:12,y:8,type:a.a.nothing},{x:12,y:9,type:a.a.nothing},{x:11,y:8,type:a.a.nothing},{x:10,y:8,type:a.a.nothing},{x:9,y:8,type:a.a.nothing},{x:8,y:9,type:a.a.nothing},{x:7,y:8,type:a.a.encounter,startScene:"dungeon.hallway"},{x:8,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:2,y:1,type:a.a.encounter,startScene:"dungeon.hallway"},{x:3,y:1,type:a.a.nothing}]}};function o(e){return c[e]}},7:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return d}));n(1);var a,r=n(669),c=n(35),o=n(40),i=n(28),s=n(32),u=(n(338),n(0)),l={drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){var n=t.getItem().item;return d(n,e.type)}};!function(e){e[e.feet=0]="feet",e[e.hands=1]="hands",e[e.chest=2]="chest",e[e.legs=3]="legs",e[e.head=4]="head",e[e.shoulders=5]="shoulders",e[e.mainHand=6]="mainHand",e[e.offHand=7]="offHand"}(a||(a={}));var d=function(e,t){switch(t){case a.chest:case a.feet:case a.hands:case a.head:case a.legs:return m(e,t);case a.mainHand:case a.offHand:var n=Object(o.c)(e);if(n.itemType!==i.a.weapon)return!1;switch(s.d[n.weaponType].classification){case s.b.oneHanded:return!0;case s.b.mainHand:return t===a.mainHand;case s.b.offHand:case s.b.shield:return t===a.offHand}return!0;default:return!1}};t.b=Object(r.a)(c.b.ITEM,l,(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,r="grey";return t&&n?r="green":n&&(r="orange"),(0,e.connectDropTarget)(Object(u.jsx)("div",{className:"equipment-slot",style:{borderColor:r},title:a[e.type],children:e.children}))}));var m=function(e,t){var n=Object(o.c)(e);return n.itemType===i.a.apparel&&n.equipmentType===t}},70:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return c}));var a=n(46),r=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.a.common,r=arguments.length>3?arguments[3]:void 0,c={key:e,context:t};return{type:"addLogEntry",entry:c,channel:n,channelContext:r}},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.a.common,n=arguments.length>2?arguments[2]:void 0;return{type:"addLogEntry",entry:e,channel:t,channelContext:n}}},71:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return i}));var a=function(e,t){return t.party.map((function(t){return c(e,t)}))},r=function(e,t){var n=t.party[0];return c(e,n)},c=function(e,t){return e.find((function(e){return e.id===t}))},o=function(e){return e.inventory.filter((function(e){return null===e})).length},i=function(e){return void 0!==(null===e||void 0===e?void 0:e.engine.gameStarted)}},8:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return p}));var a=n(3),r=5e3,c=6e4,o=12e4,i=18e4,s=24e4,u=30*c,l=60*c,d=24*l,m=265.25*d,p=function(e,t){var n=[{unit:t?"y":"year",amount:m},{unit:t?"d":"day",amount:d},{unit:t?"h":"hour",amount:l},{unit:t?"m":"minute",amount:c},{unit:t?"s":"second",amount:1e3}],r=Math.abs(e),o=[];return n.forEach((function(e){var n=Math.floor(r/e.amount);if(r-=n*e.amount,0!==n){var c=a.a.get("common-time-".concat(e.unit).concat(n>1&&!t?"-plural":""));o.push("".concat(n).concat(c))}})),o.join(" ")}},83:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d}));var a=n(13),r=n(28),c=n(7),o=r.a.apparel,i="/img/items/apparel/",s={boots1:{equipmentType:c.a.feet,itemType:o,iconImg:"".concat(i,"boots_1.png")},boots2:{equipmentType:c.a.feet,itemType:o,damageReduction:1,iconImg:"".concat(i,"boots_2.png")},boots3:{equipmentType:c.a.feet,itemType:o,damageReduction:2,iconImg:"".concat(i,"boots_3.png")},chainmailHood:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"chainmail_hood.png"),damageReduction:3},chest:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"chest_1.png"),damageReduction:2},clothGloves:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"cloth_gloves.png"),damageReduction:1},cowl:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"cowl.png"),damageReduction:2},cultistBoots:{equipmentType:c.a.feet,itemType:o,iconImg:"".concat(i,"cultist_boots.png"),damageReduction:2},crimsonRogueBoots:{equipmentType:c.a.feet,itemType:o,iconImg:"".concat(i,"crimson_rogue_boots.png"),damageReduction:2},crimsonRogueBritches:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"crimson_rogue_britches.png"),damageReduction:2},crimsonRogueCoif:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"crimson_rogue_coif.png"),damageReduction:2},crimsonRogueGrips:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"crimson_rogue_grips.png"),damageReduction:2},crimsonRogueSpaulders:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"crimson_rogue_spaulders.png"),damageReduction:2},crimsonRogueTunic:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"crimson_rogue_tunic.png"),damageReduction:2},cultistGloves:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"cultist_gloves.png"),damageReduction:2},cultistPants:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"cultist_pants.png"),damageReduction:2},cultistRobe:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"cultist_robe.png"),damageReduction:2},cultistShoulderwraps:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"cultist_shoulderwraps.png"),damageReduction:2},darkPrinceBracers:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"dark_prince_bracers.png"),damageReduction:2},darkPrinceCape:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"dark_prince_cape.png"),damageReduction:2},darkPrinceCuirass:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"dark_prince_cuirass.png"),damageReduction:2},darkPrinceHood:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"dark_prince_hood.png"),damageReduction:2},darkPrinceSarong:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"dark_prince_sarong.png"),damageReduction:2},darkPrinceSlippers:{equipmentType:c.a.feet,itemType:o,iconImg:"".concat(i,"dark_prince_slippers.png"),damageReduction:2},dreadnoughtBoots:{equipmentType:c.a.feet,itemType:o,iconImg:"".concat(i,"dreadnought_boots.png"),damageReduction:8},dreadnoughtChest:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"dreadnought_chest.png"),damageReduction:8},dreadnoughtGauntlets:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"dreadnought_gauntlets.png"),damageReduction:8},dreadnoughtHelm:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"dreadnought_helm.png"),damageReduction:8},dreadnoughtLegplates:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"dreadnought_legplates.png"),damageReduction:8},dreadnoughtPauldrons:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"dreadnought_pauldrons.png"),damageReduction:8},druidChest:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"druid-chest.png")},druidFeet:{equipmentType:c.a.feet,itemType:o,iconImg:"".concat(i,"druid-feet.png")},druidHands:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"druid-hands.png")},druidHead:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"druid-head.png")},druidLegs:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"druid-legs.png")},fedora:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"fedora.png")},footmanBoots:{equipmentType:c.a.feet,itemType:o,iconImg:"".concat(i,"footman_boots.png")},footmanBreastplate:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"footman_breastplate.png")},footmanFaceguard:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"footman_faceguard.png")},footmanFists:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"footman_fists.png")},footmanLegplates:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"footman_legplates.png")},footmanPauldrons:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"footman_pauldrons.png")},greaves1:{equipmentType:c.a.feet,itemType:o,iconImg:"".concat(i,"greaves_1.png"),damageReduction:2},greaves2:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"greaves_2.png")},hornedHelmet:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"horned_helmet.png")},leatherGloves:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"leather_gloves.png")},naturalistsCape:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"naturalists_cape.png")},naturalistsCowl:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"naturalists_cowl.png")},naturalistsFootwraps:{equipmentType:c.a.feet,itemType:o,iconImg:"".concat(i,"naturalists_footwraps.png")},naturalistsVambraces:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"naturalists_vambraces.png")},naturalistsVest:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"naturalists_vest.png")},nomadHelmet:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"nomad_helmet.png")},pants1:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"pants_1.png"),damageReduction:3},pants2:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"pants_2.png"),damageReduction:3},plateChest1:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"plate_chest_1.png")},plateChest2:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"plate_chest_2.png")},plateChest3:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"plate_chest_3.png")},plateChest4:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"plate_chest_4.png")},plateGloves1:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"plate_gloves_1.png")},plateGloves2:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"plate_gloves_2.png")},plateHelmet:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"plate_helmet_1.png")},platePants:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"plate_pants1.png")},plateShoulders1:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"plate_shoulders_1.png")},plateShoulders2:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"plate_shoulders_2.png")},robe:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"robe_1.png")},shoulders1:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"shoulders_1.png")},shoulders2:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"shoulders_2.png"),damageReduction:2},shoulders3:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"shoulders_3.png")},studdedLeatherShoulderguards:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"studded_leather_shoulderguards.png")},sunchaserBritches:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"sunchaser_britches.png")},sunchaserGloves:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"sunchaser_gloves.png")},sunchaserHelm:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"sunchaser_helm.png")},sunchaserMantle:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"sunchaser_mantle.png")},sunchaserMoccasins:{equipmentType:c.a.feet,itemType:o,iconImg:"".concat(i,"sunchaser_moccasins.png")},sunchaserTunic:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"sunchaser_tunic.png")},templeGuardChestplate:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"temple_guard_chestplate.png")},templeGuardGloves:{equipmentType:c.a.hands,itemType:o,iconImg:"".concat(i,"temple_guard_gloves.png")},templeGuardGreaves:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"temple_guard_greaves.png")},templeGuardHelm:{equipmentType:c.a.head,itemType:o,iconImg:"".concat(i,"temple_guard_helm.png")},templeGuardLegplates:{equipmentType:c.a.legs,itemType:o,iconImg:"".concat(i,"temple_guard_legplates.png")},templeGuardPauldrons:{equipmentType:c.a.shoulders,itemType:o,iconImg:"".concat(i,"temple_guard_pauldrons.png")},vest:{equipmentType:c.a.chest,itemType:o,iconImg:"".concat(i,"vest_1.png")}},u=Object.entries(s).reduce((function(e,t){var n=Object(a.a)(t,2),r=n[0],c=n[1];return e["".concat("apparel/").concat(r)]=c,e}),{});function l(e){return u[e]}t.a=u;var d=function(e){return!!u[e]}},84:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return d}));var a=n(42),r=n.n(a),c=n(60),o=n(11),i=function(e,t,n){return{x:s(e.x,t.x,n),y:s(e.y,t.y,n)}},s=function(e,t,n){return e+n*(t-e)};function u(e){return l.apply(this,arguments)}function l(){return(l=Object(c.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.Loader.shared,e.abrupt("return",new Promise((function(e,a){n.resources[t]?e(n.resources[t]):n.add(t).load((function(n,a){e(a[t])}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var d=function(e,t){var n=o.Loader.shared;n.resources[e]?t(n.resources[e]):n.add(e).load((function(n,a){t(a[e])}))}},96:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}));var a=function(e){return{type:"addGold",amount:e}},r=function(e){return{type:"addGold",amount:-e}}},98:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l}));var a=n(13),r=n(28),c=r.a.potion,o="/img/items/potions/",i={minorHealth:{category:"health",itemType:c,iconImg:"".concat(o,"minor-health.png")},minorMana:{category:"mana",itemType:c,iconImg:"".concat(o,"minor-mana.png")},minorSoma:{category:"soma",itemType:c,iconImg:"".concat(o,"minor-soma.png")},lesserHealth:{category:"health",itemType:c,iconImg:"".concat(o,"lesser-health.png")},lesserMana:{category:"mana",itemType:c,iconImg:"".concat(o,"lesser-mana.png")},lesserSoma:{category:"soma",itemType:c,iconImg:"".concat(o,"lesser-soma.png")},majorHealth:{category:"health",itemType:c,iconImg:"".concat(o,"major-health.png")},majorMana:{category:"mana",itemType:c,iconImg:"".concat(o,"major-mana.png")},majorSoma:{category:"soma",itemType:c,iconImg:"".concat(o,"major-soma.png")},greaterHealth:{category:"health",itemType:c,iconImg:"".concat(o,"greater-health.png")},greaterMana:{category:"mana",itemType:c,iconImg:"".concat(o,"greater-mana.png")},greaterSoma:{category:"soma",itemType:c,iconImg:"".concat(o,"greater-soma.png")}},s=Object.entries(i).reduce((function(e,t){var n=Object(a.a)(t,2),r=n[0],c=n[1];return e["".concat("potion/").concat(r)]=c,e}),{});function u(e){return s[e]}t.a=s;var l=function(e){return!!s[e]}}},[[667,1,2]]]);
//# sourceMappingURL=main.b28b3baf.chunk.js.map