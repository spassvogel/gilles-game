(this["webpackJsonpgilles-game"]=this["webpackJsonpgilles-game"]||[]).push([[0],{1:function(e,t,n){"use strict";var a,r;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),function(e){e[e.deed=0]="deed",e[e.apparel=1]="apparel",e[e.material=2]="material",e[e.questItem=3]="questItem",e[e.trinket=4]="trinket",e[e.weapon=5]="weapon"}(a||(a={})),function(e){e.deedForLumbermill="deedForLumbermill",e.deedForWeaponsmith="deedForWeaponsmith",e.boots1="boots1",e.boots2="boots2",e.boots3="boots3",e.chainmailHood="chainmailHood",e.chest="chest",e.clothGloves="clothGloves",e.cowl="cowl",e.fedora="fedora",e.druidChest="druidChest",e.druidFeet="druidFeet",e.druidHands="druidHands",e.druidHead="druidHead",e.druidLegs="druidLegs",e.greaves1="greaves1",e.greaves2="greaves2",e.hornedHelmet="hornedHelmet",e.leatherGloves="leatherGloves",e.nomadHelmet="nomadHelmet",e.pants1="pants1",e.pants2="pants2",e.plateChest1="plateChest1",e.plateChest2="plateChest2",e.plateChest3="plateChest3",e.plateChest4="plateChest4",e.plateGloves1="plateGloves1",e.plateGloves2="plateGloves2",e.plateHelmet="plateHelmet",e.platePants="platePants",e.plateShoulders1="plateShoulders1",e.plateShoulders2="plateShoulders2",e.robe="robe",e.shoulders1="shoulders1",e.shoulders2="shoulders2",e.shoulders3="shoulders3",e.vest="vest",e.arrowheads="arrowheads",e.bolts="bolts",e.buckle="buckle",e.chain="chain",e.cogs="cogs",e.gem="gem",e.gunpowder="gunpowder",e.ingot="ingot",e.nails="nails",e.poisonVial="poisonVial",e.ribbon="ribbon",e.rope="rope",e.scales="scales",e.spring="spring",e.thread="thread",e.blueprints="blueprints",e.crate="crate",e.dragonEye="dragonEye",e.dynamite="dynamite",e.eye="eye",e.feather="feather",e.food="food",e.heart="heart",e.horn="horn",e.key="key",e.letters="letters",e.lockPicks="lockPicks",e.oil="oil",e.orcFinger="orcFinger",e.plans="plans",e.purpleGems="purpleGems",e.runestone="runestone",e.sandwich="sandwich",e.teeth="teeth",e.tooth="tooth",e.torch="torch",e.tusk="tusk",e.vase="vase",e.vial="vial",e.weeds="weeds",e.ring="ring",e.magicAmulet="magicAmulet",e.aegisOfValor="aegisOfValor",e.arbalest="arbalest",e.battleAxe="battleAxe",e.berserkerShield="berserkerShield",e.brassKnuckles="brassKnuckles",e.buckler="buckler",e.cleaver="cleaver",e.club="club",e.dagger="dagger",e.flail="flail",e.goldenShield="goldenShield",e.greatswordOfGwai="greatswordOfGwai",e.indomitableCarapace="indomitableCarapace",e.javelin="javelin",e.khopesh="khopesh",e.longbow="longbow",e.mace="mace",e.morningStar="morningStar",e.paintedBuckler="paintedBuckler",e.poisonedDagger="poisonedDagger",e.ravenStaff="ravenStaff",e.savageStaff="savageStaff",e.simpleCrossbow="simpleCrossbow",e.spear="spear",e.steelShield="steelShield",e.sword="sword",e.warhammer="warhammer",e.woodenBulwark="woodenBulwark"}(r||(r={}))},107:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(20),r=n(22),c=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"registerSceneController",value:function(e,t,n){this.controllerTypes["".concat(e,".").concat(t)]=n}},{key:"getSceneController",value:function(e,t,n){if(!this.store["".concat(e,".").concat(t)]){if(!this.controllerTypes["".concat(e,".").concat(t)])throw new Error("No controller registered for ".concat(e,".").concat(t));this.store["".concat(e,".").concat(t)]=new(this.controllerTypes["".concat(e,".").concat(t)])(n,e)}return this.store["".concat(e,".").concat(t)]}},{key:"destroySceneConroller",value:function(e,t){delete this.store["".concat(e,".").concat(t)]}}]),e}();c.store={},c.controllerTypes={},n(498)},11:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return m}));var a,r=n(25),c=n(43),o=n(1),i=n(0),u=n(68),s=(n(280),n(26)),l={drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){var n=t.getItem().item;return m(n,e.type)}};!function(e){e[e.feet=0]="feet",e[e.hands=1]="hands",e[e.chest=2]="chest",e[e.legs=3]="legs",e[e.head=4]="head",e[e.shoulders=5]="shoulders",e[e.mainHand=6]="mainHand",e[e.offHand=7]="offHand"}(a||(a={}));var m=function(e,t){switch(t){case a.chest:case a.feet:case a.hands:case a.head:case a.legs:return d(e,t);case a.mainHand:case a.offHand:var n=Object(c.b)(e);if(n.itemType!==o.b.weapon)return!1;switch(s.e[n.weaponType]){case s.b.oneHanded:return!0;case s.b.mainHand:return t===a.mainHand;case s.b.offHand:case s.b.shield:return t===a.offHand}return!0;default:return!1}};t.b=Object(u.DropTarget)(r.b.ITEM,l,(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,r="grey";return t&&n?r="green":n&&(r="orange"),(0,e.connectDropTarget)(i.createElement("div",{className:"equipment-slot",style:{borderColor:r},title:a[e.type]},e.children))}));var d=function(e,t){var n=Object(c.b)(e);return n.itemType===o.b.apparel&&n.equipmentType===t}},119:function(e,t,n){"use strict";n.d(t,"b",(function(){return l}));var a,r=n(2),c=n(1),o=n(11),i=c.b.apparel,u="/img/items/apparel/",s=(a={},Object(r.a)(a,c.a.boots1,{item:c.a.boots1,equipmentType:o.a.feet,itemType:i,iconImg:"".concat(u,"boots_1.png")}),Object(r.a)(a,c.a.boots2,{item:c.a.boots2,equipmentType:o.a.feet,itemType:i,damageReduction:1,iconImg:"".concat(u,"boots_2.png")}),Object(r.a)(a,c.a.boots3,{item:c.a.boots3,equipmentType:o.a.feet,itemType:i,damageReduction:2,iconImg:"".concat(u,"boots_3.png")}),Object(r.a)(a,c.a.chainmailHood,{item:c.a.chainmailHood,equipmentType:o.a.head,itemType:i,iconImg:"".concat(u,"chainmail_hood.png"),damageReduction:3}),Object(r.a)(a,c.a.chest,{item:c.a.chest,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(u,"chest_1.png"),damageReduction:2}),Object(r.a)(a,c.a.clothGloves,{item:c.a.clothGloves,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(u,"cloth_gloves.png"),damageReduction:1}),Object(r.a)(a,c.a.cowl,{item:c.a.cowl,equipmentType:o.a.head,itemType:i,iconImg:"".concat(u,"cowl.png"),damageReduction:2}),Object(r.a)(a,c.a.druidChest,{item:c.a.druidHands,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(u,"druid-chest.png")}),Object(r.a)(a,c.a.druidFeet,{item:c.a.druidFeet,equipmentType:o.a.feet,itemType:i,iconImg:"".concat(u,"druid-feet.png")}),Object(r.a)(a,c.a.druidHands,{item:c.a.druidHands,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(u,"druid-hands.png")}),Object(r.a)(a,c.a.druidHead,{item:c.a.druidHead,equipmentType:o.a.head,itemType:i,iconImg:"".concat(u,"druid-head.png")}),Object(r.a)(a,c.a.druidLegs,{item:c.a.druidLegs,equipmentType:o.a.legs,itemType:i,iconImg:"".concat(u,"druid-legs.png")}),Object(r.a)(a,c.a.fedora,{item:c.a.fedora,equipmentType:o.a.head,itemType:i,iconImg:"".concat(u,"fedora.png")}),Object(r.a)(a,c.a.greaves1,{item:c.a.greaves1,equipmentType:o.a.feet,itemType:i,iconImg:"".concat(u,"greaves_1.png"),damageReduction:2}),Object(r.a)(a,c.a.greaves2,{item:c.a.greaves2,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(u,"greaves_2.png")}),Object(r.a)(a,c.a.hornedHelmet,{item:c.a.hornedHelmet,equipmentType:o.a.head,itemType:i,iconImg:"".concat(u,"horned_helmet.png")}),Object(r.a)(a,c.a.leatherGloves,{item:c.a.leatherGloves,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(u,"leather_gloves.png")}),Object(r.a)(a,c.a.nomadHelmet,{item:c.a.nomadHelmet,equipmentType:o.a.head,itemType:i,iconImg:"".concat(u,"nomad_helmet.png")}),Object(r.a)(a,c.a.pants1,{item:c.a.pants1,equipmentType:o.a.legs,itemType:i,iconImg:"".concat(u,"pants_1.png"),damageReduction:3}),Object(r.a)(a,c.a.pants2,{item:c.a.pants2,equipmentType:o.a.legs,itemType:i,iconImg:"".concat(u,"pants_2.png"),damageReduction:3}),Object(r.a)(a,c.a.plateChest1,{item:c.a.plateChest1,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(u,"plate_chest_1.png")}),Object(r.a)(a,c.a.plateChest2,{item:c.a.plateChest2,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(u,"plate_chest_2.png")}),Object(r.a)(a,c.a.plateChest3,{item:c.a.plateChest3,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(u,"plate_chest_3.png")}),Object(r.a)(a,c.a.plateChest4,{item:c.a.plateChest4,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(u,"plate_chest_4.png")}),Object(r.a)(a,c.a.plateGloves1,{item:c.a.plateGloves1,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(u,"plate_gloves_1.png")}),Object(r.a)(a,c.a.plateGloves2,{item:c.a.plateGloves2,equipmentType:o.a.hands,itemType:i,iconImg:"".concat(u,"plate_gloves_2.png")}),Object(r.a)(a,c.a.plateHelmet,{item:c.a.plateHelmet,equipmentType:o.a.head,itemType:i,iconImg:"".concat(u,"plate_helmet_1.png")}),Object(r.a)(a,c.a.platePants,{item:c.a.platePants,equipmentType:o.a.legs,itemType:i,iconImg:"".concat(u,"plate_pants1.png")}),Object(r.a)(a,c.a.plateShoulders1,{item:c.a.plateShoulders1,equipmentType:o.a.shoulders,itemType:i,iconImg:"".concat(u,"plate_shoulders_1.png")}),Object(r.a)(a,c.a.plateShoulders2,{item:c.a.plateShoulders2,equipmentType:o.a.shoulders,itemType:i,iconImg:"".concat(u,"plate_shoulders_2.png")}),Object(r.a)(a,c.a.robe,{item:c.a.robe,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(u,"robe_1.png")}),Object(r.a)(a,c.a.shoulders1,{item:c.a.shoulders1,equipmentType:o.a.shoulders,itemType:i,iconImg:"".concat(u,"shoulders_1.png")}),Object(r.a)(a,c.a.shoulders2,{item:c.a.shoulders2,equipmentType:o.a.shoulders,itemType:i,iconImg:"".concat(u,"shoulders_2.png"),damageReduction:2}),Object(r.a)(a,c.a.shoulders3,{item:c.a.shoulders3,equipmentType:o.a.shoulders,itemType:i,iconImg:"".concat(u,"shoulders_3.png")}),Object(r.a)(a,c.a.vest,{item:c.a.vest,equipmentType:o.a.chest,itemType:i,iconImg:"".concat(u,"vest_1.png")}),a);function l(e){return s[e]}t.a=s},123:function(e,t,n){"use strict";var a=n(20),r=n(22);t.a=function(){var e=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"addEventListener",value:function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(this.events[e])for(var n=0;n<this.events[e].length;n++)if(this.events[e][n]===t){this.events[e].splice(n,1);break}}},{key:"emit",value:function(e,t){this.events[e]&&this.events[e].forEach((function(e){return e(t)}))}}]),e}();return e.events={},e}},124:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1),r={dungeon:{entered:!1,lootCaches:{chest:{title:"encounter-dungeon-caches-chest",items:[a.a.nomadHelmet,a.a.teeth,a.a.poisonVial,a.a.fedora],gold:100},altar:{title:"quest-kill10-boars-dungeonentrance-altar",items:[a.a.bolts,a.a.letters]}},situations:{altar:{candleLit:!1}}}}},125:function(e,t,n){"use strict";var a,r,c;n.d(t,"a",(function(){return a})),function(e){e.tilelayer="tilelayer",e.objectgroup="objectgroup"}(a||(a={})),function(e){e.orthagonal="orthagonal",e.isometric="isometric",e.staggered="staggered",e.hexagonal="hexagonal"}(r||(r={})),function(e){e.rightUp="right-up",e.rightDown="right-down",e.leftUp="left-up",e.leftDown="left-down"}(c||(c={}))},13:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return l}));var a=n(6),r=6e4,c=12e4,o=30*r,i=60*r,u=24*i,s=265.25*u,l=function(e,t){var n=[{unit:t?"y":"year",amount:s},{unit:t?"d":"day",amount:u},{unit:t?"h":"hour",amount:i},{unit:t?"m":"minute",amount:r},{unit:t?"s":"second",amount:1e3}],c=Math.abs(e),o=[];return n.forEach((function(e){var n=Math.floor(c/e.amount);if(c-=n*e.amount,0!==n){var r=a.a.get("common-time-".concat(e.unit).concat(n>1&&!t?"-plural":""));o.push("".concat(n).concat(r))}})),o.join(" ")}},131:function(e,t,n){},18:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.nothing=0]="nothing",e[e.encounter=1]="encounter"}(a||(a={}))},21:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return g}));var a,r,c,o=n(16),i=n(32),u=n.n(i),s=n(45),l=n(20),m=n(22),d=n(76),p=n.n(d);!function(e){e[e.town=0]="town",e[e.world=1]="world"}(a||(a={})),function(e){e[e.buttonClick=0]="buttonClick",e[e.error=1]="error",e[e.toast=2]="toast"}(r||(r={}));var f={},v=null,h={},g=function(){function e(){Object(l.a)(this,e)}return Object(m.a)(e,null,[{key:"init",value:function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.getItem("musicVolume");case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=0;case 5:return this._musicVolume=e.t0,e.next=8,p.a.getItem("soundVolume");case 8:if(e.t1=e.sent,e.t1){e.next=11;break}e.t1=1;case 11:this._soundVolume=e.t1,this._initialized=!0;case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadMedia",value:function(e){c=e}},{key:"addSounds",value:function(e){Object.entries(e).forEach((function(e){var t=Object(o.a)(e,2),n=t[0],a=t[1];h[n]=c.find((function(e){return e.url===a})).content}))}},{key:"playSound",value:function(e){var t=h[e];t.volume(this.soundVolume),t.play()}},{key:"addMusicTrack",value:function(){var e=Object(s.a)(u.a.mark((function e(t,n){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return");case 2:if(this._initialized){e.next=5;break}return e.next=5,this.init();case 5:if(a=c.find((function(e){return e.url===n}))){e.next=8;break}throw new Error("No sound found at ".concat(n));case 8:f.hasOwnProperty(t)||(f[t]=a.content);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"playMusicTrack",value:function(){var t=Object(s.a)(u.a.mark((function t(n){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c){t.next=2;break}return t.abrupt("return");case 2:if(this._initialized){t.next=5;break}return t.next=5,this.init();case 5:null!==v&&f[v].fade(e.musicVolume,0,500),(a=f[n]).playing()||(a.loop(!0),a.play()),a.fade(0,e.musicVolume,500),v=n;case 10:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"soundVolume",set:function(e){this._soundVolume=e,p.a.setItem("soundVolume",e)},get:function(){return this._soundVolume}},{key:"musicVolume",set:function(e){v&&f[v].volume(e),this._musicVolume=e,p.a.setItem("musicVolume",e)},get:function(){return this._musicVolume}}]),e}();g._musicVolume=0,g._soundVolume=1,g._initialized=!1},24:function(e,t,n){"use strict";var a;function r(e,t){return{type:a.launchQuest,questName:e,assignedAventurers:t}}function c(e){return{type:a.exitEncounter,questName:e}}function o(e,t){return{type:a.updateQuestVars,questName:e,vars:t}}function i(e,t){return{type:a.setSceneName,questName:e,sceneName:t}}function u(e,t){return{type:a.setScene,questName:e,scene:t}}function s(e,t){return{type:a.enqueueSceneAction,questName:e,sceneAction:t}}function l(e){return{type:a.completeSceneAction,questName:e}}function m(e,t,n){return{type:a.deductActorAp,questName:e,actor:t,ap:n}}n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return c})),n.d(t,"j",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return m})),n.d(t,"k",(function(){return d})),n.d(t,"g",(function(){return p})),function(e){e.launchQuest="launchQuest",e.updateQuestVars="updateQuestVars",e.updateEncounterResult="updateEncounterResult",e.startEncounter="startEncounter",e.setSceneName="setSceneName",e.setScene="setScene",e.exitEncounter="exitEncounter",e.updateQuests="updateQuests",e.enqueueSceneAction="enqueueSceneAction",e.completeSceneAction="completeSceneAction",e.deductActorAp="deductActorAp",e.updateSceneObjectAction="updateSceneObjectAction",e.setActiveSceneInteractionModal="setActiveSceneInteractionModal"}(a||(a={}));var d=function(e,t,n){return{type:a.updateSceneObjectAction,questName:e,id:t,object:n}};var p=function(e,t){return{type:a.setActiveSceneInteractionModal,questName:e,sceneInteractionModal:t}}},244:function(e,t,n){},247:function(e,t,n){},25:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var a,r={ADVENTURER:"adventurer",ITEM:"item"};!function(e){e[e.adventurerInventory=0]="adventurerInventory",e[e.warehouse=1]="warehouse",e[e.tavern=2]="tavern",e[e.adventurerEquipment=3]="adventurerEquipment",e[e.lootCache=4]="lootCache"}(a||(a={}))},255:function(e){e.exports=JSON.parse('{"alchemist":[{"shape":[34,18,31,1,37,0]},{"shape":[37,0,53,5,45,17]},{"shape":[45,17,68,27,81,48]},{"shape":[72,67,75,168,11,168]},{"shape":[9,65,1,45,10,30]},{"shape":[31,19,29,5,45,0]},{"shape":[45,0,34,18,37,0]},{"shape":[45,17,81,48,72,67]},{"shape":[72,67,11,168,9,65]},{"shape":[9,65,10,30,31,19]},{"shape":[45,17,72,67,9,65]},{"shape":[9,65,31,19,45,0]},{"shape":[37,0,45,17,9,65]}],"garden":[{"shape":[48,45,48,0,58,0]},{"shape":[57,41,75,56,73,78]},{"shape":[73,78,11,68,2,56]},{"shape":[2,56,13,45,48,45]},{"shape":[48,45,58,0,57,41]},{"shape":[73,78,2,56,48,45]},{"shape":[48,45,57,41,73,78]}],"armoursmith":[{"shape":[53,1,55,0,93,5]},{"shape":[93,5,112,11,120,20]},{"shape":[120,20,124,36,119,49]},{"shape":[119,49,122,156,75,149]},{"shape":[75,149,57,135,33,104]},{"shape":[33,104,10,95,11,52]},{"shape":[11,52,0,35,2,20]},{"shape":[2,20,6,14,27,5]},{"shape":[27,5,53,1,93,5]},{"shape":[93,5,120,20,119,49]},{"shape":[119,49,75,149,33,104]},{"shape":[33,104,11,52,2,20]},{"shape":[2,20,27,5,93,5]},{"shape":[93,5,119,49,33,104]},{"shape":[33,104,2,20,93,5]}],"lumberMill":[{"shape":[32,11,43,1,45,0]},{"shape":[45,0,49,4,37,18]},{"shape":[39,29,50,44,49,48]},{"shape":[38,46,38,230,17,233]},{"shape":[17,233,13,232,13,48]},{"shape":[13,48,3,48,14,28]},{"shape":[14,28,1,7,6,4]},{"shape":[31,18,32,11,45,0]},{"shape":[39,29,49,48,40,43]},{"shape":[38,46,17,233,13,48]},{"shape":[14,28,6,4,19,18]},{"shape":[31,18,45,0,37,18]},{"shape":[37,18,39,29,40,43]},{"shape":[40,43,38,46,13,48]},{"shape":[13,48,14,28,19,18]},{"shape":[31,18,37,18,40,43]},{"shape":[40,43,13,48,19,18]},{"shape":[19,18,31,18,40,43]}],"mine":[{"shape":[15,0,79,1,88,13]},{"shape":[88,13,78,66,27,70]},{"shape":[27,70,2,50,11,27]},{"shape":[11,27,6,13,15,0]},{"shape":[15,0,88,13,27,70]},{"shape":[27,70,11,27,15,0]}],"quarry":[{"shape":[2,24,20,2,22,0]},{"shape":[22,0,103,2,117,15]},{"shape":[117,15,124,24,112,24]},{"shape":[112,24,112,64,104,70]},{"shape":[104,70,104,89,97,88]},{"shape":[97,68,66,67,60,43]},{"shape":[60,43,17,42,17,26]},{"shape":[17,26,2,24,22,0]},{"shape":[22,0,117,15,112,24]},{"shape":[112,24,104,70,97,88]},{"shape":[60,43,17,26,22,0]},{"shape":[112,24,97,88,97,68]},{"shape":[97,68,60,43,22,0]},{"shape":[22,0,112,24,97,68]}],"tannery":[{"shape":[4,2,4,0,61,1]},{"shape":[59,36,89,37,85,79]},{"shape":[85,79,15,77,15,47]},{"shape":[15,47,5,35,0,9]},{"shape":[0,9,4,2,61,1]},{"shape":[59,36,85,79,15,47]},{"shape":[15,47,0,9,61,1]},{"shape":[61,1,59,36,15,47]}],"tavern":[{"shape":[110,27,108,24,112,23]},{"shape":[112,23,151,27,148,60]},{"shape":[148,60,137,71,133,67]},{"shape":[133,67,136,69,132,75]},{"shape":[132,75,137,77,138,124]},{"shape":[131,131,136,136,55,119]},{"shape":[29,64,6,72,0,69]},{"shape":[27,56,76,61,85,67]},{"shape":[101,25,108,13,112,17]},{"shape":[112,17,102,18,104,6]},{"shape":[110,27,112,23,148,60]},{"shape":[132,75,138,124,131,131]},{"shape":[131,131,55,119,59,118]},{"shape":[29,64,0,69,27,56]},{"shape":[112,17,104,6,111,9]},{"shape":[92,27,110,27,148,60]},{"shape":[132,75,131,131,59,118]},{"shape":[50,68,29,64,27,56]},{"shape":[92,27,148,60,133,67]},{"shape":[133,67,132,75,59,118]},{"shape":[50,68,27,56,85,67]},{"shape":[133,67,59,118,56,72]},{"shape":[56,72,50,68,85,67]},{"shape":[133,67,56,72,85,67]},{"shape":[133,67,85,67,89,60]},{"shape":[92,27,133,67,89,60]},{"shape":[92,27,89,60,86,25]},{"shape":[104,0,92,27,86,25]}],"warehouse":[{"shape":[36,414,3,409,2,13]},{"shape":[2,13,31,-7,63,7]},{"shape":[62,197,63,126,65,218]},{"shape":[61,262,83,272,84,459]},{"shape":[84,459,36,414,2,13]},{"shape":[2,13,63,7,62,197]},{"shape":[62,197,65,218,61,262]},{"shape":[61,262,84,459,2,13]},{"shape":[2,13,62,197,61,262]}],"weaponsmith":[{"shape":[52,18,50,2,50,0]},{"shape":[50,0,114,1,109,49]},{"shape":[109,49,115,132,98,129]},{"shape":[98,129,66,95,65,34]},{"shape":[11,33,11,77,0,77]},{"shape":[0,29,18,18,52,18]},{"shape":[52,18,50,0,109,49]},{"shape":[109,49,98,129,65,34]},{"shape":[11,33,0,77,0,29]},{"shape":[52,18,109,49,65,34]},{"shape":[15,27,11,33,0,29]},{"shape":[52,18,65,34,53,26]},{"shape":[15,27,0,29,52,18]},{"shape":[52,18,53,26,15,27]}],"weaver":[{"shape":[51,41,54,0,55,6]},{"shape":[55,41,82,53,87,63]},{"shape":[87,63,86,259,62,254]},{"shape":[62,254,23,212,21,61]},{"shape":[21,61,2,56,51,41]},{"shape":[51,41,55,6,55,41]},{"shape":[55,41,87,63,62,254]},{"shape":[62,254,21,61,51,41]},{"shape":[51,41,55,41,62,254]}],"workshop":[{"shape":[11,2,13,0,68,3]},{"shape":[68,3,77,12,70,14]},{"shape":[70,14,69,38,10,37]},{"shape":[9,13,1,12,11,2]},{"shape":[11,2,68,3,70,14]},{"shape":[70,14,10,37,9,13]},{"shape":[9,13,11,2,70,14]}]}')},256:function(e){e.exports=JSON.parse('{"alpha":{"start":0.25,"end":0},"scale":{"start":0.04,"end":0.29,"minimumScaleMultiplier":1},"color":{"start":"#85888d","end":"#100f0c"},"speed":{"start":100,"end":200,"minimumSpeedMultiplier":1},"acceleration":{"x":10,"y":-30},"maxSpeed":200,"startRotation":{"min":265,"max":270},"noRotation":false,"rotationSpeed":{"min":8,"max":0},"lifetime":{"min":0.5,"max":3.05},"blendMode":"normal","frequency":0.0005,"emitterLifetime":-1,"maxParticles":300,"pos":{"x":0,"y":0},"addAtBack":true,"spawnType":"point"}')},259:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAgCAYAAAABtRhCAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAB3RJTUUH3gMODzc3YHmYGgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAE50lEQVRIx7WXW0wcVRjHfzO7y16YZbfAytACvbjU1hqkLVZMbbSXBEPUNjX6YDYanwYfTXzxrb7qm0lTJ018QhOjaWI0trFYbRoqpYVuwy2UpRS2lAF22YUdtuxt1ofKCIXShaZfMjm37+Q33zn/cxMURWHRVFXNAyiKIvCMTFwKO6Ne4ONPTpngZwoE6Lx6FYCDhwLPDLoMeKPtV8b6ewkEAssiVVU1v/gtLS+dhnUDFUUResZvUhLXuNF+ZVmkBw8F6B+4b5avXR8x82fUC+uCWhoaGsxCV1fXKZelGOvMNPcXspw9+zV60s3MzAweTwXJZBLJXYXPt8XMJ5NJbgX/pqGh4ctCgNalBUVRhId/u5tsQqf9UpDGxkZCoRCtra2mX2trK5qmAZhpoWZdrTIvCOyQihn8/RydsQSVm6uQJAnZ6zV9MjYbkUgEAL/fj6p+my9kOYmPViiKIgQn+8mLIv1jowSONtN0+OgyGEAkEkHXdTRNQ5Kkjal0qY3MJciLIsdOvslYXy9xbXxZu67rAEiSZOafCtgzfpM8Al2/deDEwJZOrYAu2lNFqKpq/rPjLTTtbWY0Psu1jovUVm7Hmk1jS6eYmXooEiH//0pYj3BWFc2RukM4HpxHMAz6x0aRvT1scfsYT0yTTwnEtXEsuQzxhbQ5j08F/O7H0+zz+ThQWsK52yGuBNs5XPcqllwOVzrOjv2HsZaXsuv1OtySnYSeort7kE+Vt56o1FWBo7EollwGQ7Sww13McHyWbE8n9VVVNLzWzMDkXSYGujl/uY1wNIamaciybO4+a0FXXRbd04P8PHydu/EYtmwaSy7NaCzOi0eO09F5kfk7/bhSSZ4T8zQ2NiLLMgCyLPPe+5+vudWtqlJFUYRF8MhsHNHIcXKnn86rfxK8P4Etk8G5kKR4YZ758F1OnDixrP9aUHGt8V6ExlMLbLP7GBoeAkGkxuWhKJfFlUoiJRNE7o0TCARM8UiS9NgjTnySqhRFEUZmR/jm5l9YsynGolG0RJQqpwd7OoU0P0dqZJD0TJyWlhZzU/D7/Txfe2wFVCxUzttLPNyaGEc0svx0+zZVW/cD4Eo/wJuIkevtwZiKLhteWZZXQAsGdk9PscluRzByODxlnL78Aw17mpDdZdizGUr0GNEbndRvKeeD5rcpLy83oRWVjeuLUFEUYTQ+jMfpwutw4CgpJVmzm6/++QVDtFDpLkU0DLxzUabbB6ir9vHGtp3mxi5JkhmluJ6zzONw/pfaMUSR0HyaL6530zYRBmBz7QFqj9YhSQ5efsXPQjxS2MJ/nJUUS8zEZ/G4nPSEQgyHLj08kCehtQuqy66w94/vEfIGNaVliEYGr6No40AAj9OBkDcYHmpb0RaO9hGO9lFdtodubQqAovQCG1IpgGgYlNlsbCqyrekXjvaZ+SlD3Dgwoc9hyWU4WP1SQf6lNbXouo6u6+ZtvmCgoihCcErDks2QCA3w4YF3ngjz+/1omsbkRMfG5nBkdoQ7bjeEe9hVVsZHe5u4FB7nXqTX9Kmvf5eKys3IskwwGGR4qG3ZW0VY+pgpxFRVze/zvcBWbylep5OMzY5hsVLsLiFd5MTqq+DedJRQKLQCtiHg0uv91k21uF1uPE4XhsVC1monlsqSmE8yOdGx6itsQ8BHwavN9+P6/Avf+1eTf20QhwAAAABJRU5ErkJggg=="},26:function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return d}));var a,r,c,o,i=n(2),u=n(1),s=n(29),l=u.b.weapon,m="/img/items/weapons/";!function(e){e.axe="axe",e.bow="bow",e.club="club",e.crossbow="crossbow",e.fist="fist",e.flail="flail",e.hammer="hammer",e.knife="knife",e.staff="staff",e.shield="shield",e.sword="sword",e.poleArm="poleArm"}(c||(c={})),function(e){e[e.oneHanded=0]="oneHanded",e[e.mainHand=1]="mainHand",e[e.offHand=2]="offHand",e[e.twoHanded=3]="twoHanded",e[e.shield=4]="shield"}(o||(o={}));var d,p=(a={},Object(i.a)(a,c.axe,o.oneHanded),Object(i.a)(a,c.bow,o.oneHanded),Object(i.a)(a,c.club,o.oneHanded),Object(i.a)(a,c.crossbow,o.mainHand),Object(i.a)(a,c.fist,o.oneHanded),Object(i.a)(a,c.flail,o.mainHand),Object(i.a)(a,c.hammer,o.oneHanded),Object(i.a)(a,c.knife,o.oneHanded),Object(i.a)(a,c.staff,o.twoHanded),Object(i.a)(a,c.sword,o.oneHanded),Object(i.a)(a,c.poleArm,o.twoHanded),Object(i.a)(a,c.shield,o.shield),a);!function(e){e.kinetic="kinetic"}(d||(d={}));var f=(r={},Object(i.a)(r,u.a.aegisOfValor,{item:u.a.aegisOfValor,itemType:l,weaponType:c.shield,rarity:s.a.legendary,iconImg:"".concat(m,"aegis-of-valor.png")}),Object(i.a)(r,u.a.arbalest,{item:u.a.arbalest,itemType:l,weaponType:c.crossbow,rarity:s.a.epic,iconImg:"".concat(m,"arbalest.png"),damage:Object(i.a)({},d.kinetic,40)}),Object(i.a)(r,u.a.battleAxe,{item:u.a.battleAxe,itemType:l,weaponType:c.axe,rarity:s.a.common,iconImg:"".concat(m,"battle_axe.png"),damage:Object(i.a)({},d.kinetic,20)}),Object(i.a)(r,u.a.berserkerShield,{item:u.a.berserkerShield,itemType:l,weaponType:c.shield,rarity:s.a.epic,iconImg:"".concat(m,"berserker-shield.png")}),Object(i.a)(r,u.a.brassKnuckles,{item:u.a.brassKnuckles,itemType:l,weaponType:c.fist,iconImg:"".concat(m,"brass_knuckles.png"),rarity:s.a.common,damage:Object(i.a)({},d.kinetic,10)}),Object(i.a)(r,u.a.buckler,{item:u.a.buckler,itemType:l,weaponType:c.shield,rarity:s.a.common,iconImg:"".concat(m,"buckler.png")}),Object(i.a)(r,u.a.cleaver,{item:u.a.cleaver,itemType:l,weaponType:c.knife,iconImg:"".concat(m,"cleaver.png"),rarity:s.a.common,damage:Object(i.a)({},d.kinetic,5)}),Object(i.a)(r,u.a.club,{item:u.a.club,itemType:l,weaponType:c.club,iconImg:"".concat(m,"club.png"),rarity:s.a.common,damage:Object(i.a)({},d.kinetic,8)}),Object(i.a)(r,u.a.dagger,{item:u.a.dagger,itemType:l,weaponType:c.knife,iconImg:"".concat(m,"dagger.png"),rarity:s.a.uncommon,damage:Object(i.a)({},d.kinetic,8)}),Object(i.a)(r,u.a.flail,{item:u.a.flail,itemType:l,weaponType:c.flail,iconImg:"".concat(m,"flail.png"),rarity:s.a.uncommon,damage:Object(i.a)({},d.kinetic,15)}),Object(i.a)(r,u.a.goldenShield,{item:u.a.goldenShield,itemType:l,weaponType:c.shield,rarity:s.a.rare,iconImg:"".concat(m,"golden-shield.png")}),Object(i.a)(r,u.a.greatswordOfGwai,{item:u.a.greatswordOfGwai,itemType:l,weaponType:c.sword,iconImg:"".concat(m,"greatsword-gwai.png"),unique:!0,rarity:s.a.legendary,damage:Object(i.a)({},d.kinetic,25)}),Object(i.a)(r,u.a.indomitableCarapace,{item:u.a.indomitableCarapace,itemType:l,weaponType:c.shield,rarity:s.a.epic,unique:!0,iconImg:"".concat(m,"indomitable-carapace.png")}),Object(i.a)(r,u.a.javelin,{item:u.a.javelin,itemType:l,weaponType:c.poleArm,iconImg:"".concat(m,"javelin.png"),rarity:s.a.epic,damage:Object(i.a)({},d.kinetic,25)}),Object(i.a)(r,u.a.khopesh,{item:u.a.khopesh,itemType:l,weaponType:c.sword,iconImg:"".concat(m,"khopesh.png"),rarity:s.a.epic,damage:Object(i.a)({},d.kinetic,15)}),Object(i.a)(r,u.a.longbow,{item:u.a.longbow,itemType:l,weaponType:c.bow,iconImg:"".concat(m,"longbow.png"),rarity:s.a.rare,damage:Object(i.a)({},d.kinetic,2)}),Object(i.a)(r,u.a.mace,{item:u.a.mace,itemType:l,weaponType:c.club,iconImg:"".concat(m,"mace.png"),rarity:s.a.rare,damage:Object(i.a)({},d.kinetic,15)}),Object(i.a)(r,u.a.morningStar,{item:u.a.morningStar,itemType:l,weaponType:c.club,iconImg:"".concat(m,"morning-star.png"),rarity:s.a.uncommon,damage:Object(i.a)({},d.kinetic,13)}),Object(i.a)(r,u.a.paintedBuckler,{item:u.a.paintedBuckler,itemType:l,weaponType:c.shield,iconImg:"".concat(m,"painted-buckler.png")}),Object(i.a)(r,u.a.poisonedDagger,{item:u.a.poisonedDagger,itemType:l,weaponType:c.knife,iconImg:"".concat(m,"poisoned-dagger.png"),rarity:s.a.epic,damage:Object(i.a)({},d.kinetic,12)}),Object(i.a)(r,u.a.ravenStaff,{item:u.a.ravenStaff,itemType:l,weaponType:c.staff,iconImg:"".concat(m,"raven-staff.png"),rarity:s.a.epic,damage:Object(i.a)({},d.kinetic,13)}),Object(i.a)(r,u.a.savageStaff,{item:u.a.savageStaff,itemType:l,weaponType:c.staff,iconImg:"".concat(m,"savage-staff.png"),rarity:s.a.epic,damage:Object(i.a)({},d.kinetic,8)}),Object(i.a)(r,u.a.simpleCrossbow,{item:u.a.simpleCrossbow,itemType:l,weaponType:c.crossbow,iconImg:"".concat(m,"crossbow.png"),rarity:s.a.common,damage:Object(i.a)({},d.kinetic,3)}),Object(i.a)(r,u.a.spear,{item:u.a.spear,itemType:l,weaponType:c.poleArm,iconImg:"".concat(m,"sword.png"),rarity:s.a.rare,damage:Object(i.a)({},d.kinetic,10)}),Object(i.a)(r,u.a.steelShield,{item:u.a.steelShield,itemType:l,weaponType:c.shield,rarity:s.a.rare,iconImg:"".concat(m,"steel-shield.png")}),Object(i.a)(r,u.a.sword,{item:u.a.sword,itemType:l,weaponType:c.sword,iconImg:"".concat(m,"sword.png"),rarity:s.a.uncommon,damage:Object(i.a)({},d.kinetic,14)}),Object(i.a)(r,u.a.warhammer,{item:u.a.warhammer,itemType:l,weaponType:c.hammer,iconImg:"".concat(m,"warhammer.png"),rarity:s.a.rare,damage:Object(i.a)({},d.kinetic,16)}),Object(i.a)(r,u.a.woodenBulwark,{item:u.a.woodenBulwark,itemType:l,weaponType:c.shield,rarity:s.a.common,iconImg:"".concat(m,"wooden-bulwark.png")}),r);t.d=f},269:function(e,t,n){e.exports=n(497)},28:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o}));var a=function(){return"/world"},r=function(e){return"".concat(a(),"/").concat(e)},c=function(){return"/town"},o=function(e){return"".concat(c(),"/").concat(e)}},280:function(e,t,n){},29:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c})),function(e){e[e.common=0]="common",e[e.uncommon=1]="uncommon",e[e.rare=2]="rare",e[e.epic=3]="epic",e[e.legendary=4]="legendary"}(a||(a={}));var r=function e(t){switch(t){case a.common:return"item-icon-common";case a.uncommon:return"item-icon-uncommon";case a.rare:return"item-icon-rare";case a.epic:return"item-icon-epic";case a.legendary:return"item-icon-legendary"}return e(a.common)},c=function(e){switch(e.rarity){case a.common:return"item-name-common";case a.uncommon:return"item-name-uncommon";case a.rare:return"item-name-rare";case a.epic:return"item-name-epic";case a.legendary:return"item-name-legendary"}return r(a.common)}},30:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.resource=0]="resource",e[e.production=1]="production",e[e.tavern=2]="tavern",e[e.warehouse=3]="warehouse"}(a||(a={}))},31:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a,r,c=n(2);!function(e){e.wood="wood",e.iron="iron",e.stone="stone",e.leather="leather",e.fabric="fabric",e.food="food"}(r||(r={})),t.b=(a={},Object(c.a)(a,r.wood,{resource:r.wood,iconImg:"/img/resources/wood.png"}),Object(c.a)(a,r.iron,{resource:r.iron,iconImg:"/img/resources/iron.png"}),Object(c.a)(a,r.stone,{resource:r.stone,iconImg:"/img/resources/stone.png"}),Object(c.a)(a,r.leather,{resource:r.leather,iconImg:"/img/resources/leather.png"}),Object(c.a)(a,r.fabric,{resource:r.fabric,iconImg:"/img/resources/fabric.png"}),Object(c.a)(a,r.food,{resource:r.food,iconImg:"/img/resources/food.png"}),a)},310:function(e,t,n){},311:function(e,t,n){},312:function(e,t,n){},313:function(e,t,n){},314:function(e,t,n){},315:function(e,t,n){},316:function(e,t,n){},321:function(e,t){},323:function(e,t){},335:function(e,t){},337:function(e,t){},362:function(e,t){},364:function(e,t){},365:function(e,t){},371:function(e,t){},373:function(e,t){},39:function(e,t,n){"use strict";var a;function r(e,t,n){return{type:a.moveItemInInventory,adventurerId:e,fromSlot:t,toSlot:n}}function c(e,t,n){return{type:a.addItemToInventory,adventurerId:e,item:t,toSlot:n}}function o(e,t){return{type:a.removeItemFromInventory,adventurerId:e,fromSlot:t}}function i(e,t,n){return{type:a.assignEquipment,adventurerId:e,item:n,equipmentSlot:t}}function u(e,t){return{type:a.removeEquipment,adventurerId:e,equipmentSlot:t}}n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return u})),function(e){e.moveItemInInventory="moveItemInInventory",e.moveItemToOtherAdventurer="moveItemToOtherAdventurer",e.moveItemFromWarehouseToAdventurer="moveItemFromWarehouseToAdventurer",e.addItemToInventory="addItemToInventory",e.removeItemFromInventory="removeItemFromInventory",e.assignEquipment="assignEquipment",e.removeEquipment="removeEquipment"}(a||(a={}))},391:function(e,t){},393:function(e,t){},40:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.common=0]="common",e[e.town=1]="town",e[e.quest=2]="quest"}(a||(a={}))},405:function(e,t){},408:function(e,t){},41:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(35),r=n(20),c=n(22),o=n(38),i=n(37),u=n(123),s=n(21),l=function(e){Object(o.a)(n,e);var t=Object(i.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,null,[{key:"addToast",value:function(e,t,n,r){var c=this;this.stack=[].concat(Object(a.a)(this.stack),[{time:Date.now(),title:e,type:t,icon:n,link:r}]),this.emit(this.EVENT_TOASTS_UPDATED,this.stack),s.c.playSound(s.b.toast),setTimeout((function(){c.stack=c.stack.filter((function(e){return Date.now()-e.time<c.lifeTime})),c.emit(c.EVENT_TOASTS_UPDATED,c.stack)}),this.lifeTime)}}]),n}(Object(u.a)());l.stack=[],l.lifeTime=5e3,l.EVENT_TOASTS_UPDATED="toast"},413:function(e,t,n){},42:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a,r=n(0),c=n.n(r),o=n(6),i=n(27);!function(e){e[e.achievementUnlocked=0]="achievementUnlocked",e[e.cheat=1]="cheat",e[e.game=2]="game",e[e.itemCrafted=3]="itemCrafted",e[e.questCompleted=4]="questCompleted",e[e.questEncounter=5]="questEncounter",e[e.questLaunched=6]="questLaunched",e[e.questUpdate=7]="questUpdate"}(a||(a={}));t.b=function(e){var t=e.title,n=e.type,r=void 0===n?a.achievementUnlocked:n,u=e.icon,s=void 0===u?"/img/items/quest-items/dragon-eye.png":u,l=e.link,m=Object(i.g)(),d=o.a.getToastType(r);return c.a.createElement("div",{className:"toast ".concat(l&&"withlink"),onClick:function(){l&&m.push(l)}},c.a.createElement("div",{className:"label type"},d),c.a.createElement("div",{className:"label title app-h2-white"},t),c.a.createElement("div",{className:"icon"},c.a.createElement("div",{className:"background"}),c.a.createElement("img",{className:"image",width:"300",alt:"dragon eye",src:"".concat(".").concat(s)}),c.a.createElement("div",{className:"foreground"})),c.a.createElement("div",{className:"banner"}))}},43:function(e,t,n){"use strict";n.d(t,"b",(function(){return E}));var a,r,c,o=n(8),i=n(119),u=n(9),s=n(1),l=s.b.deed,m={deedForLumbermill:{item:s.a.deedForLumbermill,structure:u.a.lumberMill,itemType:l,iconImg:"/img/items/deeds/deed.png"},deedForWeaponsmith:{item:s.a.deedForWeaponsmith,structure:u.a.weaponsmith,itemType:l,iconImg:"/img/items/deeds/deed.png"}},d=n(2),p=s.b.material,f="/img/items/materials/",v=(a={},Object(d.a)(a,s.a.arrowheads,{item:s.a.arrowheads,itemType:p,iconImg:"".concat(f,"arrowheads.png")}),Object(d.a)(a,s.a.bolts,{item:s.a.bolts,itemType:p,iconImg:"".concat(f,"bolts.png")}),Object(d.a)(a,s.a.buckle,{item:s.a.buckle,itemType:p,iconImg:"".concat(f,"buckle.png")}),Object(d.a)(a,s.a.chain,{item:s.a.chain,itemType:p,iconImg:"".concat(f,"chain.png")}),Object(d.a)(a,s.a.cogs,{item:s.a.cogs,itemType:p,iconImg:"".concat(f,"cogs.png")}),Object(d.a)(a,s.a.gem,{item:s.a.gem,itemType:p,iconImg:"".concat(f,"gem.png")}),Object(d.a)(a,s.a.ingot,{item:s.a.ingot,itemType:p,iconImg:"".concat(f,"ingot.png")}),Object(d.a)(a,s.a.nails,{item:s.a.nails,itemType:p,iconImg:"".concat(f,"nails.png")}),Object(d.a)(a,s.a.poisonVial,{item:s.a.poisonVial,itemType:p,iconImg:"".concat(f,"poison-vial.png")}),Object(d.a)(a,s.a.ribbon,{item:s.a.ribbon,itemType:p,iconImg:"".concat(f,"ribbon.png")}),Object(d.a)(a,s.a.rope,{item:s.a.rope,itemType:p,iconImg:"".concat(f,"rope.png")}),Object(d.a)(a,s.a.gem,{item:s.a.gem,itemType:p,iconImg:"".concat(f,"gem.png")}),Object(d.a)(a,s.a.gunpowder,{item:s.a.gunpowder,itemType:p,iconImg:"".concat(f,"gunpowder.png")}),Object(d.a)(a,s.a.scales,{item:s.a.scales,itemType:p,iconImg:"".concat(f,"scales.png")}),Object(d.a)(a,s.a.spring,{item:s.a.spring,itemType:p,iconImg:"".concat(f,"spring.png")}),Object(d.a)(a,s.a.thread,{item:s.a.thread,itemType:p,iconImg:"".concat(f,"thread.png")}),a),h=s.b.questItem,g="/img/items/quest-items/",b=(r={},Object(d.a)(r,s.a.blueprints,{item:s.a.blueprints,itemType:h,iconImg:"".concat(g,"blueprints.png")}),Object(d.a)(r,s.a.crate,{item:s.a.crate,itemType:h,iconImg:"".concat(g,"crate.png")}),Object(d.a)(r,s.a.dynamite,{item:s.a.dynamite,itemType:h,iconImg:"".concat(g,"dynamite.png")}),Object(d.a)(r,s.a.dragonEye,{item:s.a.dragonEye,itemType:h,iconImg:"".concat(g,"dragon-eye.png")}),Object(d.a)(r,s.a.eye,{item:s.a.eye,itemType:h,iconImg:"".concat(g,"eye.png")}),Object(d.a)(r,s.a.feather,{item:s.a.feather,itemType:h,iconImg:"".concat(g,"feather.png")}),Object(d.a)(r,s.a.food,{item:s.a.food,itemType:h,iconImg:"".concat(g,"food.png")}),Object(d.a)(r,s.a.heart,{item:s.a.heart,itemType:h,iconImg:"".concat(g,"heart.png")}),Object(d.a)(r,s.a.horn,{item:s.a.horn,itemType:h,iconImg:"".concat(g,"horn.png")}),Object(d.a)(r,s.a.key,{item:s.a.key,itemType:h,iconImg:"".concat(g,"key.png")}),Object(d.a)(r,s.a.letters,{item:s.a.letters,itemType:h,iconImg:"".concat(g,"letters.png")}),Object(d.a)(r,s.a.lockPicks,{item:s.a.lockPicks,itemType:h,iconImg:"".concat(g,"lock-picks.png")}),Object(d.a)(r,s.a.oil,{item:s.a.oil,itemType:h,iconImg:"".concat(g,"oil.png")}),Object(d.a)(r,s.a.orcFinger,{item:s.a.orcFinger,itemType:h,iconImg:"".concat(g,"orc-finger.png")}),Object(d.a)(r,s.a.plans,{item:s.a.plans,itemType:h,iconImg:"".concat(g,"plans.png")}),Object(d.a)(r,s.a.purpleGems,{item:s.a.purpleGems,itemType:h,iconImg:"".concat(g,"purple-gems.png")}),Object(d.a)(r,s.a.runestone,{item:s.a.runestone,itemType:h,iconImg:"".concat(g,"runestone.png")}),Object(d.a)(r,s.a.sandwich,{item:s.a.sandwich,itemType:h,iconImg:"".concat(g,"sandwich.png")}),Object(d.a)(r,s.a.teeth,{item:s.a.teeth,itemType:h,iconImg:"".concat(g,"teeth.png")}),Object(d.a)(r,s.a.tooth,{item:s.a.tooth,itemType:h,iconImg:"".concat(g,"tooth.png")}),Object(d.a)(r,s.a.torch,{item:s.a.torch,itemType:h,iconImg:"".concat(g,"torch.png")}),Object(d.a)(r,s.a.tusk,{item:s.a.tusk,itemType:h,iconImg:"".concat(g,"tusk.png")}),Object(d.a)(r,s.a.vase,{item:s.a.vase,itemType:h,iconImg:"".concat(g,"vase.png")}),Object(d.a)(r,s.a.vial,{item:s.a.vial,itemType:h,iconImg:"".concat(g,"vial.png")}),Object(d.a)(r,s.a.weeds,{item:s.a.weeds,itemType:h,iconImg:"".concat(g,"weeds.png")}),r),y=s.b.trinket,O=(c={},Object(d.a)(c,s.a.magicAmulet,{item:s.a.magicAmulet,itemType:y,iconImg:"".concat("/img/items/trinkets/","magic_amulet.png")}),Object(d.a)(c,s.a.ring,{item:s.a.ring,itemType:y,iconImg:"".concat("/img/items/trinkets/","ring.png")}),c),j=n(26),w=Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)(Object(o.a)({},m),i.a),v),b),O),j.d);t.a=w;function E(e){return w[e]}},436:function(e,t){},442:function(e,t,n){},443:function(e,t,n){},444:function(e,t,n){},445:function(e,t,n){},446:function(e,t,n){},447:function(e,t,n){},448:function(e,t,n){},449:function(e,t,n){},450:function(e,t,n){},456:function(e,t,n){},457:function(e,t,n){},458:function(e,t,n){},459:function(e,t,n){},46:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return o}));var a,r=n(40);function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.a.common,c=arguments.length>3?arguments[3]:void 0,o={key:e,context:t};return{type:a.addLogEntry,entry:o,channel:n,channelContext:c}}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.a.common,n=arguments.length>2?arguments[2]:void 0;return{type:a.addLogEntry,entry:e,channel:t,channelContext:n}}!function(e){e.addLogEntry="addLogEntry"}(a||(a={}))},460:function(e,t,n){},461:function(e,t,n){},462:function(e,t,n){},463:function(e,t,n){},464:function(e,t,n){},465:function(e,t,n){},466:function(e,t,n){},467:function(e,t,n){},468:function(e,t,n){},469:function(e,t,n){},470:function(e,t,n){},471:function(e,t,n){},472:function(e,t,n){},473:function(e,t,n){},474:function(e,t,n){},475:function(e,t,n){},476:function(e,t,n){},477:function(e,t,n){},478:function(e,t,n){},479:function(e,t,n){},480:function(e,t,n){},481:function(e,t,n){},482:function(e,t,n){},483:function(e,t,n){},484:function(e,t,n){},485:function(e,t,n){},486:function(e,t,n){},487:function(e,t,n){},495:function(e,t){},496:function(e,t,n){},497:function(e,t,n){"use strict";n.r(t),n.d(t,"runGame",(function(){return oc})),n.d(t,"restartGame",(function(){return cc})),n.d(t,"loadGame",(function(){return rc}));var a,r,c,o=n(35),i=n(32),u=n.n(i),s=n(45);!function(e){e.clearCombatAction="clearCombatAction",e.startCombatAction="startCombatAction",e.moveActor="moveActor"}(a||(a={})),function(e){e[e.player=0]="player",e[e.enemy=1]="enemy"}(r||(r={})),function(e){e.move="move",e.slash="slash",e.shoot="shoot"}(c||(c={}));var l,m={actors:[{allegiance:r.player,health:100,location:[3,5],name:"c4a5d270",remainingAP:5},{allegiance:r.player,health:100,location:[4,6],name:"2e655832",remainingAP:4}],turn:r.player},d=function(e,t){var n=t.getState().combat;if(n.action&&n.action.endsAt<Date.now())if(n.turn===r.enemy);else if(n.turn===r.player){switch(n.action.type){case c.move:t.dispatch(function(e,t){return{type:a.moveActor,actor:e,location:t}}(n.action.actor,n.action.target)),t.dispatch({type:a.clearCombatAction})}return{action:null}}return null},p=n(0),f=n.n(p),v=n(116),h=n(12);!function(e){e.gameTick="gameTick"}(l||(l={}));var g,b=n(46),y=function(e){var t=e.split(".").map((function(e){return Number(e)}));if(3!==t.length)throw new Error("Received invalid version string: ".concat(e));t.forEach((function(e){if(e>=1024)throw new Error("Version string invalid, ".concat(e," is too large"))}));for(var n=0,a=0;a<3;a++)n|=t[a]<<10*a;return n}("0.0.5"),O=n(2),j=n(16),w=n(502),E=n(263),k=n(59),N=n(27),T=n(501),I=n(52),S=n(21),x=n(6),C=n(252),q=n.n(C),A=n(253),D=function(e){var t=e.itemsLoaded,n=e.itemsTotal;return p.createElement("div",null," ","Loading (".concat(Math.floor((t||0)/(n||0)*100),")%")," ")};!function(e){e[e.image=0]="image",e[e.sound=1]="sound"}(g||(g={}));var R,P=[],M=function(e){var t=new Image;return t.src=e,new Promise((function(e,n){function a(){t.naturalWidth?e(t):n(null),t.removeEventListener("load",a),t.removeEventListener("error",a)}t.naturalWidth?e(t):t.complete?n(null):(t.addEventListener("load",a),t.addEventListener("error",a))}))},H=function(e){if((e=e.toLowerCase()).endsWith("png")||e.endsWith("jpg")||e.endsWith("gif"))return g.image;if(e.endsWith("mp3")||e.endsWith("ogg")||e.endsWith("wav"))return g.sound;throw Error("Could not determine type for ".concat(e))},L=function(e){var t=Object(p.useState)(!1),n=Object(j.a)(t,2),a=n[0],r=n[1],c=Object(p.useState)(0),o=Object(j.a)(c,2),i=o[0],l=o[1];Object(p.useEffect)((function(){f()}),[]);var m=e.children,d=e.manifest,f=function(){l(0);var t=e.manifest.map((function(e){return v(e).catch((function(e){return console.error(e)}))}));Promise.all(t).then((function(t){e.onLoadComplete&&e.onLoadComplete(P),r(!0)}))},v=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,a,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P.some((function(e){return e.url===t}))&&console.warn("Loading media with url ".concat(t," more than once! Will overwrite.")),(n=H(t))!==g.image){e.next=7;break}return e.next=5,M(t);case 5:r=e.sent,a={content:r,mediaType:n,url:t};case 7:if(n===g.sound&&(c=new A.Howl({src:["".concat(".","/").concat(t)]}),a={content:c,mediaType:n,url:t}),!a){e.next=14;break}return P.push(a),l(i+1),e.abrupt("return",a);case 14:throw new Error("Unknown error while trying to load ".concat(t));case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return a?p.createElement(p.Fragment,null," ",m," "):p.createElement(D,{itemsLoaded:i,itemsTotal:d.length})},W=n(9),V=n(117),F=n(28);!function(e){e[e.NotBuilt=0]="NotBuilt",e[e.Building=1]="Building",e[e.Built=2]="Built"}(R||(R={}));var Q,_,B={level:0,state:R.NotBuilt,workers:0},G=n(20),U=n(22),z=n(10),X=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"0";Object(G.a)(this,e),this.shapes=void 0,this.shapes=t[n].map((function(e){var t=e.shape;return new z.Polygon(t)}))}return Object(U.a)(e,[{key:"contains",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!(!this.shapes||0===this.shapes.length)&&this.shapes.some((function(n){return n.contains(e,t)}))}}]),e}(),Y=n(255),Z=n(17),J=n(69),K=function(e){var t=e.hitAreaShapes,n=W.a.lumberMill,a="".concat(".","/img/town/town-alpha/").concat(n,".json"),r=Object(p.useState)(),c=Object(j.a)(r,2),o=c[0],i=c[1],u=e.selected?[ye]:[],s=Object(Z.useApp)();Object(p.useEffect)((function(){Object(J.b)(a,(function(e){i(e.textures)}))}),[s,s.loader,a]);var l=Object(p.useState)(0),m=Object(j.a)(l,2),d=m[0],v=m[1];return Object(Z.useTick)((function(e){return v((function(t){return t+.01*e}))})),o?f.a.createElement(Z.Sprite,{name:n,position:e.position,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(n)},hitArea:t,filters:u,texture:o["structure.png"]},f.a.createElement(Z.Sprite,{name:"blades",texture:o["blades.png"],anchor:new z.Point(.5,.5),x:15,y:10,rotation:d})):null},$=n(256),ee=n(80),te=n(257),ne=Object(Z.PixiComponent)("ParticleEmitter",{create:function(){return new z.ParticleContainer},applyProps:function(e,t,n){var a=n.image,r=n.config,c=Object(ee.a)(n,["image","config"]);Object(Z.applyDefaultProps)(e,t,c);var o=this._emitter;if(!o){o=new te.a(e,[z.Texture.from(a)],r);var i=performance.now();o.emit=!0,function e(){o.raf=requestAnimationFrame(e);var t=performance.now();o.update(3e-4*(t-i)),i=t}()}this._emitter=o},willUnmount:function(){this._emitter&&(this._emitter.emit=!1,cancelAnimationFrame(this._emitter.raf))}}),ae=function(e){var t=e.hitAreaShapes,n=e.position,a=W.a.tavern,r=e.selected?[ye]:[];return f.a.createElement(Z.Container,{position:n},f.a.createElement(Z.Sprite,{name:a,interactive:!0,buttonMode:!0,pointertap:function(){e.onStructureClick(a)},filters:r,hitArea:t,image:"".concat(".","/img/town/town-alpha/").concat(a,".png")}),f.a.createElement(ne,{name:"smoke",x:107,y:-2,image:"".concat(".","/img/town/effects/smokeparticle.png"),config:$}))},re=n(38),ce=n(37),oe=function(e){return function(t){Object(re.a)(a,t);var n=Object(ce.a)(a);function a(){return Object(G.a)(this,a),n.apply(this,arguments)}return Object(U.a)(a,[{key:"render",value:function(){var t=this;return p.createElement(ar.Consumer,null,(function(n){return p.createElement(e,Object.assign({},t.props,n))}))}}]),a}(p.Component)},ie=function(e){var t=e.structure,n=e.position,a=e.hitAreaShapes,r=e.selected,c=e.onStructureClick,o=r?[ye]:[];return f.a.createElement(Z.Sprite,{name:t,position:n,interactive:!0,buttonMode:!0,pointertap:function(){c(t)},hitArea:a,filters:o,image:"".concat(".","/img/town/town-alpha/").concat(t,".png")})},ue=(n(310),function(e){var t=e.structures,n=[W.a.workshop,W.a.quarry,W.a.tavern,W.a.tannery,W.a.alchemist,W.a.garden,W.a.weaponsmith,W.a.armoursmith,W.a.warehouse,W.a.mine,W.a.lumberMill,W.a.weaver],a=Object(N.h)("".concat(Object(F.c)(),"/:structure"));return f.a.createElement("div",{className:"legenda"},f.a.createElement("ul",null,n.map((function(e){return t[e].state===R.NotBuilt?null:f.a.createElement("li",{key:e},function(e){return(null===a||void 0===a?void 0:a.params.structure)===e.toString()?f.a.createElement("span",{className:"highlighted"},"".concat(x.a.getStructureName(e))):f.a.createElement(k.b,{to:Object(F.b)(e)},"".concat(x.a.getStructureName(e)))}(e))}))))}),se=(n(311),n(126)),le=n(258),me=n(259),de=n.n(me),pe=Object(p.forwardRef)((function(e,t){var n=Object(Z.useApp)();if(n){var a="url('".concat(de.a,"'), auto");n.renderer.plugins.interaction.cursorStyles.pointer=a}return f.a.createElement(fe,Object.assign({app:n},e,{ref:t}))})),fe=Object(Z.PixiComponent)("Viewport",{create:function(e){var t=new le.a({screenWidth:e.screenWidth,screenHeight:e.screenHeight,worldWidth:e.worldWidth,worldHeight:e.worldHeight,ticker:e.app.ticker,interaction:e.app.renderer.plugins.interaction});t.on("clicked",(function(t){e.onClick&&e.onClick(t)}));var n=e.minScale,a=void 0===n?1:n,r=e.maxScale,c=void 0===r?2:r;return t.drag().pinch().wheel().clamp({direction:"all"}).clampZoom({minScale:a,maxScale:c}).decelerate(),t}}),ve=pe,he=Object(p.forwardRef)((function(e,t){var n=e.children,a=e.screenWidth,r=e.screenHeight,c=e.worldWidth,o=e.worldHeight,i=Object(p.useRef)(null);return Object(p.useImperativeHandle)(t,(function(){return i.current})),Object(p.useEffect)((function(){if(be.enabled=!1,i.current){var e=i.current;e.on("moved",(function(){var t=I.b.utils.normalize(e.screenWidth,c,e.right),n=I.b.utils.normalize(o,e.screenHeight,e.bottom),a=Math.max(t*n-.4,0);be.gain=a,be.lacunarity=2.4,be.enabled=be.gain>0}))}var t=function(e){e.preventDefault()};return window.addEventListener("wheel",t,{passive:!1}),function(){window.removeEventListener("wheel",t)}}),[o,c]),f.a.createElement(Z.Stage,{width:a,height:r,options:ge},f.a.createElement(ve,{screenWidth:a,screenHeight:r,worldWidth:c,worldHeight:o,ref:i},f.a.createElement(Z.Sprite,{name:"background",image:"".concat(".","/img/town/town-alpha/background.png"),filters:[be]},n)))})),ge={autoDensity:!0,sharedLoader:!0},be=new se.a,ye=new V.a(8,16763904),Oe=oe((function(e){var t=Object(N.h)("".concat(Object(F.c)(),"/:structure")),n=null===t||void 0===t?void 0:t.params.structure,a=Object(p.useRef)(null),r=Object(p.useRef)(null),c=Object(p.useRef)(!1);Object(p.useEffect)((function(){S.c.addMusicTrack(S.a.town,"sound/music/Soliloquy.mp3"),S.c.playMusicTrack(S.a.town)}),[]),Object(p.useEffect)((function(){var e=I.b.to(ye,{duration:.6,thickness:2,yoyo:!0,repeat:-1});return function(){e.pause(0),e.kill()}}),[]),Object(p.useEffect)((function(){if(r.current){var e=r.current;e.on("drag-start",(function(e){c.current=!0,e.event.stopPropagation()})),e.on("drag-end",(function(){c.current=!1}))}}),[]);var o=function(t){c.current||e.onStructureClick(t)},i=Object(h.e)((function(e){return e.structures}));Object(p.useEffect)((function(){if(n&&r.current){var e=r.current;e.zoomPercent(0);var t=we(W.a[n]);e.moveCenter(t)}}),[n]);var u=Object(p.useState)(nr),s=Object(j.a)(u,2),l=s[0],m=s[1],d=Object(p.useState)(1079),v=Object(j.a)(d,2),g=v[0],b=v[1];return Object(p.useEffect)((function(){var e=function(){var e,t,n=(null===(e=a.current)||void 0===e?void 0:e.clientWidth)||nr,r=(null===(t=a.current)||void 0===t?void 0:t.clientHeight)||1079;m(n),b(r)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]),f.a.createElement("div",{className:"town-view",ref:a},f.a.createElement(ue,{structures:i}),f.a.createElement(he,{screenWidth:l,screenHeight:g,worldWidth:1024,worldHeight:1600,ref:r},[W.a.workshop,W.a.quarry,W.a.tavern,W.a.tannery,W.a.alchemist,W.a.garden,W.a.weaponsmith,W.a.armoursmith,W.a.warehouse,W.a.mine,W.a.lumberMill,W.a.weaver].reverse().map((function(e){if(i[e].state===R.NotBuilt)return null;var t=je(e),a=we(e),r=new X(Y,e);return f.a.createElement(t,{position:a,structure:e,hitAreaShapes:r,onStructureClick:o,key:e,selected:n===e})}))))})),je=function(e){switch(e){case W.a.workshop:case W.a.quarry:case W.a.tannery:case W.a.alchemist:case W.a.garden:case W.a.weaponsmith:case W.a.armoursmith:case W.a.warehouse:case W.a.mine:case W.a.weaver:return ie;case W.a.lumberMill:return K;case W.a.tavern:return ae}},we=function(e){var t,n;switch(e){case W.a.workshop:t=373,n=610;break;case W.a.quarry:t=632,n=633;break;case W.a.tannery:t=372,n=460;break;case W.a.tavern:t=500,n=469;break;case W.a.alchemist:t=411,n=371;break;case W.a.garden:t=822,n=689;break;case W.a.weaponsmith:t=449,n=460;break;case W.a.armoursmith:t=473,n=442;break;case W.a.warehouse:t=471,n=130;break;case W.a.lumberMill:t=403,n=320;break;case W.a.mine:t=183,n=527;break;case W.a.weaver:t=484,n=333}return new PIXI.Point(t,n)},Ee=n(41),ke=n(42),Ne=(n(312),function(){var e=Object(p.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],r=function(e){a(e)};return Object(p.useEffect)((function(){return Ee.a.addEventListener(Ee.a.EVENT_TOASTS_UPDATED,r),function(){Ee.a.removeEventListener(Ee.a.EVENT_TOASTS_UPDATED,r)}}),[]),f.a.createElement("div",{className:"toasts"},n.map((function(e){return f.a.createElement(ke.b,Object.assign({key:e.time},e))})))});n(85),n(131),n(313);!function(e){e[e.auto=0]="auto",e[e.large=1]="large",e[e.medium=2]="medium",e[e.small=3]="small"}(Q||(Q={})),function(e){e.blue="blue",e.purple="purple",e.green="green"}(_||(_={}));var Te,Ie,Se=function(e){var t,n=e.color,a=(e.size,e.square),r=e.text,c=Object(ee.a)(e,["color","size","square","text"]),o="button\n        ".concat(e.className||"","\n        button-").concat("string"===typeof n?n:_[null!==n&&void 0!==n?n:_.blue],"\n        button-").concat("string"===typeof e.size?e.size:Q[null!==(t=e.size)&&void 0!==t?t:Q.auto],"\n        ").concat(a?"button-square":"","\n    ");return p.createElement("button",Object.assign({},c,{className:o,onClick:function(t){var n;null===(n=e.onClick)||void 0===n||n.call(e,t)}}),p.createElement("span",null,!!r&&r,!r&&e.children))},xe=function(e){return p.createElement("div",{className:"window"},p.createElement("div",{className:"header"},!1!==e.backEnabled&&p.createElement(Se,{className:"back-button",onClick:function(t){e.onBack&&(null===e||void 0===e||e.onBack(),S.c.playSound(S.b.buttonClick))},square:!0,size:"medium",color:"purple",text:"<"}),p.createElement("h3",null,e.title),!1!==e.closeEnabled&&p.createElement(Se,{className:"close-button",onClick:function(t){e.onClose&&(null===e||void 0===e||e.onClose(),S.c.playSound(S.b.buttonClick))},square:!0,size:"medium",color:"purple",text:"x"})),e.children)},Ce=(n(314),function(e){return function(t){Object(re.a)(a,t);var n=Object(ce.a)(a);function a(){return Object(G.a)(this,a),n.apply(this,arguments)}return Object(U.a)(a,[{key:"render",value:function(){return p.createElement(xe,this.props,p.createElement(e,this.props))}}]),a}(p.Component)}),qe=n(49),Ae=(n(315),Object(qe.c)(Ce)((function(){var e=Object(p.useRef)(null),t=Object(p.useRef)(null);return p.createElement("div",{className:"settings-window"},p.createElement("details",{open:!0,className:"sound"},p.createElement("summary",null,"Sound"),p.createElement("section",null,p.createElement("p",null,p.createElement("label",null,"Sound"),p.createElement("button",{onClick:function(){I.a.to(e.current,{duration:.5,value:0,onComplete:function(){S.c.soundVolume=0}})}},p.createElement("span",{role:"img","aria-label":"Mute"},"\ud83d\udd07")),p.createElement("input",{type:"range",min:"0",max:"1",step:"0.05",ref:e,onChange:function(e){var t=parseFloat(e.target.value),n=Math.pow(t,2);S.c.soundVolume=n},defaultValue:"".concat(Math.sqrt(S.c.soundVolume))})),p.createElement("p",null,p.createElement("label",null,"Music"),p.createElement("button",{onClick:function(){I.a.to(t.current,{duration:.5,value:0,onComplete:function(){S.c.musicVolume=0}})}},p.createElement("span",{role:"img","aria-label":"Mute"},"\ud83d\udd07")),p.createElement("input",{type:"range",min:"0",max:"1",step:"0.05",ref:t,onChange:function(e){var t=parseFloat(e.target.value),n=Math.pow(t,2);S.c.musicVolume=n},defaultValue:"".concat(Math.sqrt(S.c.musicVolume))})))))}))),De=n(8),Re=n(43),Pe=n(1),Me=n(40),He=n(31),Le=[He.a.food,He.a.wood,He.a.iron,He.a.stone,He.a.fabric,He.a.leather];function We(e){return{type:Te.addResources,resources:e}}function Ve(e){return{type:Ie.finishBuildingStructure,structure:e}}function Fe(e){return{type:Ie.upgradeStructure,structure:e}}function Qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:Ie.increaseWorkers,structure:e,workers:t}}function _e(e,t){return{type:Ie.addItemToToProduces,structure:e,item:t}}!function(e){e.addResources="addResources",e.removeResources="removeResources"}(Te||(Te={})),function(e){e.upgradeStructure="upgradeStructure",e.increaseWorkers="increaseWorkers",e.decreaseWorkers="decreaseWorkers",e.startBuildingStructure="startBuildingStructure",e.finishBuildingStructure="finishBuildingStructure",e.setStructureState="setStructureState",e.addItemToToProduces="addItemToToProduces"}(Ie||(Ie={}));var Be,Ge,Ue=n(54);function ze(e,t){return{type:Be.addItem,item:e,toSlot:t}}function Xe(e){return{type:Be.removeItem,fromSlot:e}}!function(e){e.addItem="addItem",e.moveItemInWarehouse="moveItemInWarehouse",e.removeItem="removeItem"}(Be||(Be={})),function(e){e.addWorkers="addWorkers"}(Ge||(Ge={}));n(316);var Ye,Ze=Ce((function(e){var t=Object(p.useRef)(null),n=Object(p.useState)({gold:50,resources:50,workers:10}),a=Object(j.a)(n,2),r=a[0],c=a[1],o=Object(h.d)(),i=function(e,t){o(function(e,t){return{type:Ie.setStructureState,structure:e,state:t}}(e,t))},u=function(e){var t;o((t=e,{type:Ge.addWorkers,value:t})),o(Object(b.c)("common-cheat-workers-added",{amount:e},Me.a.common))},s=Object(h.e)((function(e){return e.structures})),l=function(e){return p.createElement("option",{value:e,key:e},x.a.getItemName(e))},m=Object.keys(Pe.b).filter((function(e){return!isNaN(e)})).map((function(e){return p.createElement("optgroup",{label:Pe.b[e],key:e},function(e){return Object.keys(Pe.a).filter((function(t){return Object(Re.b)(t).itemType==e})).map((function(e){return l(e)}))}(e))})),d=function(e,t){i(e,t?R.Built:R.NotBuilt),t?Ee.a.addToast("The ".concat(x.a.getStructureName(e)," is constructed"),ke.a.cheat):Ee.a.addToast("The ".concat(x.a.getStructureName(e)," is not constructed"),ke.a.cheat)};return p.createElement("div",{className:"cheat-window"},p.createElement("div",{className:"label-numberbox-button"},p.createElement("label",null,"Gold"),p.createElement("input",{type:"number",value:r.gold,style:{width:"50px"},onChange:function(e){var t=Number(e.target.value);c(Object(De.a)(Object(De.a)({},r),{},{gold:t}))}}),p.createElement("button",{onClick:function(e){var t=r.gold;!function(e){o(Object(Ue.b)(e)),o(Object(b.c)("common-cheat-gold-added",{amount:e},Me.a.common))}(t);var n=x.a.get("common-cheat-gold-added",{amount:t});Ee.a.addToast(n,ke.a.cheat,"/img/resources/gold.png")}},"Add")),p.createElement("div",{className:"label-numberbox-button"},p.createElement("label",null,"Workers"),p.createElement("input",{type:"number",value:r.workers,style:{width:"50px"},onChange:function(e){var t=Number(e.target.value);c(Object(De.a)(Object(De.a)({},r),{},{workers:t}))}}),p.createElement("button",{onClick:function(e){var t=r.workers;u(t);var n=x.a.get("common-cheat-workers-added",{amount:t});Ee.a.addToast(n,ke.a.cheat,"/img/resources/worker.png")}},"Add")),p.createElement("div",{className:"label-numberbox-button"},p.createElement("label",null,"Resources"),p.createElement("input",{type:"number",value:r.resources,style:{width:"50px"},onChange:function(e){var t=Number(e.target.value);c(Object(De.a)(Object(De.a)({},r),{},{resources:t}))}}),p.createElement("button",{onClick:function(e){!function(e){var t=Le.reduce((function(t,n){return t[n]=e,t}),{});o(We(t)),o(Object(b.c)("common-cheat-resources-added",{amount:e},Me.a.common))}(r.resources);var t=x.a.get("common-cheat-resources-added",{amount:r.resources});Ee.a.addToast(t,ke.a.cheat)}},"Add")),p.createElement("div",{className:"label-numberbox-button"},p.createElement("label",null,"Items"),p.createElement("select",{style:{width:"150px"},ref:t},m),p.createElement("button",{onClick:function(e){var n=t.current.value;!function(e){o(ze(e)),o(Object(b.c)("common-cheat-item-added",{item:e},Me.a.common))}(n);var a=x.a.get("common-cheat-item-added",{item:n}),r=Object(Re.b)(n).iconImg;Ee.a.addToast(a,ke.a.cheat,r)}},"Add")),Object.keys(s).map((function(e){return function(e){var t=Object(W.b)(e),n=s[e],a=t.levels[n.level],r=x.a.get(a.displayName);return p.createElement("div",{className:"label-dropdown",key:e},p.createElement("label",{title:e},"".concat(r)),p.createElement("input",{key:e,type:"checkbox",checked:n.state===R.Built,onChange:function(){return d(e,n.state!==R.Built)}}))}(e)})))})),Je=n(162),Ke=(n(413),Object(qe.c)(Ce,oe)((function(e){var t=Object(h.e)((function(e){return e})),n=Object(p.useState)(),a=Object(j.a)(n,2),r=a[0],c=a[1],o=function(){var t=Object(s.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return");case 2:return c(void 0),t.next=5,rc(r);case 5:Ee.a.addToast(x.a.get("ui-game-loaded"),ke.a.game,"/img/items/misc/magic-eye.png"),e.onCloseWindow();case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return p.createElement("div",{className:"menu"},p.createElement("p",null,p.createElement(Se,{onClick:function(){var t=p.createElement(Ze,{title:"Cheats"});e.onOpenWindow(t)}},"Cheats!")),p.createElement("p",null,p.createElement(Se,{onClick:function(){var t=p.createElement(Ae,{title:"Settings"});e.onOpenWindow(t)}},"Settings")),p.createElement("fieldset",null,p.createElement("legend",null,"Save and load"),p.createElement("section",null,"Save game to disk:\xa0",p.createElement(Se,{onClick:function(){var e=Object(Je.createEncryptor)("P5mw}jD>5c6Y]yqy"),n=document.createElement("a"),a=JSON.stringify(t),r=e.encrypt(a);n.setAttribute("href","data:text/json;cccharset=utf-8,"+encodeURIComponent(r)),n.setAttribute("download","Gidletown save.json"),n.click()}},"Save")),p.createElement("section",null,"Load game from disk:\xa0",p.createElement("input",{type:"file",onChange:function(e){var t=Object(Je.createEncryptor)("P5mw}jD>5c6Y]yqy"),n=new FileReader;n.onload=function(){var e=n.result,a=t.decrypt(e),r=JSON.parse(a);c(r)},n.readAsText(e.target.files[0])}}),p.createElement(Se,{onClick:o,disabled:!r},"Load"))))}))),$e=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=["","k","M","G","T","P","E"],a=Math.log10(e)/3|0;if(0===a)return e.toFixed(t);var r=n[a],c=Math.pow(10,3*a),o=e/c;return o.toFixed(t)+r},et=n(260),tt=n.n(et),nt=n(123),at=function(e){Object(re.a)(n,e);var t=Object(ce.a)(n);function n(){return Object(G.a)(this,n),t.apply(this,arguments)}return Object(U.a)(n,null,[{key:"showContextTooltip",value:function(e,t,n){var a={type:e,info:t,referenceRect:n};tt()(a,this.lastContext)?this.clear():(this.emit(this.EVENT_CONTEXT_UPDATED,a),this.lastContext=a)}},{key:"clear",value:function(){this.emit(this.EVENT_CONTEXT_UPDATED,void 0),this.lastContext=void 0}}]),n}(Object(nt.a)());at.EVENT_CONTEXT_UPDATED="tooltipContextUpdated",at.lastContext=void 0,function(e){e[e.item=0]="item",e[e.trait=1]="trait",e[e.resource=2]="resource",e[e.skill=3]="skill"}(Ye||(Ye={}));var rt,ct=function(){return Object(h.e)((function(e){return e.gold}))},ot=function(){return Object(h.e)((function(e){return e.resources}))},it=n(70),ut=Object(it.a)([function(e){return e.structures},function(e){return e.workers}],(function(e,t){return t-Object.keys(e).map((function(t){return e[t]})).reduce((function(e,t){return e+t.workers}),0)})),st=function(){return Object(h.e)(ut)};n(442);!function(e){e[e.smallest=0]="smallest",e[e.small=1]="small",e[e.medium=2]="medium",e[e.big=3]="big",e[e.biggest=4]="biggest"}(rt||(rt={}));var lt=function e(t){switch(t){case rt.smallest:return"common-icon-smallest";case rt.small:return"common-icon-small";case rt.medium:return"common-icon-medium";case rt.big:return"common-icon-big";case rt.biggest:return"common-icon-biggest"}return e(rt.medium)},mt=function(){var e=ct(),t=ot(),n=st(),a=function(e,t,n){return p.createElement("li",{key:n,onClick:function(e){var t=e.currentTarget.getBoundingClientRect();at.showContextTooltip(Ye.resource,n,t),e.stopPropagation()}},p.createElement("div",{className:"icon ".concat(lt(rt.smallest)),style:{backgroundImage:"url(".concat(".").concat(e,")")}}),p.createElement("div",{className:"amount"},$e(t,0)))},r=Le.map((function(e){var n=He.b[e];return a(n.iconImg,t[e],e)}));return r.push(a("/img/resources/worker.png",n,"workers"),a("/img/resources/gold.png",e,"gold")),p.createElement("ul",{className:"resourcebar"},r)},dt=(n(443),function(e){var t=Object(p.useContext)(ar);return p.createElement("div",{className:"topbar"},p.createElement("div",{className:"topbar-left"},p.createElement(mt,null)),p.createElement("div",{className:"topbar-right"},p.createElement("div",{className:"hamburger",onClick:function(n){var a=p.createElement(Ke,{title:"Menu",persistor:e.persistor});t.onOpenWindow(a)}},"\u2630")))}),pt=n(18);window.PIXI=z;var ft,vt=function(e){var t=e.quest,n=e.leader,a=e.encounterActive,r=e.position,c=e.onClick,o=e.selected?"/img/world/map-marker-selected.png":"/img/world/map-marker.png",i=Object(p.useRef)(null);return Object(p.useEffect)((function(){var e=i.current,t=new z.Graphics;t.beginFill(12245589),t.drawCircle(0,0,256),t.endFill(),e.mask=t,e.addChild(t)}),[i]),f.a.createElement(Z.Sprite,{image:"".concat(".").concat(o),name:t.name,x:r.x,y:r.y,interactive:!0,buttonMode:!0,scale:new z.Point(.1,.1),anchor:new z.Point(.5,1),pointerdown:function(){c&&c(t)}},n&&f.a.createElement(Z.Sprite,{image:"".concat(".","/").concat(n.avatarImg),name:"avatar",anchor:new z.Point(.5,.5),x:0,y:-396,scale:new z.Point(.66,.66),ref:i}),a&&f.a.createElement(Z.Sprite,{image:"".concat(".","/img/world/quest-alert.png"),name:"quest-alert",anchor:new z.Point(.5,1),x:180,y:-396,scale:new z.Point(2,2)}))},ht=n(58),gt=function(e){var t=e.positions;return e.positions.length>2?f.a.createElement(Z.Graphics,{name:"questline",x:0,y:0,draw:function(e){e.lineStyle(3,16724736),e.moveTo(t[0].x,t[0].y);var n=0;for(n=1;n<t.length-2;n++){var a=(t[n].x+t[n+1].x)/2,r=(t[n].y+t[n+1].y)/2;e.quadraticCurveTo(t[n].x,t[n].y,a,r)}e.quadraticCurveTo(t[n].x,t[n].y,t[n+1].x,t[n+1].y),e.endFill()}}):null};!function(e){e[e.unavailable=0]="unavailable",e[e.available=1]="available",e[e.active=2]="active",e[e.completed=3]="completed"}(ft||(ft={}));var bt=Object(it.a)([function(e){return e.quests}],(function(e){return e.filter((function(e){return e.status===ft.active})).map((function(e){return e}))})),yt=n(56);n(444);window.PIXI=z;var Ot=function(e){var t=e.retrieveWorldViewRef,n=e.smallMap,a=Object(p.useCallback)((function(t){return t.quests.find((function(t){return t.name===e.selectedQuestName}))}),[e.selectedQuestName]),r=Object(h.e)(a),c=Object(h.e)((function(e){return e.adventurers})),o=Object(h.e)((function(e){return bt(e)})),i=function(t){e.onPartyClick(t)},u=Object(p.useState)(nr),s=Object(j.a)(u,2),l=s[0],m=s[1],d=Object(p.useState)(1024),v=Object(j.a)(d,2),g=v[0],b=v[1];Object(p.useEffect)((function(){var e=function(){var e,a,r=t(),c=(null===(e=r.current)||void 0===e?void 0:e.clientWidth)||nr,o=(null===(a=r.current)||void 0===a?void 0:a.clientHeight)||1024;m(c),b(n?c<576?32:64:o)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[t,n]),Object(p.useEffect)((function(){r&&O(r)}),[r,g]);var y=Object(p.useRef)(null);Object(p.useEffect)((function(){if(y.current){var e=y.current,t=wt({x:0,y:0});e.moveCenter(t.x/2,t.y/2+10)}}),[l]);var O=function(e){var t=y.current;if(t){var n=jt(e),a=wt(n);t.moveCenter(a.x,a.y)}},w={autoDensity:!0,sharedLoader:!0,width:l,height:g};return f.a.createElement("div",{className:"world-map"},f.a.createElement(Z.Stage,{width:l,height:g,options:w},f.a.createElement(ve,{screenWidth:l,screenHeight:g,worldWidth:1500,worldHeight:1061,ref:y},f.a.createElement(Z.Sprite,{image:"".concat(".","/img/world/francesca-baerald-fbaerald-angeloumap-lowres.jpg"),interactive:!0,pointerdown:function(){}},o.map((function(e){var t=Et(e);return f.a.createElement(gt,{positions:t,key:e.name})})),o.map((function(e){var t=jt(e),n=wt(t),a=Object(ht.c)(c,e),o=Object(yt.b)(e.name),u=Math.floor(e.progress),s=o.nodes[u];return f.a.createElement(vt,{quest:e,leader:a,position:n,key:e.name,selected:e===r,encounterActive:s.type===pt.a.encounter,onClick:function(e){return i(e.name)}})}))))),e.selectedQuestName&&f.a.createElement("div",{className:"title"},f.a.createElement("span",null,x.a.getQuestTitle(e.selectedQuestName)),f.a.createElement("span",{onClick:function(){return i(e.selectedQuestName)}},"x")))},jt=function(e){var t=Object(yt.b)(e.name),n=Math.floor(e.progress),a=t.nodes[n],r=t.nodes[n+1];return r?Object(J.a)(a,r,e.progress-n):a},wt=function(e){var t=10*e.x+750,n=10*e.y+530.5;return new z.Point(t,n)},Et=function(e){for(var t=[],n=Object(yt.b)(e.name),a=0;a<e.progress;a++)t.push(wt(n.nodes[a]));var r=wt(jt(e));return t.push(r),t},kt=(n(244),function(e){var t=e.activeTab,n=void 0===t?null:t;!n&&e.children&&e.children.length&&(n=e.children[0].props.id);var a="".concat(e.className," ").concat(e.disabled?"disabled":""),r=f.a.Children.map(e.children,(function(e){return f.a.cloneElement(e,{active:e.props.id===n,onClick:function(){c(e.props.id)}})})),c=function(t){e.onTabSelected&&!0!==e.disabled&&e.onTabSelected(t)};return f.a.createElement("ul",{className:"tabstrip ".concat(a),onClick:function(t){S.c.playSound(S.b.buttonClick),e.onClick&&e.onClick(t)}},r)}),Nt=function(e){var t=(e.active?"active":"")+(e.className||"");return p.createElement("li",{className:"tabstrip-tab ".concat(t),onClick:function(t){e.onClick&&e.onClick(t)}},e.children)},Tt=(n(445),function(e){var t=e.adventurer,n=e.size,a=(e.className||"")+(void 0!==n?lt(n):"")+" avatar";return p.createElement("div",{className:a,style:{backgroundImage:"url(".concat(".","/").concat(t.avatarImg,")")},onClick:function(){e.onClick&&e.onClick(e.adventurer.id)}},p.createElement("div",{className:"sizer"}),e.displayName&&p.createElement("div",{className:"name"},t.name))}),It=function(e){var t=e.adventurers,n=e.onAdventurerTabSelected;return f.a.createElement(kt,{className:"adventurers-tabstrip",onTabSelected:function(t){var a=e.adventurers.find((function(e){return e.id===t}));n(a.id)},activeTab:e.selectedAdventurerId,disabled:e.disabled},t.map((function(e){return t=e,f.a.createElement(Nt,{id:t.id,key:t.id},f.a.createElement(Tt,{adventurer:t,className:lt(rt.small)}));var t})))},St=function(e){return e.adventurers},xt=function(e){return e.quests},Ct=(Object(it.a)([St,xt],(function(e,t){var n=[],a=Object.values(t).reduce((function(t,a){var r=Object(ht.b)(e,a);return a.status===ft.active&&(t[a.name]=r),n.push.apply(n,Object(o.a)(r)),t}),{});return a.solo=e.filter((function(e){return-1===n.indexOf(e)})),a})),function(e){return Object(it.a)([St,xt],(function(t,n){var a=n.find((function(t){return t.name===e}));return Object(ht.b)(t,a)}))}),qt=(Object(it.a)([St,xt],(function(e,t){var n=t.reduce((function(e,t){return t.status===ft.active&&e.push.apply(e,Object(o.a)(t.party)),e}),[]);return e.filter((function(e){return-1===n.indexOf(e.id)}))})),n(25)),At=n(11),Dt=n(68),Rt=n(29),Pt=(n(446),n(447),function(e){var t=e.item,n=Object(Re.b)(t);n||console.warn("could not find definition for ".concat(t));var a="item-icon ".concat(lt(e.size)," ").concat(Object(Rt.b)(n.rarity)," ");return p.createElement("div",{className:a,onClick:function(n){if(!1!==e.showContext){var a=n.currentTarget.getBoundingClientRect();at.showContextTooltip(Ye.item,Object(Re.b)(t),a),n.stopPropagation()}e.onClick&&e.onClick(n)}},p.createElement("img",{src:"".concat(".").concat(n.iconImg),alt:x.a.getItemName(e.item)}))});var Mt,Ht,Lt=Object(Dt.DragSource)(qt.b.ITEM,{beginDrag:function(e){return{inventorySlot:e.index,item:e.item,sourceId:e.sourceId,sourceType:e.sourceType}}},(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.item,n=e.onClick,a=e.isDragging,r=e.connectDragSource,c=e.size;return a?null:r(p.createElement("div",null,p.createElement(Pt,{item:t,onClick:function(e){n&&n(e)},size:c})))})),Wt=(n(448),n(119)),Vt=function(){var e=Object(h.e)((function(e){return e.adventurers})),t=Object(h.e)((function(e){return e.quests}));return Object(p.useMemo)((function(){return function(e,t){var n=t.reduce((function(e,t){return t.status===ft.active&&e.push.apply(e,Object(o.a)(t.party)),e}),[]);return e.filter((function(e){return-1===n.indexOf(e.id)}))}(e,t)}),[e,t])},Ft=function(e){var t=Object(p.useCallback)((function(t){return t.adventurers.find((function(t){return t.id===e}))}),[e]);return Object(h.e)(t)},Qt=function(e){var t=function(e){var t,n=Ft(e),a=function(e){var t=n.equipment[At.a[e]];return t&&Object(Wt.b)(t).damageReduction||0};return t={},Object(O.a)(t,At.a[At.a.head],a(At.a.head)),Object(O.a)(t,At.a[At.a.chest],a(At.a.chest)),Object(O.a)(t,At.a[At.a.hands],a(At.a.hands)),Object(O.a)(t,At.a[At.a.shoulders],a(At.a.shoulders)),Object(O.a)(t,At.a[At.a.legs],a(At.a.legs)),Object(O.a)(t,At.a[At.a.feet],a(At.a.feet)),t}(e.adventurerId),n=function(e){var n=t[At.a[e]];return n?f.a.createElement("div",{className:At.a[e],key:e},n):null};return f.a.createElement("li",{className:"guy"},n(At.a.head),n(At.a.chest),n(At.a.hands),n(At.a.shoulders),n(At.a.legs),n(At.a.feet))},_t=(n(449),function(e){var t=e.adventurer,n=e.onDropItemEquipment,a=function(e){var a=t.equipment[At.a[e]];return f.a.createElement("li",{className:At.a[e]},f.a.createElement(At.b,{onDrop:function(t){return n(t,e)},type:e},a&&f.a.createElement(Lt,{index:e,sourceId:t.id,sourceType:qt.a.adventurerEquipment,item:a,size:rt.medium})),f.a.createElement("span",{className:"info"},x.a.getEquipmentSlot(e)))};return f.a.createElement("ul",{className:"adventurer-equipment"},a(At.a.head),a(At.a.chest),a(At.a.hands),a(At.a.shoulders),a(At.a.legs),a(At.a.feet),a(At.a.mainHand),a(At.a.offHand),f.a.createElement(Qt,{adventurerId:t.id}))}),Bt={drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){var n=t.getItem();return n.sourceType!==qt.a.adventurerEquipment||(null==e.item||Object(At.c)(e.item,n.inventorySlot))}},Gt=Object(Dt.DropTarget)(qt.b.ITEM,Bt,(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,a=e.connectDropTarget,r=["inventory-item"];return t&&n?r.push("drop-active"):n&&r.push("drop-possible"),a(p.createElement("div",{className:r.join(" ")},e.children))})),Ut=(n(450),function(e){for(var t=[],n=function(n){var a=void 0,r=e.items[n];r&&(a=p.createElement(Lt,{index:n,sourceId:e.sourceId,sourceType:e.sourceType,item:r}));var c=p.createElement(Gt,{key:"inventory-slot-".concat(n),item:r,size:e.iconSize,onDrop:function(t){if((t.inventorySlot!==n||t.sourceType!==e.sourceType||t.sourceId!==e.sourceId)&&e.onDropItem){var a=t.inventorySlot;e.onDropItem(t.item,a,n,t.sourceType,t.sourceId)}}},a);t.push(c)},a=0;a<e.items.length;a++)n(a);return p.createElement("div",{className:"inventory ".concat(e.className)},t)}),zt=n(39),Xt=function(){return Object(h.e)((function(e){return e.stockpile}))},Yt=n(107),Zt=Object(p.createContext)(null),Jt=function(e){var t=e.questName,n=e.children,a=Object(h.f)(),r=Object(p.useState)(!1),c=Object(j.a)(r,2),o=c[0],i=c[1],u=a.getState().quests.find((function(e){return e.name===t})),s=u.scene,l=u.sceneName,m=Object(p.useMemo)((function(){return l?Yt.a.getSceneController(t,l,a):null}),[t,l,a]);return Object(p.useEffect)((function(){if(l&&m){i(!1);m.loadData((function(){i(!0),!s&&m&&(m.createScene(),m.sceneEntered())}))}}),[m,t,s,l]),!m||m.dataLoaded||o?f.a.createElement(Zt.Provider,{value:m},n):f.a.createElement("div",null,"loading...")},Kt=function(){var e=Object(h.d)(),t=Object(p.useContext)(Zt),n=Xt();return{dropItemEquipment:function(t,n,a){var r=t.item,c=[];switch(t.sourceType){case qt.a.adventurerInventory:c.push(Object(zt.f)(a.id,t.inventorySlot),Object(zt.c)(a.id,n,r));var o=a.equipment[At.a[n]];o&&c.push(Object(zt.b)(a.id,o,t.inventorySlot));break;case qt.a.warehouse:c.push(Xe(t.inventorySlot),Object(zt.c)(a.id,n,r));var i=a.equipment[At.a[n]];i&&c.push(ze(i,t.inventorySlot));break;case qt.a.adventurerEquipment:c.push(Object(zt.c)(a.id,n,r));var u=a.equipment[At.a[n]],s=t.inventorySlot;u?c.push(Object(zt.c)(a.id,s,u)):c.push(Object(zt.e)(a.id,s))}c.forEach((function(t){return e(t)}))},dropItemInventory:function(n,a,r,c,o,i){var u=[];switch(c){case qt.a.adventurerInventory:u.push(Object(zt.d)(o.id,a,r));break;case qt.a.warehouse:u.push(Xe(a),Object(zt.b)(o.id,n,r));var s=o.inventory[r];s&&u.push(ze(s,a));break;case qt.a.adventurerEquipment:u.push(Object(zt.b)(o.id,n,r));var l=o.inventory[r];l?u.push(Object(zt.c)(o.id,a,l)):u.push(Object(zt.e)(o.id,a));break;case qt.a.lootCache:t&&i&&t.takeItemFromCache(a,i,o,r)}u.forEach((function(t){return e(t)}))},dropItemWarehouse:function(t,a,r,c,o){var i=[];switch(c){case qt.a.warehouse:i.push(function(e,t){return{type:Be.moveItemInWarehouse,fromSlot:e,toSlot:t}}(a,r));var u=n[r];u&&i.push(Object(zt.b)(o,u,a));break;case qt.a.adventurerInventory:i.push(Object(zt.f)(o,a),ze(t,r));var s=n[r];s&&i.push(Object(zt.b)(o,s,a))}i.forEach((function(t){return e(t)}))}}};n(456);!function(e){e.arrowFinder="arrowFinder",e.gloomy="gloomy",e.houseHouston="houseHouston",e.houseMaddox="houseMaddox",e.houseMonroe="houseMonroe"}(Mt||(Mt={}));var $t=(Ht={},Object(O.a)(Ht,Mt.arrowFinder,{trait:Mt.arrowFinder,hasEffect:!0}),Object(O.a)(Ht,Mt.gloomy,{trait:Mt.gloomy,hasEffect:!0}),Object(O.a)(Ht,Mt.houseHouston,{trait:Mt.houseHouston}),Object(O.a)(Ht,Mt.houseMaddox,{trait:Mt.houseMaddox}),Object(O.a)(Ht,Mt.houseMonroe,{trait:Mt.houseMonroe}),Ht);var en=function(e){var t=Ft(e.adventurerId),n=function(e,t){var n=function(e){return $t[e]}(e);return f.a.createElement(p.Fragment,{key:e},f.a.createElement("li",{onClick:function(e){var t=e.currentTarget.getBoundingClientRect();at.showContextTooltip(Ye.trait,n,t),e.stopPropagation()}},x.a.getTraitName(e)),!t&&", ")};return(null===t||void 0===t?void 0:t.traits)?f.a.createElement(f.a.Fragment,null,f.a.createElement("p",null,x.a.get("ui-adventurer-info-traits-title")),f.a.createElement("ul",{className:"adventurer-traits"},t.traits.map((function(e,a){return n(e,a===t.traits.length-1)})))):null},tn=n(26),nn=(n(457),function(e){var t,n=Ft(e.adventurerId);return(null===n||void 0===n?void 0:n.skills)?f.a.createElement(f.a.Fragment,null,f.a.createElement("p",null,x.a.get("ui-adventurer-info-skills-title")),f.a.createElement("ul",{className:"adventurer-skills"},null===(t=Object.keys(n.skills))||void 0===t?void 0:t.map((function(e,t){return function(e){var t=function(t){var n=t.currentTarget.getBoundingClientRect();at.showContextTooltip(Ye.skill,e,n),t.stopPropagation()};return f.a.createElement(p.Fragment,{key:e},f.a.createElement("li",{onClick:t},f.a.createElement("span",{className:"skill",onClick:t},x.a.getSkillName(e)),f.a.createElement("span",null,n.skills[e])))}(tn.c[e])})))):null});function an(e){return Math.pow(e/.5,2)}n(458);var rn=function(e){var t,n,a,r=(t=e.progress||0,n=0,t>(a=1)?a:t<n?n:t);return p.createElement("div",{className:"progressbar"},p.createElement("div",{className:"progressbar-label"},e.label),p.createElement("div",{className:"progressbar-bar",style:{width:"".concat(100*r,"%")}}))};var cn=function(e){var t=e.xp,n=function(e){return Math.floor(.5*Math.sqrt(e))}(t),a=an(n),r=an(n+1);return p.createElement("div",{className:"level"},"Level ",n,p.createElement(rn,{progress:(t-a)/(r-a),label:x.a.get("ui-adventurer-info-xp-progress",{xp:Math.floor(t-a),next:r-a})}))},on=function(e){var t=Object(p.useCallback)((function(t){return t.quests.find((function(t){return t.name===e}))}),[e]);return Object(h.e)(t)},un=(n(459),function(e){var t=e.adventurer,n=e.questName,a=Kt(),r=a.dropItemEquipment,c=a.dropItemInventory;return f.a.createElement("div",{className:"adventurer-panel"},f.a.createElement("div",{className:"info"},f.a.createElement("div",{className:"name"},t.name,n&&f.a.createElement(sn,{questName:n,adventurer:t})),f.a.createElement(cn,{xp:t.xp}),f.a.createElement(en,{adventurerId:t.id}),f.a.createElement(nn,{adventurerId:t.id})),f.a.createElement("div",{className:"equipment"},f.a.createElement(_t,{adventurer:t,onDropItemEquipment:function(e,n){r(e,n,t)}})),f.a.createElement("div",{className:"right"},f.a.createElement(Ut,{sourceType:qt.a.adventurerInventory,sourceId:t.id,items:t.inventory,className:"inventory-small",onDropItem:function(e,n,a,r,o){c(e,n,a,r,t,o)}})))}),sn=function(e){var t,n=on(e.questName),a=Object(p.useContext)(Zt),r=Object(p.useMemo)((function(){return a.getRemainingAdventurerAp(e.adventurer.id)}),[a,e.adventurer.id]);return(null===n||void 0===n||null===(t=n.scene)||void 0===t?void 0:t.combat)?f.a.createElement("span",null,x.a.get("ui-adventurer-info-ap-remaining",{ap:r})):null},ln=n(125);n(246);window.PIXI=z;var mn,dn=Object(Z.PixiComponent)("RectTileLayer",{create:function(e){return new window.PIXI.tilemap.CompositeRectTileLayer},applyProps:function(e,t,n){var a=n.layer,r=n.tilesets,c=n.horizontalTiles,o=n.spritesheets;if(a.data)for(var i=0;i<a.data.length;i++){var u=pn(a.data[i],r);if(u){var s=u.tilewidth,l=u.tileheight,m=i%c*s,d=Math.floor(i/c)*l,p=o[u.name];if(a.data[i]>0){var f="".concat(u.name,"-").concat(a.data[i]);e.addFrame(p.textures[f],m,d)}}}}}),pn=function(e,t){for(var n,a=t.length-1;a>=0&&!((n=t[a]).firstgid<=e);a--);return n},fn=function(e){var t=e.data,n=e.spritesheets;return f.a.createElement(Z.Container,null,t.layers.filter((function(e){return e.visible&&e.type===ln.a.tilelayer})).map((function(e){return vn(e,t.width,t.tilesets,n)})))},vn=function(e,t,n,a){return f.a.createElement(dn,{key:e.name,layer:e,horizontalTiles:t,tilesets:n,spritesheets:a})},hn=function(e){var t=e.children,n=Object(ee.a)(e,["children"]);return f.a.createElement(h.b.Consumer,null,(function(e){var a=e.store;return f.a.createElement(Z.Stage,n,f.a.createElement(h.a,{store:a},t))}))};!function(e){e.move="move"}(mn||(mn={}));var gn,bn=n(24),yn=Object(Z.PixiComponent)("SpriteAnimated",{create:function(e){var t=e.textures;return new z.AnimatedSprite(t||[],!0)},applyProps:function(e,t,n){t.textures!==n.textures&&(Object(Z.applyDefaultProps)(e,t,n),e.gotoAndPlay(0))}}),On=Object(p.memo)(yn);!function(e){e.north="n",e.northEast="ne",e.east="e",e.southEast="se",e.south="s",e.southWest="sw",e.west="w",e.northWest="nw"}(gn||(gn={}));var jn=Object(p.memo)((function(e){var t,n,a=e.location,r=void 0===a?[0,0]:a,c=e.controller,o=e.idleAnimation,i=e.children,u=Object(ee.a)(e,["location","controller","idleAnimation","children"]),s=null===(t=c.mapData)||void 0===t?void 0:t.tilewidth,l=null===(n=c.mapData)||void 0===n?void 0:n.tileheight,m=Object(p.useRef)(null),d=Object(p.useRef)(),v=Object(h.d)(),g=Object(p.useCallback)((function(t){var n=t.quests.find((function(t){return t.name===e.controller.questName}));return n.scene.actionQueue?n.scene.actionQueue.filter((function(t){return t.actor===e.name})):[]}),[e.name,e.controller.questName]),b=Object(h.e)(g),y=Object(p.useState)("stand"),O=Object(j.a)(y,2),w=O[0],E=O[1],k=Object(p.useMemo)((function(){return c.getActorSpritesheetPath(e.name)}),[c,e.name]);Object(p.useEffect)((function(){if(m){var t=b[0];if(t){switch(t.actionType){case mn.move:var n=function(){v(Object(bn.b)(e.controller.questName)),e.controller.actorMoved(e.name,t.target)},a=(t.endsAt-performance.now())/1e3;a<0&&n(),r[0]===t.target[0]&&r[1]>t.target[1]?M(gn.north):r[0]<t.target[0]&&r[1]>t.target[1]?M(gn.northEast):r[0]<t.target[0]&&r[1]===t.target[1]?M(gn.east):r[0]<t.target[0]&&r[1]<t.target[1]?M(gn.southEast):r[0]===t.target[0]&&r[1]<t.target[1]?M(gn.south):r[0]>t.target[0]&&r[1]<t.target[1]?M(gn.southWest):r[0]>t.target[0]&&r[1]===t.target[1]?M(gn.west):r[0]>t.target[0]&&r[1]>t.target[1]&&M(gn.northWest),E("walk"),I.b.killTweensOf(m.current),I.b.to(m.current,{duration:a,ease:"linear",pixi:{x:t.target[0]*s,y:t.target[1]*l},onComplete:n})}d.current=t}}}),[v,s,l,b,e.controller,e.name,r]);var N=Object(p.useMemo)((function(){return E("stand"),{x:r[0]*s,y:r[1]*l}}),[r,s,l]),T=N.x,S=N.y,x=Object(p.useState)(null),C=Object(j.a)(x,2),q=C[0],A=C[1];Object(p.useEffect)((function(){if(k){var e=Object.keys(PIXI.Loader.shared.resources[k].textures).reduce((function(e,t){var n=t.replace(/[0-9]/g,"");return e[n]||(e[n]=[]),e[n].push(PIXI.Loader.shared.resources[k].textures[t]),e}),{});A(e)}}),[k]);var D=Object(p.useState)(gn.north),R=Object(j.a)(D,2),P=R[0],M=R[1],H=Object(p.useRef)(!1);Object(p.useEffect)((function(){var e;e=P===gn.southWest||P===gn.west||P===gn.northWest,H.current=e}),[P]),Object(p.useEffect)((function(){if(o){var e=2e3+4e3*Math.random(),t=setInterval((function(){var e=Math.random()<.5;P===gn.north&&e?M(gn.northWest):P===gn.northWest&&e?M(gn.west):P===gn.west&&e?M(gn.southWest):P===gn.southWest&&e?M(gn.south):P===gn.south&&e?M(gn.southEast):P===gn.southEast&&e?M(gn.east):P===gn.east&&e?M(gn.northEast):P===gn.northEast&&e&&M(gn.north),P!==gn.north||e?P!==gn.northEast||e?P!==gn.east||e?P!==gn.southEast||e?P!==gn.south||e?P!==gn.southWest||e?P!==gn.west||e?P!==gn.northWest||e||M(gn.north):M(gn.northWest):M(gn.west):M(gn.southWest):M(gn.south):M(gn.southEast):M(gn.east):M(gn.northEast)}),e);return function(){return clearInterval(t)}}}),[w,P]);var L=Object(p.useCallback)((function(){switch(P){case gn.northWest:return"".concat("").concat(w,"-").concat(gn.northEast);case gn.west:return"".concat("").concat(w,"-").concat(gn.east);case gn.southWest:return"".concat("").concat(w,"-").concat(gn.southEast);default:return"".concat("").concat(w,"-").concat(P)}}),[w,P]);return f.a.createElement(Z.Container,Object.assign({x:T,y:S,ref:m},u),k&&q&&f.a.createElement(On,{animationSpeed:.1,name:"footman",isPlaying:!0,textures:q[L()],x:50,y:30,scale:[H.current?-1:1,1],anchor:[.5,.5],pivot:[0,0],filters:[wn(En,kn)]}),i)})),wn=function(e,t){var n=e.map((function(n,a){return[e[a],t[a]]}));return new se.b(n,.15)},En=[3679,8831,14501,21964],kn=[3870010,6561118,8930966,11166141],Nn=Object(p.forwardRef)((function(e,t){var n=Object(p.useRef)(null);return Object(p.useImperativeHandle)(t,(function(){var e;return{drawAction:function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=n.current;if(r){var c=a?65280:16724736;r.clear().lineStyle(3,c).moveTo(e.x,e.y).lineTo(t.x,t.y)}},clear:function(){var e=n.current;null===e||void 0===e||e.clear()},parent:null===(e=n.current)||void 0===e?void 0:e.parent}})),f.a.createElement(Z.Graphics,{name:"ActionPath",ref:n})})),Tn=Object(p.forwardRef)((function(e,t){var n=Object(p.useRef)(null),a=e.tileWidth,r=e.tileHeight;return Object(p.useImperativeHandle)(t,(function(){var e;return{drawAp:function(e,t){n.current&&(n.current.x=a*e[0]+a/2,n.current.y=r*e[1]+r/2,n.current.text="".concat(t),n.current.visible=!0)},clear:function(){n.current&&(n.current.visible=!1)},parent:null===(e=n.current)||void 0===e?void 0:e.parent}})),f.a.createElement(Z.Text,{name:"ActionPoints",ref:n,anchor:[.5,.5],style:{fontFamily:"Gabriela",fontSize:42,fill:16715792,align:"center"}})})),In=Object(p.memo)((function(e){var t,n,a=e.controller,r=e.location,c=e.name,o=e.selected,i=null===(t=a.mapData)||void 0===t?void 0:t.tilewidth,u=null===(n=a.mapData)||void 0===n?void 0:n.tileheight,s=Object(h.d)(),l=on(a.questName).scene,m=l.combat,d=Ft(c),v=Object(p.useRef)(null),g=Object(p.useRef)(null),b=Object(p.useState)(!1),y=Object(j.a)(b,2),O=y[0],w=y[1];Object(p.useEffect)((function(){if(O&&r){var e=v.current,t=null===e||void 0===e?void 0:e.parent,n=function(t){if(O&&r&&e){var n=a.pointToSceneLocation(new PIXI.Point(t.data.global.x,t.data.global.y)),o=a.locationIsBlocked(n),s=!0,l=new PIXI.Point(r[0]*i+i/2,r[1]*u+u/2);if(m){var d,p,f=a.calculateWalkApCosts(r,n);if(f>0)null===(d=g.current)||void 0===d||d.drawAp(n,f),s=(a.getRemainingAdventurerAp(c)||-1)>=f;else null===(p=g.current)||void 0===p||p.clear()}e.drawAction(l,t.data.global,!o&&s)}};return t.on("pointermove",n),function(){t.off("pointermove",n)}}}),[O,m,a,r,c,u,i]);var E=function(e){var t,n,o,i;w(!1);var u=v.current;if(w(!1),null===u||void 0===u||u.clear(),null===(t=g.current)||void 0===t||t.clear(),!(null===(n=l.actionQueue)||void 0===n?void 0:n.length)){var d=a.pointToSceneLocation(new PIXI.Point(e.data.global.x,e.data.global.y));if(!a.locationIsBlocked(d)){var p=a.pointToSceneLocation(e.data.global);if(!(p[0]<0||p[0]>=(null===(o=a.mapData)||void 0===o?void 0:o.width)||p[1]<0||p[1]>=(null===(i=a.mapData)||void 0===i?void 0:i.height))){var f=a.findPath(r,p);if(m)if((a.getRemainingAdventurerAp(c)||-1)<((null===f||void 0===f?void 0:f.length)||0))return;null===f||void 0===f||f.forEach((function(e,t){var n={actionType:mn.move,actor:c,target:e,endsAt:500*(t+1)+performance.now()};s(Object(bn.d)(a.questName,n))})),s(Object(bn.c)(a.questName,c,(null===f||void 0===f?void 0:f.length)||0))}}}};return f.a.createElement(Z.Container,{interactive:!0},f.a.createElement(Nn,{ref:v}),f.a.createElement(Tn,{ref:g,tileWidth:i,tileHeight:u}),f.a.createElement(jn,{name:c,controller:a,location:r,interactive:!0,pointerdown:function(){w(!0),e.setSelectedActor(c)},pointerup:E,pointerupoutside:E,hitArea:new PIXI.Rectangle(null===r||void 0===r?void 0:r[0],null===r||void 0===r?void 0:r[1],i,u),idleAnimation:Math.random()<.5},o&&f.a.createElement(Z.Graphics,{name:"selectioncircle",draw:function(e){e.lineStyle(3,16777215),e.drawCircle(i/2,u/2,i/2-3),e.endFill()}}),f.a.createElement(Z.Sprite,{scale:.1,anchor:.5,x:i/2,y:-30,image:"".concat(".","/").concat(d.avatarImg)}),o&&a.actorCanInteract(c)&&f.a.createElement(Z.Container,{interactive:!0,pointerdown:function(){a.actorInteract(c)}},f.a.createElement(Z.Sprite,{image:"".concat(".","/img/scene/ui/background.png"),width:i/2,height:i/2,y:u,x:i/2,anchor:.5}),f.a.createElement(Z.Sprite,{image:"".concat(".","/img/scene/ui/interact.png"),width:i/2,height:i/2,y:u,x:i/2,anchor:.5}))))})),Sn=function(e){var t=Object(p.useState)({}),n=Object(j.a)(t,2),a=n[0],r=n[1],c=Object(p.useState)(),o=Object(j.a)(c,2),i=o[0],u=o[1];return Object(p.useEffect)((function(){if(i){var t=xn(i,a);if(t){var n=t.name;Object(J.b)("".concat(e,"/").concat(t.image),(function(c){if(c.error)throw new Error("Loading ".concat(e,"\n").concat(c.error));var o=Cn(t),i=new PIXI.Spritesheet(c.texture,o);i.parse((function(){var e=Object(De.a)(Object(De.a)({},a),{},Object(O.a)({},n,i));r(e)}))}))}}}),[i,e,a]),{loadComplete:!!i&&void 0===xn(i,a),loadTilesets:function(e){u(e)},tileSpritesheets:a}},xn=function(e,t){return e.find((function(e){return!t[e.name]}))},Cn=function(e){for(var t=e.columns,n={},a=0;a<e.tilecount;a++){var r=e.tilewidth,c=e.tileheight,o=a%t*r,i=Math.floor(a/t)*c;n["".concat(e.name,"-").concat(a+e.firstgid)]={frame:{x:o,y:i,w:r,h:c},spriteSourceSize:{x:o,y:i,w:r,h:c},rotated:!1,trimmed:!1,sourceSize:{w:r,h:c}}}return{frames:n,meta:{image:e.image,size:{w:e.imagewidth,h:e.imageheight},scale:1}}},qn=Object(p.forwardRef)((function(e,t){var n,a,r=e.location,c=void 0===r?[0,0]:r,o=e.controller,i=e.children,u=null===(n=o.mapData)||void 0===n?void 0:n.tilewidth,s=null===(a=o.mapData)||void 0===a?void 0:a.tileheight,l=Object(p.useMemo)((function(){return{x:c[0]*u,y:c[1]*s}}),[c,u,s]),m=l.x,d=l.y;return f.a.createElement(Z.Container,{x:m,y:d,ref:t},i)})),An=function(e,t,n){if(e.gid){var a=Dn(e.gid,t.mapData.tilesets),r=n[a.name];return f.a.createElement(qn,{key:"".concat(e.name).concat(e.location[0]).concat(e.location[1]),controller:t,location:e.location},f.a.createElement(Z.Sprite,{name:e.name,texture:r.textures["".concat(a.name,"-").concat(e.gid)]}))}return f.a.createElement("div",null)},Dn=function(e,t){for(var n=t.length-1;n>=0;n--)if(t[n].firstgid<=e)return t[n];return t[0]};window.PIXI=z;var Rn,Pn=function(e){var t=Object(p.useContext)(Zt),n=t.mapData,a=t.basePath,r=Sn(a),c=r.loadComplete,o=r.loadTilesets,i=r.tileSpritesheets,u=Object(p.useRef)(null),s=on(t.questName).scene,l=Object(p.useMemo)((function(){var t;return(null===s||void 0===s||null===(t=s.actors)||void 0===t?void 0:t.find((function(t){return t.name===e.selectedActor})))||null}),[s,e.selectedActor]),m=Object(p.useCallback)((function(){var n;return null===s||void 0===s||null===(n=s.actors)||void 0===n?void 0:n.map((function(n){return function(n){var a=n.name,r=n.location;return f.a.createElement(In,{location:r,controller:t,name:a,key:a,selected:(null===l||void 0===l?void 0:l.name)===a,setSelectedActor:e.setSelectedActor})}(n)}))}),[t,e.setSelectedActor,s,l]);if(Object(p.useEffect)((function(){n&&o(n.tilesets)}),[o,n]),!c||!n||!s)return f.a.createElement("div",null,"loading...");var d=n.width*n.tilewidth,v=n.height*n.tileheight;return f.a.createElement(f.a.Fragment,null,f.a.createElement(hn,{width:d,height:v},f.a.createElement(Z.Container,{ref:u,interactive:!0,hitArea:new z.Rectangle(0,0,d,v)},f.a.createElement(fn,{basePath:a,data:n,spritesheets:i}),s.objects.map((function(e){return An(e,t,i)})),m())),!1)},Mn=function(e){var t=on(e.questName),n=Object(yt.b)(t.name),a=Math.floor(t.progress);do{var r=n.nodes[a].log;if(r)return f.a.createElement("div",null,f.a.createElement("p",null,"".concat(x.a.get(r))));a--}while(a>=0);return f.a.createElement("h1",{className:"app-h2"},x.a.getQuestTitle(t.name))},Hn=function(e){return on(e.questName).sceneName?f.a.createElement(Pn,e):f.a.createElement(Mn,{questName:e.questName})},Ln=(n(460),function(e){var t=(e.className||"")+" itemslist";return p.createElement("ul",{className:t},e.items.map((function(t,n){return p.createElement("li",{key:"".concat(t).concat(n),className:"item"},p.createElement(Lt,{item:t,index:n,sourceId:e.sourceId,sourceType:e.sourceType}),p.createElement("div",{className:"text"},p.createElement("p",{className:"name"},x.a.getItemName(t)),p.createElement("p",{className:"subtext"},x.a.getItemSubtext(t))))})))}),Wn=(n(461),n(247),function(e){var t=Object(p.useContext)(Zt),n=Ft(e.adventurerId),a=Object(ht.a)(n),r=Object(p.useRef)(null),c=t.getLootCache(e.cacheName);if(!c)return null;return f.a.createElement("div",{className:"interaction-modal loot-cache",ref:r},f.a.createElement("div",{className:"header"},f.a.createElement("div",{className:"title"},x.a.get(c.title)),f.a.createElement("div",{className:"close",onClick:e.onClose})),c.items.length>0&&f.a.createElement("div",{className:"content"},f.a.createElement("div",{className:"items"},f.a.createElement(Ln,{items:c.items,sourceType:qt.a.lootCache,sourceId:e.cacheName})),f.a.createElement("div",{className:"adventurer"},f.a.createElement(Tt,{adventurer:n}),f.a.createElement(Se,{onClick:function(c){c.stopPropagation(),r.current.querySelectorAll(".itemslist .item").forEach((function(e,t){t>=a||e.classList.add("taking")})),I.a.to(".itemslist .item.taking",{right:"-100%",stagger:{each:.1,ease:"power2.inOut"},onComplete:function(){for(var r=0;r<a;r++)t.takeItemFromCache(0,e.cacheName,n)}})},disabled:0===a,size:"small"},x.a.get("quest-common-loot-cache-take-all")))),!!c.gold&&f.a.createElement("div",{className:"content"},f.a.createElement("div",{className:"gold"},f.a.createElement("div",{className:"icon ".concat(lt(rt.medium)),style:{backgroundImage:"url(".concat(".","/img/resources/gold.png)")}}),x.a.get("quest-common-loot-cache-gold",{gold:c.gold})),f.a.createElement("div",{className:"take-gold"},f.a.createElement(Se,{onClick:function(n){n.stopPropagation(),t.takeGoldFromCache(e.cacheName)},size:"small"},x.a.get("quest-common-loot-cache-take")))))}),Vn=(n(462),function(e){var t=Object(p.useContext)(Zt),n=Object(p.useRef)(null),a=t.getSituation(e.situation,e.adventurerId);if(!a)return null;var r=a.title,c=a.choices,o=function(n){var a=n.currentTarget.getAttribute("data-option");t.handleSituationOptionClick(e.situation,a),n.stopPropagation()};return f.a.createElement("div",{className:"interaction-modal situation",ref:n},f.a.createElement("div",{className:"header"},f.a.createElement("div",{className:"title"},x.a.get(r)),f.a.createElement("div",{className:"close",onClick:function(t){e.onClose(),t.stopPropagation()}})),c.length>0&&f.a.createElement("div",{className:"content"},c.map((function(e){return f.a.createElement(Se,{key:e,"data-option":e,onClick:o},x.a.get(e))}))))}),Fn=(n(463),function(e){var t=Object(h.e)(Ct(e.questName)),n=Object(p.useContext)(Zt);return f.a.createElement("div",{className:"combat-bar"},f.a.createElement("div",{className:"title"},x.a.get("ui-combat-bar-title")),f.a.createElement("div",{className:"adventurers"},t.map((function(e){return f.a.createElement(f.a.Fragment,{key:e.id},f.a.createElement(Tt,{adventurer:e,size:rt.smallest}),f.a.createElement("div",{className:"ap"},n.getRemainingAdventurerAp(e.id)," AP"))}))))});n(464);!function(e){e[e.auto=0]="auto",e[e.vertical=1]="vertical",e[e.horizontal=2]="horizontal"}(Rn||(Rn={}));var Qn,_n=function(e){var t,n,a=Object(N.g)(),r=Object(h.d)(),c=e.layout,o=void 0===c?Rn.auto:c,i=Object(h.e)(Ct(e.questName)),u=i[0],s=Object(p.useState)(null===u||void 0===u?void 0:u.id),l=Object(j.a)(s,2),m=l[0],d=l[1],v=Object(p.useMemo)((function(){return i.find((function(e){return e.id===m}))}),[i,m]),g=on(e.questName),b=null===g||void 0===g||null===(t=g.scene)||void 0===t?void 0:t.activeInteractionModal,y=function(e){d(e)},O=function(){r(Object(bn.g)(e.questName))};return Object(p.useEffect)((function(){i.length||a.push(Object(F.d)())}),[i.length,a]),i.length?f.a.createElement(Jt,{questName:e.questName},(null===g||void 0===g||null===(n=g.scene)||void 0===n?void 0:n.combat)&&f.a.createElement(Fn,{questName:e.questName}),f.a.createElement("div",{className:"quest-panel quest-panel-".concat(Rn[o])},f.a.createElement("div",{className:"quest-area"},f.a.createElement(Hn,{questName:e.questName,selectedActor:m,setSelectedActor:y}),b&&"lootCache"===b.type&&f.a.createElement("div",{className:"modal",onClick:O},f.a.createElement(Wn,{cacheName:b.lootCache,adventurerId:m,onClose:O})),b&&"situation"===b.type&&f.a.createElement("div",{className:"modal",onClick:O},f.a.createElement(Vn,{situation:b.situation,adventurerId:m,onClose:O}))),f.a.createElement("div",{className:"party-area"},f.a.createElement(It,{adventurers:i,selectedAdventurerId:m,onAdventurerTabSelected:y,disabled:void 0!==b}),f.a.createElement("div",{className:"adventurer-details"},v&&f.a.createElement(un,{adventurer:v,questName:e.questName}))))):null},Bn=(n(465),function(){var e=Object(p.useRef)(null),t=Object(N.h)("".concat(Object(F.d)(),"/:questname")),n=null===t||void 0===t?void 0:t.params.questname,a=Object(N.g)();Object(p.useEffect)((function(){S.c.addMusicTrack(S.a.world,"sound/music/TheLoomingBattle.ogg"),S.c.playMusicTrack(S.a.world)}),[]);return f.a.createElement("div",{className:"world-view",ref:e},f.a.createElement(Ot,{selectedQuestName:n,smallMap:null!=n,onPartyClick:function(e){e===n?a.push(Object(F.d)()):a.push(Object(F.a)(e)),S.c.playSound(S.b.buttonClick)},retrieveWorldViewRef:function(){return e}}),n&&f.a.createElement(_n,{questName:n}))});n(466);!function(e){e[e.all=0]="all",e[e.town=1]="town",e[e.quest=2]="quest"}(Qn||(Qn={}));var Gn,Un,zn=function(e){var t=Object(p.useState)(!1),n=Object(j.a)(t,2),a=n[0],r=n[1],c=Object(p.useState)("all"),o=Object(j.a)(c,2),i=o[0],u=o[1],s=Object(h.e)((function(e){return e.log})),l=Object(h.e)((function(e){return bt(e)})),m=[{label:x.a.get("ui-log-tab-all"),tabId:"all",tabType:Qn.all},{label:x.a.get("ui-log-tab-town"),tabId:"town",tabType:Qn.town}];l.forEach((function(e){var t=e.name;m.push({channelContext:t,label:x.a.getQuestTitle(t),tabId:"quest-".concat(t),tabType:Qn.quest})}));var d=[],f=m.find((function(e){return e.tabId===i}));switch(f.tabType){case Qn.all:d=s;break;case Qn.town:d=s.filter((function(e){return e.channel===Me.a.town}));break;case Qn.quest:d=s.filter((function(e){return e.channel===Me.a.quest&&e.channelContext===f.channelContext}))}return p.createElement("div",{className:"log ".concat(a?"expanded":"")},p.createElement("div",{className:"tab-bar"},p.createElement(kt,{className:"tabs",onTabSelected:function(e){u(e)},activeTab:i},m.map((function(e){return p.createElement(Nt,{id:e.tabId,key:e.tabId},e.label)}))),p.createElement(Se,{className:"expand-button",onClick:function(){r(!a)},square:!0,size:"medium",text:a?"\u25bc":"\u25b2"})),p.createElement("div",{className:"log-entries"},d.map((function(e){return function(e){var t=x.a.get(e.key,e.context);return p.createElement("div",{className:"entry",key:e.time},t)}(e)}))))};function Xn(e,t,n,a,r){return{type:Gn.start,taskType:e,name:t,origin:n,time:a,callbacks:r}}function Yn(e){var t=Object(p.useCallback)((function(t){return t.structures[e]}),[e]);return Object(h.e)(t)}!function(e){e.start="startTask",e.update="updateTasks"}(Gn||(Gn={})),function(e){e[e.buildStructure=0]="buildStructure",e[e.craftItem=1]="craftItem",e[e.studyItem=2]="studyItem"}(Un||(Un={}));var Zn,Jn,Kn=function(e){var t=e.info,n=Object(h.d)(),a=ct(),r=Object(W.b)(t.structure),c=r.cost.gold||0<=a,o=!(Yn(t.structure).state===R.NotBuilt)||!c,i=x.a.getItemSubtext(t.item),u=function(e){n(Object(Ue.c)(r.cost.gold||0)),n(function(e){return{type:Ie.startBuildingStructure,structure:e}}(e));var t=[Ve(e)],a=r.cost.time,c=Xn(Un.buildStructure,"".concat(e,".build"),"town",a,t);n(c)};return p.createElement("div",null,i&&p.createElement("p",{className:"subtext"},'"',i,'"'),p.createElement(Se,{disabled:o,size:"small",onClick:function(){return u(t.structure)}},"Start construction (",r.cost.gold," gold)"))},$n=n(13),ea=(Zn={},Object(O.a)(Zn,Pe.a.aegisOfValor,{item:Pe.a.aegisOfValor,levelRequired:3,cost:{resources:{wood:20,iron:5},time:$n.a}}),Object(O.a)(Zn,Pe.a.arbalest,{item:Pe.a.arbalest,cost:{resources:{wood:20,iron:5},time:$n.a}}),Object(O.a)(Zn,Pe.a.battleAxe,{item:Pe.a.battleAxe,cost:{resources:{wood:20,iron:5},time:$n.a}}),Object(O.a)(Zn,Pe.a.berserkerShield,{item:Pe.a.berserkerShield,levelRequired:2,cost:{resources:{wood:20,iron:5},time:$n.a}}),Object(O.a)(Zn,Pe.a.brassKnuckles,{item:Pe.a.brassKnuckles,cost:{resources:{wood:20,iron:5},time:$n.a}}),Object(O.a)(Zn,Pe.a.simpleCrossbow,{item:Pe.a.simpleCrossbow,cost:{resources:{wood:20,iron:5},time:$n.a}}),Object(O.a)(Zn,Pe.a.cleaver,{item:Pe.a.cleaver,cost:{resources:{wood:10,iron:15},time:$n.a}}),Object(O.a)(Zn,Pe.a.club,{item:Pe.a.club,cost:{resources:{wood:30},time:$n.a}}),Object(O.a)(Zn,Pe.a.dagger,{item:Pe.a.dagger,cost:{resources:{wood:10,iron:10},time:$n.b}}),Object(O.a)(Zn,Pe.a.flail,{item:Pe.a.flail,cost:{resources:{wood:10,iron:10},time:$n.b}}),Object(O.a)(Zn,Pe.a.goldenShield,{item:Pe.a.goldenShield,levelRequired:2,cost:{resources:{wood:20,iron:5},time:$n.a}}),Object(O.a)(Zn,Pe.a.javelin,{item:Pe.a.javelin,cost:{resources:{wood:20,iron:10},time:$n.b+$n.a}}),Object(O.a)(Zn,Pe.a.khopesh,{item:Pe.a.khopesh,cost:{resources:{wood:15,iron:40},time:$n.d}}),Object(O.a)(Zn,Pe.a.longbow,{item:Pe.a.longbow,cost:{resources:{wood:40,iron:5},time:$n.b}}),Object(O.a)(Zn,Pe.a.mace,{item:Pe.a.mace,cost:{resources:{wood:15,iron:10},time:$n.b}}),Object(O.a)(Zn,Pe.a.morningStar,{item:Pe.a.morningStar,cost:{resources:{wood:15,iron:15},time:$n.b}}),Object(O.a)(Zn,Pe.a.paintedBuckler,{item:Pe.a.paintedBuckler,cost:{resources:{wood:20,iron:10},time:$n.b+$n.a}}),Object(O.a)(Zn,Pe.a.poisonedDagger,{item:Pe.a.poisonedDagger,cost:{resources:{wood:50,iron:15},materials:[Pe.a.poisonVial],time:$n.b}}),Object(O.a)(Zn,Pe.a.ravenStaff,{item:Pe.a.ravenStaff,cost:{resources:{wood:15,iron:10,food:5},time:$n.b}}),Object(O.a)(Zn,Pe.a.savageStaff,{item:Pe.a.savageStaff,cost:{resources:{wood:15,iron:10,food:5},time:$n.b}}),Object(O.a)(Zn,Pe.a.spear,{item:Pe.a.spear,cost:{resources:{wood:15,iron:15},time:$n.b}}),Object(O.a)(Zn,Pe.a.steelShield,{item:Pe.a.steelShield,cost:{resources:{wood:15,iron:15},time:$n.b}}),Object(O.a)(Zn,Pe.a.sword,{item:Pe.a.sword,cost:{resources:{wood:10,iron:30},time:$n.b}}),Object(O.a)(Zn,Pe.a.warhammer,{item:Pe.a.warhammer,cost:{resources:{wood:10,iron:30},time:$n.b}}),Object(O.a)(Zn,Pe.a.woodenBulwark,{item:Pe.a.woodenBulwark,cost:{resources:{wood:10,iron:30},time:$n.b}}),Zn),ta=ea;var na,aa,ra=(Jn={},Object(O.a)(Jn,Pe.a.boots1,{item:Pe.a.boots1,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.boots2,{item:Pe.a.boots2,cost:{resources:{wood:10,iron:45},time:$n.b},levelRequired:2}),Object(O.a)(Jn,Pe.a.boots3,{item:Pe.a.boots3,cost:{resources:{wood:10,iron:45},time:$n.b},levelRequired:3}),Object(O.a)(Jn,Pe.a.chainmailHood,{item:Pe.a.chainmailHood,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.chest,{item:Pe.a.chest,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.clothGloves,{item:Pe.a.clothGloves,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.cowl,{item:Pe.a.cowl,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.druidChest,{item:Pe.a.druidHands,cost:{resources:{wood:10,iron:45},time:$n.b},levelRequired:2}),Object(O.a)(Jn,Pe.a.druidFeet,{item:Pe.a.druidFeet,cost:{resources:{wood:10,iron:45},time:$n.b},levelRequired:2}),Object(O.a)(Jn,Pe.a.druidHands,{item:Pe.a.druidHands,cost:{resources:{wood:10,iron:45},time:$n.b},levelRequired:2}),Object(O.a)(Jn,Pe.a.druidHead,{item:Pe.a.druidHead,cost:{resources:{wood:10,iron:45},time:$n.b},levelRequired:2}),Object(O.a)(Jn,Pe.a.druidLegs,{item:Pe.a.druidLegs,cost:{resources:{wood:10,iron:45},time:$n.b},levelRequired:2}),Object(O.a)(Jn,Pe.a.fedora,{item:Pe.a.fedora,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.greaves1,{item:Pe.a.greaves1,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.greaves2,{item:Pe.a.greaves2,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.hornedHelmet,{item:Pe.a.hornedHelmet,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.leatherGloves,{item:Pe.a.leatherGloves,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.nomadHelmet,{item:Pe.a.nomadHelmet,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.pants1,{item:Pe.a.pants1,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.pants2,{item:Pe.a.pants2,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.plateChest1,{item:Pe.a.plateChest1,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.plateChest2,{item:Pe.a.plateChest2,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.plateChest3,{item:Pe.a.plateChest3,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.plateChest4,{item:Pe.a.plateChest4,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.plateGloves1,{item:Pe.a.plateGloves1,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.plateGloves2,{item:Pe.a.plateGloves2,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.plateHelmet,{item:Pe.a.plateHelmet,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.platePants,{item:Pe.a.platePants,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.plateShoulders1,{item:Pe.a.plateShoulders1,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.plateShoulders2,{item:Pe.a.plateShoulders2,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.robe,{item:Pe.a.robe,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.shoulders1,{item:Pe.a.shoulders1,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.shoulders2,{item:Pe.a.shoulders2,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.shoulders3,{item:Pe.a.shoulders3,cost:{resources:{wood:10,iron:45},time:$n.b}}),Object(O.a)(Jn,Pe.a.vest,{item:Pe.a.vest,cost:{resources:{wood:10,iron:45},time:$n.b}}),Jn),ca=(na={},Object(O.a)(na,Pe.a.torch,{item:Pe.a.torch,cost:{resources:{wood:2,fabric:1},time:$n.c}}),Object(O.a)(na,Pe.a.sandwich,{item:Pe.a.sandwich,cost:{resources:{food:1},time:$n.c/2}}),na),oa={},ia=Object(De.a)(Object(De.a)(Object(De.a)(Object(De.a)({},oa),ra),ta),ca),ua=function(e){return ia[e]},sa=function(e){return e.tasks},la=function(e){return Object(h.e)(function(e){return Object(it.a)([sa],(function(t){return t.running.filter((function(t){return t.origin==="".concat(e,".craft")}))}))}(e))},ma=function(e){return Object(h.e)(function(e){return Object(it.a)([sa],(function(t){return t.running.filter((function(t){return t.origin==="".concat(e,".study")}))}))}(e))},da=$n.d,pa=function(e){var t=e.structure,n=Yn(t),a=ma(t),r=Object(h.d)();if(!t)return null;if(n.produces.some((function(t){return t===e.item})))return p.createElement("p",null,"Constructed at:\xa0",p.createElement(k.b,{to:Object(F.b)(t)},x.a.getStructureName(t)));var c=a.find((function(t){return t.name===e.item}));if(c)return p.createElement("p",null,p.createElement(k.b,{to:Object(F.b)(t)},x.a.get("ui-tooltip-study-currently-studying")),Object($n.e)(c.timeRemaining,!0));var o=ua(e.item);if(n.level<(o.levelRequired||0)||n.state!==R.Built)return p.createElement("p",{className:"invalid"},x.a.get("ui-tooltip-study-requires-structure-level",{structure:t,level:(o.levelRequired||0)+1}));return p.createElement("p",null,p.createElement(Se,{onClick:function(){var n=[_e(e.structure,e.item)],a=da,c=Xn(Un.studyItem,e.item,"".concat(t,".study"),a,n);r(c)},size:"small"},x.a.get("ui-tooltip-study-start-study")))},fa=function(e){var t,n=(t=e.item,oa[t]?W.a.alchemist:ra[t]?W.a.armoursmith:ta[t]?W.a.weaponsmith:ca[t]?W.a.workshop:null);return Object(Re.b)(e.item).unique?p.createElement("p",null,"Unique item"):n?p.createElement(pa,{item:e.item,structure:n}):null},va=function(e){var t=e.info,n=x.a.getItemSubtext(t.item),a=x.a.getWeaponType(t.weaponType),r=x.a.getWeaponClassification(tn.e[t.weaponType]);return p.createElement(p.Fragment,null,p.createElement("div",null,a,t.weaponType!==tn.c.shield&&" (".concat(r,")")),n&&p.createElement("p",{className:"subtext"},'"',n,'"'),t.damage&&p.createElement("p",null," damage: ",t.damage[tn.a.kinetic]," "),p.createElement(fa,{item:t.item}))},ha=function(e){var t=e.info,n=t.damageReduction,a=x.a.getItemSubtext(t.item),r=x.a.getEquipmentSlot(t.equipmentType);return p.createElement(p.Fragment,null,p.createElement("div",null,"".concat(r)),a&&p.createElement("p",{className:"subtext"},'"',a,'"'),n&&p.createElement("p",null," ",x.a.get("ui-tooltip-damage-reduction",{damageReduction:n})," "),p.createElement(fa,{item:t.item}))},ga=(n(467),function(e){var t=e.info;switch(t.itemType){case Pe.b.deed:return p.createElement(Kn,{info:t});case Pe.b.weapon:return p.createElement(va,{info:t});case Pe.b.apparel:return p.createElement(ha,{info:t});default:var n=x.a.getItemSubtext(t.item);return n&&p.createElement("p",{className:"subtext"},'"',n,'"')||null}}),ba=(n(468),function(e){var t=e.info,n=ot(),a=ct(),r=Object(h.e)((function(e){return e.workers})),c=st(),o=Object(h.e)((function(e){return e.structures}));switch(t){case He.a.fabric:case He.a.food:case He.a.iron:case He.a.leather:case He.a.stone:case He.a.wood:var i=$e(n[t],0);return p.createElement(p.Fragment,null,p.createElement("div",{className:"resource-context"},x.a.get("resource-".concat(t,"-info"))),p.createElement("div",null,x.a.get("ui-tooltip-resource-quantity",{amount:i})),p.createElement("div",null,function(){var e=Object(W.c)(He.a[t]),n=o[e];if(n.state!==R.Built)return p.createElement("span",null,x.a.get("ui-tooltip-resource-produce-row-notbuilt",{structure:x.a.getStructureName(e)}));var a=Object(W.b)(e).levels[n.level].generates[t],r=x.a.get("ui-tooltip-resource-produce-row",{structure:"%SPLIT%",amount:a}).split("%SPLIT%");return p.createElement("span",{className:"produced"},r[0],p.createElement(k.b,{to:Object(F.b)(e)},x.a.getStructureName(e)),r[1])}()));case"gold":var u=a;return p.createElement(p.Fragment,null,p.createElement("div",{className:"resource-context"}," ".concat(x.a.get("resource-".concat(t,"-info")))),p.createElement("div",null,x.a.get("ui-tooltip-resource-quantity",{amount:u})));case"workers":var s=c,l=r;return p.createElement(p.Fragment,null,p.createElement("div",{className:"resource-context"}," ".concat(x.a.get("resource-".concat(t,"-info")))),p.createElement("div",null,x.a.get("ui-tooltip-workers-quantity",{free:s,total:l})));default:throw new Error("Uknow value "+t)}});n(469),n(470);!function(e){e[e.bottom=0]="bottom",e[e.top=1]="top",e[e.left=2]="left",e[e.right=3]="right"}(aa||(aa={}));var ya=function(e){var t=e.children,n=e.referenceRect,a=Object(p.useRef)(null),r=Object(p.useState)(e.placement||aa.bottom),c=Object(j.a)(r,2),o=c[0],i=c[1],u=Object(p.useState)(),s=Object(j.a)(u,2),l=s[0],m=s[1];Object(p.useEffect)((function(){var e=a.current;if(e&&l){var t=e.getBoundingClientRect();switch(o){case aa.top:if(t.top-t.height-8-8<l.top)return void i(aa.bottom);break;case aa.bottom:if(t.top+t.height+8+8>l.height)return void i(aa.top)}e.style.opacity="1";var n=e.querySelector(".tooltip-content");if(t.left<l.left+8){var r=l.left-t.left+8;n.style.transform="translateX(".concat(r,"px)")}else if(t.right>l.right-8){var c=t.right-l.right+8;n.style.transform="translateX(".concat(-c,"px)")}else n.style.transform=""}}),[i,l,o,n]);var d=function(){at.clear()};Object(p.useEffect)((function(){var e,t;return m(null===(e=a.current)||void 0===e||null===(t=e.closest(".app"))||void 0===t?void 0:t.getBoundingClientRect()),window.addEventListener("resize",d),function(){window.removeEventListener("resize",d)}}),[]);var v=0,h=0,g="";if(l)switch(o){case aa.bottom:v=n.left-l.left+n.width/2,h=n.top-l.top+n.height,g="tooltip-bottom";break;case aa.top:v=n.left-l.left+n.width/2,h=n.top-l.top,g="tooltip-top"}return f.a.createElement("div",{className:"tooltip ".concat(g),style:{left:v,opacity:0,top:h},ref:a},f.a.createElement("div",{className:"tooltip-arrow"}),f.a.createElement("div",{className:"tooltip-content"},t))},Oa=(n(471),function(e){var t=e.traitDefinition;return p.createElement("div",{className:"trait-context"},p.createElement("div",{className:"description"},x.a.getTraitDescription(t.trait)),t.hasEffect&&p.createElement("div",{className:"effect"},x.a.getTraitEffect(t.trait)))}),ja=function(){var e=Object(p.useState)(),t=Object(j.a)(e,2),n=t[0],a=t[1],r=function(e){a(e)};if(Object(p.useEffect)((function(){return at.addEventListener(at.EVENT_CONTEXT_UPDATED,r),function(){at.removeEventListener(at.EVENT_CONTEXT_UPDATED,r)}}),[]),!n)return null;var c=n.info,o=n.type;return f.a.createElement(ya,{referenceRect:n.referenceRect},f.a.createElement("div",{className:"context-tooltip"},function(){switch(o){case Ye.resource:var e=x.a.getResourceName(c);return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"name resource"},e),f.a.createElement(ba,{info:c}));case Ye.item:var t=x.a.getItemName(c.item),a=c,r="name item ".concat(Object(Rt.c)(a));return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"".concat(r)},t),f.a.createElement(ga,{info:a}));case Ye.trait:var i=c,u=x.a.getTraitName(i.trait);return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"name trait"},x.a.get("ui-tooltip-type-trait"),u),f.a.createElement(Oa,{traitDefinition:i}));case Ye.skill:var s=c,l=x.a.getSkillName(s);return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"name skill"},x.a.get("ui-tooltip-type-skill"),l),x.a.getSkillInfo(s));default:throw new Error("Unknown context type ".concat(n.type))}}()))},wa=(n(472),function(){Object(p.useRef)();var e=Object(p.useRef)(new z.Filter("",ka,Ea));return Object(p.useEffect)((function(){requestAnimationFrame((function t(n){e.current.uniforms.time=(n||0)/1e3,requestAnimationFrame(t)}))}),[]),null}),Ea={resolution:{type:"2f",value:{x:window.innerWidth,y:window.innerHeight}},alpha:{type:"1f",value:1},shift:{type:"1f",value:1.6},time:{type:"1f",value:0},speed:{type:"2f",value:{x:.7,y:.4}}},ka="\n    precision mediump float;\n    uniform vec2      resolution;\n    uniform float     time;\n    uniform float     alpha;\n    uniform vec2      speed;\n    uniform float     shift;\n\n    float rand(vec2 n) {\n        return fract(cos(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n    }\n\n    float noise(vec2 n) {\n    const vec2 d = vec2(0.0, 1.0);\n    vec2 b = floor(n), f = smoothstep(vec2(0.0), vec2(1.0), fract(n));\n        return mix(mix(rand(b), rand(b + d.yx), f.x), mix(rand(b + d.xy), rand(b + d.yy), f.x), f.y);\n    }\n\n    float fbm(vec2 n) {\n    float total = 0.0, amplitude = 1.0;\n    for (int i = 0; i < 4; i++) {\n        total += noise(n) * amplitude;\n        n += n;\n        amplitude *= 0.5;\n    }\n\n    return total;\n    }\n\n    void main() {\n    const vec3 c1 = vec3(126.0/255.0, 0.0/255.0, 97.0/255.0);\n    const vec3 c2 = vec3(173.0/255.0, 0.0/255.0, 161.4/255.0);\n    const vec3 c3 = vec3(0.2, 0.0, 0.0);\n    const vec3 c4 = vec3(164.0/255.0, 1.0/255.0, 214.4/255.0);\n    const vec3 c5 = vec3(0.1);\n    const vec3 c6 = vec3(0.9);\n\n    vec2 p = gl_FragCoord.xy * 8.0 / resolution.xx;\n    float q = fbm(p - time * 0.1);\n    vec2 r = vec2(fbm(p + q + time * speed.x - p.x - p.y), fbm(p + q - time * speed.y));\n    vec3 c = mix(c1, c2, fbm(p + r)) + mix(c3, c4, r.x) - mix(c5, c6, r.y);\n    float grad = gl_FragCoord.y / resolution.y;\n    gl_FragColor = vec4(c * cos(shift * gl_FragCoord.y / resolution.y), 1.0);\n    gl_FragColor.xyz *= 1.0-grad;\n    }\n",Na=["sound/fx/button-click.ogg","sound/fx/error.ogg","sound/fx/toast.ogg","sound/music/Soliloquy.mp3","sound/music/TheLoomingBattle.ogg"],Ta=n(30),Ia=function(e,t){if(t>6)throw new Error("Cannot possibly have more than ".concat(6," on one item!"));return e-.1*e*(t-1)},Sa=(n(473),function(e){var t;return t=null==e.max?e.value:p.createElement("span",null,e.value," / ",p.createElement("span",{className:"max"},e.max)),p.createElement("div",{className:"updownvalue"},p.createElement("label",null," ",e.label),t,p.createElement("i",{className:"arrow up"+(e.upDisabled?" disabled":""),onClick:function(t){e.onUp&&!e.upDisabled&&e.onUp(t)}}),p.createElement("i",{className:"arrow down"+(e.downDisabled?" disabled":""),onClick:function(t){e.onDown&&!e.downDisabled&&e.onDown(t)}}))}),xa=(n(474),function(e){return f.a.createElement("div",{className:"structureview-header structureview-header-".concat(e.structure)})}),Ca=function(e){var t=e.resources,n=ot(),a=Object(p.useMemo)((function(){return Object.keys(t).reduce((function(e,a){return e[a]=n[a]>=t[a],e}),{})}),[t,n]),r=(e.className||"")+" resourcesbox",c=Object.keys(e.resources).map((function(t){var n="resource";a&&!a[t]&&(n+=" insufficient");var r=He.b[t];if(!r)throw new Error("No resource description found for ".concat(t));return p.createElement("li",{className:n,key:t},p.createElement("div",{className:"icon",style:{backgroundImage:"url(".concat(".").concat(r.iconImg,")")}}),p.createElement("div",{className:"name"},x.a.getResourceName(t)),p.createElement("div",{className:"amount"},e.resources[t]))}));return p.createElement("ul",{className:r},c)},qa=(n(475),n(476),function(e){var t=e.items,n=(e.className||"")+" items-box",a=t.reduce((function(e,t){return e[t]||(e[t]=0),e[t]++,e}),{}),r=Xt(),c=Object(p.useMemo)((function(){var e=Object(o.a)(r),n=[];return t.forEach((function(t){var a=e.findIndex((function(e){return e===t}));if(a>-1){var r=e.splice(a,1),c=Object(j.a)(r,1)[0];c&&n.push(c)}})),n}),[t,r]),i=Object.keys(a).map((function(e){var t=e,n=a[e],r="item";n>(c?c.filter((function(e){return e===t})).length:0)&&(r+=" missing");var o=Re.a[t];return p.createElement("li",{className:r,key:t},p.createElement("div",{className:"icon ".concat(lt(rt.smallest)),style:{backgroundImage:"url(".concat(".").concat(o.iconImg,")")}}),p.createElement("div",{className:"name"},"".concat(x.a.getItemName(t)," (").concat(n,")")))}));return p.createElement("ul",{className:n},i)}),Aa=function(e){var t=e.structure,n=Object(p.useState)(),a=Object(j.a)(n,2),r=a[0],c=a[1],o=Object(p.useState)(0),i=Object(j.a)(o,2),u=i[0],s=i[1],l=Object(h.d)(),m=ct(),d=Yn(t),f=ot(),v=Xt(),g=st(),y=la(t),O=ma(t),w=Object(W.b)(e.structure);if(!w)throw new Error("No definition found for structure ".concat(e.structure,"\n            with type ProductionStructureDefinition."));var E=d.level,k=Yn(t),N=x.a.getStructureName(e.structure),T=function(e,n){var a,r=Ia(e.cost.time||0,n);l((a=e.cost.resources||{},{type:Te.removeResources,resources:a})),l(Qe(t,n));var c=[ze(e.item),Qe(t,n)],o=Xn(Un.craftItem,e.item,"".concat(t,".craft"),r,c);l(o)};return p.createElement(p.Fragment,null,p.createElement(xa,{structure:e.structure}),p.createElement("details",{open:!0,className:"production-structure-view"},p.createElement("summary",null,N),p.createElement("section",null,function(){var e=w.levels[E+1],n=null!=e?e.cost.gold||0:-1,a=null!=e&&m>=n,r=null==e?x.a.get("ui-structure-upgrade-max"):x.a.get("ui-structure-upgrade",{cost:n,level:E+2});return p.createElement("div",null,p.createElement("label",null,x.a.get("ui-structure-level")),"".concat(E+1," / ").concat(w.levels.length),p.createElement(Se,{className:"upgrade",onClick:function(){var e;e=n,l(Object(Ue.c)(e)),l(Fe(t)),l(Object(b.c)("log-town-upgrade-structure-complete",{level:E+1,structure:t},Me.a.town))},disabled:!a},r))}(),p.createElement("div",null,"craft:"),p.createElement("div",{className:"crafting-area"},p.createElement("ul",{className:"vertical-tab-bar"},k.produces.map((function(e){return p.createElement("li",{key:"craft".concat(e),onClick:function(t){t.stopPropagation(),c(e)},className:r===e?"selected":""},p.createElement(Pt,{item:e}),x.a.getItemName(e))}))),function(){var e=r;if(!e)return null;var t=ua(e),n=t.cost.resources,a=Object.keys(n).some((function(e){return n[e]>f[e]})),c=!1,o=t.cost.materials;o&&(c=o.some((function(e){return-1===v.indexOf(e)})));var i=a||c||u<1;return p.createElement("div",{className:"crafting-details"},x.a.get("ui-structure-production-craft-a",{item:e}),p.createElement("div",{className:"crafting-costs"},p.createElement("fieldset",null,p.createElement(Ca,{resources:n})),p.createElement("fieldset",null,o&&p.createElement(qa,{items:o}))),p.createElement("div",{className:"buttonrow"},p.createElement("div",null,p.createElement(Sa,{value:u,label:x.a.get("ui-structure-production-workers"),onUp:function(e){e.stopPropagation(),s(u+1)},onDown:function(e){e.stopPropagation(),s(u-1)},upDisabled:u>=g||u>=6,downDisabled:u<1}),function(e){if(0===u)return"";var t=Ia(e,u),n=Object($n.e)(t);return x.a.get("ui-structure-production-crafting-time",{time:n})}(t.cost.time||0)),p.createElement("div",null,p.createElement(Se,{disabled:i,className:"craft",onClick:function(e){e.stopPropagation(),T(t,u),s(0)}},x.a.get("ui-structure-production-craft")))))}()),p.createElement("fieldset",null,p.createElement("legend",null,x.a.get("ui-structure-production-crafting")),y.map((function(e){return p.createElement(rn,{key:"".concat(e.name).concat(e.startTime),label:"".concat(e.name," (").concat(Object($n.e)(e.timeRemaining),")"),progress:e.progress})}))),O.length>0&&p.createElement("fieldset",null,p.createElement("legend",null,x.a.get("ui-structure-production-studying")),O.map((function(e){return p.createElement(rn,{key:"".concat(e.name).concat(e.startTime),label:"".concat(e.name," (").concat(Object($n.e)(e.timeRemaining),")"),progress:e.progress})}))))))},Da=oe((function(e){var t=e.sufficientResources,n=e.resources,a=e.deltaResources,r=Object(h.e)((function(e){return e.structures})),c=(e.className||"")+" resourcesbox",o=Object.keys(n).map((function(n){var c="resource";t&&!t[n]&&(c+=" insufficient");var o,i=He.b[n],u=e.resources[n];if(!i)throw new Error("No resource description found for ".concat(n));a[n]&&(o=p.createElement("span",{className:"animate-up"},"+ ".concat(a[n].toFixed(2))));var s=Object(W.c)(He.a[n]);return p.createElement("li",{className:c,key:n},p.createElement("div",{className:"icon ".concat(lt(rt.smallest)),style:{backgroundImage:"url(".concat(".").concat(i.iconImg,")")}}),p.createElement("div",{className:"name"},x.a.getResourceName(n)),p.createElement("div",{className:"amount"},u.toFixed(1)),p.createElement("div",{className:"max"}," / ".concat(e.maxResources[n])),p.createElement("div",{className:"delta"},o),p.createElement("div",{className:"structure"},"source:",r[s].state===R.Built?p.createElement(k.b,{to:Object(F.b)(s),onClick:function(){e.onCloseWindow()}},x.a.getStructureName(s)):x.a.getStructureName(s)))}));return p.createElement("ul",{className:c},o)})),Ra=function(e){var t=Object(p.useRef)();return Object(p.useEffect)((function(){t.current=e})),t.current},Pa={fabric:0,food:0,iron:10,leather:0,stone:0,wood:10},Ma={fabric:0,food:0,iron:0,leather:0,stone:0,wood:0},Ha=function(){var e=Object(h.d)();return{startUpgradeStructure:function(t,n,a){e(Object(Ue.c)(t)),e(Fe(a)),e(Object(b.c)("log-town-upgrade-structure-complete",{level:n,structure:a},Me.a.town))}}},La=(n(477),function(e){var t=Ft(e.adventurerId),n=Kt(),a=n.dropItemEquipment,r=n.dropItemInventory,c=function(e){var n=t.equipment[At.a[e]],r=null;if(n){var c=p.createRef();r=p.createElement(Lt,{index:e,sourceId:t.id,sourceType:qt.a.adventurerEquipment,item:n,onClick:function(e){var t=e.currentTarget.getBoundingClientRect();at.showContextTooltip(Ye.item,Object(Re.b)(n),t),e.stopPropagation()},ref:c,size:rt.medium})}return p.createElement(p.Fragment,null,p.createElement(At.b,{onDrop:function(n){return function(e,n){a(e,n,t)}(n,e)},type:e},r),p.createElement("span",{className:"info"},x.a.getEquipmentSlot(e)))},o=p.createElement("ul",null,p.createElement("li",null,c(At.a.head)),p.createElement("li",null,c(At.a.shoulders)),p.createElement("li",null,c(At.a.chest)),p.createElement("li",null,c(At.a.hands)),p.createElement("li",null,c(At.a.legs)),p.createElement("li",null,c(At.a.feet)),p.createElement("li",null,c(At.a.mainHand)),p.createElement("li",null,c(At.a.offHand)));return p.createElement("div",{className:"adventurer-info"},p.createElement("div",{className:"left"},p.createElement("div",{className:"name"},p.createElement("b",null,t.name)),p.createElement(cn,{xp:t.xp}),p.createElement("div",{className:"attributes"},Object.keys(t.basicAttributes).map((function(e){var n=t.basicAttributes[e];return p.createElement("div",{key:"".concat(t.id,"-").concat(e)},p.createElement("b",null,e),": ",n.toFixed(1))}))),p.createElement("div",{className:"equipment"},o)),p.createElement("div",{className:"right"},p.createElement(Ut,{sourceType:qt.a.adventurerInventory,sourceId:t.id,items:t.inventory,onDropItem:function(e,n,a,c,o){r(e,n,a,c,t,o)}})))}),Wa=(n(478),qt.a.warehouse),Va=function(e){var t=Object(p.useState)(),n=Object(j.a)(t,2),a=n[0],r=n[1],c=ot(),o=Object(p.useState)(Ma),i=Object(j.a)(o,2),u=i[0],s=i[1],l=Ra(c),m=Object(p.useRef)(null),d=ct(),f=Xt(),v=Object(h.e)((function(e){return e.structures})),g=Ha().startUpgradeStructure,b=Vt(),y=Kt().dropItemWarehouse;Object(p.useEffect)((function(){var e=Object.keys(c).reduce((function(e,t){return l&&l[t]&&(e[t]=c[t]-l[t]),e}),{});s(e)}),[c,l]),Object(p.useEffect)((function(){if(m.current){var e=m.current;e.classList.remove("animate"),setTimeout((function(){m&&e.classList.add("animate")}),200)}}),[u]);var O=Object(W.b)(W.a.warehouse);if(!O)throw new Error("No definition found for structure ".concat(W.a.warehouse," with type StructureDefinition."));var w=Yn(W.a.warehouse),E=O.levels[w.level],k=w.level,N=x.a.getStructureName(W.a.warehouse);return p.createElement("details",{open:!0,className:"warehouse-structureview"},p.createElement("summary",null,N),function(){var e=O.levels[k+1],t=null!=e?e.cost.gold||0:-1,n=null!=e&&d>=t,a=null==e?x.a.get("ui-structure-upgrade-max"):x.a.get("ui-structure-upgrade",{cost:t,level:k+2});return p.createElement("div",null,p.createElement("label",null,x.a.get("ui-structure-level")),"".concat(k+1," / ").concat(O.levels.length),p.createElement(Se,{className:"upgrade",onClick:function(e){g(t,k+1,W.a.warehouse)},disabled:!n},a))}(),p.createElement("fieldset",{className:"resources",ref:m},p.createElement("legend",null,"Resources"),p.createElement(Da,{resources:c,structures:v,maxResources:E.maxResources,deltaResources:u})),p.createElement("h3",null,"Stockpile"),p.createElement(Ut,{sourceType:Wa,items:f,onDropItem:function(e,t,n,a,r){y(e,t,n,a,r)}}),p.createElement("h3",null,"Adventurers"),p.createElement("div",null,p.createElement(It,{adventurers:b,selectedAdventurerId:a,onAdventurerTabSelected:function(e){r(e)}}),p.createElement("div",{className:"adventurer-inventory"},a?p.createElement(La,{adventurerId:a}):null)))},Fa=(n(479),n(480),Object(Dt.DropTarget)(qt.b.ADVENTURER,{drop:function(e,t){e.onDrop(t.getItem())},canDrop:function(e,t){return!0}},(function(e,t){return{canDrop:t.canDrop(),connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))((function(e){var t=e.isOver,n=e.canDrop,a="droppable-adventurer-slot";return t?a+=" active-drop":n&&(a+=" can-drop"),(0,e.connectDropTarget)(p.createElement("div",{className:a}))}))),Qa=function(e){return p.createElement("ul",{className:"assign-adventurers"},function(){for(var t=[],n=function(n){var a=void 0,r="";if(!!e.assignedAventurers[n]){var c=e.assignedAventurers[n];a=p.createElement(Tt,{adventurer:c,displayName:!1,onClick:function(){return e.onAdventurerClicked(c)}}),r="has-adventurer"}else a=p.createElement(Fa,{onDrop:function(t){e.onAdventurerDropped(t,n)}});t.push(p.createElement("li",{key:"slot".concat(n),className:r},a))},a=0;a<e.availableSlots;a++)n(a);return t}())},_a=(n(481),function(e){var t=Object(h.e)((function(e){return e.stockpile})),n=function(e){return!e.requiredItems||e.requiredItems.every((function(n){var a=e.requiredItems.filter((function(e){return e===n})).length;return t.filter((function(e){return e===n})).length>=a}))};return p.createElement("div",{className:"quest-board"},p.createElement("h2",null,x.a.get("structure-tavern-title-quest-board")),p.createElement("ul",{className:"quest-list"},e.availableQuests.map((function(t){var n="quest ".concat(t.name===e.selectedQuestName?" selected":"");return p.createElement("li",{key:t.name,className:n,onClick:function(){e.onQuestClick(t.name)}},p.createElement("div",{className:"icon",style:{backgroundImage:"url(".concat(".",")")}}),p.createElement("div",{className:"title"},x.a.getQuestTitle(t.name)," "))}))),function(){if(!e.selectedQuestName)return null;var t=e.availableQuests.find((function(t){return t.name===e.selectedQuestName}));if(!t)return p.createElement("div",null," ",x.a.get("structure-tavern-quest-launched")," ");var a=Object(yt.b)(t.name),r=e.assignedAventurers.filter((function(e){return null!==e})).length>=3,c=n(a),o=r&&c;return p.createElement("div",{className:"quest-details"},x.a.getQuestDescription(e.selectedQuestName),p.createElement(Qa,{availableSlots:5,assignedAventurers:e.assignedAventurers,onAdventurerClicked:e.onRemoveAdventurer,onAdventurerDropped:e.onAdventurerDropped}),p.createElement(qa,{items:a.requiredItems||[]}),p.createElement(Se,{disabled:!o,onClick:function(){return e.onLaunchQuest()}},x.a.get("structure-tavern-button-launch-quest")))}())}),Ba=(n(482),function(e){var t=e.adventurer,n=e.assignedAventurers,a=e.questName,r=e.onAddAdventurer,c=e.onRemoveAdventurer,o=n.indexOf(t)>-1,i=x.a.getQuestTitle(a);return o?p.createElement(Se,{onClick:function(){c(t)},className:"adventurer-button"},x.a.get("structure-tavern-button-leave-quest")):5===n.filter(Boolean).length?p.createElement(Se,{disabled:!0,className:"adventurer-button"},x.a.get("structure-tavern-button-join-quest-full-party")):p.createElement(Se,{onClick:function(){var e=Ga(n);r(t,e)},className:"adventurer-button"},x.a.get("structure-tavern-button-join-quest",{quest:i}))}),Ga=function(e){for(var t=0;t<5;t++)if(!e[t])return t;return 0},Ua=(n(483),{beginDrag:function(e){return{adventurer:e.adventurer,sourceId:e.sourceId,sourceType:qt.a.adventurerInventory}}});var za,Xa=Object(Dt.DragSource)(qt.b.ADVENTURER,Ua,(function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}}))((function(e){var t=e.isDragging,n=e.connectDragSource,a="draggable-adventurer-avatar";return e.disabled&&(a+=" disabled"),t&&(a+=" dragging"),n(p.createElement("div",{className:a},p.createElement(Tt,e)))})),Ya=function(e){var t=e.adventurer,n=e.onQuest,a=e.assignedAventurers,r=e.expanded,c=e.selectedQuestName,o=e.onClick,i=e.onAddAdventurer,u=e.onRemoveAdventurer,s=a.indexOf(t)>-1;return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"room ".concat(r?"expanded":"")},f.a.createElement(Xa,{disabled:s||n,adventurer:t,className:"adventurer-icon",sourceId:Ka,key:"avatar:".concat(t.id)}),f.a.createElement("span",{key:t.id,onClick:function(){return o(t)}},t.name,n&&x.a.get("structure-tavern-on-a-quest"))),r&&f.a.createElement("div",{className:"adventurer-details"},f.a.createElement(un,{adventurer:t}),!n&&c&&f.a.createElement(Ba,{adventurer:t,assignedAventurers:a,questName:c,onAddAdventurer:i,onRemoveAdventurer:u})))},Za=function(){return f.a.createElement("div",{className:"room"},"(empty room)")},Ja=function(e){for(var t=e.roomCount,n=e.adventurers,a=e.assignedAventurers,r=e.selectedQuestName,c=e.onAddAdventurer,o=e.onRemoveAdventurer,i=Object(p.useState)(),u=Object(j.a)(i,2),s=u[0],l=u[1],m=function(e){s===e.id?l(void 0):l(e.id)},d=[],v=function(t){var i=n.find((function(e){return e.room===t}));if(!i)return d.push(f.a.createElement(Za,{key:"room".concat(t)})),"continue";var u,l=(u=i.id,!!Object.values(e.quests).find((function(e){return e.party.indexOf(u)>-1})));d.push(f.a.createElement(Ya,{key:i.id,adventurer:i,assignedAventurers:a,selectedQuestName:r,expanded:s===i.id,onQuest:l,onClick:m,onAddAdventurer:c,onRemoveAdventurer:o}))},h=0;h<t;h++)v(h);return f.a.createElement("div",{className:"rooms"},f.a.createElement("h2",null,"Rooms"),d)},Ka=(n(484),"tavern"),$a=function(e){var t=ct(),n=Yn(W.a.tavern).level,a=Object(h.e)((function(e){return e.adventurers})),r=Object(h.e)((function(e){return e.quests})),c=Object(p.useState)([]),i=Object(j.a)(c,2),u=i[0],s=i[1],l=Object(p.useState)(),m=Object(j.a)(l,2),d=m[0],f=m[1],v=Object(W.b)(W.a.tavern),g=v.levels[n],y=x.a.getStructureName(W.a.tavern),O=Object(h.d)(),w=r.filter((function(e){return e.status===ft.available})),E=function(e,t){var n=Object(o.a)(u);n[t]=e,s(n)},k=function(e){var t=u.indexOf(e),n=Object(o.a)(u);delete n[t],s(n)},N=function(){var e,t=x.a.getQuestTitle(d),n=u[0];Ee.a.addToast(t,ke.a.questLaunched,null===n||void 0===n?void 0:n.avatarImg,Object(F.a)(d)),e=d,O(Object(bn.f)(e,u))};return p.createElement("details",{open:!0,className:"tavernstructureview"},p.createElement("summary",null,y),function(){var e=v.levels[n+1],a=null!=e?e.cost.gold||0:-1,r=null!=e&&t>=a,c=null==e?x.a.get("ui-structure-upgrade-max"):x.a.get("ui-structure-upgrade",{cost:a,level:n+2});return p.createElement("div",null,p.createElement("label",null,x.a.get("ui-structure-level")),"".concat(n+1," / ").concat(v.levels.length),p.createElement(Se,{className:"upgrade",onClick:function(e){var t;t=a,O(Object(Ue.c)(t)),O(Fe(W.a.tavern)),O(Object(b.c)("log-town-upgrade-structure-complete",{level:n+1,structure:W.a.tavern},Me.a.town))},disabled:!r},c))}(),p.createElement("section",null,p.createElement(Ja,{roomCount:g.rooms,adventurers:a,assignedAventurers:u,quests:r,selectedQuestName:d,onAddAdventurer:E,onRemoveAdventurer:k}),p.createElement(_a,{availableQuests:w,selectedQuestName:d,assignedAventurers:u,onQuestClick:function(e){return function(e){f(d===e?void 0:e),s([])}(e)},onAdventurerDropped:function(e,t){e.sourceId===Ka&&E(e.adventurer,t)},onRemoveAdventurer:k,onLaunchQuest:function(){return N()}})))},er=(n(485),function(e){var t=Object(h.e)((function(e){return e.gold})),n=Object(h.e)((function(t){var n=t.structures[e.type];if(!n)throw new Error("No structure '".concat(e.type,"' found in the store!"));return n.level})),a=Object(h.e)((function(t){var n=t.structures[e.type];if(!n)throw new Error("No structure '".concat(e.type,"' found in the store!"));return n.workers})),r=Object(h.e)((function(e){return ut(e)})),c=Object(W.b)(e.type);if(!c)throw new Error("No definition found for structure ".concat(e.type," with type ResourceStructureDefinition."));var o=Ha().startUpgradeStructure,i=Object(h.d)(),u=function(){i(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return{type:Ie.decreaseWorkers,structure:e,workers:t}}(e.type))},s=function(){i(Qe(e.type))},l=c.levels[n];return p.createElement(p.Fragment,null,p.createElement(xa,{structure:e.type}),p.createElement("details",{open:!0,className:"resource-structure-view"},p.createElement("section",null,function(){var e=a===l.workerCapacity||(r||0)<1,t=0===a;return p.createElement(Sa,{label:x.a.get("ui-structure-production-workers"),value:a,max:l.workerCapacity,upDisabled:e,downDisabled:t,onDown:u,onUp:s})}(),function(){var a=c.levels[n+1],r=null!=a?a.cost.gold||0:-1,i=null!=a&&t>=r,u=null==a?x.a.get("ui-structure-upgrade-max"):x.a.get("ui-structure-upgrade",{cost:r,level:n+2});return p.createElement("div",null,p.createElement("label",null,x.a.get("ui-structure-level")),n+1+" / "+c.levels.length,p.createElement(Se,{className:"upgrade",onClick:function(){o(r,n+1,e.type)},disabled:!i},u))}(),function(){var e=l.generates,t=Object.keys(e).reduce((function(t,n){return e[n]&&t.push("".concat(e[n]," x ").concat(a," = ").concat(e[n]*(a||0)," ").concat(n)),t}),[]).join(",");return p.createElement("div",null,"Generates (every minute): ",p.createElement("br",null),t)}())))}),tr=(n(486),Ce((function(e){var t=Object(h.e)((function(e){return e.tasks})).running.filter((function(t){return"town"===t.origin&&t.name==="".concat(e.structure,".build")}))[0],n=Yn(e.structure);return p.createElement("div",{className:"structure-details"},function(){if(n.state===R.Building)return t?p.createElement("div",{className:"building"},p.createElement(rn,{progress:t.progress,label:"Building... (".concat(Object($n.e)(t.timeRemaining),")")})):null;switch(Object(W.b)(e.structure).type){case Ta.a.production:return p.createElement(Aa,{structure:e.structure});case Ta.a.resource:return p.createElement(er,{type:e.structure});case Ta.a.warehouse:return p.createElement(Va,null);case Ta.a.tavern:return p.createElement($a,null);default:return p.createElement("div",null," ",e.structure," ")}}())})));n(487);T.a.registerPIXI(PIXI),I.b.registerPlugin(T.a),function(e){e[e.Town=0]="Town",e[e.World=1]="World"}(za||(za={}));var nr=960,ar=Object(p.createContext)(null),rr=function(e){var t=Object(p.useRef)(null),n=Object(p.useState)([]),a=Object(j.a)(n,2),r=a[0],c=a[1],i=Object(p.useState)([]),u=Object(j.a)(i,2),s=u[0],l=u[1],m=function(){S.c.playSound(S.b.buttonClick)},d=function(e){if(e){var t=x.a.getStructureName(e);f(p.createElement(tr,{structure:e,title:t})),S.c.playSound(S.b.buttonClick)}},f=function(e){l([].concat(Object(o.a)(s||[]),[e]))},v=function(){l([])},h=function(){s&&s.length&&l(s.slice(0,-1))};return Object(p.useEffect)((function(){var e=q()((function(){at.clear()}),100);return window.addEventListener("scroll",e),window.addEventListener("wheel",e),function(){window.removeEventListener("resize",e),window.removeEventListener("wheel",e)}}),[]),p.createElement(ar.Provider,{value:{media:r,onOpenWindow:f,onCloseWindow:v}},p.createElement(wa,null),p.createElement("div",{className:"app",ref:t,style:{maxWidth:nr},onClick:function(){at.clear()}},p.createElement(w.a,{backend:E.a},p.createElement(k.a,null,p.createElement(L,{manifest:Na,onLoadComplete:function(e){var t,n=e.filter((function(e){return e.mediaType===g.sound}));S.c.loadMedia(n),S.c.addSounds((t={},Object(O.a)(t,S.b.buttonClick,"sound/fx/button-click.ogg"),Object(O.a)(t,S.b.error,"sound/fx/error.ogg"),Object(O.a)(t,S.b.toast,"sound/fx/toast.ogg"),t)),c(e)}},p.createElement(dt,{persistor:e.persistor}),p.createElement("div",{style:{margin:"4px 0 0 8px"}},p.createElement(N.d,null,p.createElement(N.b,{path:"/",exact:!0},p.createElement(N.a,{from:"/",to:Object(F.d)()})),p.createElement(N.b,{path:Object(F.d)()},p.createElement(k.b,{to:Object(F.c)()},p.createElement(Se,{onClick:function(){return m()},color:"green"}," ",x.a.get("ui-view-button-town")," "))),p.createElement(N.b,{path:Object(F.c)()},p.createElement(k.b,{to:Object(F.d)()},p.createElement(Se,{onClick:function(){return m()}}," ",x.a.get("ui-view-button-world")," "))))," | ",p.createElement(Se,{onClick:function(){cc()},color:_.purple}," Restart! ")),p.createElement(N.d,null,p.createElement(N.b,{path:Object(F.c)(),render:function(){return p.createElement(Oe,{onStructureClick:d})}}),p.createElement(N.b,{path:Object(F.d)(),render:function(){return p.createElement(Bn,null)}})),p.createElement(zn,null),function(){if(!s.length)return null;var e=s[s.length-1],t={onClose:v,onBack:h,backEnabled:s.length>1,closeEnabled:!0};return p.cloneElement(e,t)}(),p.createElement(ja,null),p.createElement(Ne,null))))))};var cr,or=Object(h.c)((function(e,t){return{}}),(function(e,t){return{}}))(rr),ir=function(e){var t=Object(W.b)(W.a.warehouse),n=e.structures[W.a.warehouse].level;return t.levels[n].maxResources},ur=function(e,t){var n=t.structures,a={},r=(Date.now()-e)/2e4,c=ir(t);return r<1?null:(Object.keys(n).forEach((function(e){return function(e){var t=Object(W.b)(e);if(t.type===Ta.a.resource){var c=t,o=n[e].level,i=c.levels[o];Object.keys(i.generates).reduce((function(t,a){var c=i.generates[a]*n[e].workers*r;return t[a]=(t[a]||0)+c,t}),a)}}(e)})),Object.keys(a).forEach((function(e){a[e]&&t.resources[e]+a[e]>=c[e]&&(a[e]=c[e]-t.resources[e])})),a)},sr=function(e,t){var n=[],a=[],r=t.getState();return r.quests.forEach((function(c){if(c.status===ft.active){var o=yt.a[c.name],i=c.progress,u=Math.floor(i);if(o.nodes[u].type===pt.a.nothing){for(var s=e/6e4*4,l=Math.min(i+s,o.nodes.length-1),m=Math.floor(l)-u,d=1;d<=m;d++){var p=o.nodes[u+d];if(p.type===pt.a.encounter){t.dispatch(Object(bn.i)(c.name,p.startScene));var f=x.a.getQuestTitle(c.name),v=Object(ht.c)(r.adventurers,c);Ee.a.addToast(f,ke.a.questEncounter,null===v||void 0===v?void 0:v.avatarImg,Object(F.a)(c.name)),p.log&&n.push({channel:Me.a.quest,channelContext:c.name,key:p.log});break}p.type===pt.a.nothing&&p.log&&n.push({channel:Me.a.quest,channelContext:c.name,key:p.log})}a.push({name:c.name,progress:l})}}})),{logUpdates:n,questUpdates:a}},lr=n(262),mr=n.n(lr);var dr,pr,fr,vr=!1,hr=function(){return vr?(vr=!1,cr.state()):null},gr=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function br(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");gr?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):yr(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):yr(e)}))}}function yr(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var Or,jr,wr,Er=function(){return{strength:Math.floor(3*Math.random())+9,dexterity:Math.floor(3*Math.random())+9,intelligence:Math.floor(3*Math.random())+9,health:Math.floor(3*Math.random())+9}},kr=[{id:"c4a5d270",equipment:{head:Pe.a.cowl,chest:Pe.a.chest,hands:Pe.a.clothGloves,shoulders:Pe.a.shoulders2,legs:Pe.a.pants2,feet:Pe.a.boots3,offHand:Pe.a.indomitableCarapace},basicAttributes:Er(),health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:0,name:"Ximena Maddox",traits:[Mt.houseMaddox,Mt.gloomy],avatarImg:"".concat("img/avatars","/female/f_14.png"),spritesheetPath:"".concat("img/scene/actors/","archer.json"),skills:(dr={},Object(O.a)(dr,tn.c.crossbow,10),Object(O.a)(dr,tn.c.bow,10),dr),inventory:[Pe.a.deedForLumbermill,null,Pe.a.simpleCrossbow,Pe.a.dagger,Pe.a.khopesh,null,Pe.a.sword,null,null,null,null,Pe.a.steelShield,null,null,null,null]},{id:"2e655832",equipment:{feet:Pe.a.boots2},basicAttributes:Er(),name:"Donte Houston",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:1,avatarImg:"".concat("img/avatars","/male/m_05.png"),spritesheetPath:"".concat("img/scene/actors/","footman.json"),traits:[Mt.houseHouston],skills:(pr={},Object(O.a)(pr,tn.c.crossbow,12),Object(O.a)(pr,tn.c.staff,13),pr),inventory:[Pe.a.simpleCrossbow,null,null,null,null,Pe.a.boots1,Pe.a.chainmailHood,Pe.a.nomadHelmet,Pe.a.plateChest4,null,Pe.a.buckler,null,null,null,null,null,null,null,null,null,null,null,Pe.a.plateHelmet,Pe.a.cowl]},{id:"ec6f1050",equipment:{feet:Pe.a.boots3,offHand:Pe.a.aegisOfValor},basicAttributes:Er(),name:"Zackary 'bone bag' Morris",health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:2,traits:[Mt.gloomy],skills:(fr={},Object(O.a)(fr,tn.c.sword,12),Object(O.a)(fr,tn.c.hammer,6),fr),avatarImg:"".concat("img/avatars","/male/m_09.png"),spritesheetPath:"".concat("img/scene/actors/","skeleton.json"),inventory:[Pe.a.greatswordOfGwai,null,null,null,Pe.a.berserkerShield]},{id:"d299f98a",basicAttributes:Er(),equipment:{},name:"Mike Keith",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:4,avatarImg:"".concat("img/avatars","/male/m_19.png"),spritesheetPath:"".concat("img/scene/actors/","grunt.json"),traits:[Mt.arrowFinder],skills:Object(O.a)({},tn.c.sword,13),inventory:[null,null,null,null,Pe.a.khopesh,Pe.a.hornedHelmet,Pe.a.woodenBulwark]},{id:"96c686c3",equipment:{},basicAttributes:Er(),name:"Wayne Monroe",health:100*Math.random(),xp:100*Math.random(),baseAP:4,room:5,avatarImg:"".concat("img/avatars","/male/m_08.png"),spritesheetPath:"".concat("img/scene/actors/","grunt.json"),traits:[Mt.houseMonroe,Mt.arrowFinder],skills:Object(O.a)({},tn.c.axe,12),inventory:[null,null,null,Pe.a.goldenShield]},{id:"250d1a9d",basicAttributes:Er(),equipment:{},name:"Alexis Ortiz ",health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:9,avatarImg:"".concat("img/avatars","/female/f_10.png"),spritesheetPath:"".concat("img/scene/actors/","footman.json"),inventory:[null,null,null,null,null],skills:Object(O.a)({},tn.c.axe,10)},{id:"169384ef",equipment:{},basicAttributes:Er(),name:"Karlee Nolan",health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:3,avatarImg:"".concat("img/avatars","/female/f_16.png"),spritesheetPath:"".concat("img/scene/actors/","footman.json"),inventory:[Pe.a.greatswordOfGwai,null,null,null],skills:Object(O.a)({},tn.c.axe,10)},{id:"f22d66cb",basicAttributes:Er(),equipment:{},name:"Gylbarde the Earnest",health:100*Math.random(),xp:100*Math.random(),baseAP:5,room:8,avatarImg:"".concat("img/avatars","/male/m_09.png"),spritesheetPath:"".concat("img/scene/actors/","footman.json"),inventory:[null,null,null,null,null],skills:Object(O.a)({},tn.c.axe,13)},{id:"36c686c1",equipment:{},basicAttributes:Er(),name:"Lanslet of the Water",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:6,avatarImg:"".concat("img/avatars","/male/m_26.png"),spritesheetPath:"".concat("img/scene/actors/","footman.json"),inventory:[Pe.a.greatswordOfGwai,null,null,null,Pe.a.shoulders1,Pe.a.fedora,Pe.a.greaves2],skills:Object(O.a)({},tn.c.axe,3)},{id:"12c613d4",equipment:{},basicAttributes:Er(),name:"Tedric the Bold",health:100*Math.random(),xp:100*Math.random(),baseAP:6,room:7,avatarImg:"".concat("img/avatars","/male/m_33.png"),spritesheetPath:"".concat("img/scene/actors/","footman.json"),inventory:[Pe.a.greatswordOfGwai,null,null,null],skills:Object(O.a)({},tn.c.axe,10)}],Nr={lastTick:Date.now(),lastProducedUpdate:Date.now()},Tr=[null,null,null,Pe.a.dagger,Pe.a.deedForWeaponsmith,null,Pe.a.sandwich,Pe.a.sandwich,null,null,Pe.a.torch,Pe.a.torch,null,Pe.a.torch],Ir=function(e,t){if(!t.log.length)return e;var n=t.log.map((function(e){return Object(De.a)(Object(De.a)({},e),{},{time:Date.now()})}));return[].concat(Object(o.a)(n),Object(o.a)(e))},Sr=n(124),xr=[{name:"kill10Boars",status:ft.active,party:["c4a5d270","2e655832","ec6f1050","d299f98a"],progress:0,questVars:Sr.a,encounterResults:[],icon:"sigil1.png"},{name:"retrieveMagicAmulet",party:[],status:ft.available,progress:0,questVars:{},encounterResults:[],icon:"sigil2.png",reward:{gold:4,items:[Pe.a.deedForWeaponsmith]}}],Cr=function(e,t){var n=t.assignedAventurers.filter((function(e){return!!e})).map((function(e){return e.id}));return e.map((function(e){if(e.name===t.questName){var a=Object(yt.b)(t.questName).getInitialQuestVars(e);return Object(De.a)(Object(De.a)({},e),{},{status:ft.active,party:n,questVars:a})}return e}))},qr=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.progress+1;return Object(De.a)(Object(De.a)({},e),{},{progress:n,scene:void 0,sceneName:void 0})}return e}))},Ar=function(e,t){return e.map((function(e){return e.name===t.questName?Object(De.a)(Object(De.a)({},e),{},{sceneName:t.sceneName,scene:void 0}):e}))},Dr=function(e,t){return e.map((function(e){return e.name===t.questName?Object(De.a)(Object(De.a)({},e),{},{scene:t.scene}):e}))},Rr=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.actionQueue=[].concat(Object(o.a)(n.actionQueue||[]),[t.sceneAction]),Object(De.a)(Object(De.a)({},e),{},{scene:n})}return e}))},Pr=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");var a=n.actionQueue[0];if(!a)return e;switch(a.actionType){case mn.move:n.actors=n.actors.map((function(e){return e.name===a.actor?Object(De.a)(Object(De.a)({},e),{},{location:a.target}):e}))}return n.actionQueue=Object(o.a)(n.actionQueue.slice(1)),Object(De.a)(Object(De.a)({},e),{},{scene:n})}return e}))},Mr=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.actors=n.actors.map((function(e){if(e.name===t.actor){var n=e.ap-t.ap;return Object(De.a)(Object(De.a)({},e),{},{ap:n})}return e})),Object(De.a)(Object(De.a)({},e),{},{scene:n})}return e}))},Hr=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.scene;if(!n)throw new Error("Something broke. No scene");return n.objects=n.objects.map((function(e){return e.id===t.id?Object(De.a)(Object(De.a)({},e),t.object):e})),Object(De.a)(Object(De.a)({},e),{},{scene:n})}return e}))},Lr=function(e,t){var n=t.quests;return n.length?e.map((function(e){var t=n.find((function(t){return t.name===e.name}));if(t){var a=t.progress;return Object(De.a)(Object(De.a)({},e),{},{progress:a})}return e})):e},Wr=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=Object.assign({},e.questVars,t.vars);return Object(De.a)(Object(De.a)({},e),{},{questVars:n})}return e}))},Vr=function(e,t){return e.map((function(e){if(e.name===t.questName){var n=e.encounterResults.concat();return n[t.nodeIndex]=t.result,Object(De.a)(Object(De.a)({},e),{},{encounterResults:n})}return e}))},Fr=function(e,t){return e.map((function(e){return e.name===t.questName&&e.scene&&(e.scene.activeInteractionModal=t.sceneInteractionModal),e}))},Qr=(Or={},Object(O.a)(Or,W.a.alchemist,Object(De.a)(Object(De.a)({},B),{},{produces:[]})),Object(O.a)(Or,W.a.armoursmith,Object(De.a)(Object(De.a)({},B),{},{produces:[Pe.a.boots1]})),Object(O.a)(Or,W.a.garden,{level:0,workers:0,state:R.Built}),Object(O.a)(Or,W.a.lumberMill,B),Object(O.a)(Or,W.a.mine,{level:0,workers:0,state:R.NotBuilt}),Object(O.a)(Or,W.a.quarry,B),Object(O.a)(Or,W.a.tavern,{level:0,workers:0,state:R.Built}),Object(O.a)(Or,W.a.tannery,B),Object(O.a)(Or,W.a.warehouse,{level:0,workers:0,state:R.Built}),Object(O.a)(Or,W.a.weaponsmith,Object(De.a)(Object(De.a)({},B),{},{produces:[Pe.a.simpleCrossbow,Pe.a.dagger]})),Object(O.a)(Or,W.a.weaver,B),Object(O.a)(Or,W.a.workshop,Object(De.a)(Object(De.a)({},B),{},{produces:[Pe.a.torch,Pe.a.sandwich]})),Or),_r=function(e,t,n){var a=Object(De.a)(Object(De.a)({},e[t]),{},{state:n});return Object(De.a)(Object(De.a)({},e),{},Object(O.a)({},t,a))},Br={completed:[],running:[]},Gr=function(e){return{name:e.name,origin:e.origin,type:e.taskType,callbacks:e.callbacks,timeRemaining:e.time,startTime:Date.now(),lastTick:Date.now(),progress:0}},Ur=Object(qe.b)({adventurers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case zt.a.moveItemInInventory:var n=t,a=n.adventurerId,r=n.fromSlot,c=n.toSlot,o=e.find((function(e){return e.id===a})),i=o.inventory.map((function(e,t){return t===r?o.inventory[c]:t===c?o.inventory[r]:e}));return e.map((function(e){return e===o?Object(De.a)(Object(De.a)({},e),{},{inventory:i}):e}));case zt.a.moveItemToOtherAdventurer:var u=t,s=u.adventurerId,l=u.fromSlot,m=u.toAdventurerId,d=e.find((function(e){return e.id===s})),p=d.inventory[l];return e.map((function(e){if(e.id===s){var t=e.inventory.concat();return t[l]=null,Object(De.a)(Object(De.a)({},e),{},{inventory:t})}if(e.id===m){var n=e.inventory.concat(),a=n.findIndex((function(e){return null===e}));return n[a]=p,Object(De.a)(Object(De.a)({},e),{},{inventory:n})}return e}));case zt.a.addItemToInventory:var f=t,v=f.item;return e.map((function(e){if(e.id===t.adventurerId){var n=e.inventory.concat(),a=t.toSlot;return null!==a&&void 0!==a||(a=n.findIndex((function(e){return null===e||void 0===e}))),n[a]=v,Object(De.a)(Object(De.a)({},e),{},{inventory:n})}return e}));case zt.a.removeItemFromInventory:var h=t,g=h.fromSlot;return e.map((function(e){if(e.id===t.adventurerId){var n=e.inventory.map((function(e,t){return t!==g?e:null}));return Object(De.a)(Object(De.a)({},e),{},{inventory:n})}return e}));case zt.a.assignEquipment:var b=t,y=b.equipmentSlot,j=b.item;return e.map((function(e){return e.id===t.adventurerId?Object(De.a)(Object(De.a)({},e),{},{equipment:Object(De.a)(Object(De.a)({},e.equipment),{},Object(O.a)({},At.a[y],j))}):e}));case zt.a.removeEquipment:var w=t,E=w.equipmentSlot;return e.map((function(e){return e.id===t.adventurerId?Object(De.a)(Object(De.a)({},e),{},{equipment:Object(De.a)(Object(De.a)({},e.equipment),{},Object(O.a)({},At.a[E],null))}):e}))}return e},combat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.startCombatAction:var n=t;return Object(De.a)(Object(De.a)({},e),{},{action:{actor:n.actor,endsAt:n.endsAt,target:n.target,type:n.combatType}});case a.moveActor:var r=t,c=e.actors.map((function(e){return e.name===r.actor?Object(De.a)(Object(De.a)({},e),{},{location:r.location}):e}));return Object(De.a)(Object(De.a)({},e),{},{actors:c});case a.clearCombatAction:return Object(De.a)(Object(De.a)({},e),{},{action:void 0})}return e},engine:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case l.gameTick:var n=t.resources,a=null===n?e.lastProducedUpdate:Date.now();return Object(De.a)(Object(De.a)({},e),{},{lastProducedUpdate:a,lastTick:Date.now()})}return e},gold:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ue.a.addGold:return e+t.amount}return e},stockpile:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Be.addItem:var n=t,a=n.item,r=t,c=r.toSlot;return void 0===c&&-1===(c=e.findIndex((function(e){return null===e})))?[].concat(Object(o.a)(e),[a]):e.map((function(e,t){return t===c?a:e}));case Be.moveItemInWarehouse:var i=t,u=i.fromSlot,s=i.toSlot;return e.map((function(t,n){return n===u?e[s]:n===s?e[u]:t}));case Be.removeItem:var l=t,m=l.fromSlot;return e.map((function(e,t){return t!==m?e:null}))}return e},log:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b.a.addLogEntry:var n=t,a=n.entry,r=n.channel,c=n.channelContext,i=a.key,u=a.context,s=Date.now();return[{channel:r,channelContext:c,context:u,key:i,time:s}].concat(Object(o.a)(e));case l.gameTick:return Ir(e,t)}return e},quests:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case bn.a.launchQuest:return Cr(e,t);case bn.a.exitEncounter:return qr(e,t);case bn.a.updateQuestVars:return Wr(e,t);case bn.a.updateEncounterResult:return Vr(e,t);case bn.a.setSceneName:return Ar(e,t);case bn.a.setScene:return Dr(e,t);case bn.a.enqueueSceneAction:return Rr(e,t);case bn.a.completeSceneAction:return Pr(e,t);case bn.a.deductActorAp:return Mr(e,t);case bn.a.updateSceneObjectAction:return Hr(e,t);case bn.a.setActiveSceneInteractionModal:return Fr(e,t);case l.gameTick:return Lr(e,t)}return e},resources:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pa,t=arguments.length>1?arguments[1]:void 0,n=function(t){return Object.keys(e).reduce((function(n,a){return n[a]=e[a]+(t[a]||0),n}),{})};switch(t.type){case Te.addResources:var a=t.resources;return n(a);case Te.removeResources:var r=t.resources;return Object.keys(e).reduce((function(t,n){return t[n]=e[n]-(r[n]||0),t}),{});case l.gameTick:var c=t.resources;return null===c?e:n(c)}return e},rngState:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;return t.type===l.gameTick&&null!=t.rngState&&(e=Object.assign({},t.rngState)),e},structures:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qr,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ie.startBuildingStructure:return _r(e,t.structure,R.Building);case Ie.finishBuildingStructure:return _r(e,t.structure,R.Built);case Ie.upgradeStructure:var n=e[t.structure].level+1,a=Object(De.a)(Object(De.a)({},e[t.structure]),{},{level:n});return Object(De.a)(Object(De.a)({},e),{},Object(O.a)({},t.structure,a));case Ie.increaseWorkers:var r=t,c=r.workers,i=e[t.structure].workers+c,u=Object(De.a)(Object(De.a)({},e[t.structure]),{},{workers:i});return Object(De.a)(Object(De.a)({},e),{},Object(O.a)({},t.structure,u));case Ie.decreaseWorkers:var s=t,l=s.workers,m=e[t.structure].workers-l,d=Object(De.a)(Object(De.a)({},e[t.structure]),{},{workers:m});return Object(De.a)(Object(De.a)({},e),{},Object(O.a)({},t.structure,d));case Ie.setStructureState:var p=t,f=p.state;return _r(e,t.structure,f);case Ie.addItemToToProduces:var v=t,h=v.item,g=[].concat(Object(o.a)(e[t.structure].produces),[h]),b=Object(De.a)(Object(De.a)({},e[t.structure]),{},{produces:g});return Object(De.a)(Object(De.a)({},e),{},Object(O.a)({},t.structure,b))}return e},tasks:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Br,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Gn.start:var n=Gr(t),a=e.running.concat(n);return Object(De.a)(Object(De.a)({},e),{},{running:a});case l.gameTick:var r=Date.now(),c=[],o=[];return e.running.forEach((function(e){var t=r+e.timeRemaining,n=(r-e.startTime)/(t-e.startTime),a=e.timeRemaining-(r-e.lastTick),i=Object(De.a)(Object(De.a)({},e),{},{progress:n,lastTick:r,timeRemaining:a});a<0?o.push(i):c.push(i)})),{running:c,completed:o}}return e},workers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:13,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ge.addWorkers:return e+t.value}return e}}),zr=n(163),Xr=n(76),Yr=n.n(Xr),Zr={key:"root",storage:Yr.a,version:y},Jr=Object(zr.a)(Zr,Ur),Kr=Object(s.a)(u.a.mark((function e(){var t,n=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},e.abrupt("return",new Promise((function(e,n){var a=Object(qe.d)(Jr,t,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),r=Object(zr.b)(a,void 0,(function(){var t=Object(ht.d)(a.getState());e({store:a,persistor:r,isHydrated:t})}))})));case 2:case"end":return e.stop()}}),e)}))),$r=function(e,t){e.completed.forEach((function(e){return function(e){switch(e.callbacks.forEach((function(e){return t(e)})),e.type){case Un.craftItem:var n=e.name,a=x.a.get("common-item-crafted",{item:n}),r=Object(Re.b)(n);Ee.a.addToast(a,ke.a.itemCrafted,r.iconImg)}}(e)}))},ec=(n(496),function(){var e=Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(J.c)("".concat(".","/lang/en-US.json"));case 2:t=e.sent,x.a.init(t.data),n="GILLESROX2",vr=!0,cr=mr()(n,{state:!0}),tc();case 6:case"end":return e.stop()}var n}),e)})));return function(){return e.apply(this,arguments)}}()),tc=function(){var e=Object(s.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kr();case 2:t=e.sent,n=t.store,a=t.isHydrated,jr=t.persistor,a?ac(n):nc(n),oc(n);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),nc=function(e){console.log("STARTING NEW GAME"),e.dispatch(Object(b.c)("test-game-welcome")),console.log("Starting new GILLES-IDLE-GAME (version ".concat("0.0.5",")"))},ac=function(e){console.log("Continuing existing GILLES-IDLE-GAME (version ".concat("0.0.5",")"))},rc=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jr.purge();case 2:return e.next=4,Kr(t);case 4:n=e.sent,a=n.store,oc(a),location.href="#/world/";case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),cc=function(){confirm("Are you sure you wish to reset all your progress?")&&(clearTimeout(wr),jr.purge(),Yr.a.clear(),tc(),location.href="#/town")},oc=function(e){clearTimeout(wr),v.render(p.createElement(h.a,{store:e},p.createElement(or,{persistor:jr})),document.getElementById("root")),br();wr=setInterval((function(){var t=e.getState(),n=Date.now()-t.engine.lastTick,a=[],r=ur(t.engine.lastProducedUpdate,t),c=hr();d(n,e);var i=sr(n,e),u=i.questUpdates,s=i.logUpdates;a.push.apply(a,Object(o.a)(s)),e.dispatch(function(e,t,n,a,r){return{type:l.gameTick,delta:e,rngState:t,resources:n,quests:a,log:r}}(n,c,r,u,a)),$r(t.tasks,e.dispatch)}),2500)};ec()},498:function(e,t,n){"use strict";n.r(t),n.d(t,"DungeonEntranceSceneController",(function(){return P})),n.d(t,"DungeonHallwaySceneController",(function(){return M}));var a,r=n(20),c=n(22),o=n(81),i=n(60),u=n(38),s=n(37),l=n(32),m=n.n(l),d=n(45),p=n(8),f=n(125),v=function(e){var t=e.layers.filter((function(e){return e.type===f.a.objectgroup})),n={};return t.forEach((function(t){t.objects.reduce((function(t,n){var a=n.x,r=n.y;void 0!==n.gid&&(r-=n.height);var c=[a/e.tilewidth,r/e.tileheight],o=h(n.properties),i=Object(p.a)({location:c,ezProps:o},n);return t["".concat(c[0],",").concat(c[1])]=i,t}),n)})),n},h=function(e){if(e)return e.reduce((function(e,t){return e[t.name]=t.value,e}),{})};!function(e){e.adventurerStart="adventurerStart",e.exit="exit"}(a||(a={}));var g=function(e,t,n){t.data.reduce((function(e,t,a){if(t>0){var r=a%n,c=Math.floor(a/n);e.push([r,c])}return e}),e)},b=function(e,t){return e[0]===t[0]&&e[1]===t[1]},y=n(58),O=n(69),j=n(261),w=n(24),E=n(41),k=n(42),N=n(28);function T(e){return"string"===typeof e.key}var I=n(6),S=n(46),x=n(56),C=n(40),q=n(54),A=n(39);var D=function(){function e(t,n){Object(r.a)(this,e),this.mapData=void 0,this.aStar=void 0,this.questName=void 0,this.tilemapObjects=void 0,this.jsonPath=void 0,this.store=void 0,this.blockedTiles=[],this.spritesheetsMap={},this.store=t,this.questName=n}return Object(c.a)(e,[{key:"loadData",value:function(e){var t=this;if(this.dataLoaded)return e();if(!this.jsonPath)throw new Error("No jsonPath defined!");Object(O.b)("".concat(".","/").concat(this.jsonPath),function(){var n=Object(d.a)(m.a.mark((function n(a){var r,c,o,i,u,s,l;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t.mapData=a.data,t.tilemapObjects=v(a.data),t.mapData.layers.filter((function(e){return e.visible})).forEach((function(e){e.properties&&e.properties.some((function(e){return"blocksMovement"===e.name&&!0===e.value}))&&g(t.blockedTiles,e,e.width)})),r=t.getAdventurers(),c=Array.from(new Set(r.map((function(e){return e.spritesheetPath})))),o=0,i=c;case 6:if(!(o<i.length)){n.next=16;break}return u=i[o],n.next=10,Object(O.c)(u);case 10:s=n.sent,l=s.spritesheet,t.spritesheetsMap[u]=l;case 13:o++,n.next=6;break;case 16:t.aStar=t.createAStar(),e();case 18:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}},{key:"createScene",value:function(){var e={objects:this.createObjects(),actors:this.createActors(),combat:!0};this.store.dispatch(Object(w.h)(this.questName,e))}},{key:"sceneEntered",value:function(){}},{key:"getActorSpritesheet",value:function(e){var t=this.getActorSpritesheetPath(e);return this.spritesheetsMap[t]}},{key:"getActorSpritesheetPath",value:function(e){return this.getAdventurers().find((function(t){return t.id===e})).spritesheetPath}},{key:"actorMoved",value:function(e,t){var n,a=this.tilemapObjects["".concat(t[0],",").concat(t[1])];if(a&&"exit"===a.type)if(null===(n=a.ezProps)||void 0===n?void 0:n.loadScene)this.store.dispatch(Object(w.i)(this.questName,a.ezProps.loadScene));else{var r=Math.floor(this.getQuest().progress)+1,c=Object(x.b)(this.questName).nodes[r];c.log&&this.store.dispatch(Object(S.c)(c.log,null,C.a.quest,this.questName)),this.store.dispatch(Object(w.e)(this.questName))}}},{key:"actorCanInteract",value:function(e){var t,n,a=this.getQuest().scene,r=null===a||void 0===a?void 0:a.actors.find((function(t){return t.name===e})),c=null===(t=this.tilemapObjects)||void 0===t?void 0:t["".concat(r.location[0],",").concat(r.location[1])];return c&&(null===(n=c.ezProps)||void 0===n?void 0:n.interactive)}},{key:"actorInteract",value:function(e){if(this.actorCanInteract(e)){var t=this.getQuest().scene,n=null===t||void 0===t?void 0:t.actors.find((function(t){return t.name===e})),a=null===t||void 0===t?void 0:t.objects.find((function(e){return b(e.location,n.location)}));a?this.interactWithObject(n,a):console.warn("No object found")}else console.warn("Can't interact")}},{key:"interactWithObject",value:function(e,t){}},{key:"pointToSceneLocation",value:function(e){var t,n;return(null===(t=this.mapData)||void 0===t?void 0:t.tilewidth)&&(null===(n=this.mapData)||void 0===n?void 0:n.tileheight)?[Math.floor(e.x/this.mapData.tilewidth),Math.floor(e.y/this.mapData.tilewidth)]:[0,0]}},{key:"locationIsBlocked",value:function(e){return this.blockedTiles.some((function(t){return b(t,e)}))}},{key:"getLootCache",value:function(e){}},{key:"takeGoldFromCache",value:function(e){var t=this.getLootCache(e);t&&this.store.dispatch(Object(q.b)(t.gold||0))}},{key:"takeItemFromCache",value:function(e,t,n,a){var r=this.getLootCache(t);if(r){var c=r.items[e];this.store.dispatch(Object(A.b)(n.id,c,a))}}},{key:"getSituation",value:function(e,t){}},{key:"handleSituationOptionClick",value:function(e,t){}},{key:"findPath",value:function(e,t){var n,a=function(e){return{x:e[0],y:e[1]}};return null===(n=this.aStar)||void 0===n?void 0:n.findPath(a(e),a(t))}},{key:"calculateWalkApCosts",value:function(e,t){var n;return(null===(n=this.findPath(e,t))||void 0===n?void 0:n.length)||0}},{key:"getRemainingAdventurerAp",value:function(e){var t,n=this.getQuest().scene;return null===n||void 0===n||null===(t=n.actors.find((function(t){return t.name===e})))||void 0===t?void 0:t.ap}},{key:"createAStar",value:function(){for(var e=[],t=0;t<this.mapData.height;t++){for(var n=[],a=0;a<this.mapData.width;a++){var r=[a,t],c=this.locationIsBlocked(r);n.push(c?1:0)}e.push(n)}return new j.AStarFinder({grid:{matrix:e},includeStartNode:!1,heuristic:"Manhattan",weight:0})}},{key:"createActors",value:function(){if(!this.tilemapObjects)throw new Error("No tilemapObjects");var e=this.getAdventurers(),t=Object.values(this.tilemapObjects).filter((function(e){return"adventurerStart"===e.type})).map((function(e){return e.location}));if(e.length>t.length)throw new Error("Not enough objects with 'adventurerStart' property set to true");return e.reduce((function(e,n,a){var r=t[a],c=n.baseAP;return e.push({location:r,name:n.id,ap:c}),e}),[])}},{key:"createObjects",value:function(){var e=this;if(!this.tilemapObjects)throw new Error("No tilemapObjects");return Object.values(this.tilemapObjects).map((function(t){return e.createObject(t)})).filter((function(e){return null!==e}))}},{key:"createObject",value:function(e){switch(e.type){case a.adventurerStart:case a.exit:return null;default:return e}}},{key:"getQuest",value:function(){var e=this;return this.store.getState().quests.find((function(t){return t.name===e.questName}))}},{key:"getQuestVars",value:function(){return this.getQuest().questVars}},{key:"getAdventurers",value:function(){var e=this.store.getState(),t=this.getQuest();return Object(y.b)(e.adventurers,t)}},{key:"getAdventurerByActor",value:function(e){return this.store.getState().adventurers.find((function(t){return t.id===e.name}))}},{key:"questUpdate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=T(e)?e:{key:e},r=I.a.getTextEntry(a);n&&E.a.addToast(r,k.a.questUpdate,t,Object(N.a)(this.questName)),this.store.dispatch(Object(S.b)(a,C.a.quest,this.questName))}},{key:"basePath",get:function(){return this.jsonPath?"".concat(".","/").concat(this.jsonPath.substr(0,this.jsonPath.lastIndexOf("/"))):null}},{key:"dataLoaded",get:function(){return!!this.mapData}}]),e}(),R=n(107),P=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),o=0;o<a;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).jsonPath="scenes/ork-dungeon-level1.json",e}return Object(c.a)(n,[{key:"interactWithObject",value:function(e,t){switch(t.name){case"chest":if(33===t.gid){var a,r={key:"quest-common-adventurer-opened-chest",context:{adventurer:null===(a=this.getAdventurerByActor(e))||void 0===a?void 0:a.name}};this.questUpdate(r,"/img/items/misc/chest-02.png"),this.store.dispatch(Object(w.k)(this.questName,t.id,{gid:34}))}this.store.dispatch(Object(w.g)(this.questName,{type:"lootCache",lootCache:t.name}));break;case"altar":this.store.dispatch(Object(w.g)(this.questName,{type:"situation",situation:"altar"}))}Object(o.a)(Object(i.a)(n.prototype),"interactWithObject",this).call(this,e,t)}},{key:"sceneEntered",value:function(){this.getQuestVars().dungeon.entered||this.questUpdate("quest-kill10-boars-enter-dungeon-see-chest")}},{key:"getLootCache",value:function(e){return this.getQuestVars().dungeon.lootCaches[e]}},{key:"takeGoldFromCache",value:function(e){if(Object(o.a)(Object(i.a)(n.prototype),"takeGoldFromCache",this).call(this,e),this.getLootCache(e)){var t=this.getQuestVars();t.dungeon.lootCaches[e].gold=0,this.store.dispatch(Object(w.j)(this.questName,t))}}},{key:"takeItemFromCache",value:function(e,t,a,r){if(Object(o.a)(Object(i.a)(n.prototype),"takeItemFromCache",this).call(this,e,t,a,r),this.getLootCache(t)){var c=this.getQuestVars(),u=c.dungeon.lootCaches[t].items.filter((function(t,n){return n!==e}));c.dungeon.lootCaches[t].items=u,this.store.dispatch(Object(w.j)(this.questName,c))}}},{key:"getSituation",value:function(e,t){switch(e){case"altar":return this.getQuestVars().dungeon.situations.altar.candleLit?{title:"quest-kill10-boars-dungeonentrance-altar",choices:["quest-kill10-boars-dungeonentrance-altar-rummagedrawers"]}:{title:"quest-kill10-boars-dungeonentrance-altar",choices:["quest-kill10-boars-dungeonentrance-altar-lightcandle","quest-kill10-boars-dungeonentrance-altar-rummagedrawers"]};default:return Object(o.a)(Object(i.a)(n.prototype),"getSituation",this).call(this,e,t)}}},{key:"handleSituationOptionClick",value:function(e,t){switch(e){case"altar":switch(t){case"quest-kill10-boars-dungeonentrance-altar-lightcandle":var n=this.getQuestVars();n.dungeon.situations.altar.candleLit=!0,this.store.dispatch(Object(w.j)(this.questName,n));break;case"quest-kill10-boars-dungeonentrance-altar-rummagedrawers":this.store.dispatch(Object(w.g)(this.questName,{type:"lootCache",lootCache:"altar"}))}}}}]),n}(D),M=function(e){Object(u.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,c=new Array(a),o=0;o<a;o++)c[o]=arguments[o];return(e=t.call.apply(t,[this].concat(c))).jsonPath="scenes/ork-dungeon-level2.json",e}return n}(D);R.a.registerSceneController("kill10Boars","dungeon.entrance",P),R.a.registerSceneController("kill10Boars","dungeon.hallway",M)},54:function(e,t,n){"use strict";var a;function r(e){return{type:a.addGold,amount:e}}function c(e){return{type:a.addGold,amount:-e}}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c})),function(e){e.addGold="addGold"}(a||(a={}))},56:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var a=n(18),r=n(124),c={getQuestVars:function(e){return e.questVars},getInitialQuestVars:function(e){return r.a},nodes:[{x:0,y:1,type:a.a.nothing,log:"quest-kill10-boars-node0"},{x:0,y:2,type:a.a.nothing},{x:0,y:3,type:a.a.nothing},{x:0,y:4,type:a.a.nothing},{x:0,y:3,type:a.a.encounter,startScene:"dungeon.entrance"},{x:1,y:3,type:a.a.nothing,log:"quest-kill10-boars-leave-dungeon"},{x:1,y:3,type:a.a.nothing,log:"quest-kill10-boars-left-dungeon"},{x:2,y:3,type:a.a.nothing},{x:3,y:3,type:a.a.encounter,startScene:"dungeon.hallway"},{x:4,y:4,type:a.a.nothing,log:"The party spots a boss"},{x:5,y:4,type:a.a.nothing}]},o=n(1),i={kill10Boars:c,retrieveMagicAmulet:{getQuestVars:function(e){return e.questVars},getInitialQuestVars:function(e){return{baz:!1,zux:13}},requiredItems:[o.a.torch,o.a.torch,o.a.torch,o.a.sandwich,o.a.sandwich],nodes:[{x:0,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:2,y:1,type:a.a.nothing},{x:3,y:1,type:a.a.nothing},{x:4,y:1,type:a.a.nothing},{x:5,y:1,type:a.a.nothing},{x:7,y:1,type:a.a.nothing},{x:8,y:2,type:a.a.nothing},{x:8,y:3,type:a.a.nothing},{x:9,y:3,type:a.a.nothing},{x:10,y:1,type:a.a.nothing},{x:10,y:2,type:a.a.nothing},{x:10,y:3,type:a.a.nothing},{x:10,y:4,type:a.a.nothing},{x:11,y:5,type:a.a.nothing},{x:12,y:6,type:a.a.nothing},{x:12,y:7,type:a.a.nothing},{x:13,y:8,type:a.a.nothing},{x:12,y:8,type:a.a.nothing},{x:12,y:9,type:a.a.nothing},{x:11,y:8,type:a.a.nothing},{x:10,y:8,type:a.a.nothing},{x:9,y:8,type:a.a.nothing},{x:8,y:9,type:a.a.nothing},{x:7,y:8,type:a.a.encounter,startScene:"dungeon.hallway"},{x:8,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:1,y:1,type:a.a.nothing},{x:2,y:1,type:a.a.encounter,startScene:"dungeon.hallway"},{x:3,y:1,type:a.a.nothing}]}};t.a=i;function u(e){return i[e]}},58:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return i}));var a=function(e,t){return t.party.map((function(t){return c(e,t)}))},r=function(e,t){var n=t.party[0];return c(e,n)},c=function(e,t){return e.find((function(e){return e.id===t}))},o=function(e){return e.inventory.filter((function(e){return null===e})).length},i=function(e){return!!e.rngState}},6:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(20),r=n(22),c=n(47),o=n(43),i=n(1),u=n(78),s=n(42),l=n(11),m=n(26),d=function(){function e(){Object(a.a)(this,e)}return Object(r.a)(e,null,[{key:"init",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.texts=e,this.templates={},t&&this.compileAll(),this.initialized=!0}},{key:"get",value:function(e,t){var n=this.getDefault(e,t);return null===n?(console.error("Key '".concat(e,"' not found in TextManager")),"<<'".concat(e,"' missing>>")):n}},{key:"getDefault",value:function(e,t){if(!this.initialized)throw new Error("Error ".concat(this," not initialized!"));var n=this.getTemplate(e);return n?n(t):null}},{key:"getTextEntry",value:function(e){return this.get(e.key,e.context)}},{key:"getTemplate",value:function(e){var t=this.templates[e];return!t&&this.texts[e]&&(this.compile(e,this.texts[e]),t=this.templates[e]),t}},{key:"getEquipmentSlot",value:function(e){return this.get("ui-equipmentslot-".concat(Object(c.a)(l.a[e])))}},{key:"getQuestTitle",value:function(e){return this.get("quest-".concat(Object(c.a)(e),"-title"))}},{key:"getQuestDescription",value:function(e){return this.get("quest-".concat(Object(c.a)(e),"-description"))}},{key:"getResourceName",value:function(e){return this.get("resource-".concat(e,"-name"))}},{key:"getItemName",value:function(e){var t=i.b[Object(o.b)(e).itemType];return this.get("item-".concat(Object(c.a)(t),"-").concat(Object(c.a)(e),"-name"))}},{key:"getItemSubtext",value:function(e){var t=i.b[Object(o.b)(e).itemType];return this.getDefault("item-".concat(Object(c.a)(t),"-").concat(Object(c.a)(e),"-subtext"))}},{key:"getStructureName",value:function(e){return this.get("structure-".concat(Object(c.a)(e),"-name"))}},{key:"getTraitName",value:function(e){return this.get("trait-".concat(Object(c.a)(e),"-name"))}},{key:"getTraitDescription",value:function(e){return this.get("trait-".concat(Object(c.a)(e),"-description"))}},{key:"getTraitEffect",value:function(e){return this.get("trait-".concat(Object(c.a)(e),"-effect"))}},{key:"getToastType",value:function(e){return this.get("ui-toast-type-".concat(Object(c.a)(s.a[e])))}},{key:"getWeaponType",value:function(e){return this.get("ui-weapon-type-".concat(Object(c.a)(m.c[e])))}},{key:"getSkillName",value:function(e){return this.get("skill-".concat(Object(c.a)(m.c[e]),"-name"))}},{key:"getSkillInfo",value:function(e){return this.get("skill-".concat(Object(c.a)(m.c[e]),"-info"))}},{key:"getWeaponClassification",value:function(e){return this.get("ui-weapon-class-".concat(Object(c.a)(m.b[e])))}},{key:"compileAll",value:function(){var e=this;Object.keys(this.texts).forEach((function(t){e.compile(t,e.texts[t])}))}},{key:"compile",value:function(e,t){var n=u.compile(t);this.templates[e]=n}}]),e}();d.initialized=!1,d.texts=void 0,d.templates=void 0,u.registerHelper("item:name",(function(e,t){if(!o.a[e])return new u.SafeString("<<ITEM DEFINITION NOT FOUND: ".concat(e,">>"));switch(t){case"aA":return p(e);case"aD":case"aU":return v(e);default:return new u.SafeString(e)}})),u.registerHelper("structure:name",(function(e){var t=d.get("structure-".concat(e,"-name"));return new u.SafeString(t)}));var p=function(e){return f(e)},f=function(e){var t=d.getItemName(e),n=d.getTemplate("common-article-undefined");return new u.SafeString("".concat(n({noun:t})))},v=function(e){var t=d.getItemName(e),n=d.getTemplate("common-article-defined");return new u.SafeString("".concat(n({noun:t})))}},69:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l}));var a=n(32),r=n.n(a),c=n(45),o=function(e,t,n){return e+n*(t-e)},i=function(e,t,n){return{x:o(e.x,t.x,n),y:o(e.y,t.y,n)}};function u(e){return s.apply(this,arguments)}function s(){return(s=Object(c.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=PIXI.Loader.shared,e.abrupt("return",new Promise((function(e,a){n.resources[t]?e(n.resources[t]):n.add(t).load((function(n,a){e(a[t])}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var l=function(e,t){var n=PIXI.Loader.shared;n.resources[e]?t(n.resources[e]):n.add(e).load((function(n,a){t(a[e])}))}},85:function(e,t,n){},9:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return w}));var a,r=n(30),c={type:r.a.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-alchemist-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-alchemist-name",workerCapacity:5,cost:{gold:30},unlocks:[]},{displayName:"structure-alchemist-name",workerCapacity:10,cost:{gold:50},unlocks:[]}]},o=n(1),i={cost:{gold:40,time:4e3},type:r.a.production,levels:[{displayName:"structure-armoursmith-name",workerCapacity:2,cost:{gold:0},unlocks:[o.a.boots1]},{displayName:"structure-armoursmith-name",workerCapacity:5,cost:{gold:30},unlocks:[o.a.chest]},{displayName:"structure-armoursmith-name",workerCapacity:10,cost:{gold:50},unlocks:[o.a.cowl]}]},u={type:r.a.resource,cost:{gold:40,time:4e3},levels:[{displayName:"structure-garden-name",workerCapacity:2,cost:{gold:0},generates:{food:2}},{displayName:"structure-garden-name",workerCapacity:5,cost:{gold:30},generates:{food:2}},{displayName:"structure-garden-name",workerCapacity:10,cost:{gold:50},generates:{food:2}}]},s=n(13),l={type:r.a.resource,cost:{gold:31,time:s.a},levels:[{displayName:"structure-lumber-mill-name",workerCapacity:2,cost:{gold:0},generates:{wood:2}},{displayName:"structure-lumber-mill-name",workerCapacity:5,cost:{gold:30},generates:{wood:2}},{displayName:"structure-lumber-mill-name",workerCapacity:10,cost:{gold:50},generates:{wood:2}}]},m={cost:{gold:40,time:4e3},type:r.a.resource,levels:[{displayName:"structure-mine-name",workerCapacity:2,cost:{gold:0},generates:{iron:2}},{displayName:"structure-mine-name",workerCapacity:5,cost:{gold:30},generates:{iron:2}},{displayName:"structure-mine-name",workerCapacity:10,cost:{gold:50},generates:{iron:2}}]},d={cost:{gold:40,time:4e3},type:r.a.resource,levels:[{displayName:"structure-quarry-name",workerCapacity:2,cost:{gold:0},generates:{stone:2}},{displayName:"structure-quarry-name",workerCapacity:5,cost:{gold:30},generates:{stone:4}},{displayName:"structure-quarry-name",workerCapacity:10,cost:{gold:50},generates:{stone:6}}]},p={cost:{gold:40,time:4e3},type:r.a.resource,levels:[{displayName:"structure-tannery-name",workerCapacity:2,cost:{gold:0},generates:{leather:2}},{displayName:"structure-tannery-name",workerCapacity:5,cost:{gold:30},generates:{leather:5}},{displayName:"structure-tannery-name",workerCapacity:10,cost:{gold:50},generates:{leather:7}}]},f={cost:{gold:40,time:4e3},type:r.a.tavern,levels:[{displayName:"structure-tavern-name",workerCapacity:2,cost:{gold:0},rooms:10},{displayName:"structure-tavern-name",workerCapacity:5,cost:{gold:30},rooms:12},{displayName:"structure-tavern-name",workerCapacity:10,cost:{gold:50},rooms:15}]},v={cost:{gold:40,time:4e3},type:r.a.warehouse,levels:[{displayName:"structure-warehouse-name",workerCapacity:2,cost:{gold:0},maxResources:{fabric:200,food:200,iron:200,leather:200,stone:200,wood:200}},{displayName:"structure-warehouse-name",workerCapacity:5,cost:{gold:30},maxResources:{fabric:500,food:500,iron:500,leather:500,stone:500,wood:500}},{displayName:"structure-warehouse-name",workerCapacity:10,cost:{gold:50},maxResources:{fabric:1e3,food:1e3,iron:1e3,leather:1e3,stone:1e3,wood:1e3}}]},h={type:r.a.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-weaponsmith-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:5,cost:{gold:30},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:10,cost:{gold:50},unlocks:[]},{displayName:"structure-weaponsmith-name",workerCapacity:14,cost:{gold:50},unlocks:[o.a.poisonedDagger]}]},g={cost:{gold:40,time:4e3},type:r.a.resource,levels:[{displayName:"structure-weaver-name",workerCapacity:2,cost:{gold:0},generates:{fabric:2}},{displayName:"structure-weaver-name",workerCapacity:5,cost:{gold:30},generates:{fabric:5}},{displayName:"structure-weaver-name",workerCapacity:10,cost:{gold:50},generates:{fabric:7}}]},b={type:r.a.production,cost:{gold:40,time:4e3},levels:[{displayName:"structure-workshop-name",workerCapacity:2,cost:{gold:0},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:5,cost:{gold:30},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:10,cost:{gold:50},unlocks:[]},{displayName:"structure-workshop-name",workerCapacity:14,cost:{gold:50},unlocks:[]}]},y=n(31);!function(e){e.alchemist="alchemist",e.armoursmith="armoursmith",e.garden="garden",e.lumberMill="lumberMill",e.mine="mine",e.quarry="quarry",e.tavern="tavern",e.tannery="tannery",e.warehouse="warehouse",e.weaponsmith="weaponsmith",e.weaver="weaver",e.workshop="workshop"}(a||(a={}));var O={alchemist:c,armoursmith:i,garden:u,lumberMill:l,mine:m,quarry:d,tavern:f,tannery:p,warehouse:v,weaponsmith:h,weaver:g,workshop:b};function j(e){return O[e]}function w(e){switch(e){case y.a.fabric:return a.weaver;case y.a.food:return a.garden;case y.a.iron:return a.mine;case y.a.leather:return a.tannery;case y.a.stone:return a.quarry;case y.a.wood:return a.lumberMill}}}},[[269,1,2]]]);
//# sourceMappingURL=main.988b6437.chunk.js.map